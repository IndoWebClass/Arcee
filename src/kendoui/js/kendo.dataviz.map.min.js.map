{"version":3,"file":"kendo.dataviz.map.min.js","sources":["kendo.dataviz.map.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define) {\r\n    define('util/main',[\r\n        \"../kendo.core\"\r\n    ], f);\r\n})(function() {\r\n\r\n(function () {\r\n    // Imports ================================================================\r\n    var kendo = window.kendo,\r\n        deepExtend = kendo.deepExtend;\r\n\r\n    function sqr(value) {\r\n        return value * value;\r\n    }\r\n\r\n    var now = Date.now;\r\n    if (!now) {\r\n        now = function() {\r\n            return new Date().getTime();\r\n        };\r\n    }\r\n\r\n    // Template helpers =======================================================\r\n\r\n    function renderSize(size) {\r\n        if (typeof size !== \"string\") {\r\n            size += \"px\";\r\n        }\r\n\r\n        return size;\r\n    }\r\n\r\n    function renderPos(pos) {\r\n        var result = [];\r\n\r\n        if (pos) {\r\n            var parts = kendo.toHyphens(pos).split(\"-\");\r\n\r\n            for (var i = 0; i < parts.length; i++) {\r\n                result.push(\"k-pos-\" + parts[i]);\r\n            }\r\n        }\r\n\r\n        return result.join(\" \");\r\n    }\r\n\r\n    function arabicToRoman(n) {\r\n        var literals = {\r\n            1    : \"i\",       10   : \"x\",       100  : \"c\",\r\n            2    : \"ii\",      20   : \"xx\",      200  : \"cc\",\r\n            3    : \"iii\",     30   : \"xxx\",     300  : \"ccc\",\r\n            4    : \"iv\",      40   : \"xl\",      400  : \"cd\",\r\n            5    : \"v\",       50   : \"l\",       500  : \"d\",\r\n            6    : \"vi\",      60   : \"lx\",      600  : \"dc\",\r\n            7    : \"vii\",     70   : \"lxx\",     700  : \"dcc\",\r\n            8    : \"viii\",    80   : \"lxxx\",    800  : \"dccc\",\r\n            9    : \"ix\",      90   : \"xc\",      900  : \"cm\",\r\n            1000 : \"m\"\r\n        };\r\n        var values = [ 1000,\r\n                       900 , 800, 700, 600, 500, 400, 300, 200, 100,\r\n                       90  , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\r\n                       9   , 8  , 7  , 6  , 5  , 4  , 3  , 2  , 1 ];\r\n        var roman = \"\";\r\n        while (n > 0) {\r\n            if (n < values[0]) {\r\n                values.shift();\r\n            } else {\r\n                roman += literals[values[0]];\r\n                n -= values[0];\r\n            }\r\n        }\r\n        return roman;\r\n    }\r\n\r\n    function romanToArabic(r) {\r\n        r = r.toLowerCase();\r\n        var digits = {\r\n            i: 1,\r\n            v: 5,\r\n            x: 10,\r\n            l: 50,\r\n            c: 100,\r\n            d: 500,\r\n            m: 1000\r\n        };\r\n        var value = 0, prev = 0;\r\n        for (var i = 0; i < r.length; ++i) {\r\n            var v = digits[r.charAt(i)];\r\n            if (!v) {\r\n                return null;\r\n            }\r\n            value += v;\r\n            if (v > prev) {\r\n                value -= 2 * prev;\r\n            }\r\n            prev = v;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    function memoize(f) {\r\n        var cache = Object.create(null);\r\n        return function() {\r\n            var id = \"\";\r\n            for (var i = arguments.length; --i >= 0;) {\r\n                id += \":\" + arguments[i];\r\n            }\r\n            return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\r\n        };\r\n    }\r\n\r\n    function isUnicodeLetter(ch) {\r\n        return RX_UNICODE_LETTER.test(ch);\r\n    }\r\n\r\n    function withExit(f, obj) {\r\n        try {\r\n            return f.call(obj, function(value){\r\n                throw new Return(value);\r\n            });\r\n        } catch(ex) {\r\n            if (ex instanceof Return) {\r\n                return ex.value;\r\n            }\r\n            throw ex;\r\n        }\r\n        function Return(value) {\r\n            this.value = value;\r\n        }\r\n    }\r\n\r\n    // Exports ================================================================\r\n    deepExtend(kendo, {\r\n        util: {\r\n            now: now,\r\n            renderPos: renderPos,\r\n            renderSize: renderSize,\r\n            sqr: sqr,\r\n            romanToArabic: romanToArabic,\r\n            arabicToRoman: arabicToRoman,\r\n            memoize: memoize,\r\n            isUnicodeLetter: isUnicodeLetter,\r\n            withExit: withExit\r\n        }\r\n    });\r\n\r\n    var RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\r\n\r\n})();\r\n\r\nreturn window.kendo;\r\n\r\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\r\n\n(function(f, define){\n    define('dataviz/map/location',[ \"../../kendo.drawing\", \"../../util/main\" ], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n        abs = math.abs,\n        atan = math.atan,\n        atan2 = math.atan2,\n        cos = math.cos,\n        max = math.max,\n        min = math.min,\n        sin = math.sin,\n        tan = math.tan,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        util = kendo.drawing.util,\n        defined = util.defined,\n        deg = util.deg,\n        rad = util.rad,\n        round = util.round,\n        valueOrDefault = util.valueOrDefault,\n\n        sqr = kendo.util.sqr;\n\n    // Implementation =========================================================\n    var Location = Class.extend({\n        init: function(lat, lng) {\n            if (arguments.length === 1) {\n                this.lat = lat[0];\n                this.lng = lat[1];\n            } else {\n                this.lat = lat;\n                this.lng = lng;\n            }\n        },\n\n        DISTANCE_ITERATIONS: 100,\n        DISTANCE_CONVERGENCE: 1e-12,\n        DISTANCE_PRECISION: 2,\n        FORMAT: \"{0:N6},{1:N6}\",\n\n        toArray: function() {\n            return [this.lat, this.lng];\n        },\n\n        equals: function(loc) {\n            return loc && loc.lat === this.lat && loc.lng === this.lng;\n        },\n\n        clone: function() {\n            return new Location(this.lat, this.lng);\n        },\n\n        round: function(precision) {\n            this.lng = round(this.lng, precision);\n            this.lat = round(this.lat, precision);\n            return this;\n        },\n\n        wrap: function() {\n            this.lng = this.lng % 180;\n            this.lat = this.lat % 90;\n            return this;\n        },\n\n        distanceTo: function(dest, datum) {\n            return this.greatCircleTo(dest, datum).distance;\n        },\n\n        destination: function(distance, bearing, datum) {\n            bearing = rad(bearing);\n            datum = datum || dataviz.map.datums.WGS84;\n\n            var fromLat = rad(this.lat);\n            var fromLng = rad(this.lng);\n            var dToR = distance / kendo.dataviz.map.datums.WGS84.a;\n\n            var lat = math.asin(sin(fromLat) * cos(dToR) +\n                                cos(fromLat) * sin(dToR) * cos(bearing));\n\n            var lng = fromLng + atan2(sin(bearing) * sin(dToR) * cos(fromLat),\n                                      cos(dToR) - sin(fromLat) * sin(lat));\n\n           return new Location(deg(lat), deg(lng));\n        },\n\n        greatCircleTo: function(dest, datum) {\n            dest = Location.create(dest);\n            datum = datum || dataviz.map.datums.WGS84;\n\n            if (!dest || this.clone().round(8).equals(dest.clone().round(8))) {\n                return {\n                    distance: 0,\n                    azimuthFrom: 0,\n                    azimuthTo: 0\n                };\n            }\n\n            // See http://en.wikipedia.org/wiki/Vincenty's_formulae#Notation\n            // o == sigma\n            // A == alpha\n            var a = datum.a;\n            var b = datum.b;\n            var f = datum.f;\n\n            var L = rad(dest.lng - this.lng);\n\n            var U1 = atan((1 - f) * tan(rad(this.lat)));\n            var sinU1 = sin(U1);\n            var cosU1 = cos(U1);\n\n            var U2 = atan((1 - f) * tan(rad(dest.lat)));\n            var sinU2 = sin(U2);\n            var cosU2 = cos(U2);\n\n            var lambda = L;\n            var prevLambda;\n\n            var i = this.DISTANCE_ITERATIONS;\n            var converged = false;\n\n            var sinLambda;\n            var cosLambda;\n            var sino;\n            var cosA2;\n            var coso;\n            var cos2om;\n            var sigma;\n\n            while (!converged && i-- > 0) {\n                sinLambda = sin(lambda);\n                cosLambda = cos(lambda);\n                sino = math.sqrt(\n                    sqr(cosU2 * sinLambda) + sqr(cosU1 * sinU2 - sinU1 * cosU2 * cosLambda)\n                );\n\n                coso = sinU1 * sinU2 + cosU1 * cosU2 * cosLambda;\n                sigma = atan2(sino, coso);\n\n                var sinA = cosU1 * cosU2 * sinLambda / sino;\n                cosA2 = 1 - sqr(sinA);\n                cos2om = 0;\n                if (cosA2 !== 0) {\n                    cos2om = coso - 2 * sinU1 * sinU2 / cosA2;\n                }\n\n                prevLambda = lambda;\n                var C = f / 16 * cosA2 * (4 + f * (4 - 3 * cosA2));\n                lambda = L + (1 - C) * f * sinA * (\n                    sigma + C * sino * (cos2om + C * coso * (-1 + 2 * sqr(cos2om)))\n                );\n\n                converged = abs(lambda - prevLambda) <= this.DISTANCE_CONVERGENCE;\n            }\n\n            var u2 = cosA2 * (sqr(a) - sqr(b)) / sqr(b);\n            var A = 1 + u2 / 16384 * (4096 + u2 * (-768 + u2 * (320 - 175 * u2)));\n            var B = u2 / 1024 * (256 + u2 * (-128 + u2 * (74 - 47 * u2)));\n            var deltao = B * sino * (cos2om + B / 4 * (\n                coso * (-1 + 2 * sqr(cos2om)) - B / 6 * cos2om * (-3 + 4 * sqr(sino)) * (-3 + 4 * sqr(cos2om))\n            ));\n\n            var azimuthFrom = atan2(cosU2 * sinLambda, cosU1 * sinU2 - sinU1 * cosU2 * cosLambda);\n            var azimuthTo = atan2(cosU1 * sinLambda, -sinU1 * cosU2 + cosU1 * sinU2 * cosLambda);\n\n            return {\n                distance: round(b * A * (sigma - deltao), this.DISTANCE_PRECISION),\n                azimuthFrom: deg(azimuthFrom),\n                azimuthTo: deg(azimuthTo)\n            };\n        }\n    });\n\n    // IE < 9 doesn't allow to override toString on definition\n    Location.fn.toString = function() {\n        return kendo.format(this.FORMAT, this.lat, this.lng);\n    };\n\n    Location.fromLngLat = function(ll) {\n        return new Location(ll[1], ll[0]);\n    };\n\n    Location.fromLatLng = function(ll) {\n        return new Location(ll[0], ll[1]);\n    };\n\n    Location.create = function(a, b) {\n        if (defined(a)) {\n            if (a instanceof Location) {\n                return a.clone();\n            } else if (arguments.length === 1 && a.length === 2) {\n                return Location.fromLatLng(a);\n            } else {\n                return new Location(a, b);\n            }\n        }\n    };\n\n    var Extent = Class.extend({\n        init: function(nw, se) {\n            nw = Location.create(nw);\n            se = Location.create(se);\n\n            if (nw.lng + 180 > se.lng + 180 &&\n                nw.lat + 90 < se.lat + 90) {\n                this.se = nw;\n                this.nw = se;\n            } else {\n                this.se = se;\n                this.nw = nw;\n            }\n        },\n\n        contains: function(loc) {\n            var nw = this.nw,\n                se = this.se,\n                lng = valueOrDefault(loc.lng, loc[1]),\n                lat = valueOrDefault(loc.lat, loc[0]);\n\n            return loc &&\n                   lng + 180 >= nw.lng + 180 &&\n                   lng + 180 <= se.lng + 180 &&\n                   lat + 90 >= se.lat + 90 &&\n                   lat + 90 <= nw.lat + 90;\n        },\n\n        center: function() {\n            var nw = this.nw;\n            var se = this.se;\n\n            var lng = nw.lng + (se.lng - nw.lng) / 2;\n            var lat = nw.lat + (se.lat - nw.lat) / 2;\n            return new Location(lat, lng);\n        },\n\n        containsAny: function(locs) {\n            var result = false;\n            for (var i = 0; i < locs.length; i++) {\n                result = result || this.contains(locs[i]);\n            }\n\n            return result;\n        },\n\n        include: function(loc) {\n            var nw = this.nw,\n                se = this.se,\n                lng = valueOrDefault(loc.lng, loc[1]),\n                lat = valueOrDefault(loc.lat, loc[0]);\n\n            nw.lng = min(nw.lng, lng);\n            nw.lat = max(nw.lat, lat);\n\n            se.lng = max(se.lng, lng);\n            se.lat = min(se.lat, lat);\n        },\n\n        includeAll: function(locs) {\n            for (var i = 0; i < locs.length; i++) {\n                this.include(locs[i]);\n            }\n        },\n\n        edges: function() {\n            var nw = this.nw,\n                se = this.se;\n\n            return {nw: this.nw, ne: new Location(nw.lat, se.lng),\n                    se: this.se, sw: new Location(se.lat, nw.lng)};\n        },\n\n        toArray: function() {\n            var nw = this.nw,\n                se = this.se;\n\n            return [nw, new Location(nw.lat, se.lng),\n                    se, new Location(se.lat, nw.lng)];\n        },\n\n        overlaps: function(extent) {\n            return this.containsAny(extent.toArray()) ||\n                   extent.containsAny(this.toArray());\n        }\n    });\n\n    Extent.World = new Extent([90, -180], [-90, 180]);\n\n    Extent.create = function(a, b) {\n        if (a instanceof Extent) {\n            return a;\n        } else if (a && b) {\n            return new Extent(a, b);\n        } else if (a && a.length === 4 && !b) {\n            return new Extent([a[0], a[1]], [a[2], a[3]]);\n        }\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            Extent: Extent,\n            Location: Location\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/attribution',[ \"../../kendo.drawing\" ], f);\n})(function(){\n\n(function() {\n    var kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        template = kendo.template,\n\n        util = kendo.drawing.util,\n        valueOrDefault = util.valueOrDefault,\n        defined = util.defined;\n\n    var Attribution = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n            this.items = [];\n            this.element.addClass(\"k-widget k-attribution\");\n        },\n\n        options: {\n            name: \"Attribution\",\n            separator: \"&nbsp;|&nbsp;\",\n            itemTemplate: \"#= text #\"\n        },\n\n        filter: function(extent, zoom) {\n            this._extent = extent;\n            this._zoom = zoom;\n            this._render();\n        },\n\n        add: function(item) {\n            if (defined(item)) {\n                if (typeof item === \"string\") {\n                    item = { text: item };\n                }\n\n                this.items.push(item);\n                this._render();\n            }\n        },\n\n        remove: function(text) {\n            var result = [];\n            for (var i = 0; i < this.items.length; i++) {\n                var item = this.items[i];\n                if (item.text !== text) {\n                    result.push(item);\n                }\n            }\n\n            this.items = result;\n\n            this._render();\n        },\n\n        clear: function() {\n            this.items = [];\n            this.element.empty();\n        },\n\n        _render: function() {\n            var result = [];\n            var itemTemplate = template(this.options.itemTemplate);\n\n            for (var i = 0; i < this.items.length; i++) {\n                var item = this.items[i];\n                var text = this._itemText(item);\n                if (text !== \"\") {\n                    result.push(itemTemplate({\n                        text: text\n                    }));\n                }\n            }\n\n            if (result.length > 0) {\n                this.element.empty()\n                    .append(result.join(this.options.separator))\n                    .show();\n            } else {\n                this.element.hide();\n            }\n        },\n\n        _itemText: function(item) {\n            var text = \"\";\n            var inZoomLevel = this._inZoomLevel(item.minZoom, item.maxZoom);\n            var inArea = this._inArea(item.extent);\n\n            if (inZoomLevel && inArea) {\n                text += item.text;\n            }\n\n            return text;\n        },\n\n        _inZoomLevel: function(min, max) {\n            var result = true;\n            min = valueOrDefault(min, -Number.MAX_VALUE);\n            max = valueOrDefault(max, Number.MAX_VALUE);\n\n            result = this._zoom > min && this._zoom < max;\n\n            return result;\n        },\n\n        _inArea: function(area) {\n            var result = true;\n\n            if (area) {\n                result = area.contains(this._extent);\n            }\n\n            return result;\n        }\n    });\n\n    kendo.dataviz.ui.plugin(Attribution);\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/navigator',[ \"../../kendo.core\" ], f);\n})(function(){\n\n(function ($) {\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var keys = kendo.keys;\n    var proxy = $.proxy;\n\n    var NS = \".kendoNavigator\";\n\n    // Helper functions =======================================================\n    function button(dir) {\n       return kendo.format(\n           '<button class=\"k-button k-button-square k-rounded-full k-button-flat k-button-flat-base k-icon-button k-navigator-{0}\" aria-label=\"move {0}\">' +\n               '<span class=\"k-button-icon k-icon k-i-arrow-60-{0}\"></span>' +\n           '</button>', dir);\n    }\n\n    var BUTTONS = button(\"up\") + button(\"right\") + button(\"down\") + button(\"left\");\n\n    var Navigator = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n\n            this.element.addClass(\"k-widget k-navigator\")\n                        .append(BUTTONS)\n                        .on(\"click\" + NS, \".k-button\", proxy(this, \"_click\"));\n\n            var parentElement = this.element.parent().closest(\"[\" + kendo.attr(\"role\") + \"]\");\n            this._keyroot = parentElement.length > 0 ? parentElement : this.element;\n            this._tabindex(this._keyroot);\n\n            this._keydown = proxy(this._keydown, this);\n            this._keyroot.on(\"keydown\", this._keydown);\n        },\n\n        options: {\n            name: \"Navigator\",\n            panStep: 1\n        },\n\n        events: [\n            \"pan\"\n        ],\n\n        dispose: function() {\n            this._keyroot.off(\"keydown\", this._keydown);\n        },\n\n        _pan: function(x, y) {\n            var panStep = this.options.panStep;\n            this.trigger(\"pan\", {\n                x: x * panStep,\n                y: y * panStep\n            });\n        },\n\n        _click: function(e) {\n            var x = 0;\n            var y = 0;\n            var button = $(e.currentTarget);\n\n            if (button.is(\".k-navigator-up\")) {\n                y = 1;\n            } else if (button.is(\".k-navigator-down\")) {\n                y = -1;\n            } else if (button.is(\".k-navigator-right\")) {\n                x = 1;\n            } else if (button.is(\".k-navigator-left\")) {\n                x = -1;\n            }\n\n            this._pan(x, y);\n            e.preventDefault();\n        },\n\n        _keydown: function(e) {\n            switch (e.which) {\n                case keys.UP:\n                    this._pan(0, 1);\n                    e.preventDefault();\n                    break;\n\n                case keys.DOWN:\n                    this._pan(0, -1);\n                    e.preventDefault();\n                    break;\n\n                case keys.RIGHT:\n                    this._pan(1, 0);\n                    e.preventDefault();\n                    break;\n\n                case keys.LEFT:\n                    this._pan(-1, 0);\n                    e.preventDefault();\n                    break;\n            }\n        }\n    });\n\n    // Exports ================================================================\n    kendo.dataviz.ui.plugin(Navigator);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n(function(f, define){\n    define('dataviz/map/zoom',[ \"../../kendo.core\" ], f);\n})(function(){\n\n(function ($) {\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var keys = kendo.keys;\n    var proxy = $.proxy;\n\n    // Helper functions =======================================================\n    function button(dir, iconClass) {\n       return kendo.format(\n           '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-zoom-{0}\" title=\"zoom-{0}\" aria-label=\"zoom-{0}\"><span class=\"k-button-icon k-icon {1}\"></span></button>',\n           dir, iconClass);\n    }\n\n    var NS = \".kendoZoomControl\";\n    var BUTTONS = button(\"in\", \"k-i-plus\") + button(\"out\", \"k-i-minus\");\n\n    var PLUS = 187;\n    var MINUS = 189;\n    var FF_PLUS = 61;\n    var FF_MINUS = 173;\n\n\n    var ZoomControl = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n\n            this.element.addClass(\"k-widget k-zoom-control k-button-group k-group-horizontal\")\n                        .append(BUTTONS)\n                        .on(\"click\" + NS, \".k-button\", proxy(this, \"_click\"));\n\n            var parentElement = this.element.parent().closest(\"[\" + kendo.attr(\"role\") + \"]\");\n            this._keyroot = parentElement.length > 0 ? parentElement : this.element;\n\n            this._tabindex(this._keyroot);\n\n            this._keydown = proxy(this._keydown, this);\n            this._keyroot.on(\"keydown\", this._keydown);\n        },\n\n        options: {\n            name: \"ZoomControl\",\n            zoomStep: 1\n        },\n\n        events: [\n            \"change\"\n        ],\n\n        _change: function(dir) {\n            var zoomStep = this.options.zoomStep;\n            this.trigger(\"change\", {\n                delta: dir * zoomStep\n            });\n        },\n\n        _click: function(e) {\n            var button = $(e.currentTarget);\n            var dir = 1;\n\n            if (button.is(\".k-zoom-out\")) {\n                dir = -1;\n            }\n\n            this._change(dir);\n            e.preventDefault();\n        },\n\n        _keydown: function(e) {\n            switch (e.which) {\n                case keys.NUMPAD_PLUS:\n                case PLUS:\n                case FF_PLUS:\n                    this._change(1);\n                    break;\n\n                case keys.NUMPAD_MINUS:\n                case MINUS:\n                case FF_MINUS:\n                    this._change(-1);\n                    break;\n            }\n        }\n    });\n\n\n    // Exports ================================================================\n    kendo.dataviz.ui.plugin(ZoomControl);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/crs',[ \"./location\", \"../../kendo.drawing\" ], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n        atan = math.atan,\n        exp = math.exp,\n        pow = math.pow,\n        sin = math.sin,\n        log = math.log,\n        tan = math.tan,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        map = dataviz.map,\n        Location = map.Location,\n\n        util = kendo.drawing.util,\n        rad = util.rad,\n        deg = util.deg,\n        limit = util.limitValue;\n\n    // Constants ==============================================================\n    var PI = math.PI,\n        PI_DIV_2 = PI / 2,\n        PI_DIV_4 = PI / 4,\n        DEG_TO_RAD = PI / 180;\n\n    // Coordinate reference systems ===========================================\n    var WGS84 = {\n        a: 6378137,                 // Semi-major radius\n        b: 6356752.314245179,       // Semi-minor radius\n        f: 0.0033528106647474805,   // Flattening\n        e: 0.08181919084262149      // Eccentricity\n    };\n\n    // WGS 84 / World Mercator\n    var Mercator = Class.extend({\n        init: function(options) {\n            this._initOptions(options);\n        },\n\n        MAX_LNG: 180,\n        MAX_LAT: 85.0840590501,\n        INVERSE_ITERATIONS: 15,\n        INVERSE_CONVERGENCE: 1e-12,\n\n        options: {\n            centralMeridian: 0,\n            datum: WGS84\n        },\n\n        forward: function(loc, clamp) {\n            var proj = this,\n                options = proj.options,\n                datum = options.datum,\n                r = datum.a,\n                lng0 = options.centralMeridian,\n                lat = limit(loc.lat, -proj.MAX_LAT, proj.MAX_LAT),\n                lng = clamp ? limit(loc.lng, -proj.MAX_LNG, proj.MAX_LNG) : loc.lng,\n                x = rad(lng - lng0) * r,\n                y = proj._projectLat(lat);\n\n            return new Point(x, y);\n        },\n\n        _projectLat: function(lat) {\n            var datum = this.options.datum,\n                ecc = datum.e,\n                r = datum.a,\n                y = rad(lat),\n                ts = tan(PI_DIV_4 + y / 2),\n                con = ecc * sin(y),\n                p = pow((1 - con) / (1 + con), ecc / 2);\n\n            // See:\n            // http://en.wikipedia.org/wiki/Mercator_projection#Generalization_to_the_ellipsoid\n            return r * log(ts * p);\n        },\n\n        inverse: function(point, clamp) {\n            var proj = this,\n                options = proj.options,\n                datum = options.datum,\n                r = datum.a,\n                lng0 = options.centralMeridian,\n                lng = point.x / (DEG_TO_RAD * r) + lng0,\n                lat = limit(proj._inverseY(point.y), -proj.MAX_LAT, proj.MAX_LAT);\n\n            if (clamp) {\n                lng = limit(lng, -proj.MAX_LNG, proj.MAX_LNG);\n            }\n\n            return new Location(lat, lng);\n        },\n\n        _inverseY: function(y) {\n            var proj = this,\n                datum = proj.options.datum,\n                r = datum.a,\n                ecc = datum.e,\n                ecch = ecc / 2,\n                ts = exp(-y / r),\n                phi = PI_DIV_2 - 2 * atan(ts),\n                i;\n\n            for (i = 0; i <= proj.INVERSE_ITERATIONS; i++) {\n                var con = ecc * sin(phi),\n                    p = pow((1 - con) / (1 + con), ecch),\n                    dphi = PI_DIV_2 - 2 * atan(ts * p) - phi;\n\n                phi += dphi;\n\n                if (math.abs(dphi) <= proj.INVERSE_CONVERGENCE) {\n                    break;\n                }\n            }\n\n            return deg(phi);\n        }\n    });\n\n    // WGS 84 / Pseudo-Mercator\n    // Used by Google Maps, Bing, OSM, etc.\n    // Spherical projection of ellipsoidal coordinates.\n    var SphericalMercator = Mercator.extend({\n        MAX_LAT: 85.0511287798,\n\n        _projectLat: function(lat) {\n            var r = this.options.datum.a,\n                y = rad(lat),\n                ts = tan(PI_DIV_4 + y / 2);\n\n            return r * log(ts);\n        },\n\n        _inverseY: function(y) {\n            var r = this.options.datum.a,\n                ts = exp(-y / r);\n\n            return deg(PI_DIV_2 - (2 * atan(ts)));\n        }\n    });\n\n    var Equirectangular = Class.extend({\n        forward: function(loc) {\n            return new Point(loc.lng, loc.lat);\n        },\n\n        inverse: function(point) {\n            return new Location(point.y, point.x);\n        }\n    });\n\n    // TODO: Better (less cryptic name) for this class(es)\n    var EPSG3857 = Class.extend({\n        init: function() {\n            var crs = this,\n                proj = crs._proj = new SphericalMercator();\n\n            var c = this.c = 2 * PI * proj.options.datum.a;\n\n            // Scale circumference to 1, mirror Y and shift origin to top left\n            this._tm = g.transform().translate(0.5, 0.5).scale(1/c, -1/c);\n\n            // Inverse transform matrix\n            this._itm = g.transform().scale(c, -c).translate(-0.5, -0.5);\n        },\n\n        // Location <-> Point (screen coordinates for a given scale)\n        toPoint: function(loc, scale, clamp) {\n            var point = this._proj.forward(loc, clamp);\n\n            return point\n                .transform(this._tm)\n                .scale(scale || 1);\n        },\n\n        toLocation: function(point, scale, clamp) {\n            point = point\n                .clone()\n                .scale(1 / (scale || 1))\n                .transform(this._itm);\n\n            return this._proj.inverse(point, clamp);\n        }\n    });\n\n    var EPSG3395 = Class.extend({\n        init: function() {\n            this._proj = new Mercator();\n        },\n\n        toPoint: function(loc) {\n            return this._proj.forward(loc);\n        },\n\n        toLocation: function(point) {\n            return this._proj.inverse(point);\n        }\n    });\n\n    // WGS 84\n    var EPSG4326 = Class.extend({\n        init: function() {\n            this._proj = new Equirectangular();\n        },\n\n        toPoint: function(loc) {\n            return this._proj.forward(loc);\n        },\n\n        toLocation: function(point) {\n            return this._proj.inverse(point);\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            crs: {\n                EPSG3395: EPSG3395,\n                EPSG3857: EPSG3857,\n                EPSG4326: EPSG4326\n            },\n            datums: {\n                WGS84: WGS84\n            },\n            projections: {\n                Equirectangular: Equirectangular,\n                Mercator: Mercator,\n                SphericalMercator: SphericalMercator\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/layers/base',[ \"../../../kendo.core\", \"../location\" ], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var proxy = $.proxy,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        Extent = dataviz.map.Extent,\n\n        util = kendo.drawing.util,\n        defined = util.defined;\n\n    // Implementation =========================================================\n    var Layer = Class.extend({\n        init: function(map, options) {\n            this._initOptions(options);\n            this.map = map;\n\n            this.element = $(\"<div class='k-layer'></div>\")\n               .css({\n                   \"zIndex\": this.options.zIndex,\n                   \"opacity\": this.options.opacity\n               })\n               .appendTo(map.scrollElement);\n\n            this._beforeReset = proxy(this._beforeReset, this);\n            this._reset = proxy(this._reset, this);\n            this._resize = proxy(this._resize, this);\n            this._panEnd = proxy(this._panEnd, this);\n            this._activate();\n\n            this._updateAttribution();\n        },\n\n        destroy: function() {\n            this._deactivate();\n        },\n\n        show: function() {\n            this.reset();\n            this._activate();\n            this._applyExtent(true);\n        },\n\n        hide: function() {\n            this._deactivate();\n            this._setVisibility(false);\n        },\n\n        reset: function() {\n            this._beforeReset();\n            this._reset();\n        },\n\n        _reset: function() {\n            this._applyExtent();\n        },\n\n        _beforeReset: $.noop,\n\n        _resize: $.noop,\n\n        _panEnd: function() {\n            this._applyExtent();\n        },\n\n        _applyExtent: function() {\n            var options = this.options;\n\n            var zoom = this.map.zoom();\n            var matchMinZoom = !defined(options.minZoom) || zoom >= options.minZoom;\n            var matchMaxZoom = !defined(options.maxZoom) || zoom <= options.maxZoom;\n\n            var extent = Extent.create(options.extent);\n            var inside = !extent || extent.overlaps(this.map.extent());\n\n            this._setVisibility(matchMinZoom && matchMaxZoom && inside);\n        },\n\n        _setVisibility: function(visible) {\n            this.element.css(\"display\", visible ? \"\" : \"none\");\n        },\n\n        _activate: function() {\n            var map = this.map;\n            this._deactivate();\n            map.bind(\"beforeReset\", this._beforeReset);\n            map.bind(\"reset\", this._reset);\n            map.bind(\"resize\", this._resize);\n            map.bind(\"panEnd\", this._panEnd);\n        },\n\n        _deactivate: function() {\n            var map = this.map;\n            map.unbind(\"beforeReset\", this._beforeReset);\n            map.unbind(\"reset\", this._reset);\n            map.unbind(\"resize\", this._resize);\n            map.unbind(\"panEnd\", this._panEnd);\n        },\n\n        _updateAttribution: function() {\n            var attr = this.map.attribution;\n\n            if (attr) {\n                attr.add(this.options.attribution);\n            }\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                Layer: Layer\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/layers/shape',[\"./base\", \"../location\"], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var proxy = $.proxy,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n        DataSource = kendo.data.DataSource,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n\n        d = kendo.drawing,\n        Group = d.Group,\n\n        last = d.util.last,\n        defined = d.util.defined,\n\n        map = dataviz.map,\n        Location = map.Location,\n        Layer = map.layers.Layer;\n\n    // Implementation =========================================================\n    var ShapeLayer = Layer.extend({\n        init: function(map, options) {\n\n            this._pan = proxy(this._pan, this);\n\n            Layer.fn.init.call(this, map, options);\n\n            this.surface = d.Surface.create(this.element, {\n                width: map.scrollElement.width(),\n                height: map.scrollElement.height()\n            });\n\n            this._initRoot();\n\n            this.movable = new kendo.ui.Movable(this.surface.element);\n            this._markers = [];\n\n            this._click = this._handler(\"shapeClick\");\n            this.surface.bind(\"click\", this._click);\n\n            this._mouseenter = this._handler(\"shapeMouseEnter\");\n            this.surface.bind(\"mouseenter\", this._mouseenter);\n\n            this._mouseleave = this._handler(\"shapeMouseLeave\");\n            this.surface.bind(\"mouseleave\", this._mouseleave);\n\n            this._initDataSource();\n        },\n\n        options: {\n            autoBind: true\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this.surface.destroy();\n            this.dataSource.unbind(\"change\", this._dataChange);\n        },\n\n        setDataSource: function(dataSource) {\n            if (this.dataSource) {\n                this.dataSource.unbind(\"change\", this._dataChange);\n            }\n\n            this.dataSource = kendo.data.DataSource.create(dataSource);\n            this.dataSource.bind(\"change\", this._dataChange);\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _reset: function() {\n            Layer.fn._reset.call(this);\n            this._translateSurface();\n\n            if (this._data) {\n                this._load(this._data);\n            }\n        },\n\n        _initRoot: function() {\n            this._root = new Group();\n            this.surface.draw(this._root);\n        },\n\n        _beforeReset: function() {\n            this.surface.clear();\n            this._initRoot();\n        },\n\n        _resize: function() {\n            this.surface.size(this.map.size());\n        },\n\n        _initDataSource: function() {\n            var dsOptions = this.options.dataSource;\n            this._dataChange = proxy(this._dataChange, this);\n            this.dataSource = DataSource\n                .create(dsOptions)\n                .bind(\"change\", this._dataChange);\n\n            if (dsOptions && this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _dataChange: function(e) {\n            this._data = e.sender.view();\n            this._load(this._data);\n        },\n\n        _load: function(data) {\n            this._clearMarkers();\n\n            if (!this._loader) {\n                this._loader = new GeoJSONLoader(this.map, this.options.style, this);\n            }\n\n            var container = new Group();\n            for (var i = 0; i < data.length; i++) {\n                var shape = this._loader.parse(data[i]);\n                if (shape) {\n                    container.append(shape);\n                }\n            }\n\n            this._root.clear();\n            this._root.append(container);\n        },\n\n        shapeCreated: function(shape) {\n            var cancelled = false;\n            if (shape instanceof d.Circle) {\n                cancelled = defined(this._createMarker(shape));\n            }\n\n            if (!cancelled) {\n                var args = { layer: this, shape: shape };\n                cancelled = this.map.trigger(\"shapeCreated\", args);\n            }\n\n            return cancelled;\n        },\n\n        featureCreated: function(e) {\n            e.layer = this;\n            this.map.trigger(\"shapeFeatureCreated\", e);\n        },\n\n        _createMarker: function(shape) {\n            var marker = this.map.markers.bind({\n                location: shape.location\n            }, shape.dataItem);\n\n            if (marker) {\n                this._markers.push(marker);\n            }\n\n            return marker;\n        },\n\n        _clearMarkers: function() {\n            for (var i = 0; i < this._markers.length; i++) {\n                this.map.markers.remove(this._markers[i]);\n            }\n            this._markers = [];\n        },\n\n        _pan: function() {\n            if (!this._panning) {\n                this._panning = true;\n                this.surface.suspendTracking();\n            }\n        },\n\n        _panEnd: function(e) {\n            Layer.fn._panEnd.call(this, e);\n            this._translateSurface();\n            this.surface.resumeTracking();\n            this._panning = false;\n        },\n\n        _translateSurface: function() {\n            var map = this.map;\n            var nw = map.locationToView(map.extent().nw);\n\n            if (this.surface.translate) {\n                this.surface.translate(nw);\n                this.movable.moveTo({ x: nw.x, y: nw.y });\n            }\n        },\n\n        _handler: function(event) {\n            var layer = this;\n            return function(e) {\n                if (e.element) {\n                    var args = {\n                        layer: layer,\n                        shape: e.element,\n                        originalEvent: e.originalEvent\n                    };\n\n                    layer.map.trigger(event, args);\n                }\n            };\n        },\n\n        _activate: function() {\n            Layer.fn._activate.call(this);\n\n            this.map.bind(\"pan\", this._pan);\n        },\n\n        _deactivate: function() {\n            Layer.fn._deactivate.call(this);\n\n            this.map.unbind(\"pan\", this._pan);\n        }\n    });\n\n    var GeoJSONLoader = Class.extend({\n        init: function(locator, defaultStyle, observer) {\n            this.observer = observer;\n            this.locator = locator;\n            this.style = defaultStyle;\n        },\n\n        parse: function(item) {\n            var root = new Group();\n            var unwrap = true;\n\n            if (item.type === \"Feature\") {\n                unwrap = false;\n                this._loadGeometryTo(root, item.geometry, item);\n                this._featureCreated(root, item);\n            } else {\n                this._loadGeometryTo(root, item, item);\n            }\n\n            if (unwrap && root.children.length < 2) {\n                root = root.children[0];\n            }\n\n            return root;\n        },\n\n        _shapeCreated: function(shape) {\n            var cancelled = false;\n\n            if (this.observer && this.observer.shapeCreated) {\n                cancelled = this.observer.shapeCreated(shape);\n            }\n\n            return cancelled;\n        },\n\n        _featureCreated: function(group, dataItem) {\n            if (this.observer && this.observer.featureCreated) {\n                this.observer.featureCreated({\n                    group: group,\n                    dataItem: dataItem,\n                    properties: dataItem.properties\n                });\n            }\n        },\n\n        _loadGeometryTo: function(container, geometry, dataItem) {\n            var coords = geometry.coordinates;\n            var i;\n            var path;\n\n            switch(geometry.type) {\n                case \"LineString\":\n                    path = this._loadPolygon(container, [coords], dataItem);\n                    this._setLineFill(path);\n                    break;\n\n                case \"MultiLineString\":\n                    for (i = 0; i < coords.length; i++) {\n                        path = this._loadPolygon(container, [coords[i]], dataItem);\n                        this._setLineFill(path);\n                    }\n                    break;\n\n                case \"Polygon\":\n                    this._loadPolygon(container, coords, dataItem);\n                    break;\n\n                case \"MultiPolygon\":\n                    for (i = 0; i < coords.length; i++) {\n                        this._loadPolygon(container, coords[i], dataItem);\n                    }\n                    break;\n\n                case \"Point\":\n                    this._loadPoint(container, coords, dataItem);\n                    break;\n\n                case \"MultiPoint\":\n                    for (i = 0; i < coords.length; i++) {\n                        this._loadPoint(container, coords[i], dataItem);\n                    }\n                    break;\n            }\n        },\n\n        _setLineFill: function(path) {\n            var segments = path.segments;\n            if (segments.length < 4 || !segments[0].anchor().equals(last(segments).anchor())) {\n                path.options.fill = null;\n            }\n        },\n\n        _loadShape: function(container, shape) {\n            if (!this._shapeCreated(shape)) {\n                container.append(shape);\n            }\n\n            return shape;\n        },\n\n        _loadPolygon: function(container, rings, dataItem) {\n            var shape = this._buildPolygon(rings);\n            shape.dataItem = dataItem;\n\n            return this._loadShape(container, shape);\n        },\n\n        _buildPolygon: function(rings) {\n            var type = rings.length > 1 ? d.MultiPath : d.Path;\n            var path = new type(this.style);\n\n            for (var i = 0; i < rings.length; i++) {\n                for (var j = 0; j < rings[i].length; j++) {\n                    var point = this.locator.locationToView(\n                        Location.fromLngLat(rings[i][j])\n                    );\n\n                    if (j === 0) {\n                        path.moveTo(point.x, point.y);\n                    } else {\n                        path.lineTo(point.x, point.y);\n                    }\n                }\n            }\n\n            return path;\n        },\n\n        _loadPoint: function(container, coords, dataItem) {\n            var location = Location.fromLngLat(coords);\n            var point = this.locator.locationToView(location);\n\n            var circle = new g.Circle(point, 10);\n            var shape = new d.Circle(circle, this.style);\n            shape.dataItem = dataItem;\n            shape.location = location;\n\n            return this._loadShape(container, shape);\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(kendo.data, {\n        schemas: {\n            geojson: {\n                type: \"json\",\n                data: function(data) {\n                    if (data.type === \"FeatureCollection\") {\n                        return data.features;\n                    }\n\n                    if (data.type === \"GeometryCollection\") {\n                        return data.geometries;\n                    }\n\n                    return data;\n                }\n            }\n        },\n        transports: {\n            geojson: {\n                read: {\n                    dataType: \"json\"\n                }\n            }\n        }\n    });\n\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                shape: ShapeLayer,\n                ShapeLayer: ShapeLayer\n            },\n            GeoJSONLoader: GeoJSONLoader\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/layers/bubble',[\"./shape\" ], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n        getter = kendo.getter,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        d = kendo.drawing,\n\n        util = d.util,\n        defined = util.defined,\n\n        map = dataviz.map,\n        Location = map.Location,\n        ShapeLayer = map.layers.ShapeLayer;\n\n    // Implementation =========================================================\n    var BubbleLayer = ShapeLayer.extend({\n        options: {\n            autoBind: true,\n            locationField: \"location\",\n            valueField: \"value\",\n            minSize: 0,\n            maxSize: 100,\n            scale: \"sqrt\",\n            symbol: \"circle\"\n        },\n\n        _load: function(data) {\n            this.surface.clear();\n\n            if (data.length === 0) {\n                return;\n            }\n\n            var opt = this.options;\n            var getValue = getter(opt.valueField);\n\n            data = data.slice(0);\n            data.sort(function(a, b) {\n                return getValue(b) - getValue(a);\n            });\n\n            var scaleType = this._scaleType();\n            var scale;\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                var location = getter(opt.locationField)(dataItem);\n                var value = getter(opt.valueField)(dataItem);\n\n                if (defined(location) && defined(value)) {\n                    if (!scale) {\n                        scale = new scaleType([0, value], [opt.minSize, opt.maxSize]);\n                    }\n\n                    location = Location.create(location);\n                    var center = this.map.locationToView(location);\n                    var size = scale.map(value);\n\n                    var symbol = this._createSymbol({\n                        center: center,\n                        size: size,\n                        style: opt.style,\n                        dataItem: dataItem,\n                        location: location\n                    });\n\n                    symbol.dataItem = dataItem;\n                    symbol.location = location;\n                    symbol.value = value;\n\n                    this._drawSymbol(symbol);\n                }\n            }\n        },\n\n        _scaleType: function() {\n            var scale = this.options.scale;\n\n            if (kendo.isFunction(scale)) {\n                return scale;\n            }\n\n            return dataviz.map.scales[scale];\n        },\n\n        _createSymbol: function(args) {\n            var symbol = this.options.symbol;\n            if (!kendo.isFunction(symbol)) {\n                symbol = dataviz.map.symbols[symbol];\n            }\n\n            return symbol(args);\n        },\n\n        _drawSymbol: function(shape) {\n            var args = { layer: this, shape: shape };\n            var cancelled = this.map.trigger(\"shapeCreated\", args);\n            if (!cancelled) {\n                this.surface.draw(shape);\n            }\n        }\n    });\n\n    var SqrtScale = kendo.Class.extend({\n        init: function(domain, range) {\n            this._domain = domain;\n            this._range = range;\n\n            var domainRange = Math.sqrt(domain[1]) - Math.sqrt(domain[0]);\n            var outputRange = range[1] - range[0];\n            this._ratio = outputRange / domainRange;\n        },\n\n        map: function(value) {\n            var rel = (Math.sqrt(value) - Math.sqrt(this._domain[0])) * this._ratio;\n            return this._range[0] + rel;\n        }\n    });\n\n    var Symbols = {\n        circle: function (args) {\n            var geo = new g.Circle(args.center, args.size / 2);\n            return new d.Circle(geo, args.style);\n        },\n\n        square: function(args) {\n            var path = new d.Path(args.style);\n            var halfSize = args.size / 2;\n            var center = args.center;\n\n            path.moveTo(center.x - halfSize, center.y - halfSize)\n                .lineTo(center.x + halfSize, center.y - halfSize)\n                .lineTo(center.x + halfSize, center.y + halfSize)\n                .lineTo(center.x - halfSize, center.y + halfSize)\n                .close();\n\n            return path;\n        }\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                bubble: BubbleLayer,\n                BubbleLayer: BubbleLayer\n            },\n            scales: {\n                sqrt: SqrtScale\n            },\n            symbols: Symbols\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/tile',[ \"./base\", \"../location\" ], f);\n})(function() {\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n\n        proxy = $.proxy,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n        template = kendo.template,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        Layer = dataviz.map.layers.Layer,\n\n        util = kendo.util,\n        renderSize = util.renderSize,\n\n        drawingUtil = kendo.drawing.util,\n        round = drawingUtil.round,\n        limit = drawingUtil.limitValue;\n\n    // Image tile layer =============================================================\n    var TileLayer = Layer.extend({\n        init: function(map, options) {\n            Layer.fn.init.call(this, map, options);\n\n            if (typeof this.options.subdomains === \"string\") {\n                this.options.subdomains = this.options.subdomains.split(\"\");\n            }\n\n            var viewType = this._viewType();\n            this._view = new viewType(this.element, this.options);\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this._view.destroy();\n            this._view = null;\n        },\n\n        _beforeReset: function() {\n            var map = this.map;\n            var origin = map.locationToLayer(map.extent().nw).round();\n            this._view.viewOrigin(origin);\n        },\n\n        _reset: function(e) {\n            var tileTitle;\n\n            if(e) {\n                tileTitle = e.tileTitle;\n            } else {\n                tileTitle = \"\";\n            }\n\n            Layer.fn._reset.call(this);\n            this._updateView();\n            this._view.reset(tileTitle);\n        },\n\n        _viewType: function() {\n            return TileView;\n        },\n\n        _activate: function() {\n            Layer.fn._activate.call(this);\n\n            if (!kendo.support.mobileOS) {\n                if (!this._pan) {\n                    this._pan = kendo.throttle(\n                        proxy(this._render, this),\n                        100\n                    );\n                }\n\n                this.map.bind(\"pan\", this._pan);\n            }\n        },\n\n        _deactivate: function() {\n            Layer.fn._deactivate.call(this);\n\n            if (this._pan) {\n                this.map.unbind(\"pan\", this._pan);\n            }\n        },\n\n        _updateView: function() {\n            var view = this._view,\n                map = this.map,\n                extent = map.extent(),\n                extentToPoint = {\n                    nw: map.locationToLayer(extent.nw).round(),\n                    se: map.locationToLayer(extent.se).round()\n                };\n\n            view.center(map.locationToLayer(map.center()));\n            view.extent(extentToPoint);\n            view.zoom(map.zoom());\n        },\n\n        _resize: function() {\n            this._render();\n        },\n\n        _panEnd: function(e) {\n            Layer.fn._panEnd.call(this, e);\n            this._render();\n        },\n\n        _render: function() {\n            this._updateView();\n            this._view.render();\n        }\n    });\n\n    var TileView = Class.extend({\n        init: function(element, options) {\n            this.element = element;\n            this._initOptions(options);\n\n            this.pool = new TilePool();\n        },\n\n        options: {\n            tileSize: 256,\n            subdomains: [\"a\", \"b\", \"c\"],\n            urlTemplate: \"\"\n        },\n\n        center: function(center) {\n            this._center = center;\n        },\n\n        extent: function(extent) {\n            this._extent = extent;\n        },\n\n        viewOrigin: function(origin) {\n            this._viewOrigin = origin;\n        },\n\n        zoom: function(zoom) {\n            this._zoom = zoom;\n        },\n\n        pointToTileIndex: function(point) {\n            return new Point(\n                math.floor(point.x / this.options.tileSize),\n                math.floor(point.y / this.options.tileSize)\n            );\n        },\n\n        tileCount: function() {\n            var size = this.size(),\n                firstTileIndex = this.pointToTileIndex(this._extent.nw),\n                nw = this._extent.nw,\n                point = this.indexToPoint(firstTileIndex).translate(-nw.x, -nw.y);\n\n            return {\n                x: math.ceil((math.abs(point.x) + size.width) / this.options.tileSize),\n                y: math.ceil((math.abs(point.y) + size.height) / this.options.tileSize)\n            };\n        },\n\n        size: function() {\n            var nw = this._extent.nw,\n                se = this._extent.se,\n                diff = se.clone().translate(-nw.x, -nw.y);\n\n            return {\n                width: diff.x,\n                height: diff.y\n            };\n        },\n\n        indexToPoint: function(index) {\n            var x = index.x, y = index.y;\n\n            return new Point(\n                x * this.options.tileSize,\n                y * this.options.tileSize\n            );\n        },\n\n        subdomainText: function() {\n            var subdomains = this.options.subdomains;\n\n            return subdomains[this.subdomainIndex++ % subdomains.length];\n        },\n\n        destroy: function() {\n            this.element.empty();\n            this.pool.empty();\n        },\n\n        reset: function(tileTitle) {\n            this._tileTitle = tileTitle;\n            this.pool.reset();\n            this.subdomainIndex = 0;\n            this.render();\n        },\n\n        render: function() {\n            var size = this.tileCount(),\n                firstTileIndex = this.pointToTileIndex(this._extent.nw),\n                tile, x, y;\n\n            for (x = 0; x < size.x; x++) {\n                for (y = 0; y < size.y; y++) {\n                    tile = this.createTile({\n                        x: firstTileIndex.x + x,\n                        y: firstTileIndex.y + y\n                    });\n\n                    if (!tile.visible) {\n                        tile.show();\n                    }\n                }\n            }\n        },\n\n        createTile: function(currentIndex) {\n            var options = this.tileOptions(currentIndex);\n            var tile = this.pool.get(this._center, options);\n            if (tile.element.parent().length === 0) {\n                this.element.append(tile.element);\n            }\n\n            return tile;\n        },\n\n        tileOptions: function(currentIndex) {\n            var index = this.wrapIndex(currentIndex),\n                point = this.indexToPoint(currentIndex),\n                origin = this._viewOrigin,\n                offset = point.clone().translate(-origin.x, -origin.y);\n\n            return {\n                index: index,\n                currentIndex: currentIndex,\n                point: point,\n                offset: roundPoint(offset),\n                zoom: this._zoom,\n                size: this.options.tileSize,\n                subdomain: this.subdomainText(),\n                urlTemplate: this.options.urlTemplate,\n                errorUrlTemplate: this.options.errorUrlTemplate,\n                tileTitle: this._tileTitle\n            };\n        },\n\n        wrapIndex: function(index) {\n            var boundary = math.pow(2, this._zoom);\n            return {\n                x: this.wrapValue(index.x, boundary),\n                y: limit(index.y, 0, boundary - 1)\n            };\n        },\n\n        wrapValue: function(value, boundary) {\n            var remainder = (math.abs(value) % boundary);\n            if (value >= 0) {\n                value = remainder;\n            } else {\n                value = boundary - (remainder === 0 ? boundary : remainder);\n            }\n\n            return value;\n        }\n    });\n\n    var ImageTile = Class.extend({\n        init: function(id, options) {\n            this.id = id;\n            this.visible = true;\n\n            this._initOptions(options);\n            this.createElement();\n            this.show();\n        },\n\n        options: {\n            urlTemplate: \"\",\n            errorUrlTemplate: \"\"\n        },\n\n        createElement: function() {\n            this.element = $(\"<img style='position: absolute; display: block;' alt='\" + this.options.tileTitle + \"' />\")\n                            .css({ width: this.options.size, height: this.options.size })\n                            .on(\"error\", proxy(function(e) {\n                                if (this.errorUrl()) {\n                                    e.target.setAttribute(\"src\", this.errorUrl());\n                                } else {\n                                    e.target.removeAttribute(\"src\");\n                                }\n                            }, this));\n        },\n\n        show: function() {\n            var element = this.element[0];\n            element.style.top = renderSize(this.options.offset.y);\n            element.style.left = renderSize(this.options.offset.x);\n\n            var url = this.url();\n            if (url) {\n                element.setAttribute(\"src\", url);\n            }\n\n            element.style.visibility = \"visible\";\n            this.visible = true;\n        },\n\n        hide: function() {\n            this.element[0].style.visibility = \"hidden\";\n            this.visible = false;\n        },\n\n        url: function() {\n            var urlResult = template(this.options.urlTemplate);\n\n            return urlResult(this.urlOptions());\n        },\n\n        errorUrl: function() {\n            var urlResult = template(this.options.errorUrlTemplate);\n\n            return urlResult(this.urlOptions());\n        },\n\n        urlOptions: function() {\n            var options = this.options;\n            return {\n                zoom: options.zoom,\n                subdomain: options.subdomain,\n                z: options.zoom,\n                x: options.index.x,\n                y: options.index.y,\n                s: options.subdomain,\n                quadkey: options.quadkey,\n                q: options.quadkey,\n                culture: options.culture,\n                c: options.culture\n            };\n        },\n\n        destroy: function() {\n            if (this.element) {\n                this.element.remove();\n                this.element = null;\n            }\n        }\n    });\n\n    var TilePool = Class.extend({\n        init: function() {\n            this._items = [];\n        },\n\n        options: {\n            maxSize: 100\n        },\n\n        get: function(center, options) {\n            if (this._items.length >= this.options.maxSize) {\n                this._remove(center);\n            }\n\n            return this._create(options);\n        },\n\n        empty: function() {\n            var items = this._items;\n            for (var i = 0; i < items.length; i++) {\n                items[i].destroy();\n            }\n\n            this._items = [];\n        },\n\n        reset: function() {\n            var items = this._items;\n            for (var i = 0; i < items.length; i++) {\n                items[i].hide();\n            }\n        },\n\n        _create: function(options) {\n            var items = this._items;\n            var tile;\n\n            // Build an unique token for the image\n            // This normally would be the URL, but we don't care about subdomains\n            var id = util.hashKey(\n                options.point.toString() +\n                options.offset.toString() +\n                options.zoom +\n                options.urlTemplate\n            );\n\n            for (var i = 0; i < items.length; i++) {\n                if (items[i].id === id) {\n                    tile = items[i];\n                    break;\n                }\n            }\n\n            if (tile) {\n                tile.show();\n            } else {\n                tile = new ImageTile(id, options);\n                this._items.push(tile);\n            }\n\n            return tile;\n        },\n\n        _remove: function(center) {\n            var items = this._items;\n            var maxDist = -1;\n            var index = -1;\n\n            for (var i = 0; i < items.length; i++) {\n                var dist = items[i].options.point.distanceTo(center);\n                if (dist > maxDist && !items[i].visible) {\n                    index = i;\n                    maxDist = dist;\n                }\n            }\n\n            if (index !== -1) {\n                items[index].destroy();\n                items.splice(index, 1);\n            }\n        }\n    });\n\n    // Methods ================================================================\n    function roundPoint(point) {\n        return new Point(round(point.x), round(point.y));\n    }\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                tile: TileLayer,\n                TileLayer: TileLayer,\n\n                ImageTile: ImageTile,\n                TilePool: TilePool,\n                TileView: TileView\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/bing',[ \"./tile\" ], f);\n})(function() {\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n        defined = kendo.drawing.util.defined,\n\n        Extent = dataviz.map.Extent,\n        Location = dataviz.map.Location,\n        TileLayer = dataviz.map.layers.TileLayer,\n        TileView = dataviz.map.layers.TileView;\n\n    // Bing tile layer =============================================================\n    var BingLayer = TileLayer.extend({\n        init: function(map, options) {\n            this.options.baseUrl =\n                this._scheme() +\n                \"://dev.virtualearth.net/REST/v1/Imagery/Metadata/\";\n\n            TileLayer.fn.init.call(this, map, options);\n\n            this._onMetadata = $.proxy(this._onMetadata, this);\n            this._fetchMetadata();\n        },\n\n        options: {\n            imagerySet: \"road\"\n        },\n\n        _fetchMetadata: function() {\n            var options = this.options;\n\n            if (!options.key) {\n                throw new Error(\"Bing tile layer: API key is required\");\n            }\n\n            $.ajax({\n                url: options.baseUrl + options.imagerySet,\n                data: {\n                    output: \"json\",\n                    include: \"ImageryProviders\",\n                    key: options.key,\n                    uriScheme: this._scheme()\n                },\n                type: \"get\",\n                dataType: \"jsonp\",\n                jsonp: \"jsonp\",\n                success: this._onMetadata\n            });\n        },\n\n        _scheme: function(proto) {\n            proto = proto || window.location.protocol;\n            return proto.replace(\":\", \"\") === \"https\" ? \"https\" : \"http\";\n        },\n\n        _onMetadata: function(data) {\n            if (data && data.resourceSets.length) {\n                var resource = this.resource = data.resourceSets[0].resources[0];\n\n                deepExtend(this._view.options, {\n                    urlTemplate: resource.imageUrl\n                        .replace(\"{subdomain}\", \"#= subdomain #\")\n                        .replace(\"{quadkey}\", \"#= quadkey #\")\n                        .replace(\"{culture}\", \"#= culture #\"),\n                    subdomains: resource.imageUrlSubdomains\n                });\n\n                var options = this.options;\n                if (!defined(options.minZoom)) {\n                    options.minZoom = resource.zoomMin;\n                }\n                if (!defined(options.maxZoom)) {\n                    options.maxZoom = resource.zoomMax;\n                }\n\n                this._addAttribution();\n\n                if (this.element.css(\"display\") !== \"none\") {\n                    this._reset();\n                }\n            }\n        },\n\n        _viewType: function() {\n            return BingView;\n        },\n\n        _addAttribution: function() {\n            var attr = this.map.attribution;\n            if (attr) {\n                var items = this.resource.imageryProviders;\n                if (items) {\n                    for (var i = 0; i < items.length; i++) {\n                        var item = items[i];\n                        for (var y = 0; y < item.coverageAreas.length; y++) {\n                            var area = item.coverageAreas[y];\n                            attr.add({\n                                text: item.attribution,\n                                minZoom: area.zoomMin,\n                                maxZoom: area.zoomMax,\n                                extent: new Extent(\n                                    new Location(area.bbox[2], area.bbox[1]),\n                                    new Location(area.bbox[0], area.bbox[3])\n                                )\n                            });\n                        }\n                    }\n                }\n            }\n        },\n\n        imagerySet: function(value) {\n            if (value) {\n                this.options.imagerySet = value;\n                this.map.attribution.clear();\n                this._fetchMetadata();\n            } else {\n                return this.options.imagerySet;\n            }\n        }\n    });\n\n    var BingView = TileView.extend({\n        options: {\n            culture: \"en-US\"\n        },\n\n        tileOptions: function(currentIndex) {\n            var options = TileView.fn.tileOptions.call(this, currentIndex);\n\n            options.culture = this.options.culture;\n            options.quadkey = this.tileQuadKey(this.wrapIndex(currentIndex));\n\n            return options;\n        },\n\n        tileQuadKey: function(index) {\n            var quadKey = \"\",\n                digit, mask, i;\n\n            for (i = this._zoom; i > 0; i--) {\n                digit = 0;\n                mask = 1 << (i - 1);\n\n                if ((index.x & mask) !== 0) {\n                    digit++;\n                }\n\n                if ((index.y & mask) !== 0) {\n                    digit += 2;\n                }\n\n                quadKey += digit;\n            }\n\n            return quadKey;\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                bing: BingLayer,\n                BingLayer: BingLayer,\n                BingView: BingView\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/layers/marker',[ \"./base\", \"../location\",\n             \"../../../kendo.data\", \"../../../kendo.tooltip\" ], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var doc = document,\n        math = Math,\n        indexOf = $.inArray,\n        proxy = $.proxy,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n        DataSource = kendo.data.DataSource,\n        Tooltip = kendo.ui.Tooltip,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        map = dataviz.map,\n        Location = map.Location,\n        Layer = map.layers.Layer;\n\n    // Implementation =========================================================\n    var MarkerLayer = Layer.extend({\n        init: function(map, options) {\n            Layer.fn.init.call(this, map, options);\n\n            this._markerClick = proxy(this._markerClick, this);\n            this.element.on(\"click\", \".k-marker\", this._markerClick);\n\n            this.items = [];\n            this._initDataSource();\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this.element.off(\"click\", \".k-marker\", this._markerClick);\n\n            this.dataSource.unbind(\"change\", this._dataChange);\n            this.clear();\n        },\n\n        options: {\n            zIndex: 1000,\n            autoBind: true,\n            dataSource: {},\n            locationField: \"location\",\n            titleField: \"title\"\n        },\n\n        add: function(arg) {\n            if (Array.isArray(arg)) {\n                for (var i = 0; i < arg.length; i++) {\n                    this._addOne(arg[i]);\n                }\n            } else {\n                return this._addOne(arg);\n            }\n        },\n\n        remove: function(marker) {\n            marker.destroy();\n\n            var index = indexOf(marker, this.items);\n            if (index > -1) {\n                this.items.splice(index, 1);\n            }\n        },\n\n        clear: function() {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n\n            this.items = [];\n        },\n\n        update: function(marker) {\n            var loc = marker.location();\n            if (loc) {\n                marker.showAt(this.map.locationToView(loc));\n\n                var args = { marker: marker, layer: this };\n                this.map.trigger(\"markerActivate\", args);\n            }\n        },\n\n        _reset: function() {\n            Layer.fn._reset.call(this);\n            var items = this.items;\n            for (var i = 0; i < items.length; i++) {\n                this.update(items[i]);\n            }\n        },\n\n        bind: function (options, dataItem) {\n            var marker = map.Marker.create(options, this.options);\n            marker.dataItem = dataItem;\n\n            var args = { marker: marker, layer: this };\n            var cancelled = this.map.trigger(\"markerCreated\", args);\n            if (!cancelled) {\n                this.add(marker);\n                return marker;\n            }\n        },\n\n        setDataSource: function(dataSource) {\n            if (this.dataSource) {\n                this.dataSource.unbind(\"change\", this._dataChange);\n            }\n\n            this.dataSource = kendo.data.DataSource.create(dataSource);\n            this.dataSource.bind(\"change\", this._dataChange);\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _addOne: function(arg) {\n            var marker = Marker.create(arg, this.options);\n            marker.addTo(this);\n\n            return marker;\n        },\n\n        _initDataSource: function() {\n            var dsOptions = this.options.dataSource;\n            this._dataChange = proxy(this._dataChange, this);\n            this.dataSource = DataSource\n                .create(dsOptions)\n                .bind(\"change\", this._dataChange);\n\n            if (dsOptions && this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _dataChange: function(e) {\n            this._load(e.sender.view());\n        },\n\n        _load: function(data) {\n            this._data = data;\n            this.clear();\n\n            var getLocation = kendo.getter(this.options.locationField);\n            var getTitle = kendo.getter(this.options.titleField);\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                this.bind({\n                    location: getLocation(dataItem),\n                    title: getTitle(dataItem)\n                }, dataItem);\n            }\n        },\n\n        _markerClick: function(e) {\n            var args = { marker: $(e.target).data(\"kendoMarker\"), layer: this };\n            this.map.trigger(\"markerClick\", args);\n        }\n    });\n\n    var Marker = Class.extend({\n        init: function(options) {\n            this.options = options || {};\n        },\n\n        addTo: function(parent) {\n            this.layer = parent.markers || parent;\n            this.layer.items.push(this);\n            this.layer.update(this);\n        },\n\n        location: function(value) {\n            if (value) {\n                this.options.location = Location.create(value).toArray();\n\n                if (this.layer) {\n                    this.layer.update(this);\n                }\n\n                return this;\n            } else {\n                return Location.create(this.options.location);\n            }\n        },\n\n        showAt: function(point) {\n            this.render();\n            this.element.css({\n                left: math.round(point.x),\n                top: math.round(point.y)\n            });\n\n            if (this.tooltip && this.tooltip.popup) {\n                // TODO: Expose popup/tooltip updatePosition? method\n                this.tooltip.popup._position();\n            }\n        },\n\n        hide: function() {\n            if (this.element) {\n                this.element.remove();\n                this.element = null;\n            }\n\n            if (this.tooltip) {\n                this.tooltip.destroy();\n                this.tooltip = null;\n            }\n        },\n\n        destroy: function() {\n            this.layer = null;\n            this.hide();\n        },\n\n        render: function() {\n            if (!this.element) {\n                var options = this.options;\n                var layer = this.layer;\n\n                this.element = $(doc.createElement(\"span\"))\n                    .addClass(\"k-marker k-icon k-i-marker-\" + kendo.toHyphens(options.shape || \"pin\"))\n                    .attr(\"title\", options.title)\n                    .attr(options.attributes || {})\n                    .data(\"kendoMarker\", this)\n                    .css(\"zIndex\", options.zIndex);\n\n                if (layer) {\n                    layer.element.append(this.element);\n                }\n\n                this.renderTooltip();\n            }\n        },\n\n        renderTooltip: function() {\n            var marker = this;\n            var title = marker.options.title;\n            var options = marker.options.tooltip || {};\n\n            if (options && Tooltip) {\n                var template = options.template;\n                if (template) {\n                    var contentTemplate = kendo.template(template);\n                    options.content = function(e) {\n                        e.location = marker.location();\n                        e.marker = marker;\n                        return contentTemplate(e);\n                    };\n                }\n\n                if (title || options.content || options.contentUrl) {\n                    this.tooltip = new Tooltip(this.element, options);\n                    this.tooltip.marker = this;\n                }\n            }\n        }\n    });\n\n    Marker.create = function(arg, defaults) {\n        if (arg instanceof Marker) {\n            return arg;\n        }\n\n        return new Marker(deepExtend({}, defaults, arg));\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                marker: MarkerLayer,\n                MarkerLayer: MarkerLayer\n            },\n            Marker: Marker\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('dataviz/map/main',[\"./crs\", \"./location\"], f);\n})(function(){\n\n(function ($, undefined) {\n    // Imports ================================================================\n    var doc = document,\n        math = Math,\n        min = math.min,\n        pow = math.pow,\n\n        proxy = $.proxy,\n\n        kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        deepExtend = kendo.deepExtend,\n\n        dataviz = kendo.dataviz,\n        ui = dataviz.ui,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        map = dataviz.map,\n        Extent = map.Extent,\n        Location = map.Location,\n        EPSG3857 = map.crs.EPSG3857,\n\n        util = kendo.util,\n        renderPos = util.renderPos,\n\n        drawingUtil = kendo.drawing.util,\n\n        defined = drawingUtil.defined,\n        limit = drawingUtil.limitValue,\n        valueOrDefault = drawingUtil.valueOrDefault;\n\n    // Constants ==============================================================\n    var CSS_PREFIX = \"k-\",\n        FRICTION = 0.90,\n        FRICTION_MOBILE = 0.93,\n        MOUSEWHEEL = \"DOMMouseScroll mousewheel\",\n        VELOCITY_MULTIPLIER = 5,\n        DEFAULT_ZOOM_RATE = 1;\n\n    // Map widget =============================================================\n    var Map = Widget.extend({\n        init: function(element, options) {\n            kendo.destroy(element);\n            Widget.fn.init.call(this, element);\n\n            this._initOptions(options);\n            this.bind(this.events, options);\n\n            this.crs = new EPSG3857();\n\n            this.element\n                .addClass(CSS_PREFIX + this.options.name.toLowerCase())\n                .css(\"position\", \"relative\")\n                .empty()\n                .append(doc.createElement(\"div\"));\n\n            this._viewOrigin = this._getOrigin();\n            this._initScroller();\n            this._initMarkers();\n            this._initControls();\n            this._initLayers();\n            this._reset();\n\n            this._mousewheel = proxy(this._mousewheel, this);\n            this.element.on(MOUSEWHEEL, this._mousewheel);\n        },\n\n        options: {\n            name: \"Map\",\n            controls: {\n                attribution: true,\n                navigator: {\n                    panStep: 100\n                },\n                zoom: true\n            },\n            layers: [],\n            layerDefaults: {\n                shape: {\n                    style: {\n                        fill: {\n                            color: \"#fff\"\n                        },\n                        stroke: {\n                            color: \"#aaa\",\n                            width: 0.5\n                        }\n                    }\n                },\n                bubble: {\n                    style: {\n                        fill: {\n                            color: \"#fff\",\n                            opacity: 0.5\n                        },\n                        stroke: {\n                            color: \"#aaa\",\n                            width: 0.5\n                        }\n                    }\n                },\n                marker: {\n                    shape: \"pinTarget\",\n                    tooltip: {\n                        position: \"top\"\n                    }\n                }\n            },\n            center: [0, 0],\n            zoom: 3,\n            minSize: 256,\n            minZoom: 1,\n            maxZoom: 19,\n            markers: [],\n            markerDefaults: {\n                shape: \"pinTarget\",\n                tooltip: {\n                    position: \"top\"\n                }\n            },\n            wraparound: true,\n            messages: {\n                tileTitle: \"Map tile\"\n            }\n        },\n\n        events:[\n            \"beforeReset\",\n            \"click\",\n            \"markerActivate\",\n            \"markerClick\",\n            \"markerCreated\",\n            \"pan\",\n            \"panEnd\",\n            \"reset\",\n            \"shapeClick\",\n            \"shapeCreated\",\n            \"shapeFeatureCreated\",\n            \"shapeMouseEnter\",\n            \"shapeMouseLeave\",\n            \"zoomEnd\",\n            \"zoomStart\"\n        ],\n\n        destroy: function() {\n            this.scroller.destroy();\n\n            if (this.navigator) {\n                this.navigator.destroy();\n            }\n\n            if (this.attribution) {\n                this.attribution.destroy();\n            }\n\n            if (this.zoomControl) {\n                this.zoomControl.destroy();\n            }\n\n            this.markers.destroy();\n\n            for (var i = 0; i < this.layers.length; i++) {\n                this.layers[i].destroy();\n            }\n\n            Widget.fn.destroy.call(this);\n        },\n\n        zoom: function(level) {\n            var options = this.options;\n\n            if (defined(level)) {\n                level = math.round(limit(level, options.minZoom, options.maxZoom));\n                if (options.zoom !== level) {\n                    options.zoom = level;\n                    this._reset();\n                }\n\n                return this;\n            } else {\n                return options.zoom;\n            }\n        },\n\n        center: function(center) {\n            if (center) {\n                this.options.center = Location.create(center).toArray();\n                this._reset();\n\n                return this;\n            } else {\n                return Location.create(this.options.center);\n            }\n        },\n\n        extent: function(extent) {\n            if (extent) {\n                this._setExtent(extent);\n                return this;\n            } else {\n                return this._getExtent();\n            }\n        },\n\n        setOptions: function(options) {\n            Widget.fn.setOptions.call(this, options);\n            this._reset();\n        },\n\n        locationToLayer: function(location, zoom) {\n            var clamp = !this.options.wraparound;\n            location = Location.create(location);\n            return this.crs.toPoint(location, this._layerSize(zoom), clamp);\n        },\n\n        layerToLocation: function(point, zoom) {\n            var clamp = !this.options.wraparound;\n            point = Point.create(point);\n            return  this.crs.toLocation(point, this._layerSize(zoom), clamp);\n        },\n\n        locationToView: function(location) {\n            location = Location.create(location);\n            var origin = this.locationToLayer(this._viewOrigin);\n            var point = this.locationToLayer(location);\n\n            return point.translateWith(origin.scale(-1));\n        },\n\n        viewToLocation: function(point, zoom) {\n            var origin = this.locationToLayer(this._getOrigin(), zoom);\n            point = Point.create(point);\n            point = point.clone().translateWith(origin);\n            return this.layerToLocation(point, zoom);\n        },\n\n        eventOffset: function(e) {\n            var point;\n            var x;\n            var y;\n            var offset = this.element.offset();\n\n            if (e.x || e.y) {\n                var field = \"location\";\n                x = e.x[field] - offset.left;\n                y = e.y[field] - offset.top;\n                point = new g.Point(x, y);\n            } else {\n                var event = e.originalEvent || e;\n                x = valueOrDefault(event.pageX, event.clientX) - offset.left;\n                y = valueOrDefault(event.pageY, event.clientY) - offset.top;\n                point = new g.Point(x, y);\n            }\n\n            return point;\n        },\n\n        eventToView: function(e) {\n            var cursor = this.eventOffset(e);\n            return this.locationToView(this.viewToLocation(cursor));\n        },\n\n        eventToLayer: function(e) {\n            return this.locationToLayer(this.eventToLocation(e));\n        },\n\n        eventToLocation: function(e) {\n            var cursor = this.eventOffset(e);\n            return this.viewToLocation(cursor);\n        },\n\n        viewSize: function() {\n            var element = this.element;\n            var scale = this._layerSize();\n            var width = element.width();\n\n            if (!this.options.wraparound) {\n                width = min(scale, width);\n            }\n            return {\n                width: width,\n                height: min(scale, element.height())\n            };\n        },\n\n        exportVisual: function() {\n            this._reset();\n            return false;\n        },\n\n        _setOrigin: function(origin, zoom) {\n            var size = this.viewSize(),\n                topLeft;\n\n            origin = this._origin = Location.create(origin);\n            topLeft = this.locationToLayer(origin, zoom);\n            topLeft.x += size.width / 2;\n            topLeft.y += size.height / 2;\n\n            this.options.center = this.layerToLocation(topLeft, zoom).toArray();\n\n            return this;\n        },\n\n        _getOrigin: function(invalidate) {\n            var size = this.viewSize(),\n                topLeft;\n\n            if (invalidate || !this._origin) {\n                topLeft = this.locationToLayer(this.center());\n                topLeft.x -= size.width / 2;\n                topLeft.y -= size.height / 2;\n\n                this._origin = this.layerToLocation(topLeft);\n            }\n\n            return this._origin;\n        },\n\n        _setExtent: function(extent) {\n            var raw = Extent.create(extent);\n            var se = raw.se.clone();\n            if (this.options.wraparound && se.lng < 0 && extent.nw.lng > 0) {\n                se.lng = 180 + (180 + se.lng);\n            }\n\n            extent = new Extent(raw.nw, se);\n            this.center(extent.center());\n\n            var width = this.element.width();\n            var height = this.element.height();\n            for (var zoom = this.options.maxZoom; zoom >= this.options.minZoom; zoom--) {\n                var topLeft = this.locationToLayer(extent.nw, zoom);\n                var bottomRight = this.locationToLayer(extent.se, zoom);\n\n                var layerWidth = math.abs(bottomRight.x - topLeft.x);\n                var layerHeight = math.abs(bottomRight.y - topLeft.y);\n\n                if (layerWidth <= width && layerHeight <= height) {\n                    break;\n                }\n            }\n\n            this.zoom(zoom);\n        },\n\n        _getExtent: function() {\n            var nw = this._getOrigin();\n            var bottomRight = this.locationToLayer(nw);\n            var size = this.viewSize();\n\n            bottomRight.x += size.width;\n            bottomRight.y += size.height;\n\n            var se = this.layerToLocation(bottomRight);\n            return new Extent(nw, se);\n        },\n\n        _zoomAround: function(pivot, level) {\n            this._setOrigin(this.layerToLocation(pivot, level), level);\n            this.zoom(level);\n        },\n\n        _initControls: function() {\n            var controls = this.options.controls;\n\n            if (ui.Attribution && controls.attribution) {\n                this._createAttribution(controls.attribution);\n            }\n\n            if (!kendo.support.mobileOS) {\n                if (ui.Navigator && controls.navigator) {\n                    this._createNavigator(controls.navigator);\n                }\n\n                if (ui.ZoomControl && controls.zoom) {\n                    this._createZoomControl(controls.zoom);\n                }\n            }\n        },\n\n        _createControlElement: function(options, defaultPos) {\n            var pos = options.position || defaultPos;\n            var posSelector = \".\" + renderPos(pos).replace(\" \", \".\");\n            var wrap = $(\".k-map-controls\" + posSelector, this.element);\n            if (wrap.length === 0) {\n                wrap = $(\"<div>\")\n                       .addClass(\"k-map-controls \" + renderPos(pos))\n                       .appendTo(this.element);\n            }\n\n            return $(\"<div>\").appendTo(wrap);\n        },\n\n        _createAttribution: function(options) {\n            var element = this._createControlElement(options, \"bottomRight\");\n            this.attribution = new ui.Attribution(element, options);\n        },\n\n        _createNavigator: function(options) {\n            var element = this._createControlElement(options, \"topLeft\");\n            var navigator = this.navigator = new ui.Navigator(element, options);\n\n            this._navigatorPan = proxy(this._navigatorPan, this);\n            navigator.bind(\"pan\", this._navigatorPan);\n\n            this._navigatorCenter = proxy(this._navigatorCenter, this);\n            navigator.bind(\"center\", this._navigatorCenter);\n        },\n\n        _navigatorPan: function(e) {\n            var map = this;\n            var scroller = map.scroller;\n\n            var x = scroller.scrollLeft + e.x;\n            var y = scroller.scrollTop - e.y;\n\n            var bounds = this._virtualSize;\n            var height = this.element.height();\n            var width = this.element.width();\n\n            // TODO: Move limits in scroller\n            x = limit(x, bounds.x.min, bounds.x.max - width);\n            y = limit(y, bounds.y.min, bounds.y.max - height);\n\n            map.scroller.one(\"scroll\", function(e) { map._scrollEnd(e); });\n            map.scroller.scrollTo(-x, -y);\n        },\n\n        _navigatorCenter: function() {\n            this.center(this.options.center);\n        },\n\n        _createZoomControl: function(options) {\n            var element = this._createControlElement(options, \"topLeft\");\n            var zoomControl = this.zoomControl = new ui.ZoomControl(element, options);\n\n            this._zoomControlChange = proxy(this._zoomControlChange, this);\n            zoomControl.bind(\"change\", this._zoomControlChange);\n        },\n\n        _zoomControlChange: function(e) {\n            if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                this.zoom(this.zoom() + e.delta);\n                this.trigger(\"zoomEnd\", { originalEvent: e });\n            }\n        },\n\n        _initScroller: function() {\n            var friction = kendo.support.mobileOS ? FRICTION_MOBILE : FRICTION;\n            var zoomable = this.options.zoomable !== false;\n            var scroller = this.scroller = new kendo.mobile.ui.Scroller(\n                this.element.children(0), {\n                    friction: friction,\n                    velocityMultiplier: VELOCITY_MULTIPLIER,\n                    zoom: zoomable,\n                    mousewheelScrolling: false,\n                    supportDoubleTap: true\n                });\n\n            scroller.bind(\"scroll\", proxy(this._scroll, this));\n            scroller.bind(\"scrollEnd\", proxy(this._scrollEnd, this));\n            scroller.userEvents.bind(\"gesturestart\", proxy(this._scaleStart, this));\n            scroller.userEvents.bind(\"gestureend\", proxy(this._scale, this));\n            scroller.userEvents.bind(\"doubleTap\", proxy(this._doubleTap, this));\n            scroller.userEvents.bind(\"tap\", proxy(this._tap, this));\n\n            this.scrollElement = scroller.scrollElement;\n        },\n\n        _initLayers: function() {\n            var defs = this.options.layers,\n                layers = this.layers = [];\n\n            for (var i = 0; i < defs.length; i++) {\n                var options = defs[i];\n                var type = options.type || \"shape\";\n                var defaults = this.options.layerDefaults[type];\n                var impl = dataviz.map.layers[type];\n\n                layers.push(new impl(this, deepExtend({}, defaults, options)));\n            }\n        },\n\n        _initMarkers: function() {\n            this.markers = new map.layers.MarkerLayer(this, this.options.markerDefaults);\n            this.markers.add(this.options.markers);\n        },\n\n        _scroll: function(e) {\n            var origin = this.locationToLayer(this._viewOrigin).round();\n            var movable = e.sender.movable;\n\n            var offset = new g.Point(movable.x, movable.y).scale(-1).scale(1/movable.scale);\n            origin.x += offset.x;\n            origin.y += offset.y;\n\n            this._scrollOffset = offset;\n\n            this._setOrigin(this.layerToLocation(origin));\n            this.trigger(\"pan\", {\n                originalEvent: e,\n                origin: this._getOrigin(),\n                center: this.center()\n            });\n        },\n\n        _scrollEnd: function(e) {\n            if (!this._scrollOffset || !this._panComplete()) {\n                return;\n            }\n\n            this._scrollOffset = null;\n            this._panEndTS = new Date();\n\n            this.trigger(\"panEnd\", {\n                originalEvent: e,\n                origin: this._getOrigin(),\n                center: this.center()\n            });\n        },\n\n        _panComplete: function() {\n            return new Date() - (this._panEndTS || 0) > 50;\n        },\n\n        _scaleStart: function(e) {\n            if (this.trigger(\"zoomStart\", { originalEvent: e })) {\n                var touch = e.touches[1];\n                if (touch) {\n                    touch.cancel();\n                }\n            }\n        },\n\n        _scale: function(e) {\n            var scale = this.scroller.movable.scale;\n            var zoom = this._scaleToZoom(scale);\n            var gestureCenter = new g.Point(e.center.x, e.center.y);\n            var centerLocation = this.viewToLocation(gestureCenter, zoom);\n            var centerPoint = this.locationToLayer(centerLocation, zoom);\n            var originPoint = centerPoint.translate(-gestureCenter.x, -gestureCenter.y);\n\n            this._zoomAround(originPoint, zoom);\n            this.trigger(\"zoomEnd\", { originalEvent: e });\n        },\n\n        _scaleToZoom: function(scaleDelta) {\n            var scale = this._layerSize() * scaleDelta;\n            var tiles = scale / this.options.minSize;\n            var zoom = math.log(tiles) / math.log(2);\n\n            return math.round(zoom);\n        },\n\n        _reset: function() {\n            if (this.attribution) {\n                this.attribution.filter(this.center(), this.zoom());\n            }\n\n            this._viewOrigin = this._getOrigin(true);\n            this._resetScroller();\n            this.trigger(\"beforeReset\");\n            this.trigger(\"reset\", {\n                tileTitle: this.options.messages.tileTitle\n            });\n        },\n\n        _resetScroller: function() {\n            var scroller = this.scroller;\n            var x = scroller.dimensions.x;\n            var y = scroller.dimensions.y;\n            var scale = this._layerSize();\n            var nw = this.extent().nw;\n            var topLeft = this.locationToLayer(nw).round();\n\n            scroller.movable.round = true;\n            scroller.reset();\n            scroller.userEvents.cancel();\n\n            var zoom = this.zoom();\n            scroller.dimensions.forcedMinScale = pow(2, this.options.minZoom - zoom);\n            scroller.dimensions.maxScale = pow(2, this.options.maxZoom - zoom);\n\n            var xBounds = { min: -topLeft.x, max: scale - topLeft.x };\n            var yBounds = { min: -topLeft.y, max: scale - topLeft.y };\n\n            if (this.options.wraparound) {\n                xBounds.max = 20 * scale;\n                xBounds.min = -xBounds.max;\n            }\n\n            if (this.options.pannable === false) {\n                var viewSize = this.viewSize();\n                xBounds.min = yBounds.min = 0;\n                xBounds.max = viewSize.width;\n                yBounds.max = viewSize.height;\n            }\n\n            x.makeVirtual();\n            y.makeVirtual();\n            x.virtualSize(xBounds.min, xBounds.max);\n            y.virtualSize(yBounds.min, yBounds.max);\n\n            this._virtualSize = { x: xBounds, y: yBounds };\n        },\n\n        _renderLayers: function() {\n            var defs = this.options.layers,\n                layers = this.layers = [],\n                scrollWrap = this.scrollWrap;\n\n            scrollWrap.empty();\n\n            for (var i = 0; i < defs.length; i++) {\n                var options = defs[i];\n                var type = options.type || \"shape\";\n                var defaults = this.options.layerDefaults[type];\n                var impl = dataviz.map.layers[type];\n\n                layers.push(new impl(this, deepExtend({}, defaults, options)));\n            }\n        },\n\n        _layerSize: function(zoom) {\n            zoom = valueOrDefault(zoom, this.options.zoom);\n            return this.options.minSize * pow(2, zoom);\n        },\n\n        _tap: function(e) {\n            if (!this._panComplete()) {\n                return;\n            }\n\n            var cursor = this.eventOffset(e);\n            this.trigger(\"click\", {\n                originalEvent: e,\n                location: this.viewToLocation(cursor)\n            });\n        },\n\n        _doubleTap: function(e) {\n            var options = this.options;\n            if (options.zoomable !== false) {\n                if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                    var toZoom = this.zoom() + DEFAULT_ZOOM_RATE;\n                    var cursor = this.eventOffset(e);\n                    var location = this.viewToLocation(cursor);\n                    var postZoom = this.locationToLayer(location, toZoom);\n                    var origin = postZoom.translate(-cursor.x, -cursor.y);\n                    this._zoomAround(origin, toZoom);\n                    this.trigger(\"zoomEnd\", { originalEvent: e });\n                }\n            }\n        },\n\n        _mousewheel: function(e) {\n            e.preventDefault();\n            var delta = dataviz.mwDelta(e) > 0 ? -1 : 1;\n            var options = this.options;\n            var fromZoom = this.zoom();\n            var toZoom = limit(fromZoom + delta, options.minZoom, options.maxZoom);\n\n            if (options.zoomable !== false && toZoom !== fromZoom) {\n                if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                    var cursor = this.eventOffset(e);\n                    var location = this.viewToLocation(cursor);\n                    var postZoom = this.locationToLayer(location, toZoom);\n                    var origin = postZoom.translate(-cursor.x, -cursor.y);\n                    this._zoomAround(origin, toZoom);\n\n                    this.trigger(\"zoomEnd\", { originalEvent: e });\n                }\n            }\n        }\n    });\n\n    // Exports ================================================================\n    dataviz.ui.plugin(Map);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('kendo.dataviz.map',[\n        \"./kendo.data\", \"./kendo.userevents\", \"./kendo.tooltip\", \"./kendo.mobile.scroller\", \"./kendo.draganddrop\",\n        \"./kendo.dataviz.core\",\n\n        \"./dataviz/map/location\",\n        \"./dataviz/map/attribution\",\n        \"./dataviz/map/navigator\",\n        \"./dataviz/map/zoom\",\n        \"./dataviz/map/crs\",\n        \"./dataviz/map/layers/base\",\n        \"./dataviz/map/layers/shape\",\n        \"./dataviz/map/layers/bubble\",\n        \"./dataviz/map/layers/tile\",\n        \"./dataviz/map/layers/bing\",\n        \"./dataviz/map/layers/marker\",\n        \"./dataviz/map/main\"\n    ], f);\n})(function(){\n\n    var __meta__ = { // jshint ignore:line\n        id: \"dataviz.map\",\n        name: \"Map\",\n        category: \"dataviz\",\n        description: \"The Kendo DataViz Map displays spatial data\",\n        depends: [ \"data\", \"userevents\", \"tooltip\", \"dataviz.core\", \"drawing\", \"mobile.scroller\" ]\n    };\n\n    return window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","kendo","window","deepExtend","sqr","value","now","Date","getTime","renderSize","size","renderPos","pos","result","parts","toHyphens","split","i","length","push","join","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","toLowerCase","digits","v","x","l","c","d","m","prev","charAt","memoize","f","cache","Object","create","id","arguments","apply","this","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","call","Return","ex","util","RegExp","amd","a1","a2","a3","$","jQuery","undefined","math","Math","abs","atan","atan2","cos","max","min","sin","tan","Class","dataviz","drawing","defined","deg","rad","round","valueOrDefault","Location","extend","init","lat","lng","DISTANCE_ITERATIONS","DISTANCE_CONVERGENCE","DISTANCE_PRECISION","FORMAT","toArray","equals","loc","clone","precision","wrap","distanceTo","dest","datum","greatCircleTo","distance","destination","bearing","map","datums","WGS84","fromLat","fromLng","dToR","a","asin","azimuthFrom","azimuthTo","b","L","U1","sinU1","cosU1","U2","sinU2","cosU2","lambda","prevLambda","converged","sinLambda","cosLambda","sino","cosA2","coso","cos2om","sigma","sqrt","sinA","C","u2","A","B","deltao","Extent","fn","toString","format","fromLngLat","ll","fromLatLng","nw","se","contains","center","containsAny","locs","include","includeAll","edges","ne","sw","overlaps","extent","World","Widget","ui","template","Attribution","element","options","_initOptions","items","addClass","name","separator","itemTemplate","filter","zoom","_extent","_zoom","_render","add","item","text","remove","clear","empty","_itemText","append","show","hide","inZoomLevel","_inZoomLevel","minZoom","maxZoom","inArea","_inArea","Number","MAX_VALUE","area","plugin","keys","proxy","NS","button","dir","BUTTONS","Navigator","on","parentElement","parent","closest","attr","_keyroot","_tabindex","_keydown","panStep","events","dispose","off","_pan","y","trigger","_click","e","currentTarget","is","preventDefault","which","UP","DOWN","RIGHT","LEFT","iconClass","PLUS","MINUS","FF_PLUS","FF_MINUS","ZoomControl","zoomStep","_change","delta","NUMPAD_PLUS","NUMPAD_MINUS","exp","pow","log","g","geometry","Point","limit","limitValue","PI","PI_DIV_2","PI_DIV_4","DEG_TO_RAD","Mercator","MAX_LNG","MAX_LAT","INVERSE_ITERATIONS","INVERSE_CONVERGENCE","centralMeridian","forward","clamp","proj","lng0","_projectLat","ecc","ts","con","p","inverse","point","_inverseY","ecch","phi","dphi","SphericalMercator","Equirectangular","EPSG3857","crs","_proj","_tm","transform","translate","scale","_itm","toPoint","toLocation","EPSG3395","EPSG4326","projections","Layer","css","zIndex","opacity","appendTo","scrollElement","_beforeReset","_reset","_resize","_panEnd","_activate","_updateAttribution","destroy","_deactivate","reset","_applyExtent","_setVisibility","noop","matchMinZoom","matchMaxZoom","inside","visible","bind","unbind","attribution","layers","DataSource","data","Group","last","ShapeLayer","surface","Surface","width","height","_initRoot","movable","Movable","_markers","_handler","_mouseenter","_mouseleave","_initDataSource","autoBind","dataSource","_dataChange","setDataSource","fetch","_translateSurface","_data","_load","_root","draw","dsOptions","sender","view","_clearMarkers","_loader","GeoJSONLoader","style","container","shape","parse","shapeCreated","cancelled","Circle","_createMarker","args","layer","featureCreated","marker","markers","location","dataItem","_panning","suspendTracking","resumeTracking","locationToView","moveTo","event","originalEvent","locator","defaultStyle","observer","root","unwrap","type","_loadGeometryTo","_featureCreated","children","_shapeCreated","group","properties","coords","coordinates","path","_loadPolygon","_setLineFill","_loadPoint","segments","anchor","fill","_loadShape","rings","_buildPolygon","MultiPath","Path","j","lineTo","circle","schemas","geojson","features","geometries","transports","read","dataType","getter","BubbleLayer","locationField","valueField","minSize","maxSize","symbol","opt","getValue","slice","sort","scaleType","_scaleType","_createSymbol","_drawSymbol","isFunction","scales","symbols","SqrtScale","domain","range","_domain","_range","domainRange","outputRange","_ratio","rel","Symbols","bubble","geo","square","halfSize","close","drawingUtil","TileLayer","subdomains","viewType","_viewType","_view","origin","locationToLayer","viewOrigin","tileTitle","_updateView","TileView","support","mobileOS","throttle","extentToPoint","render","pool","TilePool","tileSize","urlTemplate","_center","_viewOrigin","pointToTileIndex","floor","tileCount","firstTileIndex","indexToPoint","ceil","diff","index","subdomainText","subdomainIndex","_tileTitle","tile","createTile","currentIndex","tileOptions","get","wrapIndex","offset","roundPoint","subdomain","errorUrlTemplate","boundary","wrapValue","remainder","ImageTile","createElement","errorUrl","target","setAttribute","removeAttribute","top","left","url","visibility","urlResult","urlOptions","z","s","quadkey","q","culture","_items","_remove","_create","hashKey","maxDist","dist","splice","BingLayer","baseUrl","_scheme","_onMetadata","_fetchMetadata","imagerySet","key","Error","ajax","output","uriScheme","jsonp","success","proto","protocol","replace","resourceSets","resource","resources","imageUrl","imageUrlSubdomains","zoomMin","zoomMax","_addAttribution","BingView","imageryProviders","coverageAreas","bbox","tileQuadKey","quadKey","digit","mask","bing","doc","document","indexOf","inArray","Tooltip","MarkerLayer","_markerClick","titleField","arg","Array","isArray","_addOne","update","showAt","Marker","addTo","getLocation","getTitle","title","tooltip","popup","_position","attributes","renderTooltip","contentTemplate","content","contentUrl","defaults","CSS_PREFIX","FRICTION","FRICTION_MOBILE","MOUSEWHEEL","VELOCITY_MULTIPLIER","DEFAULT_ZOOM_RATE","Map","_getOrigin","_initScroller","_initMarkers","_initControls","_initLayers","_mousewheel","controls","navigator","layerDefaults","color","stroke","position","markerDefaults","wraparound","messages","scroller","zoomControl","level","_setExtent","_getExtent","setOptions","_layerSize","layerToLocation","translateWith","viewToLocation","eventOffset","field","pageX","clientX","pageY","clientY","eventToView","cursor","eventToLayer","eventToLocation","viewSize","exportVisual","_setOrigin","topLeft","_origin","invalidate","raw","bottomRight","layerWidth","layerHeight","_zoomAround","pivot","_createAttribution","_createNavigator","_createZoomControl","_createControlElement","defaultPos","posSelector","_navigatorPan","_navigatorCenter","scrollLeft","scrollTop","bounds","_virtualSize","one","_scrollEnd","scrollTo","_zoomControlChange","friction","zoomable","mobile","Scroller","velocityMultiplier","mousewheelScrolling","supportDoubleTap","_scroll","userEvents","_scaleStart","_scale","_doubleTap","_tap","defs","impl","_scrollOffset","_panComplete","_panEndTS","touch","touches","cancel","_scaleToZoom","gestureCenter","centerLocation","centerPoint","originPoint","scaleDelta","tiles","_resetScroller","dimensions","forcedMinScale","maxScale","xBounds","yBounds","pannable","makeVirtual","virtualSize","_renderLayers","scrollWrap","toZoom","postZoom","mwDelta","fromZoom","__meta__","category","description","depends"],"mappings":"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"}