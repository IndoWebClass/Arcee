{"version":3,"file":"kendo.gantt.list.min.js","sources":["kendo.gantt.list.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define) {\n    define('kendo.gantt.list',[ \"./kendo.treelist\", \"./kendo.treeview.draganddrop\" ], f);\n})(function() {\n\nvar __meta__ = { // jshint ignore:line\n    id: \"gantt.list\",\n    name: \"Gantt List\",\n    category: \"web\",\n    description: \"The Gantt List\",\n    depends: [ \"treelist\", \"treeview.draganddrop\" ],\n    hidden: true\n};\n\n(function($) {\n    var extend = $.extend,\n        map = $.map,\n        proxy = $.proxy,\n        isFunction = kendo.isFunction,\n\n        ui = kendo.ui,\n        TreeList = ui.TreeList,\n        outerHeight = kendo._outerHeight,\n        activeElement = kendo._activeElement,\n        keys = kendo.keys,\n        mobileOS = kendo.support.mobileOS,\n\n        DATATYPE = kendo.attr(\"type\"),\n        BINDING = kendo.attr(\"bind\"),\n        FORMAT = kendo.attr(\"format\"),\n\n        STRING = \"string\",\n        NS = \".kendoGanttList\",\n        DOUBLE_CLICK = \"dblclick\",\n        FOCUSIN = \"focusin\",\n        FOCUSOUT = \"focusout\",\n        KEYDOWN = \"keydown\",\n        KEYUP = \"keyup\",\n        MOUSE_DOWN = \"mousedown\",\n        BEFORE_EDIT = \"beforeEdit\",\n        EDIT = \"edit\",\n        SAVE = \"save\",\n        CANCEL = \"cancel\",\n        RENDER = \"render\",\n        DOT = \".\",\n\n        defaultDateFormat = \"{0:\" + kendo.getCulture().calendar.patterns.d +\"}\",\n\n        titleFromField = {\n            \"title\": \"Title\",\n            \"start\": \"Start Time\",\n            \"end\": \"End Time\",\n            \"percentComplete\": \"% Done\",\n            \"parentId\": \"Predecessor ID\",\n            \"id\": \"ID\",\n            \"orderId\": \"Order ID\"\n        },\n\n        SIZE_CALCULATION_TEMPLATE = \"<table style='visibility: hidden;'>\" +\n            \"<tbody>\" +\n                \"<tr style='height:{0}'>\" +\n                    \"<td>&nbsp;</td>\" +\n                \"</tr>\" +\n            \"</tbody>\" +\n        \"</table>\",\n\n        listStyles = {\n            gridHeader: \"k-grid-header\",\n            gridContentWrap: \"k-grid-content\",\n            editCell: \"k-edit-cell\",\n            iconCollapse: \"k-i-collapse\",\n            iconExpand: \"k-i-expand\"\n        };\n\n    var GanttList = ui.GanttList = TreeList.extend({\n        init: function(element, options) {\n            if (this.options.columns.length === 0) {\n                this.options.columns.push(\"title\");\n            }\n\n            TreeList.fn.init.call(this, element, options);\n\n            this._unbindDataSource();\n            this._setWidth();\n        },\n\n        options: {\n            name: \"GanttList\",\n            autoBind: false,\n            sortable: true,\n            selectable: true,\n            navigatable: false,\n            editable: {\n                move: true,\n                mode: \"incell\"\n            },\n            resizable: false,\n            renderAllRows: false\n        },\n\n        destroy: function() {\n            TreeList.fn.destroy.call(this);\n            kendo.destroy(this.element);\n        },\n\n        closeCell: function(isCancel) {\n            var that = this;\n            var cell = (that.editor || {}).element;\n            var tr;\n            var model;\n\n            if (!cell || !cell[0] || !that._isIncellEditable()) {\n                return;\n            }\n\n            model = that.dataItem(cell);\n            that._cancelEditor();\n            cell.removeClass(listStyles.editCell);\n            tr = cell.parent().removeClass(listStyles.editRow);\n\n            if (that.lockedContent) {\n                that._relatedRow(tr).removeClass(listStyles.editRow);\n            }\n\n            if (isCancel) {\n                that._render();\n            }\n\n            that.trigger(\"itemChange\", { item: tr, data: model, ns: ui });\n\n            if (that.lockedContent) {\n                that._adjustRowHeight(tr.css(\"height\", \"\")[0], that._relatedRow(tr).css(\"height\", \"\")[0]);\n            }\n        },\n\n        insertAfter: function(nodeData, referenceNode) {\n            if(!nodeData || !referenceNode) {\n                return;\n            }\n\n            var orderId = referenceNode.orderId;\n            var taskInfo = {\n                parentId: referenceNode.parentId\n            };\n\n            if (referenceNode.parentId === nodeData.parentId && referenceNode.orderId > nodeData.orderId) {\n                taskInfo.orderId = orderId;\n            } else {\n                taskInfo.orderId = orderId + 1;\n            }\n\n            this.trigger(\"reorder\", {\n                task: nodeData,\n                updateInfo: taskInfo\n            });\n        },\n\n        insertBefore: function(nodeData, referenceNode) {\n            if(!nodeData || !referenceNode) {\n                return;\n            }\n\n            var orderId = referenceNode.orderId;\n            var taskInfo = {\n                parentId: referenceNode.parentId\n            };\n\n            if (referenceNode.parentId === nodeData.parentId &&\n                referenceNode.orderId > nodeData.orderId) {\n                    taskInfo.orderId = orderId - 1;\n            } else {\n                taskInfo.orderId = orderId;\n            }\n\n            this.trigger(\"reorder\", {\n                task: nodeData,\n                updateInfo: taskInfo\n            });\n        },\n\n        _adjustHeight: function() {\n            var element = this.element;\n            var contentWrap = element.find(DOT + listStyles.gridContentWrap);\n            var header = element.find(DOT + listStyles.gridHeader);\n            var height;\n            var scrollbar = kendo.support.scrollbar();\n\n            if (this._isHeightSet(element)) {\n                height = element.height() - outerHeight(header);\n\n                contentWrap.height(height);\n\n                if (this._hasLockedColumns) {\n                    scrollbar = this.table[0].offsetWidth > this.table.parent()[0].clientWidth ? scrollbar : 0;\n                    this.lockedContent.height(height - scrollbar);\n                }\n            }\n        },\n\n        _adjustRowHeight: function(row1, row2) {\n            var height;\n            var offsetHeight1 = row1.offsetHeight;\n            var offsetHeight2 = row2.offsetHeight;\n\n            if (offsetHeight1 > offsetHeight2) {\n                height = offsetHeight1 + \"px\";\n            } else if (offsetHeight1 < offsetHeight2) {\n                height = offsetHeight2 + \"px\";\n            }\n\n            if (height) {\n                row1.style.height = row2.style.height = height;\n            }\n         },\n\n        // identical code found in treelist, grid & scheduler :(\n        _isHeightSet: function(el) {\n            var initialHeight, newHeight;\n            if (el[0].style.height) {\n                return true;\n            } else {\n                initialHeight = el.height();\n            }\n\n            el.height(\"auto\");\n            newHeight = el.height();\n            el.height(\"\");\n\n            return (initialHeight != newHeight);\n        },\n\n        _attachCellEditingEventHandlers: function() {\n            var that = this,\n                editable = that.options.editable;\n\n            if (that._isIncellEditable() && editable.update !== false) {\n                that._startEditHandler = function(e) {\n                    var td = e.currentTarget ? $(e.currentTarget) : e;\n                    var column = that._columnFromElement(td);\n\n                    if (that.editable) {\n                        return;\n                    }\n\n                    if (column && column.editable()) {\n                        that._editCell(td, column, that._modelFromElement(td));\n                    }\n                };\n\n                that.content\n                    .on(FOCUSIN + NS, proxy(that._focusInEditableHandler, that))\n                    .on(FOCUSOUT + NS, proxy(that._focusoutCellHandler, that))\n                    .on(KEYDOWN + NS, \"tr:not(.k-grouping-row) > td\", proxy(that._keydownHandler, that))\n                    .on(KEYUP + NS, \"tr:not(.k-grouping-row) > td\", proxy(that._keyupHandler, that));\n\n                if (!mobileOS) {\n                    that.content\n                        .on(MOUSE_DOWN + NS, \"tr:not(.k-grouping-row) > td\", proxy(that._mouseDownHandler, that))\n                        .on(DOUBLE_CLICK + NS, \"tr:not(.k-grouping-row) > td\", proxy(that._openEditorHandler, that));\n                } else {\n                    that.touch = that.content\n                        .kendoTouch({\n                            filter: \"td\",\n                            touchstart: function(e) {\n                                that._mouseDownHandler(e.touch);\n                            },\n                            doubletap: function(e) {\n                                if(e.event.target.classList.contains(\"k-icon\")) {\n                                    return;\n                                }\n                                that._openEditorHandler(e.touch);\n                            }\n                        }).data(\"kendoTouch\");\n                }\n            }\n        },\n\n        _blurActiveElement: function() {\n            var activeElement = kendo._activeElement();\n\n            if (activeElement && activeElement.nodeName.toLowerCase() !== \"body\") {\n                $(activeElement).trigger(\"blur\");\n            }\n        },\n\n        _closeCellTimeouted: function() {\n            var that = this,\n                target = activeElement(),\n                editor = that.editor || {},\n                cell = editor.element;\n\n            if (cell && cell[0] && target && !$.contains(cell[0], target) && cell[0] !== target && !$(target).closest(\".k-animation-container\").length) {\n                if (editor.end()) {\n                    that.closeCell();\n                }\n            }\n        },\n\n        _columns: function() {\n            var that = this,\n                columns = this.options.columns;\n\n            that._hasExpandable = false;\n\n            columns.forEach(function(item){\n                if(item.expandable) {\n                    that._hasExpandable = true;\n                }\n            });\n\n            that.columns = that.options.columns = map(columns, proxy(that._eachColumn, that));\n\n            TreeList.fn._columns.call(that);\n        },\n\n        _columnEditor: function(column) {\n            var attr = {\n                \"name\": column.field,\n                \"required\": true\n            };\n\n            attr[BINDING] = \"value:\" + column.field;\n            attr[DATATYPE] = \"date\";\n            attr[FORMAT] = kendo._extractFormat(column.format);\n\n            return function(container, options) {\n                var model = options.model,\n                    field = model.fields[column.field] || model[column.field],\n                    validation = field.validation;\n\n                if (validation && validation.dateCompare && isFunction(validation.dateCompare) && validation.message) {\n                    $('<span ' + kendo.attr(\"for\") + '=\"' + column.field + '\" class=\"k-invalid-msg\"/>')\n                        .hide()\n                        .appendTo(container);\n\n                    attr[kendo.attr(\"dateCompare-msg\")] = validation.message;\n                }\n\n                $('<input type=\"text\"/>')\n                    .attr(attr)\n                    .prependTo(container)\n                    .kendoDateTimePicker({ format: options.format });\n            };\n        },\n\n        _columnFromElement: function(element) {\n            var td = element.closest(\"td\"),\n                tr = td.parent(),\n                idx = tr.children().index(td);\n\n            return this.columns[idx];\n        },\n\n        _eachColumn: function(column) {\n            var that = this,\n                resourcesField = that.options.resourcesField,\n                isSortable = this.options.sortable;\n\n            var model = function() {\n                this.field = \"\";\n                this.title = \"\";\n                this.editable = function() { return false; };\n                this.sortable = false;\n            };\n\n            var formatResources = function(task) {\n                var value = task.get(resourcesField) || [],\n                    formatedValue = [];\n\n                for (var i = 0; i < value.length; i++) {\n                    formatedValue.push(kendo.format(\"{0} [{1}]\", value[i].get(\"name\"), value[i].get(\"formatedValue\")));\n                }\n\n                return formatedValue.join(\", \");\n            };\n\n            if(column.columns) {\n                that.hasNestedColumns = true;\n                column.columns = map(column.columns, proxy(this._eachColumn, this));\n            }\n\n            if(typeof column === STRING) {\n                column = {\n                    field: column,\n                    title: titleFromField[column]\n                };\n            }\n\n            if (column.editable === true) {\n                column.editable = function() {\n                    return true;\n                };\n            } else {\n                column.editable = function() {\n                    return false;\n                };\n            }\n\n            if(column.field === \"start\" || column.field === \"end\") {\n                column.format = kendo.getCulture().calendar.patterns[column.format] || column.format || defaultDateFormat;\n\n                if(!column.editor) {\n                    if(column.format === defaultDateFormat || column.format.toLowerCase().indexOf(\"h\") > -1) {\n                        column.editor = that._columnEditor(column);\n                    }\n                }\n            }\n            if (column.field === resourcesField) {\n                column.sortable = false;\n                column.template = column.template || formatResources;\n            }\n            if(!that._hasExpandable && column.field === \"title\") {\n                column.expandable = true;\n            }\n\n            if(isSortable && !column.sortable) {\n                column.sortable = false;\n            }\n\n            return extend(new model(), column);\n        },\n\n        _editCell: function(cell, column, model) {\n            var that = this,\n                resourcesField = that.options.resourcesField,\n                modelCopy = that.dataSource._createNewModel(model.toJSON()),\n                editedCell;\n\n            if (column.field === resourcesField) {\n                column.editor(cell, modelCopy);\n                return;\n            } else {\n                if (that.trigger(BEFORE_EDIT, { model: model, container: cell })) {\n                    that.dataSource._restorePageSizeAfterAddChild();\n                    return;\n                }\n\n                that.closeCell();\n\n                model._edit = true;\n\n                that._cancelEditor();\n\n                that._render({\n                    editedColumn: column,\n                    editedColumnIndex: cell.index()\n                });\n\n                editedCell = that.table.add(that.lockedTable).find(DOT + listStyles.editCell).first();\n\n                that.editor = that._createIncellEditor(editedCell, {\n                    columns: [column],\n                    model: model,\n                    change: function(e) {\n                        if (that.trigger(SAVE, { values: e.values, container: cell, model: model } )) {\n                            e.preventDefault();\n                        }\n                    }\n                });\n\n                // refresh the current element as the DOM element reference can be changed after render()\n                that._current = editedCell;\n\n                that.trigger(EDIT, { container: cell, model: model });\n            }\n        },\n\n        _focusInEditableHandler: function(e) {\n            var that = this,\n                target = e.target;\n\n            if (!$.contains(target, activeElement())) {\n                clearTimeout(that._closeCellTimeout);\n                that._closeCellTimeout = null;\n            }\n        },\n\n        _focusoutCellHandler: function(e) {\n            var that = this;\n\n            that._closeCellTimeout = setTimeout(function() {\n                that._closeCellTimeouted(e);\n            }, 1);\n        },\n\n        _keydownHandler: function(e) {\n            if (e.keyCode === keys.ENTER) {\n                e.preventDefault();\n            }\n        },\n\n        _keyupHandler: function(e) {\n            var that = this,\n                key = e.keyCode,\n                cell, model;\n\n            switch (key) {\n                case keys.ENTER:\n                    that._blurActiveElement();\n                    that._closeCellTimeouted(e);\n                    break;\n                case keys.ESC:\n                    if (that.editor) {\n                        cell = $(e.target);\n                        model = that._modelFromElement(cell);\n\n                        that.trigger(CANCEL, { model: model, cell: cell });\n                    }\n                    break;\n            }\n        },\n\n        _modelFromElement: function(element) {\n            var row = element.closest(\"tr\"),\n                model = this.dataSource.getByUid(row.attr(kendo.attr(\"uid\")));\n\n            return model;\n        },\n\n        _mouseDownHandler: function(e) {\n            var currentTarget = $(e.currentTarget);\n\n            if (!currentTarget.hasClass(listStyles.editCell)) {\n                this._blurActiveElement();\n            }\n        },\n\n        _openEditorHandler: function(e) {\n            var that = this,\n                td = $(e.currentTarget),\n                isLockedCell = that.lockedTable && td.closest(\"table\")[0] === that.lockedTable[0],\n                selectable = that.selectable && that.selectable.options.multiple;\n\n            if (td.hasClass(listStyles.editCell) ||\n                td.has(\"a.k-grid-delete\").length ||\n                td.has(\"button.k-grid-delete\").length ||\n                (td.closest(\"tbody\")[0] !== that.tbody[0] && !isLockedCell) ||\n                $(e.target).is(\":input\") ||\n                $(e.target).hasClass(listStyles.iconExpand) ||\n                $(e.target).hasClass(listStyles.iconCollapse)) {\n\n                return;\n            }\n\n            if (that.editor) {\n                if (that.editor.end()) {\n                    if (selectable) {\n                        $(activeElement()).trigger(\"blur\");\n                    }\n                    that.closeCell();\n                    that.editCell(td);\n                }\n            } else {\n                that.editCell(td);\n            }\n        },\n\n        _renderTree: function(taskTree) {\n            TreeList.fn._render.call(this);\n\n            if(this.hasNestedColumns) {\n                this.element.addClass(\"k-gantt-treelist-nested-columns\");\n            }\n\n            if(taskTree && taskTree.length && !taskTree.editedColumn) {\n                if (this.options.rowHeight) {\n                    this._rowHeight(taskTree);\n                }\n\n                this.trigger(RENDER);\n            }\n\n            this._adjustHeight();\n        },\n\n        _rowHeight: function(tasks) {\n            var content = this.content,\n                options = this.options,\n                rowHeight = typeof options.rowHeight === STRING ? options.rowHeight : options.rowHeight + \"px\",\n                table = $(kendo.format(SIZE_CALCULATION_TEMPLATE, rowHeight)),\n                height;\n\n            content.append(table);\n            height = outerHeight(table.find(\"tr\"));\n            table.remove();\n\n            this.element.find('[role=\"treegrid\"]').css(\"height\", (tasks.length * height) + \"px\");\n        },\n\n        _setData: function(tasks) {\n            this.dataSource.data(tasks);\n        },\n\n        _setWidth: function() {\n            this.element.find(\".k-grid-header table\").css(\"minWidth\", this.options.listWidth);\n            this.content.find(\"table\").css(\"minWidth\", this.options.listWidth);\n        }\n    });\n\n    ui.plugin(GanttList);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","hidden","$","window","kendo","jQuery","extend","map","proxy","isFunction","ui","TreeList","outerHeight","_outerHeight","activeElement","_activeElement","keys","mobileOS","support","DATATYPE","attr","BINDING","FORMAT","STRING","NS","DOUBLE_CLICK","FOCUSIN","FOCUSOUT","KEYDOWN","KEYUP","MOUSE_DOWN","BEFORE_EDIT","EDIT","SAVE","CANCEL","RENDER","DOT","defaultDateFormat","getCulture","calendar","patterns","d","titleFromField","title","start","end","percentComplete","parentId","orderId","SIZE_CALCULATION_TEMPLATE","listStyles","gridHeader","gridContentWrap","editCell","iconCollapse","iconExpand","GanttList","init","element","options","this","columns","length","push","fn","call","_unbindDataSource","_setWidth","autoBind","sortable","selectable","navigatable","editable","move","mode","resizable","renderAllRows","destroy","closeCell","isCancel","that","cell","editor","tr","model","_isIncellEditable","dataItem","_cancelEditor","removeClass","parent","editRow","lockedContent","_relatedRow","_render","trigger","item","data","ns","_adjustRowHeight","css","insertAfter","nodeData","referenceNode","taskInfo","task","updateInfo","insertBefore","_adjustHeight","contentWrap","find","header","height","scrollbar","_isHeightSet","_hasLockedColumns","table","offsetWidth","clientWidth","row1","row2","offsetHeight1","offsetHeight","offsetHeight2","style","el","initialHeight","newHeight","_attachCellEditingEventHandlers","update","_startEditHandler","e","td","currentTarget","column","_columnFromElement","_editCell","_modelFromElement","content","on","_focusInEditableHandler","_focusoutCellHandler","_keydownHandler","_keyupHandler","_mouseDownHandler","_openEditorHandler","touch","kendoTouch","filter","touchstart","doubletap","event","target","classList","contains","_blurActiveElement","nodeName","toLowerCase","_closeCellTimeouted","closest","_columns","_hasExpandable","forEach","expandable","_eachColumn","_columnEditor","field","required","_extractFormat","format","container","fields","validation","dateCompare","message","hide","appendTo","prependTo","kendoDateTimePicker","idx","children","index","resourcesField","isSortable","formatResources","value","get","formatedValue","i","join","hasNestedColumns","indexOf","template","modelCopy","dataSource","_createNewModel","toJSON","editedCell","_restorePageSizeAfterAddChild","_edit","editedColumn","editedColumnIndex","add","lockedTable","first","_createIncellEditor","change","values","preventDefault","_current","clearTimeout","_closeCellTimeout","setTimeout","keyCode","ENTER","key","ESC","row","getByUid","hasClass","isLockedCell","multiple","has","tbody","is","_renderTree","taskTree","addClass","rowHeight","_rowHeight","tasks","append","remove","_setData","listWidth","plugin","amd","a1","a2","a3"],"mappings":"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"}