{"version":3,"file":"kendo.gantt.min.js","sources":["kendo.gantt.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.gantt',[\"./kendo.data\", \"./kendo.resizable\", \"./kendo.switch\", \"./kendo.gantt.data\", \"./kendo.gantt.editors\", \"./kendo.gantt.list\", \"./kendo.gantt.timeline\", \"./kendo.pdf\"], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"gantt\",\n    name: \"Gantt\",\n    category: \"web\",\n    description: \"The Gantt component.\",\n    depends: [ \"data\", \"resizable\", \"switch\", \"gantt.data\", \"gantt.editors\", \"gantt.list\", \"gantt.timeline\", \"pdf\" ]\n};\n\n(function($, undefined) {\n\n    var kendo = window.kendo,\n        keys = $.extend({F10: 121}, kendo.keys),\n        supportsMedia = \"matchMedia\" in window,\n        mobileOS = kendo.support.mobileOS,\n        Widget = kendo.ui.Widget,\n        ObservableObject = kendo.data.ObservableObject,\n        ObservableArray = kendo.data.ObservableArray,\n        Query = kendo.data.Query,\n        isArray = Array.isArray,\n        inArray = $.inArray,\n        isFunction = kendo.isFunction,\n        proxy = $.proxy,\n        extend = $.extend,\n        isPlainObject = $.isPlainObject,\n        outerWidth = kendo._outerWidth,\n        outerHeight = kendo._outerHeight,\n        defaultIndicatorWidth = 3,\n\n        NS = \".kendoGantt\",\n        PERCENTAGE_FORMAT = \"p0\",\n        TABINDEX = \"tabIndex\",\n        CLICK = \"click\",\n        STRING = \"string\",\n        ARIA_DESCENDANT = \"aria-activedescendant\",\n        ARIA_LABEL = \"aria-label\",\n        ACTIVE_CELL = \"gantt_active_cell\",\n        DOT = \".\",\n        TASK_DELETE_CONFIRM = \"Are you sure you want to delete this task?\",\n        DEPENDENCY_DELETE_CONFIRM = \"Are you sure you want to delete this dependency?\",\n        TOGGLE_BUTTON_TEMPLATE = kendo.template('<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-gantt-toggle\" type=\"button\" '+ ARIA_LABEL + '=\"Toggle\"><span class=\"k-button-icon #=styles.iconToggle#\"></span></button>'),\n        BUTTON_TEMPLATE = '<button aria-label=\"#=text#\" class=\"#=styles.button# #=styles.buttonDefaults# #=className#\" type=\"button\" '+\n            '#if (action) {#' +\n                'data-action=\"#=action#\"' +\n            '#}#' +\n        '>' +\n            '<span class=\"k-button-icon #=iconClass#\"></span>' +\n            '<span class=\"k-button-text\">#=text#</span>' +\n        '</button>',\n        COMMAND_BUTTON_TEMPLATE = '<a class=\"#=className#\" #=attr# href=\"\\\\#\"><span class=\"k-button-text\">#=text#</span></a>',\n        VIEWS_DROPDOWN_TEMPLATE = kendo.template('<select aria-label=\"#= label #\" class=\"k-dropdown k-picker k-dropdown-list #= styles.viewsDropdown #\">' +\n            '#for(var view in views){#' +\n                '<option value=\"#=view#\">#=views[view].title#</option>' +\n            '#}#' +\n        '</select>'),\n        HEADER_VIEWS_TEMPLATE = kendo.template('<div class=\"#=styles.viewsWrapper#\">' +\n            '<span class=\"k-button-group #=styles.views#\">' +\n                '#for(var view in views){#' +\n                    '<button type=\"button\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-view-#= view.toLowerCase() #\" data-#=ns#name=\"#=view#\">' +\n                        '<span class=\"k-button-text\">#=views[view].title#</span>' +\n                    '</button>' +\n                '#}#' +\n            '</span>' +\n        '</div>');\n\n    var ganttStyles = {\n        wrapper: \"k-widget k-gantt\",\n        plannedTasks: \"k-gantt-planned\",\n        rowHeight: \"k-gantt-rowheight\",\n        content: \"k-gantt-content\",\n        listWrapper: \"k-gantt-treelist\",\n        list: \"k-gantt-treelist\",\n        timelineWrapper: \"k-gantt-timeline\",\n        timeline: \"k-gantt-timeline\",\n        splitBarWrapper: \"k-splitbar k-splitbar-horizontal k-splitbar-draggable-horizontal\",\n        splitBar: \"k-splitbar\",\n        splitBarHover: \"k-splitbar-horizontal-hover\",\n        popupWrapper: \"k-list-container\",\n        popupList: \"k-list k-reset\",\n        resizeHandle: \"k-resize-handle\",\n        icon: \"k-icon\",\n        item: \"k-item\",\n        line: \"k-gantt-line\",\n        buttonDelete: \"k-gantt-delete\",\n        buttonCancel: \"k-gantt-cancel\",\n        buttonSave: \"k-gantt-update\",\n        buttonToggle: \"k-gantt-toggle\",\n        buttonDefaults: \"k-button-md k-rounded-md k-button-solid\",\n        primary: \"k-button-solid-primary\",\n        hovered: \"k-state-hover\",\n        selected: \"k-selected\",\n        focused: \"k-focus\",\n        focusedCell: \"k-state-focused\",\n        gridHeader: \"k-grid-header\",\n        gridHeaderWrap: \"k-grid-header-wrap\",\n        gridContent: \"k-grid-content\",\n        tasks: \"k-gantt-tasks\",\n        popup: {\n            form: \"k-popup-edit-form\",\n            editForm: \"k-gantt-edit-form\",\n            formContainer: \"k-edit-form-container\",\n            resourcesFormContainer: \"k-resources-form-container\",\n            message: \"k-popup-message\",\n            buttonsContainer: \"k-edit-buttons\",\n            button: \"k-button\",\n            editField: \"k-edit-field\",\n            editLabel: \"k-edit-label\",\n            resourcesField: \"k-gantt-resources\"\n        },\n        toolbar: {\n            headerWrapper: \"k-gantt-header k-toolbar k-gantt-toolbar\",\n            footerWrapper: \"k-gantt-footer k-toolbar k-gantt-toolbar\",\n            toolbar: \"k-gantt-toolbar\",\n            views: \"k-gantt-views\",\n            viewsWrapper: \"k-gantt-views-wrapper\",\n            viewsDropdown: \"k-views-dropdown\",\n            button: \"k-button\",\n            buttonToggle: \"k-gantt-toggle\",\n            buttonDefaults: \"k-button-md k-rounded-md k-button-solid\",\n            iconPlus: \"k-icon k-i-plus\",\n            iconPdf: \"k-icon k-i-file-pdf\",\n            iconToggle: \"k-icon k-i-layout-1-by-4\",\n            viewButton: \"k-view\",\n            link: \"k-link\",\n            pdfButton: \"k-gantt-pdf\",\n            appendButton: \"k-gantt-create\"\n        }\n    };\n\n    function selector(uid) {\n        return \"[\" + kendo.attr(\"uid\") + (uid ? \"='\" + uid + \"']\" : \"]\");\n    }\n\n    function trimOptions(options) {\n        delete options.name;\n        delete options.prefix;\n\n        delete options.remove;\n        delete options.edit;\n        delete options.add;\n        delete options.navigate;\n\n        return options;\n    }\n\n    function focusTable(table, direct) {\n        var wrapper = table.parents('[' + kendo.attr(\"role\") + '=\"gantt\"]');\n        var scrollPositions = [];\n        var parents = scrollableParents(wrapper);\n\n        table.attr(TABINDEX, 0);\n\n        if (direct) {\n            parents.each(function(index, parent) {\n                scrollPositions[index] = $(parent).scrollTop();\n            });\n        }\n\n        try {\n            //The setActive method does not cause the document to scroll to the active object in the current page\n            table[0].setActive();\n        } catch (e) {\n            table[0].focus();\n        }\n\n        if (direct) {\n            parents.each(function(index, parent) {\n                $(parent).scrollTop(scrollPositions[index]);\n            });\n        }\n    }\n\n    function scrollableParents(element) {\n        return $(element).parentsUntil(\"body\")\n                .filter(function(index, element) {\n                    var computedStyle = kendo.getComputedStyles(element, [\"overflow\"]);\n                    return computedStyle.overflow != \"visible\";\n                })\n                .add(window);\n    }\n\n    var defaultCommands;\n\n    var Gantt = Widget.extend({\n        init: function(element, options, events) {\n            if (isArray(options)) {\n                options = { dataSource: options };\n            }\n\n            defaultCommands = {\n                append: {\n                    text: \"Add Task\",\n                    action: \"add\",\n                    className: Gantt.styles.toolbar.appendButton + \" k-button-solid-base\",\n                    iconClass: Gantt.styles.toolbar.iconPlus\n                },\n                pdf: {\n                    text: \"Export to PDF\",\n                    className: Gantt.styles.toolbar.pdfButton  + \" k-button-solid-base\",\n                    iconClass: Gantt.styles.toolbar.iconPdf\n                }\n            };\n\n            Widget.fn.init.call(this, element, options);\n\n            if (events) {\n                this._events = events;\n            }\n\n            this._wrapper();\n\n            this._resources();\n\n            if (!this.options.views || !this.options.views.length) {\n                this.options.views = [\"day\", \"week\", \"month\"];\n            }\n\n            this._timeline();\n\n            this._toolbar();\n\n            this._footer();\n\n            this._adjustDimensions();\n\n            // Prevent extra refresh from setting the view\n            this._preventRefresh = true;\n\n            this.view(this.timeline._selectedViewName);\n\n            this._preventRefresh = false;\n\n            this._dataSource();\n\n            this._assignments();\n\n            this._dropDowns();\n\n            this._list();\n\n            this._dependencies();\n\n            this._resizable();\n\n            this._scrollable();\n\n            this._dataBind();\n\n            this._attachEvents();\n\n            this._createEditor();\n\n            kendo.notify(this);\n        },\n\n        events: [\n            \"dataBinding\",\n            \"dataBound\",\n            \"add\",\n            \"edit\",\n            \"remove\",\n            \"cancel\",\n            \"save\",\n            \"change\",\n            \"navigate\",\n            \"moveStart\",\n            \"move\",\n            \"moveEnd\",\n            \"resizeStart\",\n            \"resize\",\n            \"resizeEnd\",\n            \"columnHide\",\n            \"columnReorder\",\n            \"columnResize\",\n            \"columnShow\",\n            \"togglePlannedTasks\"\n        ],\n\n        options: {\n            name: \"Gantt\",\n            autoBind: true,\n            navigatable: false,\n            selectable: true,\n            editable: true,\n            resizable: false,\n            columnResizeHandleWidth: defaultIndicatorWidth,\n            columns: [],\n            views: [],\n            dataSource: {},\n            dependencies: {},\n            resources: {},\n            assignments: {},\n            taskTemplate: null,\n            messages: {\n                save: \"Save\",\n                cancel: \"Cancel\",\n                destroy: \"Delete\",\n                deleteTaskConfirmation: TASK_DELETE_CONFIRM,\n                deleteDependencyConfirmation: DEPENDENCY_DELETE_CONFIRM,\n                deleteTaskWindowTitle: \"Delete task\",\n                deleteDependencyWindowTitle: \"Delete dependency\",\n                selectView: \"Select view\",\n                views: {\n                    day: \"Day\",\n                    week: \"Week\",\n                    month: \"Month\",\n                    year: \"Year\",\n                    start: \"Start\",\n                    end: \"End\"\n                },\n                actions: {\n                    append: \"Add Task\",\n                    addChild: \"Add Child\",\n                    insertBefore: \"Add Above\",\n                    insertAfter: \"Add Below\",\n                    pdf: \"Export to PDF\"\n                },\n                editor: {\n                    editorTitle: \"Task\",\n                    resourcesEditorTitle: \"Resources\",\n                    title: \"Title\",\n                    start: \"Start\",\n                    end: \"End\",\n                    plannedStart: \"Planned Start\",\n                    plannedEnd: \"Planned End\",\n                    percentComplete: \"Complete\",\n                    resources: \"Resources\",\n                    assignButton: \"Assign\",\n                    resourcesHeader: \"Resources\",\n                    unitsHeader: \"Units\"\n                },\n                plannedTasks: {\n                    switchText: \"Planned Tasks\",\n                    offsetTooltipAdvanced: \"Met deadline earlier\",\n                    offsetTooltipDelay: \"Delay\",\n                    seconds: \"seconds\",\n                    minutes: \"minutes\",\n                    hours: \"hours\",\n                    days: \"days\"\n                }\n            },\n            showWorkHours: true,\n            showWorkDays: true,\n            toolbar: null,\n            workDayStart: new Date(1980, 1, 1, 8, 0, 0),\n            workDayEnd: new Date(1980, 1, 1, 17, 0, 0),\n            workWeekStart: 1,\n            workWeekEnd: 5,\n            hourSpan: 1,\n            snap: true,\n            height: 600,\n            listWidth: \"30%\",\n            rowHeight: null,\n            showPlannedTasks: false\n        },\n\n        select: function(value) {\n            var list = this.list;\n\n            if (!value) {\n                return list.select();\n            }\n\n            if (typeof value === STRING) {\n                value = list.content.find(value);\n            }\n\n            list.select(value);\n\n            this.list.element.find(\"table[role=treegrid]\").trigger(\"focus\");\n            return;\n        },\n\n        clearSelection: function() {\n            this.list.clearSelection();\n            this.list.trigger(\"change\");\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n\n            if (this.dataSource) {\n                this.dataSource.unbind(\"change\", this._refreshHandler);\n                this.dataSource.unbind(\"progress\", this._progressHandler);\n                this.dataSource.unbind(\"error\", this._errorHandler);\n            }\n\n            if (this.dependencies) {\n                this.dependencies.unbind(\"change\", this._dependencyRefreshHandler);\n                this.dependencies.unbind(\"error\", this._dependencyErrorHandler);\n            }\n\n            if (this.timeline) {\n                this.timeline.unbind();\n                this.timeline.destroy();\n            }\n\n            if (this.list) {\n                this.list.unbind();\n                this.list.destroy();\n            }\n\n            if (this.footerDropDown) {\n                this.footerDropDown.destroy();\n            }\n\n            if (this.headerDropDown) {\n                this.headerDropDown.destroy();\n            }\n\n            if (this._editor) {\n                this._editor.destroy();\n            }\n\n            if (this._resizeDraggable) {\n                this._resizeDraggable.destroy();\n            }\n\n            this.toolbar.off(NS);\n\n            if (supportsMedia) {\n                this._mediaQuery.removeListener(this._mediaQueryHandler);\n                this._mediaQuery = null;\n            }\n\n            $(window).off(\"resize\" + NS, this._resizeHandler);\n            $(this.wrapper).off(NS);\n\n            this.toolbar = null;\n            this.footer = null;\n\n            kendo.destroy(this.element);\n        },\n\n        setOptions: function(options) {\n            var newOptions = kendo.deepExtend({}, this.options, options);\n\n            var events = this._events;\n\n            if (!options.views) {\n                var selectedView = this.view().name;\n\n                newOptions.views = $.map(this.options.views, function(view) {\n                    var isSettings = isPlainObject(view);\n                    var name = isSettings ? ((typeof view.type !== \"string\") ? view.title : view.type) : view;\n\n                    if (selectedView === name) {\n                        if (isSettings) {\n                            view.selected = true;\n                        } else {\n                            view = { type: name, selected: true };\n                        }\n                    } else if (isSettings) {\n                        view.selected = false;\n                    }\n\n                    return view;\n                });\n            }\n\n            if (!options.dataSource) { newOptions.dataSource = this.dataSource; }\n            if (!options.dependencies) { newOptions.dependencies = this.dependencies; }\n            if (!options.resources) { newOptions.resources = this.resources; }\n            if (!options.assignments) { newOptions.assignments = this.assignments; }\n\n            this.destroy();\n            this.element.empty();\n            this.options = null;\n\n            this.init(this.element, newOptions, events);\n\n            Widget.fn._setEvents.call(this, newOptions);\n        },\n\n        _attachEvents: function() {\n            this._resizeHandler = proxy(this.resize, this, false);\n            $(window).on(\"resize\" + NS, this._resizeHandler);\n\n            if (supportsMedia && this._mediaQuery.matches === true) {\n                this._mediaQueryHandler({ matches: true });\n            }\n        },\n\n        _wrapper: function() {\n            var ganttStyles = Gantt.styles;\n            var splitBarHandleClassName = [ganttStyles.icon, ganttStyles.resizeHandle].join(\" \");\n            var options = this.options;\n            var height = options.height;\n            var width = options.width;\n\n            this.wrapper = this.element.addClass(ganttStyles.wrapper);\n            this.layout = $(\"<div class='\" + ganttStyles.content + \"' />\").appendTo(this.wrapper)\n                .append(\"<div class='\" + ganttStyles.listWrapper + \"'><div></div></div>\")\n                .append(\"<div class='\" + ganttStyles.splitBarWrapper + \"'><div class='\" + splitBarHandleClassName + \"'></div></div>\")\n                .append(\"<div class='\" + ganttStyles.timelineWrapper + \"'><div></div></div>\");\n\n            if(options.showPlannedTasks) {\n                this.wrapper.addClass(ganttStyles.plannedTasks);\n            }\n\n            if (height) {\n                this.wrapper.css(\"height\", height);\n            }\n\n            if (width) {\n                this.wrapper.css(\"width\", width);\n            }\n\n            if (options.rowHeight) {\n                this.wrapper.addClass(ganttStyles.rowHeight);\n            }\n\n            this.treelistWrapper = this.wrapper.find(DOT + ganttStyles.list);\n            this.splitbar = this.wrapper.find(DOT + ganttStyles.splitBar);\n            this.timelineWrapper = this.wrapper.find(DOT + ganttStyles.timeline);\n\n            this.treelistWrapper.css(\"width\", options.listWidth);\n            this.timelineWrapper.css(\"width\", this.wrapper.width() - this.treelistWrapper.outerWidth() - this.splitbar.outerWidth() );\n        },\n\n        _toolbar: function() {\n            var that = this;\n            var ganttStyles = Gantt.styles;\n            var viewsSelector = DOT + ganttStyles.toolbar.views + \" > button\";\n            var viewsDropdownSelector = DOT + ganttStyles.toolbar.viewsDropdown;\n            var pdfSelector = DOT + ganttStyles.toolbar.pdfButton;\n            var toggleSelector = DOT + ganttStyles.buttonToggle;\n            var contentSelector = DOT + ganttStyles.gridContent;\n            var splitbar = that.splitbar;\n            var treelist = that.treelistWrapper;\n            var timeline = that.timelineWrapper;\n            var actions = this.options.toolbar;\n            var toolbar;\n            var views;\n            var toggleButton;\n            var mediaQueryHandler = function(e) {\n\n                if (e.matches) {\n                    treelist.addClass(\"k-hidden\");\n                    splitbar.addClass(\"k-hidden\");\n\n                    treelist.width(\"100%\");\n                } else {\n                    treelist.removeClass(\"k-hidden\");\n                    splitbar.removeClass(\"k-hidden\");\n                    timeline.removeClass(\"k-hidden\");\n\n                    treelist.width(treelist.outerWidth());\n\n                    that.refresh();\n\n                    timeline\n                        .find(contentSelector)\n                        .scrollTop(that.scrollTop);\n                }\n\n                that._resize();\n            };\n\n            if (!isFunction(actions)) {\n                actions = (typeof actions === STRING ? actions : this._actions(actions));\n                actions = proxy(kendo.template(actions), this);\n            }\n\n            toggleButton = $(TOGGLE_BUTTON_TEMPLATE({ styles: ganttStyles.toolbar }));\n\n            views = $(HEADER_VIEWS_TEMPLATE({\n                ns: kendo.ns,\n                views: this.timeline.views,\n                styles: ganttStyles.toolbar\n            }));\n\n            toolbar = $(\"<div role='toolbar' class='\" + ganttStyles.toolbar.headerWrapper + \"'>\")\n                .append(toggleButton)\n                .append(actions({}))\n                .append(\"<span class='k-spacer k-toolbar-spacer' />\")\n                .append(views);\n\n            if (views.find(\"button\").length > 1) {\n                views.prepend(VIEWS_DROPDOWN_TEMPLATE({\n                    ns: kendo.ns,\n                    views: this.timeline.views,\n                    styles: ganttStyles.toolbar,\n                    label: this.options.messages.selectView\n                }));\n            }\n\n            if(this.toggeSwitchWrap) {\n                this.toggeSwitchWrap.insertBefore(views);\n            }\n\n            this.wrapper.prepend(toolbar);\n            this.toolbar = toolbar;\n\n            if (supportsMedia) {\n                this._mediaQueryHandler = proxy(mediaQueryHandler, this);\n                this._mediaQuery = window.matchMedia(\"(max-width: 480px)\");\n                this._mediaQuery.addListener(this._mediaQueryHandler);\n            }\n\n            toolbar\n                .on(\"change\" + NS, viewsDropdownSelector, function() {\n                    var list = that.list;\n                    var name = $(this).val();\n\n                    if (list.editable && list.editable.trigger(\"validate\")) {\n                        return;\n                    }\n\n                    if (!that.trigger(\"navigate\", { view: name })) {\n                        that.view(name);\n                    }\n\n                    that.toolbar.find(DOT + ganttStyles.focused).removeClass(ganttStyles.focused);\n                })\n                .on(CLICK + NS, viewsSelector, function(e) {\n                    e.preventDefault();\n\n                    var list = that.list;\n                    var name = $(this).attr(kendo.attr(\"name\"));\n\n                    if (list.editor && !list.editor.end()) {\n                        return;\n                    }\n\n                    if (!that.trigger(\"navigate\", { view: name })) {\n                        that.view(name);\n                    }\n\n                    that.toolbar.find(DOT + ganttStyles.focused).removeClass(ganttStyles.focused);\n                })\n                .on(\"keydown\" + NS, viewsSelector, function(e) {\n                    var views = $(DOT + ganttStyles.toolbar.views).children(\":not(.k-current-view)\");\n                    var focusedViewIndex = views.index((that._focusedView && that._focusedView[0]) || views.closest(DOT + ganttStyles.selected)[0]);\n\n                    if (e.keyCode === keys.RIGHT) {\n                        $(that.toolbar.find(DOT + ganttStyles.focused)).removeClass(ganttStyles.focused);\n                        that._focusedView = focusedViewIndex + 1 === views.length ? $(views[0]) : $(views[focusedViewIndex + 1]);\n                        that._focusedView.trigger(\"focus\").addClass(ganttStyles.focused);\n                        e.preventDefault();\n                    } else if (e.keyCode === keys.LEFT) {\n                        $(that.toolbar.find(DOT + ganttStyles.focused)).removeClass(ganttStyles.focused);\n                        that._focusedView = focusedViewIndex === 0 ? $(views[views.length - 1]) : $(views[focusedViewIndex - 1]);\n                        that._focusedView.trigger(\"focus\").addClass(ganttStyles.focused);\n                        e.preventDefault();\n                    } else if ((e.keyCode === keys.ENTER || e.keyCode === keys.SPACEBAR) && that._focusedView) {\n                        that.view(that._focusedView.text().toLowerCase());\n                        e.preventDefault();\n                    } else if (e.keyCode >= 49 && e.keyCode <= 57) {\n                        that.view(that.timeline._viewByIndex(e.keyCode - 49));\n                    }\n                })\n                .on(CLICK + NS, pdfSelector, function(e) {\n                    e.preventDefault();\n\n                    that.saveAsPDF();\n                })\n                .on(CLICK + NS, toggleSelector, function(e) {\n                    e.preventDefault();\n\n                    if (treelist.is(\":visible\")) {\n                        treelist.addClass(\"k-hidden\");\n                        timeline.removeClass(\"k-hidden\");\n\n                        that.refresh();\n\n                        timeline\n                            .find(contentSelector)\n                            .scrollTop(that.scrollTop);\n                    } else {\n                        treelist.removeClass(\"k-hidden\");\n                        timeline.addClass(\"k-hidden\");\n\n                        treelist\n                            .find(contentSelector)\n                            .scrollTop(that.scrollTop);\n                    }\n\n                    that._resize();\n                });\n\n            this.wrapper\n                .on(\"focusout\" + NS, function(e) {\n                    if (!$(e.relatedTarget).closest(DOT + ganttStyles.toolbar.toolbar).length) {\n                        that.toolbar.find(DOT + ganttStyles.focused).removeClass(ganttStyles.focused);\n                    }\n                    if (!$(e.relatedTarget).closest(DOT + ganttStyles.toolbar.views).length) {\n                        that.toolbar.find(DOT + ganttStyles.toolbar.views).removeClass(ganttStyles.toolbar.expanded);\n                    }\n                });\n\n        },\n\n        _actions: function() {\n            var options = this.options;\n            var editable = options.editable;\n            var actions = options.toolbar;\n            var html = \"\";\n            var action;\n\n            if (!isArray(actions)) {\n                if (editable && editable.create !== false) {\n                    actions = [\"append\"];\n                } else {\n                    return html;\n                }\n            }\n\n            for (var i = 0, length = actions.length; i < length; i++) {\n                action = actions[i];\n\n                if(action === \"plannedTasks\" || action.name === \"plannedTasks\") {\n                    this._createPlannedTasksSwitch();\n                    continue;\n                }\n\n                html += this._createButton(action);\n            }\n\n            return html;\n        },\n\n        _footer: function() {\n            var editable = this.options.editable;\n\n            if (!editable || editable.create === false) {\n                return;\n            }\n\n            var ganttStyles = Gantt.styles.toolbar;\n            var messages = this.options.messages.actions;\n            var button = $(kendo.template(BUTTON_TEMPLATE)(extend(true, { styles: ganttStyles }, defaultCommands.append, { text: messages.append })));\n            var footer = $(\"<div class='\" + ganttStyles.footerWrapper + \"'>\").append(button);\n\n            this.wrapper.append(footer);\n            this.footer = footer;\n        },\n\n        _createButton: function(command) {\n            var template = command.template || BUTTON_TEMPLATE;\n            var messages = this.options.messages.actions;\n            var commandName = typeof command === STRING ? command : command.name || command.text;\n            var className = defaultCommands[commandName] ? defaultCommands[commandName].className : \"k-gantt-\" + (commandName || \"\").replace(/\\s/g, \"\");\n            var options = {\n                iconClass: \"\",\n                action: \"\",\n                text: commandName,\n                className: className,\n                styles: Gantt.styles.toolbar\n            };\n\n            if(!options.className) {\n                options.className = \"k-button-solid-base\";\n            } else if (options.className.indexOf(\"k-button-solid-primary\") === -1) {\n                options.className += \" k-button-solid-base\";\n            }\n\n            if (!commandName && !(isPlainObject(command) && command.template))  {\n                throw new Error(\"Custom commands should have name specified\");\n            }\n\n            options = extend(true, options, defaultCommands[commandName], { text: messages[commandName] });\n\n            if (isPlainObject(command)) {\n                if (command.className && inArray(options.className, command.className.split(\" \")) < 0) {\n                    command.className += \" \" + options.className;\n                }\n\n                options = extend(true, options, command);\n            }\n\n            return kendo.template(template)(options);\n        },\n\n        _adjustDimensions: function() {\n            var element = this.element;\n            var toolbarHeight = outerHeight(this.toolbar);\n            var footerHeight = this.footer ? outerHeight(this.footer) : 0;\n            var totalHeight = element.height();\n            var totalWidth = element.width();\n            var splitBarWidth = this.splitbar.is(\":visible\") ? outerWidth(this.splitbar) : 0;\n            var treeListWidth = this.treelistWrapper.is(\":visible\") ? outerWidth(this.treelistWrapper) : 0;\n            var timelineWidth = totalWidth - ( treeListWidth + splitBarWidth );\n\n            this.layout.children().height(totalHeight - (toolbarHeight + footerHeight));\n            this.timelineWrapper.width(timelineWidth);\n\n            if (totalWidth < (treeListWidth + splitBarWidth)) {\n                this.treelistWrapper.width(totalWidth - splitBarWidth);\n            }\n        },\n\n        _scrollTo: function(value) {\n            var view = this.timeline.view();\n            var list = this.list;\n            var attr = kendo.attr(\"uid\");\n            var id = typeof value === \"string\" ? value :\n                value.closest(\"tr\" + selector()).attr(attr);\n            var action;\n            var scrollTarget;\n            var scrollIntoView = function() {\n                if (scrollTarget.length !== 0) {\n                    action();\n                }\n            };\n\n            if (view.content.is(\":visible\")) {\n                scrollTarget = view.content.find(selector(id));\n                action = function() {\n                    view._scrollTo(scrollTarget);\n                };\n            } else {\n                scrollTarget = list.element.find(selector(id));\n                action = function() {\n                    scrollTarget.get(0).scrollIntoView();\n                };\n            }\n\n            scrollIntoView();\n        },\n\n        _dropDowns: function() {\n            var that = this;\n            var actionsSelector = DOT + Gantt.styles.toolbar.appendButton;\n            var actionMessages = this.options.messages.actions;\n            var timeline = this.timeline;\n            var editable = this.options.editable;\n\n            var handler = function(e) {\n                var type = e.type;\n                var orderId;\n                var dataSource = that.dataSource;\n                var task = dataSource._createNewModel({});\n                var selected = that.dataItem(that.select());\n                var parent = dataSource.taskParent(selected);\n                var firstSlot = timeline.view()._timeSlots()[0];\n                var target = type === \"add\" ? selected : parent;\n                var editable = that.list.editor;\n\n                if (editable && editable.trigger(\"validate\")) {\n                    return;\n                }\n\n                task.set(\"title\", \"New task\");\n\n                if (target) {\n                    task.set(\"parentId\", target.get(\"id\"));\n                    task.set(\"start\", target.get(\"start\"));\n                    task.set(\"end\", target.get(\"end\"));\n                    task.set(\"plannedStart\", target.get(\"plannedStart\"));\n                    task.set(\"plannedEnd\", target.get(\"plannedEnd\"));\n                } else {\n                    task.set(\"start\", firstSlot.start);\n                    task.set(\"end\", firstSlot.end);\n                }\n\n                if (type !== \"add\") {\n                    orderId = selected.get(\"orderId\");\n                    orderId = type === \"insert-before\" ? orderId : orderId + 1;\n                }\n\n                that._createTask(task, orderId);\n            };\n\n            if (!editable || editable.create === false) {\n                return;\n            }\n\n            this.footerDropDown = new kendo.gantt.TaskDropDown(this.footer.children(actionsSelector).eq(0), {\n                messages: {\n                    actions: actionMessages\n                },\n                direction: \"up\",\n                animation: {\n                    open: {\n                        effects: \"slideIn:up\"\n                    }\n                }\n            });\n\n            this.headerDropDown = new kendo.gantt.TaskDropDown(this.toolbar.children(actionsSelector).eq(0), {\n                messages: {\n                    actions: actionMessages\n                }\n            });\n\n            this.footerDropDown.bind(\"command\", handler);\n            this.headerDropDown.bind(\"command\", handler);\n        },\n\n        _getListEditable: function() {\n            var editable = false,\n                options = this.options;\n\n            if(options.editable !== false) {\n                editable = \"incell\";\n\n                if(options.editable && options.editable.update === false) {\n                    editable = false;\n                } else {\n                    if(!options.editable || options.editable.reorder !== false) {\n                        editable = {\n                            mode: \"incell\",\n                            move: {\n                                reorderable: true\n                            }\n                        };\n                    }\n                }\n            }\n\n            return editable;\n        },\n\n        _getListOptions: function() {\n            var options = this.options,\n                editable = this._getListEditable(),\n                listWrapper = this.wrapper.find(DOT + ganttStyles.list),\n                ganttListOptions = {\n                    columns: options.columns || [],\n                    dataSource: this.dataSource,\n                    selectable: options.selectable,\n                    reorderable: options.reorderable,\n                    editable: editable,\n                    resizable: options.resizable,\n                    filterable: options.filterable,\n                    columnMenu: options.columnMenu,\n                    columnResizeHandleWidth: this.options.columnResizeHandleWidth,\n                    listWidth: outerWidth(listWrapper),\n                    resourcesField: this.resources.field,\n                    rowHeight: this.options.rowHeight\n                };\n\n            return ganttListOptions;\n        },\n\n        _attachResourceEditor: function(columns) {\n            var column;\n\n            for (var i = 0; i < columns.length; i++) {\n                column = columns[i];\n\n                if (column.field === this.resources.field && typeof column.editor !== \"function\") {\n                    column.editor = proxy(this._createResourceEditor, this);\n                }\n            }\n        },\n\n        _attachListEvents: function() {\n            var that = this,\n                navigatable = that.options.navigatable,\n                toggleButtons = this.wrapper.find(DOT + ganttStyles.toolbar.toolbar + \" \" + DOT + ganttStyles.toolbar.appendButton),\n                restoreFocus = function() {\n                    var element;\n\n                    if (navigatable && that._cachedCurrent) {\n                        element = that.list.content.find(\"tr\").eq(that._cachedCurrent.rowIndex).find(\"td\").eq(that._cachedCurrent.columnIndex);\n\n                        that._current(element);\n\n                        focusTable(that.list.content.find(\"table\"), true);\n                    }\n\n                    delete that._cachedCurrent;\n                };\n\n            that.list\n                .bind(\"columnShow\", function(e) {\n                    that.trigger(\"columnShow\", { column: e.column });\n                })\n                .bind(\"columnHide\", function(e) {\n                    that.trigger(\"columnHide\", { column: e.column });\n                })\n                .bind(\"columnReorder\", function(e) {\n                    that.trigger(\"columnReorder\", { column: e.column, oldIndex: e.oldIndex, newIndex: e.newIndex });\n                })\n                .bind(\"columnResize\", function(e) {\n                    that.trigger(\"columnResize\", { column: e.column, oldWidth: e.oldWidth, newWidth: e.newWidth });\n                })\n                .bind(\"render\", function() {\n                    that._navigatable();\n                 }, true)\n                .bind(\"beforeEdit\", function(e) {\n                    that._cachedCurrent = {\n                        rowIndex: e.container.closest(\"tr\").index(),\n                        columnIndex: e.container.index()\n                    };\n\n                    if (that.trigger(\"edit\", { task: e.model, container: e.container })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"cancel\", function(e) {\n                    if (that.trigger(\"cancel\", { task: e.model, container: e.cell })) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    that._preventItemChange = true;\n                    that.list.closeCell(true);\n                    restoreFocus();\n                })\n                .bind(\"save\", function(e) {\n                    var updatedValues = e.values;\n                    that._preventRefresh = true;\n\n                    if(that.updateDuration === null || that.updateDuration === undefined) {\n                        that.updateDuration = e.model.duration();\n                    }\n\n                    if(that.updatePlannedDuration === null || that.updatePlannedDuration === undefined) {\n                        that.updatePlannedDuration = e.model.plannedDuration();\n                    }\n\n                    if (updatedValues.hasOwnProperty(\"start\")) {\n                        that.previousStart = e.model.get(\"start\");\n                        updatedValues.end = new Date(updatedValues.start.getTime() + that.updateDuration);\n                    }\n\n                    if (updatedValues.hasOwnProperty(\"plannedStart\") && updatedValues.plannedStart) {\n                        that.previousPlannedStart = e.model.get(\"plannedStart\");\n                        updatedValues.plannedEnd = new Date(updatedValues.plannedStart.getTime() + that.updatePlannedDuration);\n                    }\n\n                    if (updatedValues.hasOwnProperty(\"percentComplete\")) {\n                        that.previousPercentComplete = e.model.get(\"percentComplete\");\n                    }\n\n                    that.updatedValues = updatedValues;\n                })\n                .bind(\"itemChange\", function(e) {\n                    var updateInfo = that.updatedValues;\n                    var task = e.data;\n                    var resourcesField = that.resources.field;\n\n                    if (that._preventItemChange) {\n                        that._preventItemChange = false;\n                        return;\n                    }\n\n                    if (that.previousStart) {\n                        task.set(\"start\", that.previousStart);\n                        that.previousStart = null;\n                    }\n\n                    if (that.previousPlannedStart) {\n                        task.set(\"plannedStart\", that.previousPlannedStart);\n                        that.previousPlannedStart = null;\n                    }\n\n                    if (that.previousPercentComplete !== null && that.previousPercentComplete !== undefined) {\n                        task.set(\"percentComplete\", that.previousPercentComplete);\n                        that.previousPercentComplete = null;\n                    }\n\n                    if (!that.trigger(\"save\", { task: task, values: updateInfo })) {\n                        if(updateInfo) {\n                            that._preventRefresh = true;\n                            that.dataSource.update(task, updateInfo);\n\n                            if (updateInfo[resourcesField]) {\n                                that._updateAssignments(task.get(\"id\"), updateInfo[resourcesField]);\n                            }\n                        }\n\n                        that._preventRefresh = false;\n                        that._requestStart();\n                        that.dataSource.sync().then(function() {\n                            restoreFocus();\n                        });\n                    } else if(that.dataSource.hasChanges()) {\n                        that.dataSource.cancelChanges();\n                        that._preventRefresh = false;\n                        that.refresh();\n                    }\n\n                    that.updatedValues = null;\n                    that.updateDuration = null;\n                })\n                .bind(\"change\", function() {\n                    that.trigger(\"change\");\n\n                    var selection = that.list.select();\n\n                    if (selection.length) {\n                        toggleButtons.removeAttr(\"data-action\", \"add\");\n                        that.timeline.select(\"[data-uid='\" + selection.attr(\"data-uid\") + \"']\");\n                    } else {\n                        toggleButtons.attr(\"data-action\", \"add\");\n                        that.timeline.clearSelection();\n                    }\n                })\n                .bind(\"collapse\", function(e) {\n                    e.preventDefault();\n\n                    var row = that.list.element.find(\"tr[data-uid='\" + e.model.uid + \"']\");\n                    e.model.set(\"expanded\", false);\n\n                    that._cachedCurrent = {\n                        rowIndex: row.index(),\n                        columnIndex: row.find(\".k-state-focused\").index()\n                    };\n\n                    restoreFocus();\n                })\n                .bind(\"expand\", function(e) {\n                    e.preventDefault();\n\n                    var row = that.list.element.find(\"tr[data-uid='\" + e.model.uid + \"']\");\n                    e.model.set(\"expanded\", true);\n\n                    that._cachedCurrent = {\n                        rowIndex: row.index(),\n                        columnIndex: row.find(\".k-state-focused\").index()\n                    };\n\n                    restoreFocus();\n                })\n                .bind(\"dragend\", function(e) {\n                    var dataSource = that.dataSource,\n                        task, updateInfo;\n\n                    if(e.position === \"over\") {\n                        dataSource.cancelChanges();\n\n                        updateInfo = {\n                            parentId: e.source.parentId\n                        };\n\n                        task = dataSource.get(e.source.id);\n\n                        if (!that.trigger(\"save\", { task: task, values: updateInfo })) {\n                            dataSource.update(task, updateInfo);\n                        }\n\n                        dataSource.sync();\n                    }\n                })\n                .bind(\"dataBound\", function() {\n                    if(that.dataSource.sort().length === 0) {\n                        that.dataSource.sort([{field: \"orderId\", dir: \"asc\"}]);\n                    }\n                })\n                .bind(\"reorder\", function(e) {\n                    that._updateTask(e.task, e.updateInfo);\n                    restoreFocus();\n                });\n        },\n\n        _list: function() {\n            var ganttStyles = Gantt.styles,\n                listWrapper = this.wrapper.find(DOT + ganttStyles.list),\n                listElement = listWrapper.find(\"> div\"),\n                listOptions = this._getListOptions();\n\n            this._attachResourceEditor(listOptions.columns);\n\n            this.list = new kendo.ui.GanttList(listElement, listOptions);\n\n            this._attachListEvents();\n        },\n\n        _timeline: function() {\n            var that = this;\n            var ganttStyles = Gantt.styles;\n            var options = trimOptions(extend(true, { resourcesField: this.resources.field }, this.options));\n            var element = this.wrapper.find(DOT + ganttStyles.timeline + \" > div\");\n\n            this.timeline = new kendo.ui.GanttTimeline(element, options);\n\n            this.timeline\n                .bind(\"navigate\", function(e) {\n                    var viewName = e.view.replace(/\\./g, \"\\\\.\").toLowerCase();\n\n                    that.toolbar\n                        .find(DOT + ganttStyles.toolbar.views + \" > button\")\n                        .removeClass(ganttStyles.selected)\n                        .end()\n                        .find(DOT + ganttStyles.toolbar.viewButton + \"-\" + viewName)\n                        .addClass(ganttStyles.selected);\n\n                    that.toolbar\n                        .find(DOT + ganttStyles.toolbar.viewsDropdown)\n                        .val(e.view);\n\n                    that.refresh();\n                })\n                .bind(\"moveStart\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (that.trigger(\"moveStart\", { task: e.task })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"move\", function(e) {\n                    var task = e.task;\n                    var start = e.start;\n                    var end = new Date(start.getTime() + task.duration());\n\n                    if (that.trigger(\"move\", { task: task, start: start, end: end })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"moveEnd\", function(e) {\n                    var task = e.task;\n                    var start = e.start;\n                    var end = new Date(start.getTime() + task.duration());\n\n                    if (!that.trigger(\"moveEnd\", { task: task, start: start, end: end })) {\n                        that._updateTask(that.dataSource.getByUid(task.uid), {\n                            start: start,\n                            end: end\n                        });\n                    }\n                })\n                .bind(\"resizeStart\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (that.trigger(\"resizeStart\", { task: e.task })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"resize\", function(e) {\n                    if (that.trigger(\"resize\", { task: e.task, start: e.start, end: e.end })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"resizeEnd\", function(e) {\n                    var task = e.task;\n                    var updateInfo = {};\n\n                    if (e.resizeStart) {\n                        updateInfo.start = e.start;\n                    } else {\n                        updateInfo.end = e.end;\n                    }\n\n                    if (!that.trigger(\"resizeEnd\", { task: task, start: e.start, end: e.end })) {\n                        that._updateTask(that.dataSource.getByUid(task.uid), updateInfo);\n                    }\n                })\n                .bind(\"percentResizeStart\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"percentResizeEnd\", function(e) {\n                    that._updateTask(that.dataSource.getByUid(e.task.uid), { percentComplete: e.percentComplete });\n                })\n                .bind(\"dependencyDragStart\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"dependencyDragEnd\", function(e) {\n                    var dependency = that.dependencies._createNewModel({\n                        type: e.type,\n                        predecessorId: e.predecessor.id,\n                        successorId: e.successor.id\n                    });\n\n                    that._createDependency(dependency);\n                })\n                .bind(\"select\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable) {\n                        editable.end();\n                    }\n\n                    that.select(\"[data-uid='\" + e.uid + \"']\");\n                })\n                .bind(\"editTask\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        return;\n                    }\n\n                    that.editTask(e.uid);\n                })\n                .bind(\"clear\", function() {\n                    that.clearSelection();\n                })\n                .bind(\"removeTask\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        return;\n                    }\n\n                    that.removeTask(that.dataSource.getByUid(e.uid));\n                })\n                .bind(\"removeDependency\", function(e) {\n                    var editable = that.list.editor;\n\n                    if (editable && !editable.end()) {\n                        return;\n                    }\n\n                    that.removeDependency(that.dependencies.getByUid(e.uid));\n                });\n        },\n\n        _dataSource: function() {\n            var options = this.options;\n            var dataSource = options.dataSource;\n\n            dataSource = isArray(dataSource) ? { data: dataSource } : dataSource;\n\n            if (this.dataSource && this._refreshHandler) {\n                this.dataSource\n                    .unbind(\"change\", this._refreshHandler)\n                    .unbind(\"progress\", this._progressHandler)\n                    .unbind(\"error\", this._errorHandler);\n            } else {\n                this._refreshHandler = proxy(this.refresh, this);\n                this._progressHandler = proxy(this._requestStart, this);\n                this._errorHandler = proxy(this._error, this);\n            }\n\n            this.dataSource = kendo.data.GanttDataSource.create(dataSource)\n                .bind(\"change\", this._refreshHandler)\n                .bind(\"progress\", this._progressHandler)\n                .bind(\"error\", this._errorHandler);\n        },\n\n        _dependencies: function() {\n            var dependencies = this.options.dependencies || {};\n            var dataSource = isArray(dependencies) ? { data: dependencies } : dependencies;\n\n            if (this.dependencies && this._dependencyRefreshHandler) {\n                this.dependencies\n                    .unbind(\"change\", this._dependencyRefreshHandler)\n                    .unbind(\"error\", this._dependencyErrorHandler);\n            } else {\n                this._dependencyRefreshHandler = proxy(this.refreshDependencies, this);\n                this._dependencyErrorHandler = proxy(this._error, this);\n            }\n\n            this.dependencies = kendo.data.GanttDependencyDataSource.create(dataSource)\n                .bind(\"change\", this._dependencyRefreshHandler)\n                .bind(\"error\", this._dependencyErrorHandler);\n        },\n\n        _resources: function() {\n            var resources = this.options.resources;\n            var dataSource = resources.dataSource || {};\n\n            this.resources = {\n                field: \"resources\",\n                dataTextField: \"name\",\n                dataColorField: \"color\",\n                dataFormatField: \"format\"\n            };\n\n            extend(this.resources, resources);\n\n            this.resources.dataSource = kendo.data.DataSource.create(dataSource);\n        },\n\n        _assignments: function() {\n            var assignments = this.options.assignments;\n            var dataSource = assignments.dataSource || { };\n\n            if (this.assignments) {\n                this.assignments.dataSource\n                    .unbind(\"change\", this._assignmentsRefreshHandler);\n            } else {\n                this._assignmentsRefreshHandler = proxy(this.refresh, this);\n            }\n\n            this.assignments = {\n                dataTaskIdField: \"taskId\",\n                dataResourceIdField: \"resourceId\",\n                dataValueField: \"value\"\n            };\n\n            extend(this.assignments, assignments);\n\n            this.assignments.dataSource = kendo.data.DataSource.create(dataSource);\n\n            this.assignments.dataSource.\n                bind(\"change\", this._assignmentsRefreshHandler);\n        },\n\n        _createEditor: function() {\n            var that = this;\n\n            var editor = this._editor = new kendo.gantt.PopupEditor(this.wrapper, extend({}, this.options, {\n                target: this,\n                resources: {\n                    field: this.resources.field,\n                    editor: proxy(this._createResourceEditor, this)\n                },\n                createButton: proxy(this._createPopupButton, this)\n            }));\n\n            editor\n                .bind(\"cancel\", function(e) {\n                    var task = that.dataSource.getByUid(e.model.uid);\n\n                    if (that.trigger(\"cancel\", { container: e.container, task: task })) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    that.cancelTask();\n                })\n                .bind(\"edit\", function(e) {\n                    var task = that.dataSource.getByUid(e.model.uid);\n\n                    if (that.trigger(\"edit\", { container: e.container, task: task })) {\n                        e.preventDefault();\n                    }\n                })\n                .bind(\"save\", function(e) {\n                    var task = that.dataSource.getByUid(e.model.uid);\n\n                    that.saveTask(task, e.updateInfo);\n                })\n                .bind(\"remove\", function(e) {\n                    that.removeTask(e.model.uid);\n                })\n                .bind(\"close\", that._onDialogClose);\n        },\n\n        _onDialogClose: function() {},\n\n        _createResourceEditor: function(container, options) {\n            var that = this;\n            var model = options instanceof ObservableObject ? options : options.model;\n            var id = model.get(\"id\");\n            var messages = this.options.messages;\n            var resourcesField = this.resources.field;\n            var unitsValidation = { step: 0.01 };\n            var assignmentsModel = this.assignments.dataSource.options.schema.model;\n\n            if (assignmentsModel && assignmentsModel.fields.Units && assignmentsModel.fields.Units.validation) {\n                extend(true, unitsValidation, assignmentsModel.fields.Units.validation);\n            }\n\n            var editor = this._resourceEditor = new kendo.gantt.ResourceEditor(container, {\n                resourcesField: resourcesField,\n                unitsValidation: unitsValidation,\n                data: this._wrapResourceData(id),\n                model: model,\n                messages: extend({}, messages.editor),\n                buttons: [\n                    { name: \"update\", text: messages.save, className: Gantt.styles.primary },\n                    { name: \"cancel\", text: messages.cancel }\n                ],\n                createButton: proxy(this._createPopupButton, this),\n                save: function(e) {\n                    that._updateAssignments(e.model.get(\"id\"), e.model.get(resourcesField));\n                }\n            });\n\n            editor.open();\n        },\n\n        _createPopupButton: function(command) {\n            var commandName = command.name || command.text;\n            var options = {\n                className: Gantt.styles.popup.button + \" \" + Gantt.styles.buttonDefaults + \" k-gantt-\" + (commandName || \"\").replace(/\\s/g, \"\"),\n                text: commandName,\n                attr: \"\"\n            };\n\n            if (!commandName && !(isPlainObject(command) && command.template))  {\n                throw new Error(\"Custom commands should have name specified\");\n            }\n\n            if (isPlainObject(command)) {\n                if (command.className) {\n                    command.className += \" \" + options.className;\n                }\n\n                options = extend(true, options, command);\n            }\n\n            if(!options.className) {\n                options.className = \"k-button-solid-base\";\n            } else if (options.className.indexOf(\"k-button-solid-primary\") === -1) {\n                options.className += \" k-button-solid-base\";\n            }\n\n            return kendo.template(COMMAND_BUTTON_TEMPLATE)(options);\n        },\n\n        view: function(type) {\n            return this.timeline.view(type);\n        },\n\n        range: function (range) {\n            var dataSource = this.dataSource;\n            var view = this.view();\n            var timeline = this.timeline;\n\n            if (range) {\n                view.options.range = {\n                    start: range.start,\n                    end: range.end\n                };\n\n                timeline._render(dataSource.taskTree());\n                timeline._renderDependencies(this.dependencies.view());\n            }\n\n            return {\n                start: view.start,\n                end: view.end\n            };\n        },\n\n        date: function (date) {\n            var view = this.view();\n\n            if (date) {\n                view.options.date = date;\n                view._scrollToDate(date);\n            }\n\n            return view.options.date;\n        },\n\n        dataItem: function(value) {\n            if (!value) {\n                return null;\n            }\n\n            var list = this.list;\n            var element = list.element.find(value);\n\n            return list._modelFromElement(element);\n        },\n\n        setDataSource: function(dataSource) {\n            this.options.dataSource = dataSource;\n\n            this._dataSource();\n\n            this.list.setDataSource(this.dataSource);\n\n            if (this.options.autoBind) {\n                dataSource.fetch();\n            }\n        },\n\n        setDependenciesDataSource: function(dependencies) {\n            this.options.dependencies = dependencies;\n\n            this._dependencies();\n\n            if (this.options.autoBind) {\n                dependencies.fetch();\n            }\n        },\n\n        items: function() {\n            return this.wrapper.children(\".k-task\");\n        },\n\n        _updateAssignments: function(id, resources) {\n            var dataSource = this.assignments.dataSource;\n            var taskId = this.assignments.dataTaskIdField;\n            var resourceId = this.assignments.dataResourceIdField;\n            var hasMatch = false;\n            var assignments = new Query(dataSource.view())\n                .filter({\n                    field: taskId,\n                    operator: \"eq\",\n                    value: id\n                }).toArray();\n            var assignment;\n            var resource;\n            var value;\n\n            while (assignments.length) {\n                assignment = assignments[0];\n\n                for (var i = 0, length = resources.length; i < length; i++) {\n                    resource = resources[i];\n\n                    if (assignment.get(resourceId) === resource.get(\"id\")) {\n                        value = resources[i].get(\"value\");\n                        this._updateAssignment(assignment, value);\n                        resources.splice(i, 1);\n                        hasMatch = true;\n                        break;\n                    }\n                }\n\n                if (!hasMatch) {\n                    this._removeAssignment(assignment);\n                }\n\n                hasMatch = false;\n\n                assignments.shift();\n            }\n\n            for (var j = 0, newLength = resources.length; j < newLength; j++) {\n                resource = resources[j];\n                this._createAssignment(resource, id);\n            }\n\n            dataSource.sync();\n        },\n\n        cancelTask: function() {\n            var editor = this._editor;\n            var container = editor.container;\n\n            if (container) {\n                editor.close();\n            }\n        },\n\n        editTask: function(uid) {\n            var task = typeof uid === \"string\" ? this.dataSource.getByUid(uid) : uid;\n\n            if (!task) {\n                return;\n            }\n\n            var taskCopy = this.dataSource._createNewModel(task.toJSON());\n            taskCopy.uid = task.uid;\n\n            this.cancelTask();\n\n            this._editTask(taskCopy);\n        },\n\n        _editTask: function(task) {\n            this._editor.editTask(task, this.options.editable.plannedTasks);\n        },\n\n        saveTask: function(task, updateInfo) {\n            var editor = this._editor;\n            var container = editor.container;\n            var editable = editor.editable;\n\n            if (container && editable && editable.end()) {\n                this._updateTask(task, updateInfo);\n            }\n        },\n\n        _updateTask: function(task, updateInfo) {\n            var that = this;\n            var resourcesField = that.resources.field;\n\n            if (!that.trigger(\"save\", { task: task, values: updateInfo })) {\n                if(updateInfo) {\n                    that._preventRefresh = true;\n\n                    that.dataSource.update(task, updateInfo);\n\n                    if (updateInfo[resourcesField]) {\n                        that._updateAssignments(task.get(\"id\"), updateInfo[resourcesField]);\n                    }\n                }\n\n                that._syncDataSource();\n            } else if(that.dataSource.hasChanges()) {\n                that.dataSource.cancelChanges();\n                that._preventRefresh = false;\n                that.refresh();\n            }\n        },\n\n        _updateAssignment: function(assignment, value) {\n            var resourceValueField = this.assignments.dataValueField;\n\n            assignment.set(resourceValueField, value);\n        },\n\n        removeTask: function(uid) {\n            var that = this;\n            var task = typeof uid === \"string\" ? this.dataSource.getByUid(uid) : uid;\n\n            if (!task) {\n                return;\n            }\n\n            this._taskConfirm(function(cancel) {\n                if (!cancel) {\n                    that._removeTask(task);\n                }\n            }, task);\n        },\n\n        _createTask: function(task, index) {\n            if (!this.trigger(\"add\", {\n                task: task,\n                dependency: null\n            })) {\n                var dataSource = this.dataSource;\n\n                this._preventRefresh = true;\n\n                if (index === undefined) {\n                    dataSource.add(task);\n                } else {\n                    dataSource.insert(index, task);\n                }\n\n                this._scrollToUid = task.uid;\n                this._syncDataSource();\n            }\n        },\n\n        _createDependency: function(dependency) {\n            if (!this.trigger(\"add\", {\n                task: null,\n                dependency: dependency\n            })) {\n                this._preventDependencyRefresh = true;\n\n                this.dependencies.add(dependency);\n\n                this._preventDependencyRefresh = false;\n\n                this.dependencies.sync();\n            }\n        },\n\n        _createAssignment: function(resource, id) {\n            var assignments = this.assignments;\n            var dataSource = assignments.dataSource;\n            var taskId = assignments.dataTaskIdField;\n            var resourceId = assignments.dataResourceIdField;\n            var resourceValue = assignments.dataValueField;\n            var assignment = dataSource._createNewModel();\n\n            assignment[taskId] = id;\n            assignment[resourceId] = resource.get(\"id\");\n            assignment[resourceValue] = resource.get(\"value\");\n\n            dataSource.add(assignment);\n        },\n\n        removeDependency: function(uid) {\n            var that = this;\n            var dependency = typeof uid === \"string\" ? this.dependencies.getByUid(uid) : uid;\n\n            if (!dependency) {\n                return;\n            }\n\n            this._dependencyConfirm(function(cancel) {\n                if (!cancel) {\n                    that._removeDependency(dependency);\n                }\n            }, dependency);\n        },\n\n        _removeTaskDependencies: function(task, dependencies) {\n            this._preventDependencyRefresh = true;\n\n            for (var i = 0, length = dependencies.length; i < length; i++) {\n                this.dependencies.remove(dependencies[i]);\n            }\n\n            this._preventDependencyRefresh = false;\n\n            this.dependencies.sync();\n        },\n\n        _removeTaskAssignments: function(task) {\n            var dataSource = this.assignments.dataSource;\n            var assignments = dataSource.view();\n            var filter = {\n                field: this.assignments.dataTaskIdField,\n                operator: \"eq\",\n                value: task.get(\"id\")\n            };\n\n            assignments = new Query(assignments).filter(filter).toArray();\n\n            this._preventRefresh = true;\n\n            for (var i = 0, length = assignments.length; i < length; i++) {\n                dataSource.remove(assignments[i]);\n            }\n\n            this._preventRefresh = false;\n\n            dataSource.sync();\n        },\n\n        _removeTask: function(task) {\n            var dependencies = this.dependencies.dependencies(task.id);\n\n            if (!this.trigger(\"remove\", {\n                task: task,\n                dependencies: dependencies\n            })) {\n                this._removeTaskDependencies(task, dependencies);\n                this._removeTaskAssignments(task);\n\n                this._preventRefresh = true;\n\n                if (this.dataSource.remove(task)) {\n                    this._syncDataSource();\n                }\n\n                this._preventRefresh = false;\n            }\n        },\n\n        _removeDependency: function(dependency) {\n            if (!this.trigger(\"remove\", {\n                task: null,\n                dependencies: [dependency]\n            })) {\n                if (this.dependencies.remove(dependency)) {\n                    this.dependencies.sync();\n                }\n            }\n        },\n\n        _removeAssignment: function(assignment) {\n            this.assignments.dataSource.remove(assignment);\n        },\n\n        _taskConfirm: function(callback, task) {\n            var messages = this.options.messages;\n\n            this._confirm(callback, {\n                model: task,\n                text: messages.deleteTaskConfirmation,\n                title: messages.deleteTaskWindowTitle\n            });\n        },\n\n        _dependencyConfirm: function(callback, dependency) {\n            var messages = this.options.messages;\n\n            this._confirm(callback, {\n                model: dependency,\n                text: messages.deleteDependencyConfirmation,\n                title: messages.deleteDependencyWindowTitle\n            });\n        },\n\n        _confirm: function(callback, options) {\n            var editable = this.options.editable;\n            var messages;\n            var buttons;\n\n            if (editable === true || editable.confirmation !== false) {\n                messages = this.options.messages;\n                buttons = [\n                    { name: \"delete\", text: messages.destroy, className: Gantt.styles.primary, click: function() { callback(); } },\n                    { name: \"cancel\", text: messages.cancel, click: function() { callback(true); } }\n                ];\n\n                this.showDialog(extend(true, {}, options, { buttons: buttons }));\n            } else {\n                callback();\n            }\n        },\n\n        showDialog: function(options) {\n            this._editor.showDialog(options);\n        },\n\n        refresh: function() {\n            if (this._preventRefresh || !this.list || this.list.editor) {\n                return;\n            }\n\n            this._progress(false);\n\n            var dataSource = this.dataSource;\n            var taskTree = dataSource.taskTree();\n            var scrollToUid = this._scrollToUid;\n            var current;\n            var cachedUid;\n            var cachedIndex = -1;\n\n            if (this.current) {\n                cachedUid = this.current.closest(\"tr\").attr(kendo.attr(\"uid\"));\n                cachedIndex = this.current.index();\n            }\n\n            if (this.trigger(\"dataBinding\")) {\n                return;\n            }\n\n            if (this.resources.dataSource.data().length !== 0) {\n                this._assignResources(taskTree);\n            }\n\n            if (this._editor) {\n                this._editor.close();\n            }\n\n            this.clearSelection();\n            this.list._renderTree(taskTree);\n            this.timeline._render(taskTree);\n            this.timeline._renderDependencies(this.dependencies.view());\n\n            if (scrollToUid) {\n                this._scrollTo(scrollToUid);\n                this.select(selector(scrollToUid));\n            }\n\n            if ((scrollToUid || cachedUid) && cachedIndex >= 0) {\n                current = this.list.element\n                    .find(\"tr\" + selector((scrollToUid || cachedUid)) + \" > td\").eq(cachedIndex);\n\n                this._current(current);\n            }\n\n            this._scrollToUid = null;\n\n            this.trigger(\"dataBound\");\n        },\n\n        refreshDependencies: function() {\n            if (this._preventDependencyRefresh) {\n                return;\n            }\n\n            if (this.trigger(\"dataBinding\")) {\n                return;\n            }\n\n            this.timeline._renderDependencies(this.dependencies.view());\n\n            this.trigger(\"dataBound\");\n        },\n\n        _assignResources: function(taskTree) {\n            var resources = this.resources;\n            var assignments = this.assignments;\n            var groupAssigments = function() {\n                var data = assignments.dataSource.view();\n                var group = {\n                    field: assignments.dataTaskIdField\n                };\n\n                data = new Query(data).group(group).toArray();\n\n                return data;\n            };\n            var assigments = groupAssigments();\n            var applyTaskResource = function(task, action) {\n                var taskId = task.get(\"id\");\n\n                kendo.setter(resources.field)(task, new ObservableArray([]));\n\n                for (var i = 0, length = assigments.length; i < length; i++) {\n                    if (assigments[i].value === taskId) {\n                        action(task, assigments[i].items);\n                    }\n                }\n            };\n            var wrapTask = function(task, items) {\n                for (var j = 0, length = items.length; j < length; j++) {\n                    var item = items[j];\n                    var resource = resources.dataSource.get(item.get(assignments.dataResourceIdField));\n                    var resourceValue = item.get(assignments.dataValueField);\n                    var resourcedId = item.get(assignments.dataResourceIdField);\n                    var valueFormat = resource.get(resources.dataFormatField) || PERCENTAGE_FORMAT;\n                    var formatedValue = kendo.toString(resourceValue, valueFormat);\n\n                    task[resources.field].push(new ObservableObject({\n                        id: resourcedId,\n                        name: resource.get(resources.dataTextField),\n                        color: resource.get(resources.dataColorField),\n                        value: resourceValue,\n                        formatedValue: formatedValue\n                    }));\n                }\n            };\n\n            for (var i = 0, length = taskTree.length; i < length; i++) {\n                applyTaskResource(taskTree[i], wrapTask);\n            }\n        },\n\n        _wrapResourceData: function(id) {\n            var that = this;\n            var result = [];\n            var resource;\n            var resources = this.resources.dataSource.view();\n            var assignments = this.assignments.dataSource.view();\n            var taskAssignments = new Query(assignments).filter({\n                field: that.assignments.dataTaskIdField,\n                operator: \"eq\",\n                value: id\n            }).toArray();\n            var valuePerResource = function(id) {\n                var resourceValue = null;\n\n                new Query(taskAssignments).filter({\n                    field: that.assignments.dataResourceIdField,\n                    operator: \"eq\",\n                    value: id\n                }).select(function(assignment) {\n                    resourceValue += assignment.get(that.assignments.dataValueField);\n                });\n\n                return resourceValue;\n            };\n\n            for (var i = 0, length = resources.length; i < length; i++) {\n                resource = resources[i];\n                result.push({\n                    id: resource.get(\"id\"),\n                    name: resource.get(that.resources.dataTextField),\n                    format: resource.get(that.resources.dataFormatField) || PERCENTAGE_FORMAT,\n                    value: valuePerResource(resource.id)\n                });\n            }\n\n            return result;\n        },\n\n        _syncDataSource: function() {\n            this._preventRefresh = false;\n            this._requestStart();\n            this.dataSource.sync();\n        },\n\n        _requestStart: function() {\n            this._progress(true);\n        },\n\n        _error: function() {\n            this._progress(false);\n        },\n\n        _progress: function(toggle) {\n            kendo.ui.progress(this.element, toggle);\n        },\n\n        _resizable: function() {\n            var that = this;\n            var wrapper = this.wrapper;\n            var ganttStyles = Gantt.styles;\n            var contentSelector = DOT + ganttStyles.gridContent;\n            var treeListWrapper = wrapper.find(DOT + ganttStyles.list);\n            var timelineWrapper = wrapper.find(DOT + ganttStyles.timeline);\n            var treeListWidth;\n            var timelineWidth;\n            var timelineScroll;\n\n            this._resizeDraggable = wrapper\n                .find(DOT + ganttStyles.splitBar)\n                .height(treeListWrapper.height())\n                .hover(function () {\n                    $(this).addClass(ganttStyles.splitBarHover);\n                }, function () {\n                    $(this).removeClass(ganttStyles.splitBarHover);\n                })\n                .end()\n                .kendoResizable({\n                    orientation: \"horizontal\",\n                    handle: DOT + ganttStyles.splitBar,\n                    \"start\": function () {\n                        treeListWidth = treeListWrapper.width();\n                        timelineWidth = timelineWrapper.width();\n                        timelineScroll = kendo.scrollLeft(timelineWrapper.find(contentSelector));\n                    },\n                    \"resize\": function(e) {\n                        var delta = e.x.initialDelta;\n\n                        if (kendo.support.isRtl(wrapper)) {\n                            delta *= -1;\n                        }\n\n                        if (treeListWidth + delta < 0 || timelineWidth - delta < 0) {\n                            return;\n                        }\n\n                        treeListWrapper.width(treeListWidth + delta);\n                        timelineWrapper.width(timelineWidth - delta);\n                        kendo.scrollLeft(timelineWrapper.find(contentSelector), (timelineScroll + delta));\n\n                        that.timeline.view()._renderCurrentTime();\n                    }\n                }).data(\"kendoResizable\");\n        },\n\n        _scrollable: function() {\n            var that = this;\n            var ganttStyles = Gantt.styles;\n            var contentSelector = DOT + ganttStyles.gridContent;\n            var headerSelector = DOT + ganttStyles.gridHeaderWrap;\n            var timelineHeader = this.timeline.element.find(headerSelector);\n            var timelineContent = this.timeline.element.find(contentSelector);\n            var treeListHeader = this.list.element.find(headerSelector);\n            var treeListContent = this.list.element.find(contentSelector);\n\n            if (mobileOS) {\n                treeListContent.css(\"overflow-y\", \"auto\");\n            }\n\n            timelineContent.on(\"scroll\", function() {\n                that.scrollTop = this.scrollTop;\n                kendo.scrollLeft(timelineHeader, this.scrollLeft);\n                treeListContent.scrollTop(this.scrollTop);\n            });\n\n            treeListContent\n                .on(\"scroll\", function() {\n                    kendo.scrollLeft(treeListHeader, this.scrollLeft);\n                })\n                .on(\"DOMMouseScroll\" + NS + \" mousewheel\" + NS, function(e) {\n                    var scrollTop = timelineContent.scrollTop();\n                    var delta = kendo.wheelDeltaY(e);\n\n                    if (delta) {\n                        e.preventDefault();\n                        //In Firefox DOMMouseScroll event cannot be canceled\n                        $(e.currentTarget).one(\"wheel\" + NS, false);\n\n                        timelineContent.scrollTop(scrollTop + (-delta));\n                    }\n                });\n        },\n\n        _navigatable: function() {\n            var that = this;\n            var navigatable = this.options.navigatable;\n            var editable = this.options.editable;\n            var ganttStyles = Gantt.styles;\n            var contentSelector = DOT + ganttStyles.gridContent;\n            var headerSelector = DOT + ganttStyles.gridHeaderWrap;\n            var headerTable = this.list.element.find(headerSelector).find(\"table\");\n            var contentTable = this.list.element.find(contentSelector).find(\"table\");\n            var isRtl = kendo.support.isRtl(this.wrapper);\n            var timelineContent = this.timeline.element.find(DOT + ganttStyles.gridContent);\n            var tables = headerTable.add(contentTable);\n            var attr = selector();\n            var cellIndex;\n            var expandState = {\n                collapse: false,\n                expand: true\n            };\n\n            var scroll = function(reverse) {\n                var width = that.timeline.view()._timeSlots()[0].offsetWidth;\n                kendo.scrollLeft(timelineContent, kendo.scrollLeft(timelineContent) + (reverse ? -width : width));\n            };\n\n            var scrollVertical = function(reverse) {\n                var height = that.timeline.view()._rowHeight;\n                timelineContent.scrollTop(timelineContent.scrollTop() + (reverse ? -height : height));\n            };\n\n            var moveVertical = function(method) {\n                var parent = that.current.parent(\"tr\" + selector());\n                var index = that.current.index();\n                var sibling = parent[method]('tr:visible').first();\n\n                if (that.select().length !== 0) {\n                    that.clearSelection();\n                }\n\n                if (sibling.length !== 0) {\n                    that._current(sibling.children(\"td\").eq(index));\n                    that._scrollTo(that.current);\n                } else {\n                    if (that.current.is(\"td\") && method == \"prevAll\") {\n                        focusTable(headerTable);\n                    } else if (that.current.is(\"th\") && method == \"nextAll\") {\n                        focusTable(contentTable);\n                    }\n                }\n            };\n            var moveHorizontal = function(method) {\n                var subling = that.current[method]();\n\n                if (subling.length !== 0) {\n                    that._current(subling);\n                    cellIndex = that.current.index();\n                }\n            };\n            var toggleExpandedState = function(value) {\n                var model = that.dataItem(that.current);\n\n                if (model.summary && model.expanded !== value) {\n                    model.set(\"expanded\", value);\n                }\n            };\n            var deleteAction = function() {\n                var editable = that.options.editable;\n\n                if (!editable || editable.destroy === false || that.list.editor) {\n                    return;\n                }\n\n                var selectedTask = that.select();\n                var uid = kendo.attr(\"uid\");\n\n                if (selectedTask.length) {\n                    that.removeTask(selectedTask.attr(uid));\n                }\n            };\n\n            $(this.wrapper)\n                .on(\"mousedown\" + NS, \"tr\" + attr + \", div\" + attr + \":not(\" + DOT + ganttStyles.line + \")\", function(e) {\n                    var currentTarget = $(e.currentTarget);\n                    var isInput = $(e.target).is(\":button,a,:input,a>.k-icon,textarea,span.k-icon:not(.k-i-none),span.k-link,.k-input,.k-multiselect-wrap\");\n                    var current;\n\n                    if (e.ctrlKey) {\n                        return;\n                    }\n\n                    if (navigatable) {\n                        if (currentTarget.is(\"tr\")) {\n                            current = $(e.target).closest(\"td\");\n                        } else {\n                            current = that.list\n                                .content.find(\"tr\" + selector(currentTarget.attr(kendo.attr(\"uid\"))) + \" > td\").first();\n                        }\n\n                        that._current(current);\n                    }\n\n                    if ((navigatable || editable) && !isInput) {\n                        that._focusTimeout = setTimeout(function() {\n                            focusTable(that.list.content.find(\"table\"), true);\n                        }, 2);\n                    }\n                })\n\n                .on(\"keydown\" + NS, function (e) {\n                    var key = e.keyCode;\n                    var that = this;\n                    var focusableItems = $(that._getToolbarItems());\n                    var idx = focusableItems.index(that.toolbar.find(DOT + ganttStyles.focused)[0]);\n                    if (idx === -1 && $(e.target).closest(DOT + ganttStyles.toolbar.views).length) {\n                        idx = focusableItems.index(that.toolbar.find(\".k-gantt-views > .k-selected:visible, .k-views-dropdown:visible\")[0]);\n                    }\n                    var itemToFocus = e.shiftKey ? focusableItems[idx -  1] : focusableItems[idx +  1];\n\n                    if (key === keys.F10) {\n                        that.toolbar.find(\".k-button:visible\").first().addClass(ganttStyles.focused).trigger(\"focus\");\n                        e.preventDefault();\n                    } else if (key == keys.TAB && $(e.target).closest(DOT + ganttStyles.toolbar.toolbar).length) {\n                        that.toolbar.find(DOT + ganttStyles.focused).removeClass(ganttStyles.focused).trigger(\"blur\");\n                        if (itemToFocus) {\n                            $(itemToFocus).addClass(ganttStyles.focused).trigger(\"focus\");\n                            e.preventDefault();\n                            return;\n                        }\n                        if (this.list.element.is(\":visible\")) {\n                            this.list.element.find(\"table[role=treegrid]\").trigger(\"focus\");\n                        } else {\n                            this.element.find(DOT + ganttStyles.tasks)[0].focus();\n                        }\n                        e.preventDefault();\n                    }\n\n                }.bind(this));\n\n            if (navigatable !== true) {\n                contentTable\n                    .on(\"keydown\" + NS, function(e) {\n                        if (e.keyCode == keys.DELETE) {\n                            deleteAction();\n                        }\n                    });\n\n                return;\n            }\n\n            tables\n                .on(\"focus\" + NS, function() {\n                    var selector = this === contentTable.get(0) ? \"td\" : \"th\";\n                    var selection = that.select();\n                    var current = that.current || $((selection.length ? selection : this))\n                        .find(selector).eq((cellIndex || 0));\n\n                    that._current(current);\n                    $(that.toolbar.find(DOT + ganttStyles.focused)).removeClass(ganttStyles.focused);\n                })\n                .on(\"blur\" + NS, function() {\n                    that._current();\n\n                    if (this == headerTable) {\n                        $(this).attr(TABINDEX, -1);\n                    }\n                })\n                .on(\"keydown\" + NS, function(e) {\n                    var key = e.keyCode;\n                    var isCell;\n\n                    if (!that.current) {\n                        return;\n                    }\n\n                    isCell = that.current.is(\"td\");\n\n                    switch (key) {\n                        case keys.RIGHT:\n                            e.preventDefault();\n                            if (e.altKey) {\n                                scroll();\n                            } else if (e.ctrlKey) {\n                                toggleExpandedState(isRtl ? expandState.collapse : expandState.expand);\n                            } else {\n                                moveHorizontal(isRtl ? \"prev\" : \"next\");\n                            }\n                            break;\n                        case keys.LEFT:\n                            e.preventDefault();\n                            if (e.altKey) {\n                                scroll(true);\n                            } else if (e.ctrlKey) {\n                                toggleExpandedState(isRtl ? expandState.expand : expandState.collapse);\n                            } else {\n                                moveHorizontal(isRtl ? \"next\" : \"prev\");\n                            }\n                            break;\n                        case keys.UP:\n                            e.preventDefault();\n                            if (e.altKey) {\n                                scrollVertical(true);\n                            } else {\n                                moveVertical(\"prevAll\");\n                            }\n                            break;\n                        case keys.DOWN:\n                            e.preventDefault();\n                            if (e.altKey) {\n                                scrollVertical();\n                            } else {\n                                moveVertical(\"nextAll\");\n                            }\n                            break;\n                        case keys.SPACEBAR:\n                            e.preventDefault();\n                            if (isCell) {\n                                that.select(that.current.closest(\"tr\"));\n                            }\n                            break;\n                        case keys.ENTER:\n                            e.preventDefault();\n                            if (isCell) {\n                                if (that.options.editable && that.options.editable.update !== false) {\n                                    that.list._startEditHandler(that.current);\n                                    $(this).one(\"keyup\", function(e) {\n                                        /* Stop the event propagation so that the list widget won't close its editor immediately */\n                                        e.stopPropagation();\n                                    });\n                                }\n                            } else {\n                                /* Sort */\n                                that.current\n                                    .children(\"a.k-link\")\n                                    .click();\n                            }\n                            break;\n                        case keys.DELETE:\n                            if (isCell) {\n                                deleteAction();\n                            }\n                            break;\n                        default:\n                            if (key >= 49 && key <= 57 && e.target.tagName.toLowerCase() !== \"input\") {\n                               that.view(that.timeline._viewByIndex(key - 49));\n                            }\n                            break;\n                    }\n                });\n        },\n\n        _getToolbarItems: function () {\n            return this.toolbar.find(\"> .k-button:visible\").toArray().concat(\n                this.toolbar.find(\".k-views-dropdown:visible\").toArray(),\n                this.toolbar.find(\".k-gantt-views > .k-selected:visible\").toArray()\n            );\n        },\n\n        _current: function(element) {\n            var ganttStyles = Gantt.styles;\n            var activeElement;\n\n            if (this.current && this.current.length) {\n                this.current\n                    .removeClass(ganttStyles.focusedCell)\n                    .removeAttr(\"id\");\n            }\n\n            if (element && element.length) {\n                this.current = element\n                    .addClass(ganttStyles.focusedCell)\n                    .attr(\"id\", ACTIVE_CELL);\n\n                activeElement = $(kendo._activeElement());\n\n                if (activeElement.is(\"table\") && this.wrapper.find(activeElement).length > 0) {\n                    activeElement\n                        .removeAttr(ARIA_DESCENDANT)\n                        .attr(ARIA_DESCENDANT, ACTIVE_CELL);\n                }\n            } else {\n                this.current = null;\n            }\n        },\n\n        _dataBind: function() {\n            var that = this;\n\n            if (that.options.autoBind) {\n                this._preventRefresh = true;\n                this._preventDependencyRefresh = true;\n\n                var promises = $.map([\n                    this.dataSource,\n                    this.dependencies,\n                    this.resources.dataSource,\n                    this.assignments.dataSource\n                ],\n                function(dataSource) {\n                    return dataSource.fetch();\n                });\n\n                $.when.apply(null, promises)\n                    .done(function() {\n                        that._preventRefresh = false;\n                        that._preventDependencyRefresh = false;\n                        that.refresh();\n                    });\n            }\n        },\n\n        _resize: function() {\n            this._adjustDimensions();\n            this.timeline.view()._adjustHeight();\n            this.timeline.view()._renderCurrentTime();\n            this.list._adjustHeight();\n        },\n\n        _createPlannedTasksSwitch: function() {\n            var that = this;\n            var switchLabel = that.options.messages.plannedTasks.switchText;\n            var toggeSwitchWrap = $(\"<span class='k-gantt-planned-wrap'><label>\" + switchLabel + \"</label></span>\");\n            var plannedToggle = new kendo.ui.Switch($(\"<input id='planned-switch' class='k-gantt-planned-switch'>\"), {\n                checked: that.options.showPlannedTasks,\n                change: proxy(that._togglePlannedTasks, that),\n                messages: {\n                    checked: \"\",\n                    unchecked: \"\"\n                }\n            });\n\n            toggeSwitchWrap.append(plannedToggle.wrapper);\n\n            that.toggeSwitchWrap = toggeSwitchWrap;\n            that.toggleSwitch = plannedToggle;\n        },\n\n        _togglePlannedTasks: function(e) {\n            var timeline = this.timeline;\n\n            if (!this.trigger(\"togglePlannedTasks\", { showPlannedTasks: !timeline.options.showPlannedTasks })) {\n                this.wrapper.toggleClass(ganttStyles.plannedTasks);\n                timeline._setPlanned(!timeline.options.showPlannedTasks);\n                timeline._render(this.dataSource.taskTree());\n                timeline._renderDependencies(this.dependencies.view());\n            } else {\n                e.preventDefault();\n            }\n        }\n    });\n\n    if (kendo.PDFMixin) {\n        kendo.PDFMixin.extend(Gantt.fn);\n\n        Gantt.fn._drawPDF = function() {\n            var ganttStyles = Gantt.styles;\n            var listTableWidth = this.wrapper.find(DOT + ganttStyles.list + \" \" + DOT + ganttStyles.gridContent + \">table\").width();\n            var content = this.wrapper.clone();\n\n            content.find(DOT + ganttStyles.list).css(\"width\", listTableWidth);\n\n            return this._drawPDFShadow({\n                content: content\n            }, {\n                avoidLinks: this.options.pdf.avoidLinks\n            });\n        };\n    }\n\n    kendo.ui.plugin(Gantt);\n\n    extend(true, Gantt, { styles: ganttStyles });\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n"],"names":["define","__meta__","id","name","category","description","depends","defaultCommands","$","window","kendo","jQuery","undefined","keys","extend","F10","supportsMedia","mobileOS","support","Widget","ui","ObservableObject","data","ObservableArray","Query","isArray","Array","inArray","isFunction","proxy","isPlainObject","outerWidth","_outerWidth","outerHeight","_outerHeight","defaultIndicatorWidth","NS","PERCENTAGE_FORMAT","TABINDEX","CLICK","STRING","ARIA_DESCENDANT","ARIA_LABEL","ACTIVE_CELL","DOT","TASK_DELETE_CONFIRM","DEPENDENCY_DELETE_CONFIRM","TOGGLE_BUTTON_TEMPLATE","template","BUTTON_TEMPLATE","COMMAND_BUTTON_TEMPLATE","VIEWS_DROPDOWN_TEMPLATE","HEADER_VIEWS_TEMPLATE","ganttStyles","wrapper","plannedTasks","rowHeight","content","listWrapper","list","timelineWrapper","timeline","splitBarWrapper","splitBar","splitBarHover","popupWrapper","popupList","resizeHandle","icon","item","line","buttonDelete","buttonCancel","buttonSave","buttonToggle","buttonDefaults","primary","hovered","selected","focused","focusedCell","gridHeader","gridHeaderWrap","gridContent","tasks","popup","form","editForm","formContainer","resourcesFormContainer","message","buttonsContainer","button","editField","editLabel","resourcesField","toolbar","headerWrapper","footerWrapper","views","viewsWrapper","viewsDropdown","iconPlus","iconPdf","iconToggle","viewButton","link","pdfButton","appendButton","selector","uid","attr","trimOptions","options","prefix","remove","edit","add","navigate","focusTable","table","direct","parents","scrollPositions","scrollableParents","each","index","parent","scrollTop","setActive","e","focus","element","parentsUntil","filter","computedStyle","getComputedStyles","overflow","Gantt","init","events","dataSource","append","text","action","className","styles","iconClass","pdf","fn","call","this","_events","_wrapper","_resources","length","_timeline","_toolbar","_footer","_adjustDimensions","_preventRefresh","view","_selectedViewName","_dataSource","_assignments","_dropDowns","_list","_dependencies","_resizable","_scrollable","_dataBind","_attachEvents","_createEditor","notify","autoBind","navigatable","selectable","editable","resizable","columnResizeHandleWidth","columns","dependencies","resources","assignments","taskTemplate","messages","save","cancel","destroy","deleteTaskConfirmation","deleteDependencyConfirmation","deleteTaskWindowTitle","deleteDependencyWindowTitle","selectView","day","week","month","year","start","end","actions","addChild","insertBefore","insertAfter","editor","editorTitle","resourcesEditorTitle","title","plannedStart","plannedEnd","percentComplete","assignButton","resourcesHeader","unitsHeader","switchText","offsetTooltipAdvanced","offsetTooltipDelay","seconds","minutes","hours","days","showWorkHours","showWorkDays","workDayStart","Date","workDayEnd","workWeekStart","workWeekEnd","hourSpan","snap","height","listWidth","showPlannedTasks","select","value","find","trigger","clearSelection","unbind","_refreshHandler","_progressHandler","_errorHandler","_dependencyRefreshHandler","_dependencyErrorHandler","footerDropDown","headerDropDown","_editor","_resizeDraggable","off","_mediaQuery","removeListener","_mediaQueryHandler","_resizeHandler","footer","setOptions","newOptions","deepExtend","selectedView","map","isSettings","type","empty","_setEvents","resize","on","matches","splitBarHandleClassName","join","width","addClass","layout","appendTo","css","treelistWrapper","splitbar","that","viewsSelector","viewsDropdownSelector","pdfSelector","toggleSelector","contentSelector","treelist","toggleButton","mediaQueryHandler","removeClass","refresh","_resize","_actions","ns","prepend","label","toggeSwitchWrap","matchMedia","addListener","val","preventDefault","children","focusedViewIndex","_focusedView","closest","keyCode","RIGHT","LEFT","ENTER","SPACEBAR","toLowerCase","_viewByIndex","saveAsPDF","is","relatedTarget","expanded","html","create","i","_createPlannedTasksSwitch","_createButton","command","commandName","replace","indexOf","Error","split","toolbarHeight","footerHeight","totalHeight","totalWidth","splitBarWidth","treeListWidth","timelineWidth","_scrollTo","scrollTarget","scrollIntoView","get","actionsSelector","actionMessages","handler","orderId","task","_createNewModel","dataItem","taskParent","firstSlot","_timeSlots","target","set","_createTask","gantt","TaskDropDown","eq","direction","animation","open","effects","bind","_getListEditable","update","reorder","mode","move","reorderable","_getListOptions","ganttListOptions","filterable","columnMenu","field","_attachResourceEditor","column","_createResourceEditor","_attachListEvents","toggleButtons","restoreFocus","_cachedCurrent","rowIndex","columnIndex","_current","oldIndex","newIndex","oldWidth","newWidth","_navigatable","container","model","cell","_preventItemChange","closeCell","updatedValues","values","updateDuration","duration","updatePlannedDuration","plannedDuration","hasOwnProperty","previousStart","getTime","previousPlannedStart","previousPercentComplete","updateInfo","_updateAssignments","_requestStart","sync","then","hasChanges","cancelChanges","selection","removeAttr","row","position","parentId","source","sort","dir","_updateTask","listElement","listOptions","GanttList","GanttTimeline","viewName","getByUid","resizeStart","dependency","predecessorId","predecessor","successorId","successor","_createDependency","editTask","removeTask","removeDependency","_error","GanttDataSource","refreshDependencies","GanttDependencyDataSource","dataTextField","dataColorField","dataFormatField","DataSource","_assignmentsRefreshHandler","dataTaskIdField","dataResourceIdField","dataValueField","PopupEditor","createButton","_createPopupButton","cancelTask","saveTask","_onDialogClose","unitsValidation","step","assignmentsModel","schema","fields","Units","validation","_resourceEditor","ResourceEditor","_wrapResourceData","buttons","range","_render","taskTree","_renderDependencies","date","_scrollToDate","_modelFromElement","setDataSource","fetch","setDependenciesDataSource","items","taskId","resourceId","hasMatch","operator","toArray","assignment","resource","_updateAssignment","splice","_removeAssignment","shift","j","newLength","_createAssignment","close","taskCopy","toJSON","_editTask","_syncDataSource","resourceValueField","_taskConfirm","_removeTask","insert","_scrollToUid","_preventDependencyRefresh","resourceValue","_dependencyConfirm","_removeDependency","_removeTaskDependencies","_removeTaskAssignments","callback","_confirm","confirmation","click","showDialog","_progress","scrollToUid","current","cachedUid","cachedIndex","_assignResources","_renderTree","groupAssigments","group","assigments","applyTaskResource","setter","wrapTask","resourcedId","valueFormat","formatedValue","toString","push","color","result","taskAssignments","valuePerResource","format","toggle","progress","treeListWrapper","timelineScroll","hover","kendoResizable","orientation","handle","scrollLeft","delta","x","initialDelta","isRtl","_renderCurrentTime","headerSelector","timelineHeader","timelineContent","treeListHeader","treeListContent","wheelDeltaY","currentTarget","one","headerTable","contentTable","tables","cellIndex","expandState","collapse","expand","scroll","reverse","offsetWidth","scrollVertical","_rowHeight","moveVertical","method","sibling","first","moveHorizontal","subling","toggleExpandedState","summary","deleteAction","selectedTask","isInput","ctrlKey","_focusTimeout","setTimeout","key","focusableItems","_getToolbarItems","idx","itemToFocus","shiftKey","TAB","DELETE","isCell","altKey","UP","DOWN","_startEditHandler","stopPropagation","tagName","concat","activeElement","_activeElement","promises","when","apply","done","_adjustHeight","switchLabel","plannedToggle","Switch","checked","change","_togglePlannedTasks","unchecked","toggleSwitch","toggleClass","_setPlanned","PDFMixin","_drawPDF","listTableWidth","clone","_drawPDFShadow","avoidLinks","plugin","amd","a1","a2","a3"],"mappings":"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"}