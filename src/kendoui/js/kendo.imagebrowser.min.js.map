{"version":3,"file":"kendo.imagebrowser.min.js","sources":["kendo.imagebrowser.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.imagebrowser',[ \"./kendo.filebrowser\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"imagebrowser\",\n    name: \"ImageBrowser\",\n    category: \"web\",\n    description: \"\",\n    hidden: true,\n    depends: [ \"filebrowser\" ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        FileBrowser = kendo.ui.FileBrowser,\n        isPlainObject = $.isPlainObject,\n        proxy = $.proxy,\n        extend = $.extend,\n        isFunction = kendo.isFunction,\n        trimSlashesRegExp = /(^\\/|\\/$)/g,\n        ERROR = \"error\",\n        NS = \".kendoImageBrowser\",\n        NAMEFIELD = \"name\",\n        SIZEFIELD = \"size\",\n        TYPEFIELD = \"type\",\n        DEFAULTSORTORDER = { field: TYPEFIELD, dir: \"asc\" },\n        EMPTYTILE = kendo.template('<div class=\"k-listview-item k-listview-item-empty\"><span class=\"k-file-preview\"><span class=\"k-file-icon k-icon k-i-none\"></span></span><span class=\"k-file-name\">${text}</span></div>');\n\n    extend(true, kendo.data, {\n        schemas: {\n            \"imagebrowser\": {\n                data: function(data) {\n                    return data.items || data || [];\n                },\n                model: {\n                    id: \"name\",\n                    fields: {\n                        name: \"name\",\n                        size: \"size\",\n                        type: \"type\"\n                    }\n                }\n            }\n        }\n    });\n\n    extend(true, kendo.data, {\n        transports: {\n            \"imagebrowser\": kendo.data.RemoteTransport.extend({\n                init: function(options) {\n                    kendo.data.RemoteTransport.fn.init.call(this, $.extend(true, {}, this.options, options));\n                },\n                _call: function(type, options) {\n                    options.data = $.extend({}, options.data, { path: this.options.path() });\n\n                    if (isFunction(this.options[type])) {\n                        this.options[type].call(this, options);\n                    } else {\n                        kendo.data.RemoteTransport.fn[type].call(this, options);\n                    }\n                },\n                read: function(options) {\n                    this._call(\"read\", options);\n                },\n                create: function(options) {\n                    this._call(\"create\", options);\n                },\n                destroy: function(options) {\n                    this._call(\"destroy\", options);\n                },\n                update: function() {\n                    //updates are handled by the upload\n                },\n                options: {\n                    read: {\n                        type: \"POST\"\n                    },\n                    update: {\n                        type: \"POST\"\n                    },\n                    create: {\n                        type: \"POST\"\n                    },\n                    destroy: {\n                        type: \"POST\"\n                    }\n                }\n            })\n        }\n    });\n\n    function offsetTop(element) {\n        return element.offsetTop - $(element).height();\n    }\n\n    function concatPaths(path, name) {\n        if(path === undefined || !path.match(/\\/$/)) {\n            path = (path || \"\") + \"/\";\n        }\n        return path + name;\n    }\n\n    function sizeFormatter(value) {\n        if(!value) {\n            return \"\";\n        }\n\n        var suffix = \" bytes\";\n\n        if (value >= 1073741824) {\n            suffix = \" GB\";\n            value /= 1073741824;\n        } else if (value >= 1048576) {\n            suffix = \" MB\";\n            value /= 1048576;\n        } else  if (value >= 1024) {\n            suffix = \" KB\";\n            value /= 1024;\n        }\n\n        return Math.round(value * 100) / 100 + suffix;\n    }\n\n    var ImageBrowser = FileBrowser.extend({\n        init: function(element, options) {\n            var that = this;\n\n            options = options || {};\n\n            FileBrowser.fn.init.call(that, element, options);\n\n            that.element.addClass(\"k-imagebrowser\");\n        },\n\n        options: {\n            name: \"ImageBrowser\",\n            fileTypes: \"*.png,*.gif,*.jpg,*.jpeg\"\n        },\n\n        value: function () {\n            var that = this,\n                selected = that._selectedItem(),\n                path,\n                imageUrl = that.options.transport.imageUrl;\n\n            if (selected && selected.get(TYPEFIELD) === \"f\") {\n                path = concatPaths(that.path(), selected.get(NAMEFIELD)).replace(trimSlashesRegExp, \"\");\n                if (imageUrl) {\n                    path = isFunction(imageUrl) ? imageUrl(path) : kendo.format(imageUrl, encodeURIComponent(path));\n                }\n                return path;\n            }\n        },\n\n        _fileUpload: function(e) {\n            var that = this,\n                options = that.options,\n                fileTypes = options.fileTypes,\n                filterRegExp = new RegExp((\"(\" + fileTypes.split(\",\").join(\")|(\") + \")\").replace(/\\*\\./g , \".*.\"), \"i\"),\n                fileName = e.files[0].name,\n                fileSize = e.files[0].size,\n                fileNameField = NAMEFIELD,\n                sizeField = SIZEFIELD,\n                file;\n\n            if (filterRegExp.test(fileName)) {\n                e.data = { path: that.path() };\n\n                file = that._createFile(fileName, fileSize);\n\n                if (!file) {\n                    e.preventDefault();\n                } else {\n                    file._uploading = true;\n\n                    that.upload.one(\"error\", function() {\n                        file = undefined;\n                    });\n\n                    that.upload.one(\"success\", function(e) {\n                        if (file) {\n                            delete file._uploading;\n\n                            var model = that._insertFileToList(file);\n\n                            model.set(fileNameField, e.response[that._getFieldName(fileNameField)]);\n                            model.set(sizeField, e.response[that._getFieldName(sizeField)]);\n\n                            that._tiles = that.listView.items().filter(\"[\" + kendo.attr(\"type\") + \"=f]\");\n                            that._scroll();\n                        }\n                    });\n                }\n            } else {\n                e.preventDefault();\n                that._showMessage(kendo.format(options.messages.invalidFileType, fileName, fileTypes));\n            }\n        },\n\n        _content: function() {\n            var that = this;\n\n            that.list = $('<div class=\"k-filemanager-listview\" />')\n                .appendTo(that.element)\n                .on(\"dblclick\" + NS, \".k-listview-item\", proxy(that._dblClick, that));\n\n            that.listView = new kendo.ui.ListView(that.list, {\n                layout: \"flex\",\n                flex: {\n                    direction: \"row\",\n                    wrap: \"wrap\"\n                },\n                dataSource: that.dataSource,\n                template: that._itemTmpl(),\n                editTemplate: that._editTmpl(),\n                selectable: true,\n                autoBind: false,\n                dataBinding: function(e) {\n\n                    that.toolbar.find(\".k-i-close\").parent().addClass(\"k-disabled\");\n\n                    if (e.action === \"remove\" || e.action === \"sync\") {\n                        e.preventDefault();\n                        kendo.ui.progress(that.listView.content, false);\n                    }\n                },\n                dataBound: function() {\n                    if (that.dataSource.view().length) {\n                        that._tiles = this.items().filter(\"[\" + kendo.attr(\"type\") + \"=f]\");\n                        that._scroll();\n                    } else {\n                        this.content.append(EMPTYTILE({ text: that.options.messages.emptyFolder }));\n                    }\n                },\n                change: proxy(that._listViewChange, that)\n            });\n\n            that.listView.content.on(\"scroll\" + NS, proxy(that._scroll, that));\n        },\n\n        _dataSource: function() {\n            var that = this,\n                options = that.options,\n                transport = options.transport,\n                typeSortOrder = extend({}, DEFAULTSORTORDER),\n                nameSortOrder = { field: NAMEFIELD, dir: \"asc\" },\n                schema,\n                dataSource = {\n                    type: transport.type || \"imagebrowser\",\n                    sort: [typeSortOrder, nameSortOrder]\n                };\n\n            if (isPlainObject(transport)) {\n                transport.path = proxy(that.path, that);\n                dataSource.transport = transport;\n            }\n\n            if (isPlainObject(options.schema)) {\n                dataSource.schema = options.schema;\n            } else if (transport.type && isPlainObject(kendo.data.schemas[transport.type])) {\n                schema = kendo.data.schemas[transport.type];\n            }\n\n            if (that.dataSource && that._errorHandler) {\n                that.dataSource.unbind(ERROR, that._errorHandler);\n            } else {\n                that._errorHandler = proxy(that._error, that);\n            }\n\n            that.dataSource = kendo.data.DataSource.create(dataSource)\n                .bind(ERROR, that._errorHandler);\n        },\n\n        _loadImage: function(li) {\n            var that = this,\n                element = $(li),\n                dataItem = that.dataSource.getByUid(element.attr(kendo.attr(\"uid\"))),\n                name = dataItem.get(NAMEFIELD),\n                thumbnailUrl = that.options.transport.thumbnailUrl,\n                img = $(\"<img />\", { alt: name }),\n                urlJoin = \"?\";\n\n            if (dataItem._uploading) {\n                return;\n            }\n\n            img.hide()\n               .on(\"load\" + NS, function() {\n                   $(this).prev().remove().end().addClass(\"k-image k-file-image\").fadeIn();\n               });\n\n            element.find(\".k-i-loading\").after(img);\n\n            if (isFunction(thumbnailUrl)) {\n                thumbnailUrl = thumbnailUrl(that.path(), encodeURIComponent(name));\n            } else {\n                if (thumbnailUrl.indexOf(\"?\") >= 0) {\n                    urlJoin = \"&\";\n                }\n\n                thumbnailUrl = thumbnailUrl + urlJoin + \"path=\" + encodeURIComponent(that.path() + name);\n                if (dataItem._override) {\n                    thumbnailUrl += \"&_=\" + new Date().getTime();\n                    delete dataItem._override;\n                }\n            }\n\n            // IE8 will trigger the load event immediately when the src is assigned\n            // if the image is loaded from the cache\n            img.attr(\"src\", thumbnailUrl);\n\n            li.loaded = true;\n        },\n\n        _scroll: function() {\n            var that = this;\n            if (that.options.transport && that.options.transport.thumbnailUrl) {\n                clearTimeout(that._timeout);\n\n                that._timeout = setTimeout(function() {\n\n                    var height = kendo._outerHeight(that.listView.content),\n                        viewTop = that.listView.content.scrollTop(),\n                        viewBottom = viewTop + height;\n\n                    that._tiles.each(function() {\n                        var top = offsetTop(this),\n                            bottom = top + this.offsetHeight;\n\n                        if ((top >= viewTop && top < viewBottom) || (bottom >= viewTop && bottom < viewBottom)) {\n                            that._loadImage(this);\n                        }\n\n                        if (top > viewBottom) {\n                            return false;\n                        }\n                    });\n\n                    that._tiles = that._tiles.filter(function() {\n                        return !this.loaded;\n                    });\n\n                }, 250);\n            }\n        },\n\n        _itemTmpl: function() {\n            var that = this,\n                html = '<div class=\"k-listview-item\" ' + kendo.attr(\"uid\") + '=\"#=uid#\" ';\n\n            html += kendo.attr(\"type\") + '=\"${' + TYPEFIELD + '}\">';\n            html += '#if(' + TYPEFIELD + ' == \"d\") { #';\n            html += '<div class=\"k-file-preview\"><span class=\"k-file-icon k-icon k-i-folder\"></span></div>';\n            html += \"#}else{#\";\n            if (that.options.transport && that.options.transport.thumbnailUrl) {\n                html += '<div class=\"k-file-preview\"><span class=\"k-file-icon k-icon k-i-loading\"></span></div>';\n            } else {\n                html += '<div class=\"k-file-preview\"><span class=\"k-file-icon k-icon k-i-file\"></span></div>';\n            }\n            html += \"#}#\";\n            html += '<span class=\"k-file-name\">${' + NAMEFIELD + '}</span>';\n            html += '#if(' + TYPEFIELD + ' == \"f\") { # <span class=\"k-file-size\">${this.sizeFormatter(' + SIZEFIELD + ')}</span> #}#';\n            html += '</div>';\n\n            return proxy(kendo.template(html), { sizeFormatter: sizeFormatter } );\n        }\n    });\n\n    kendo.ui.plugin(ImageBrowser);\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","hidden","depends","$","window","kendo","jQuery","undefined","FileBrowser","ui","isPlainObject","proxy","extend","isFunction","trimSlashesRegExp","ERROR","NS","NAMEFIELD","SIZEFIELD","TYPEFIELD","DEFAULTSORTORDER","field","dir","EMPTYTILE","template","offsetTop","element","height","concatPaths","path","match","sizeFormatter","value","suffix","Math","round","data","schemas","imagebrowser","items","model","fields","size","type","transports","RemoteTransport","init","options","fn","call","this","_call","read","create","destroy","update","ImageBrowser","that","addClass","fileTypes","selected","_selectedItem","imageUrl","transport","get","replace","format","encodeURIComponent","_fileUpload","e","filterRegExp","RegExp","split","join","fileName","files","fileSize","fileNameField","sizeField","file","test","_createFile","preventDefault","_uploading","upload","one","_insertFileToList","set","response","_getFieldName","_tiles","listView","filter","attr","_scroll","_showMessage","messages","invalidFileType","_content","list","appendTo","on","_dblClick","ListView","layout","flex","direction","wrap","dataSource","_itemTmpl","editTemplate","_editTmpl","selectable","autoBind","dataBinding","toolbar","find","parent","action","progress","content","dataBound","view","length","append","text","emptyFolder","change","_listViewChange","_dataSource","typeSortOrder","nameSortOrder","schema","sort","_errorHandler","unbind","_error","DataSource","bind","_loadImage","li","dataItem","getByUid","thumbnailUrl","img","alt","urlJoin","hide","prev","remove","end","fadeIn","after","indexOf","_override","Date","getTime","loaded","clearTimeout","_timeout","setTimeout","_outerHeight","viewTop","scrollTop","viewBottom","each","top","bottom","offsetHeight","html","plugin","amd","a1","a2","a3"],"mappings":"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"}