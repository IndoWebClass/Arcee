{"version":3,"file":"kendo.menu.min.js","sources":["kendo.menu.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.menu',[ \"./kendo.popup\", \"./kendo.data\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"menu\",\n    name: \"Menu\",\n    category: \"web\",\n    description: \"The Menu widget displays hierarchical data as a multi-level menu.\",\n    depends: [ \"popup\", \"data\", \"data.odata\" ]\n};\n\n(function ($, undefined) {\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        activeElement = kendo._activeElement,\n        touch = (kendo.support.touch && kendo.support.mobileOS),\n        isArray = Array.isArray,\n        HierarchicalDataSource = kendo.data.HierarchicalDataSource,\n        MOUSEDOWN = \"mousedown\",\n        CLICK = \"click\",\n        DELAY = 30,\n        SCROLLSPEED = 50,\n        extend = $.extend,\n        proxy = $.proxy,\n        each = $.each,\n        template = kendo.template,\n        keys = kendo.keys,\n        Widget = ui.Widget,\n        excludedNodesRegExp = /^(ul|a|div)$/i,\n        NS = \".kendoMenu\",\n        IMG = \"img\",\n        OPEN = \"open\",\n        MENU = \"k-menu\",\n        LINK = \"k-link k-menu-link\",\n        LINK_SELECTOR = \".k-link\",\n        ICON_SELECTOR = \".k-menu-expand-arrow-icon\",\n        LAST = \"k-last\",\n        CLOSE = \"close\",\n        TIMER = \"timer\",\n        FIRST = \"k-first\",\n        IMAGE = \"k-image\",\n        SELECT = \"select\",\n        ZINDEX = \"zIndex\",\n        ACTIVATE = \"activate\",\n        DEACTIVATE = \"deactivate\",\n        POINTERDOWN = \"touchstart\" + NS + \" MSPointerDown\" + NS + \" pointerdown\" + NS,\n        pointers = kendo.support.pointers,\n        msPointers = kendo.support.msPointers,\n        allPointers = msPointers || pointers,\n        CHANGE = \"change\",\n        ERROR = \"error\",\n        TOUCHSTART = kendo.support.touch ? \"touchstart\" : \"\",\n        MOUSEENTER = pointers ? \"pointerover\" : (msPointers ? \"MSPointerOver\" : \"mouseenter\"),\n        MOUSELEAVE = pointers ? \"pointerout\" : (msPointers ? \"MSPointerOut\" : \"mouseleave\"),\n        MOUSEWHEEL = \"DOMMouseScroll\" + NS + \" mousewheel\" + NS,\n        RESIZE = kendo.support.resize + NS,\n        SCROLLWIDTH = \"scrollWidth\",\n        SCROLLHEIGHT = \"scrollHeight\",\n        OFFSETWIDTH = \"offsetWidth\",\n        OFFSETHEIGHT = \"offsetHeight\",\n        POPUP_ID_ATTR = \"group\",\n        POPUP_OPENER_ATTR = \"groupparent\",\n        DOCUMENT_ELEMENT = $(document.documentElement),\n        KENDOPOPUP = \"kendoPopup\",\n        HOVERSTATE = \"k-hover\",\n        FOCUSEDSTATE = \"k-focus\",\n        DISABLEDSTATE = \"k-disabled\",\n        SELECTEDSTATE = \"k-selected\",\n        menuSelector = \".k-menu\",\n        groupSelector = \".k-menu-group\",\n        animationContainerSelector = \".k-animation-container\",\n        popupSelector = groupSelector + \",\" + animationContainerSelector,\n        allItemsSelector = \":not(.k-list) > .k-item:not([role='treeitem'])\",\n        disabledSelector = \".k-item.k-disabled\",\n        itemSelector = \".k-item\",\n        availableItemsSelector = \".k-item:not(.k-disabled)\",\n        linkSelector = \".k-item:not(.k-disabled) > .k-link\",\n        exclusionSelector = \":not(.k-item.k-separator)\",\n        templateSelector = \"div:not(.k-animation-container,.k-list-container)\",\n        scrollButtonSelector = \".k-menu-scroll-button\",\n        touchPointerTypes = { \"2\": 1, \"touch\": 1 },\n        STRING = \"string\",\n        DATABOUND = \"dataBound\",\n        ARIA_EXPANDED = \"aria-expanded\",\n\n        bindings = {\n            text: \"dataTextField\",\n            url: \"dataUrlField\",\n            spriteCssClass: \"dataSpriteCssClassField\",\n            imageUrl: \"dataImageUrlField\",\n            imageAttr: \"dataImageAttrField\",\n            content: \"dataContentField\"\n        },\n\n        rendering = {\n            wrapperCssClass: function(group, item) {\n                var result = \"k-item k-menu-item\",\n                    index = item.index;\n\n                if (item.enabled === false) {\n                    result += \" k-disabled\";\n                }\n\n                if (group.firstLevel && index === 0) {\n                    result += \" k-first\";\n                }\n\n                if (index == group.length - 1) {\n                    result += \" k-last\";\n                }\n\n                if (item.cssClass) {\n                    result += \" \" + item.cssClass;\n                }\n\n                if (item.attr && item.attr.hasOwnProperty(\"class\")) {\n                    result += \" \" + item.attr[\"class\"];\n                }\n\n                if (item.selected) {\n                    result += \" \" + SELECTEDSTATE;\n                }\n\n                return result;\n            },\n\n            itemCssAttributes: function (item) {\n                var result = \"\";\n                var attributes = item.attr || {};\n\n                for (var attr in attributes) {\n                    if(attributes.hasOwnProperty(attr) && attr !== \"class\") {\n                        result += attr + \"=\\\"\" + attributes[attr] + \"\\\" \";\n                    }\n                }\n\n                return result;\n            },\n\n            imageCssAttributes: function (imgAttributes) {\n                var result = \"\";\n                var attributes = imgAttributes && imgAttributes.toJSON ? imgAttributes.toJSON() : {};\n\n                if (!attributes['class']) {\n                    attributes['class'] = IMAGE;\n                } else {\n                    attributes['class'] += \" \" + IMAGE;\n                }\n\n                for (var attr in attributes) {\n                    if(attributes.hasOwnProperty(attr)) {\n                        result += attr + \"=\\\"\" + attributes[attr] + \"\\\" \";\n                    }\n                }\n\n                return result;\n            },\n\n            contentCssAttributes: function (item) {\n                var result = \"\";\n                var attributes = item.contentAttr || {};\n                var defaultClasses = \"k-content k-group k-menu-group k-menu-group-md\";\n\n                if (!attributes['class']) {\n                    attributes['class'] = defaultClasses;\n                } else {\n                    attributes['class'] += \" \" + defaultClasses;\n                }\n\n                for (var attr in attributes) {\n                    if(attributes.hasOwnProperty(attr)) {\n                        result += attr + \"=\\\"\" + attributes[attr] + \"\\\" \";\n                    }\n                }\n\n                return result;\n            },\n\n            textClass: function() {\n                return LINK;\n            },\n\n            arrowClass: function(item, group) {\n                var result = \"k-menu-expand-arrow-icon k-icon\";\n\n                if (group.horizontal) {\n                    result += \" k-i-arrow-s\";\n                } else {\n                    result += \" k-i-arrow-e\";\n                }\n\n                return result;\n            },\n\n            groupAttributes: function(group) {\n                return group.expanded !== true ? \" style='display:none'\" : \"\";\n            },\n\n            groupCssClass: function() {\n                return \"k-group k-menu-group k-menu-group-md\";\n            },\n\n            content: function(item) {\n                return item.content ? item.content : \"&nbsp;\";\n            }\n    };\n\n    function getEffectDirection(direction, root) {\n        direction = direction.split(\" \")[!root+0] || direction;\n        return direction.replace(\"top\", \"up\").replace(\"bottom\", \"down\");\n    }\n\n    function parseDirection(direction, root, isRtl) {\n        direction = direction.split(\" \")[!root+0] || direction;\n        var output = { origin: [\"bottom\", (isRtl ? \"right\" : \"left\")], position: [\"top\", (isRtl ? \"right\" : \"left\")] },\n            horizontal = /left|right/.test(direction);\n\n        if (horizontal) {\n            output.origin = [ \"top\", direction ];\n            output.position[1] = kendo.directions[direction].reverse;\n        } else {\n            output.origin[0] = direction;\n            output.position[0] = kendo.directions[direction].reverse;\n        }\n\n        output.origin = output.origin.join(\" \");\n        output.position = output.position.join(\" \");\n\n        return output;\n    }\n\n    function contains(parent, child) {\n        try {\n            return $.contains(parent, child);\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function updateItemClasses(item) {\n        item = $(item);\n        var omitWrap = item.attr(kendo.attr(\"omit-wrap\"));\n\n        if (omitWrap) {\n            return;\n        }\n\n        item.addClass(\"k-item k-menu-item\")\n            .children(IMG)\n            .addClass(IMAGE);\n\n        item\n            .children(\"a\")\n            .addClass(LINK)\n            .children(IMG)\n            .addClass(IMAGE);\n\n        item\n            .filter(\":not([disabled])\");\n\n        item\n            .filter(\".k-separator\")\n            .removeClass(\"k-menu-item\")\n            .addClass(\"k-menu-separator\")\n            .empty()\n            .append(\"&nbsp;\");\n\n        item\n            .filter(\"li[disabled]\")\n            .addClass(DISABLEDSTATE)\n            .prop(\"disabled\", false)\n            .attr(\"aria-disabled\", true);\n\n        if (!item.filter(\"[role]\").length) {\n            item.attr(\"role\", \"menuitem\");\n        }\n\n        if (!item.children(LINK_SELECTOR).length) {\n            item.contents()      // exclude groups, real links, templates and empty text nodes\n                .filter(function() { return (!this.nodeName.match(excludedNodesRegExp) && !(this.nodeType === 3 && !kendo.trim(this.nodeValue))); })\n                .wrapAll(\"<span class='\" + LINK + \"'></span>\")\n                .filter(function(idx, elm) { return elm.nodeType === 3; })\n                .wrap(\"<span class='k-menu-link-text'></span>\");\n        }\n\n        updateArrow(item);\n        updateFirstLast(item);\n    }\n\n    function updateArrow(item) {\n        item = $(item);\n\n        item.find(\"> .k-link > .k-menu-expand-arrow > [class*=k-i-arrow]:not(.k-sprite)\").parent().remove();\n\n        item.filter(\":has(.k-menu-group)\")\n            .children(\".k-link:not(:has([class*=k-i-arrow]:not(.k-sprite)))\")\n            .each(function () {\n                var item = $(this),\n                    arrowCssClass = getArrowCssClass(item);\n\n                item.append(\"<span class='k-menu-expand-arrow'><span class='k-menu-expand-arrow-icon k-icon \" + arrowCssClass + \"'></span></span>\");\n            });\n    }\n\n    function getArrowCssClass(item) {\n        var arrowCssClass,\n            parent = item.parent().parent(),\n            isRtl = kendo.support.isRtl(parent);\n\n        if (parent.hasClass(MENU + \"-horizontal\")) {\n            arrowCssClass = \"k-i-arrow-s\";\n        } else {\n            if (isRtl) {\n                arrowCssClass = \"k-i-arrow-w\";\n            }\n            else {\n                arrowCssClass = \"k-i-arrow-e\";\n            }\n        }\n        return arrowCssClass;\n    }\n\n    function updateFirstLast (item) {\n        item = $(item);\n\n        item.filter(\".k-first:not(:first-child)\").removeClass(FIRST);\n        item.filter(\".k-last:not(:last-child)\").removeClass(LAST);\n        item.filter(\":first-child\").addClass(FIRST);\n        item.filter(\":last-child\").addClass(LAST);\n    }\n\n    function updateHasAriaPopup (parents) {\n        if (parents && parents.length) {\n            for (var index in parents) {\n                var parentLi = parents.eq(index);\n                if (parentLi.find(\"ul\").length) {\n                    parentLi.attr(\"aria-haspopup\", true);\n                } else {\n                    parentLi.removeAttr(\"aria-haspopup\");\n                }\n            }\n        }\n    }\n\n    function getParentLiItems(group) {\n        if (!group.hasClass(MENU)) {\n            return group.parentsUntil(\".\" + MENU, \"li\");\n        }\n    }\n\n    function storeItemSelectEventHandler (element, options) {\n        var selectHandler = getItemSelectEventHandler(options);\n        if(selectHandler) {\n            setItemData(element, selectHandler);\n        }\n\n        if (options.items) {\n            $(element).children(\"ul\").children(\"li\").each(function(i){\n                storeItemSelectEventHandler(this, options.items[i]);\n            });\n        }\n    }\n\n    function setItemData (element, selectHandler) {\n        $(element).children(\".k-link\").data({\n            selectHandler : selectHandler\n        });\n    }\n\n    function getItemSelectEventHandler (options) {\n        var selectHandler = options.select,\n            isFunction = kendo.isFunction;\n\n        if (selectHandler && isFunction(selectHandler)) {\n            return selectHandler;\n        }\n        return null;\n    }\n\n    function popupOpenerSelector(id){\n        return id ? \"li[data-groupparent='\" + id + \"']\" : \"li[data-groupparent]\";\n    }\n    function popupGroupSelector(id) {\n        var selector = id ? \"[data-group='\" + id + \"']\" : \"[data-group]\";\n        return \"ul\" + selector + \",div\" + selector;\n    }\n    function getChildPopups (currentPopup, overflowWrapper) {\n        var childPopupOpener = currentPopup.find(popupOpenerSelector());\n        var result = [];\n        childPopupOpener.each(function(i, opener){\n            opener = $(opener);\n            var popupId = opener.data(POPUP_OPENER_ATTR);\n            var popup = currentPopup;\n            while(popupId) {\n                popup = overflowWrapper.find(popupGroupSelector(popupId) + \":visible\");\n                if (popup.length) {\n                    result.push(popup);\n                }\n                opener = popup.find(popupOpenerSelector());\n                popupId = opener.data(POPUP_OPENER_ATTR);\n            }\n        });\n\n        return result;\n    }\n\n    function popupParentItem(popupElement, overflowWrapper) {\n        var popupId = popupElement.data(POPUP_ID_ATTR);\n        return popupId ? overflowWrapper.find(popupOpenerSelector(popupId)) : $([]);\n    }\n\n    function itemPopup(item, overflowWrapper) {\n        var popupId = item.data(POPUP_OPENER_ATTR);\n        return popupId ? overflowWrapper.children(animationContainerSelector).children(popupGroupSelector(popupId)) : $([]);\n    }\n\n    function overflowMenuParents(current, overflowWrapper) {\n        var parents = [];\n        var getParents = function(item){\n            while (item.parentNode && !overflowWrapper.is(item.parentNode)) {\n                parents.push(item.parentNode);\n                item = item.parentNode;\n            }\n        };\n        var elem = current[0] || current;\n        getParents(elem);\n        var last = parents[parents.length - 1];\n        while($(last).is(animationContainerSelector)){\n            var popupElement = $(last).children(\"ul\");\n            elem = popupParentItem(popupElement, overflowWrapper)[0];\n            if (!elem) {\n                break;\n            }\n            parents.push(elem);\n            getParents(elem);\n            last = parents[parents.length - 1];\n        }\n        return parents;\n    }\n\n    function mousewheelDelta(e) {\n        var delta = 0;\n\n        if (e.wheelDelta) {\n            delta = -e.wheelDelta / 120;\n            delta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);\n        }\n\n        if (e.detail) {\n            delta = Math.round(e.detail / 3);\n        }\n\n        return delta;\n    }\n\n    function parentsScroll(current, scrollDirection) {\n        var scroll = 0;\n        var parent = current.parentNode;\n        while(parent && !isNaN(parent[scrollDirection])) {\n            scroll += parent[scrollDirection];\n            parent = parent.parentNode;\n        }\n        return scroll;\n    }\n\n    function isPointerTouch(e){\n        return allPointers && e.originalEvent && e.originalEvent.pointerType in touchPointerTypes;\n    }\n\n    function isTouch(e){\n        var ev = e.originalEvent;\n        return touch && /touch/i.test(ev.type || \"\");\n    }\n\n    function removeSpacesBetweenItems(ul){\n        ul.contents().filter(function(){ return this.nodeName != \"LI\"; }).remove();\n    }\n\n    var Menu = kendo.ui.DataBoundWidget.extend({\n        init: function(element, options) {\n            var that = this;\n\n            Widget.fn.init.call(that, element, options);\n\n            element = that.wrapper = that.element;\n            options = that.options;\n            that._accessors();\n            that._templates();\n            that._dataSource();\n\n            that._updateClasses();\n\n            that._animations(options);\n\n            that.nextItemZIndex = 100;\n\n            that._tabindex();\n\n            that._initOverflow(options);\n\n            that._attachMenuEventsHandlers();\n\n            if (options.openOnClick) {\n                that.clicked = false;\n            }\n\n            element.attr(\"role\", \"menubar\");\n\n            if (element[0].id) {\n                that._ariaId = kendo.format(\"{0}_mn_active\", element[0].id);\n            }\n\n            kendo.notify(that);\n        },\n\n        events: [\n            OPEN,\n            CLOSE,\n            ACTIVATE,\n            DEACTIVATE,\n            SELECT,\n            DATABOUND\n        ],\n\n        options: {\n            name: \"Menu\",\n            animation: {\n                open: {\n                    duration: 200\n                },\n                close: { // if close animation effects are defined, they will be used instead of open.reverse\n                    duration: 100\n                }\n            },\n            orientation: \"horizontal\",\n            direction: \"default\",\n            openOnClick: false,\n            closeOnClick: true,\n            hoverDelay: 100,\n            scrollable: false,\n            popupCollision: undefined\n        },\n\n        _initData: function() {\n            var that = this;\n\n            if (that.dataSource) {\n                that.angular(\"cleanup\", function(){\n                    return {\n                        elements: that.element.children()\n                    };\n                });\n                that.element.empty();\n\n                that.append(that.dataSource.view(), that.element);\n                that.angular(\"compile\", function(){\n                    return {\n                        elements: that.element.children()\n                    };\n                });\n            }\n        },\n\n        _attachMenuEventsHandlers: function() {\n            var that = this;\n            var element = that.element;\n            var options = that.options;\n            var overflowWrapper = that._overflowWrapper();\n\n            that._checkActiveProxy = proxy(that._checkActiveElement, that);\n\n            (overflowWrapper || element).on(POINTERDOWN, itemSelector, proxy(that._focusHandler, that))\n                   .on(CLICK + NS, disabledSelector, false)\n                   .on(CLICK + NS, itemSelector, proxy(that._click , that))\n                   .on(POINTERDOWN + \" \" + MOUSEDOWN + NS, \".k-content\", proxy(that._preventClose, that))\n                   .on(MOUSEENTER + NS, availableItemsSelector, proxy(that._mouseenter, that))\n                   .on(MOUSELEAVE + NS, availableItemsSelector, proxy(that._mouseleave, that))\n                   .on(MOUSEDOWN + NS, availableItemsSelector, proxy(that._mousedown, that))\n                   .on(TOUCHSTART + NS + \" \" + MOUSEENTER + NS + \" \" + MOUSELEAVE + NS + \" \" +\n                       MOUSEDOWN + NS + \" \" + CLICK + NS, linkSelector, proxy(that._toggleHover, that));\n\n            element.on(\"keydown\" + NS, proxy(that._keydown, that))\n                   .on(\"focus\" + NS, proxy(that._focus, that))\n                   .on(\"focus\" + NS, \".k-content\", proxy(that._focus, that))\n                   .on(\"blur\" + NS, proxy(that._removeHoverItem, that))\n                   .on(\"blur\" + NS, \"[tabindex]\", that._checkActiveProxy);\n\n            if (overflowWrapper) {\n                overflowWrapper\n                    .on(MOUSELEAVE + NS, popupSelector, proxy(that._mouseleavePopup, that))\n                    .on(MOUSEENTER + NS, popupSelector, proxy(that._mouseenterPopup, that));\n            }\n\n            if (options.openOnClick) {\n                that._documentClickHandler = proxy(that._documentClick, that);\n                $(document).on(\"click\", that._documentClickHandler);\n            }\n        },\n\n        _detachMenuEventsHandlers: function() {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n\n            if (overflowWrapper) {\n                overflowWrapper.off(NS);\n            }\n\n            that.element.off(NS);\n\n            if (that._documentClickHandler) {\n                $(document).off(\"click\", that._documentClickHandler);\n            }\n        },\n\n        _initOverflow: function(options) {\n            var that = this;\n            var isHorizontal = options.orientation == \"horizontal\";\n            var backwardBtn, forwardBtn;\n\n            if (options.scrollable) {\n                that._openedPopups = {};\n                that._scrollWrapper = that.element.wrap(\"<div class='k-menu-scroll-wrapper \" + options.orientation + \"'></div>\").parent();\n                if (isHorizontal) {\n                    removeSpacesBetweenItems(that.element);\n                }\n\n                backwardBtn = $(that.templates.scrollButton({direction: isHorizontal ? \"left\" : \"up\"}));\n                forwardBtn = $(that.templates.scrollButton({direction: isHorizontal ? \"right\": \"down\"}));\n                backwardBtn.add(forwardBtn).appendTo(that._scrollWrapper);\n\n                that._initScrolling(that.element, backwardBtn, forwardBtn, isHorizontal);\n\n                var initialWidth = that.element.outerWidth();\n                var initialCssWidth = that.element[0].style.width;\n                initialCssWidth = initialCssWidth === \"auto\" ? \"\" : initialCssWidth;\n\n                if (isHorizontal) {\n                    $(window).on(RESIZE, function() {\n                        setTimeout(function(){\n                            that._setOverflowWrapperWidth(initialWidth, initialCssWidth);\n                            that._toggleScrollButtons(that.element, backwardBtn, forwardBtn, isHorizontal);\n                        }, 300);\n                    });\n                }\n\n                that._setOverflowWrapperWidth(initialWidth, initialCssWidth);\n                that._toggleScrollButtons(that.element, backwardBtn, forwardBtn, isHorizontal);\n            }\n        },\n\n        _overflowWrapper: function(){\n            return this._scrollWrapper || this._popupsWrapper;\n        },\n\n        _setOverflowWrapperWidth: function(initialWidth, initialCssWidth) {\n            var that = this;\n            var wrapperCssWidth = that._scrollWrapper.css(\"width\");\n\n            that._scrollWrapper.css({width: \"\"});\n            var wrapperWidth = that._scrollWrapper.outerWidth();\n            that._scrollWrapper.css({ width: wrapperCssWidth });\n\n            var menuWidth = that.element.outerWidth();\n            var borders = that.element[0].offsetWidth - that.element[0].clientWidth;\n\n            if (menuWidth != wrapperWidth && wrapperWidth > 0) {\n                var width = initialCssWidth ? Math.min(initialWidth, wrapperWidth) : wrapperWidth;\n                that.element.width(width - borders);\n                that._scrollWrapper.width(width);\n            }\n        },\n\n        _reinitOverflow: function(options) {\n            var that = this;\n            var overflowChanged = ((options.scrollable && !that.options.scrollable) || (!options.scrollable && that.options.scrollable)) ||\n                (options.scrollable && that.options.scrollable && options.scrollable.distance != that.options.scrollable.distance) ||\n                options.orientation != that.options.orientation;\n\n            if (overflowChanged) {\n                that._detachMenuEventsHandlers();\n                that._destroyOverflow();\n                that._initOverflow(options);\n                that._attachMenuEventsHandlers();\n            }\n        },\n\n        _destroyOverflow: function() {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n            if(overflowWrapper) {\n                overflowWrapper.off(NS);\n                overflowWrapper.find(scrollButtonSelector).off(NS).remove();\n                overflowWrapper.children(animationContainerSelector).each(function(i, popupWrapper){\n                    var ul = $(popupWrapper).children(groupSelector);\n                    ul.off(MOUSEWHEEL);\n                    var popupParentLi = popupParentItem(ul, overflowWrapper);\n                    if (popupParentLi.length) {\n                        popupParentLi.append(popupWrapper);\n                    }\n                });\n\n                overflowWrapper.find(popupOpenerSelector()).removeAttr(\"data-groupparent\");\n                overflowWrapper.find(popupGroupSelector()).removeAttr(\"data-group\");\n                that.element.off(MOUSEWHEEL);\n                $(window).off(RESIZE);\n                overflowWrapper.contents().unwrap();\n\n                that._scrollWrapper = that._popupsWrapper = that._openedPopups = undefined;\n            }\n        },\n\n        _initScrolling: function(scrollElement, backwardBtn, forwardBtn, isHorizontal) {\n            var that = this;\n            var scrollable = that.options.scrollable;\n            var distance =  that.isNumeric(scrollable.distance) ? scrollable.distance : SCROLLSPEED;\n            var mouseWheelDistance = distance / 2;\n            var backward = \"-=\" + distance;\n            var forward = \"+=\" + distance;\n            var backwardDouble = \"-=\" + distance * 2;\n            var forwardDouble = \"+=\" + distance * 2;\n            var scrolling = false;\n            var touchEvents = false;\n\n            var scroll = function(value) {\n                var scrollValue = isHorizontal ? {\"scrollLeft\": value} : { \"scrollTop\": value };\n                scrollElement.finish().animate(scrollValue, \"fast\", \"linear\", function () {\n                    if (scrolling) {\n                        scroll(value);\n                    }\n                });\n                that._toggleScrollButtons(scrollElement, backwardBtn, forwardBtn, isHorizontal);\n            };\n\n            var mouseenterHandler = function(e) {\n                if (!scrolling && !touchEvents) {\n                    scroll(e.data.direction);\n                    scrolling = true;\n                }\n            };\n\n            var mousedownHandler = function(e) {\n                var scrollValue = isHorizontal ? {\"scrollLeft\": e.data.direction} : { \"scrollTop\": e.data.direction };\n                touchEvents = isTouch(e) || isPointerTouch(e);\n                scrollElement.stop().animate(scrollValue, \"fast\", \"linear\", function(){\n                    if (!touchEvents) {\n                        $(e.currentTarget).trigger(MOUSEENTER);\n                    } else {\n                         that._toggleScrollButtons(scrollElement, backwardBtn, forwardBtn, isHorizontal);\n                         scrolling = true;\n                    }\n                });\n                scrolling = false;\n\n                e.stopPropagation();\n                e.preventDefault();\n            };\n\n            backwardBtn.on(MOUSEENTER + NS, {direction: backward}, mouseenterHandler)\n                .on(kendo.eventMap.down + NS, {direction: backwardDouble}, mousedownHandler);\n\n            forwardBtn.on(MOUSEENTER + NS, {direction: forward}, mouseenterHandler)\n                .on(kendo.eventMap.down + NS, {direction: forwardDouble}, mousedownHandler);\n\n            backwardBtn.add(forwardBtn)\n                .on(MOUSELEAVE + NS, function() {\n                    scrollElement.stop();\n                    scrolling = false;\n                    that._toggleScrollButtons(scrollElement, backwardBtn, forwardBtn, isHorizontal);\n                });\n\n            scrollElement.on(MOUSEWHEEL, function(e){\n                if (!e.ctrlKey && !e.shiftKey && !e.altKey) {\n                    var wheelDelta = mousewheelDelta(e.originalEvent);\n                    var scrollSpeed = Math.abs(wheelDelta) * mouseWheelDistance;\n                    var value = (wheelDelta > 0 ? \"+=\" : \"-=\") + scrollSpeed;\n                    var scrollValue = isHorizontal ? {\"scrollLeft\": value} : {\"scrollTop\": value };\n\n                    that._closeChildPopups(scrollElement);\n\n                    scrollElement.finish().animate(scrollValue, \"fast\", \"linear\", function(){\n                        that._toggleScrollButtons(scrollElement, backwardBtn, forwardBtn, isHorizontal);\n                    });\n                    e.preventDefault();\n                }\n            });\n        },\n\n        isNumeric: function(n) {\n            return !isNaN(parseFloat(n)) && isFinite(n);\n        },\n\n        _toggleScrollButtons: function(scrollElement, backwardBtn, forwardBtn, horizontal) {\n            var currentScroll = horizontal ? kendo.scrollLeft(scrollElement) : scrollElement.scrollTop();\n            var scrollSize = horizontal ? SCROLLWIDTH : SCROLLHEIGHT;\n            var offset = horizontal ? OFFSETWIDTH : OFFSETHEIGHT;\n\n            backwardBtn.toggle(currentScroll !== 0);\n            forwardBtn.toggle(currentScroll < scrollElement[0][scrollSize] - scrollElement[0][offset] - 1);\n        },\n\n        setOptions: function(options) {\n            var animation = this.options.animation;\n\n            this._animations(options);\n\n            options.animation = extend(true, animation, options.animation);\n\n            if (\"dataSource\" in options) {\n                this._dataSource(options);\n            }\n\n            this._updateClasses();\n            this._reinitOverflow(options);\n\n            Widget.fn.setOptions.call(this, options);\n        },\n\n        destroy: function() {\n            var that = this;\n\n            Widget.fn.destroy.call(that);\n\n            that._detachMenuEventsHandlers();\n\n            that._destroyOverflow();\n\n            kendo.destroy(that.element);\n        },\n\n        enable: function (element, enable) {\n            this._toggleDisabled(element, enable !== false);\n\n            return this;\n        },\n\n        disable: function (element) {\n            this._toggleDisabled(element, false);\n\n            return this;\n        },\n\n        attemptGetItem: function (candidate) {\n            candidate = candidate || this.element;\n            var item = this.element.find(candidate);\n            var overflowWrapper = this._overflowWrapper();\n\n            if (item.length || candidate === this.element){\n                return item;\n            } else if (overflowWrapper) {\n                return overflowWrapper.find(candidate);\n            } else {\n                return $();\n            }\n        },\n\n        append: function (item, referenceItem) {\n            referenceItem = this.attemptGetItem(referenceItem);\n\n            var inserted = this._insert(item, referenceItem, referenceItem.length ? this._childPopupElement(referenceItem) : null);\n\n            each(inserted.items, function (i) {\n                inserted.group.append(this);\n                updateArrow(this);\n                storeItemSelectEventHandler(this, item[i] || item);\n            });\n\n            updateArrow(referenceItem);\n            updateFirstLast(inserted.group.find(\".k-first, .k-last\").add(inserted.items));\n            updateHasAriaPopup(getParentLiItems(inserted.group));\n\n            return this;\n        },\n\n        insertBefore: function (item, referenceItem) {\n            referenceItem = this.attemptGetItem(referenceItem);\n\n            var inserted = this._insert(item, referenceItem, referenceItem.parent());\n\n            each(inserted.items, function (i) {\n                referenceItem.before(this);\n                updateArrow(this);\n                updateFirstLast(this);\n                storeItemSelectEventHandler(this, item[i] || item);\n            });\n\n            updateFirstLast(referenceItem);\n\n            return this;\n        },\n\n        insertAfter: function (item, referenceItem) {\n            referenceItem = this.attemptGetItem(referenceItem);\n\n            var inserted = this._insert(item, referenceItem, referenceItem.parent());\n\n            each(inserted.items, function (i) {\n                referenceItem.after(this);\n                updateArrow(this);\n                updateFirstLast(this);\n                storeItemSelectEventHandler(this, item[i] || item);\n            });\n\n            updateFirstLast(referenceItem);\n\n            return this;\n        },\n\n        _insert: function (item, referenceItem, parent) {\n            var that = this,\n                items, groups;\n\n            if (!referenceItem || !referenceItem.length) {\n                parent = that.element;\n            }\n\n            var plain = $.isPlainObject(item) || item instanceof kendo.data.ObservableObject,\n                groupData = {\n                    firstLevel: parent.hasClass(MENU),\n                    horizontal: parent.hasClass(MENU + \"-horizontal\"),\n                    expanded: true,\n                    length: parent.children().length\n                };\n\n            if (referenceItem && !parent.length) {\n                parent = $(that.renderGroup({ group: groupData, options: that.options })).appendTo(referenceItem);\n            }\n\n            if (plain || isArray(item) || item instanceof kendo.data.ObservableArray) { // is JSON\n                items = $($.map(plain ? [ item ] : item, function (value, idx) {\n                            if (typeof value === \"string\") {\n                                return $(value).get();\n                            } else {\n                                return $(that.renderItem({\n                                    group: groupData,\n                                    item: extend(value, { index: idx })\n                                })).get();\n                            }\n                        }));\n            } else {\n                if (typeof item == \"string\" && item.charAt(0) != \"<\") {\n                    items = that.element.find(item);\n                } else {\n                    items = $(item);\n                }\n\n                groups = items.find(\"> ul\")\n                                .addClass(\"k-menu-group k-menu-group-md\")\n                                .attr(\"role\", \"menu\");\n\n                items = items.filter(\"li\");\n\n                items.add(groups.find(\"> li\")).each(function () {\n                    updateItemClasses(this);\n                });\n            }\n\n            return { items: items, group: parent };\n        },\n\n        remove: function (element) {\n            element = this.attemptGetItem(element);\n\n            var that = this,\n                parent = element.parentsUntil(that.element, allItemsSelector),\n                group = element.parent(\"ul:not(.k-menu)\");\n\n            element.remove();\n\n            if (group && !group.children(allItemsSelector).length) {\n                var parentItems = getParentLiItems(group);\n\n                var container = group.parent(animationContainerSelector);\n\n                if (container.length) {\n                    container.remove();\n                } else {\n                    group.remove();\n                }\n\n                updateHasAriaPopup(parentItems);\n            }\n\n            if (parent.length) {\n                parent = parent.eq(0);\n\n                updateArrow(parent);\n                updateFirstLast(parent);\n            }\n\n            return that;\n        },\n\n        _openAfterLoad: function (element, dataItem) {\n            var that = this;\n            if(dataItem.loaded()) {\n                that.open(element);\n                that._loading = false;\n            } else {\n                dataItem.one(CHANGE, function(){\n                    element.find(ICON_SELECTOR).removeClass(\"k-i-loading\");\n                    if(that._loading) {\n                        that.open(element);\n                        that._loading = false;\n                    }\n                });\n            }\n        },\n\n        open: function (element) {\n            var that = this;\n            var options = that.options;\n            var horizontal = options.orientation == \"horizontal\";\n            var direction = options.direction;\n            var isRtl = kendo.support.isRtl(that.wrapper);\n            var overflowWrapper = that._overflowWrapper();\n            element = (overflowWrapper || that.element).find(element);\n\n            var dataItem = that.dataSource && that.dataSource.getByUid(element.data(kendo.ns + \"uid\"));\n\n            if(dataItem && dataItem.hasChildren && !dataItem.loaded() && !that._loading){\n                that._loading = true;\n                element.find(ICON_SELECTOR).addClass(\"k-i-loading\");\n                dataItem.load();\n                that._openAfterLoad(element, dataItem);\n                return;\n            }\n\n            if (/^(top|bottom|default)$/.test(direction)) {\n                if (isRtl) {\n                    direction = horizontal ? (direction + \" left\").replace(\"default\", \"bottom\") : \"left\";\n                } else {\n                    direction = horizontal ? (direction + \" right\").replace(\"default\", \"bottom\") : \"right\";\n                }\n            }\n\n            var visiblePopups = \">.k-popup:visible,>.k-animation-container>.k-popup:visible\";\n            var closePopup = function () {\n                var popup = $(this).data(KENDOPOPUP);\n                if (popup) {\n                    // Use the built-in close method to play the hoverDelay from the options\n                    that.close($(this).closest(\"li.k-item\"), true);\n                }\n            };\n\n            element.siblings()\n                   .find(visiblePopups)\n                   .each(closePopup);\n\n            if (overflowWrapper) {\n                element.find(visiblePopups).each(closePopup);\n            }\n\n            if (that.options.openOnClick) {\n                that.clicked = true;\n            }\n\n            element.each(function () {\n                var li = $(this);\n\n                clearTimeout(li.data(TIMER));\n\n                li.data(TIMER, setTimeout(function () {\n                    var ul = li.find(\"> .k-menu-group, > .k-animation-container > .k-menu-group\").filter(\":hidden\").first();\n                    var popup;\n                    var overflowPopup;\n\n                    if  (!ul[0] && overflowWrapper) {\n                        overflowPopup = that._getPopup(li);\n                        ul = overflowPopup && overflowPopup.element;\n                    }\n                    if (ul.is(\":visible\")) {\n                        return;\n                    }\n\n                    if (ul[0] && that._triggerEvent({ item: li[0], type: OPEN }) === false) {\n\n                        if (!ul.find(\".k-menu-group\")[0] && ul.children(\".k-item\").length > 1) {\n                            var windowHeight = $(window).height(),\n                                setScrolling = function(){\n                                    ul.css({maxHeight: windowHeight - (kendo._outerHeight(ul) - ul.height()) - kendo.getShadows(ul).bottom, overflow: \"auto\"});\n                                };\n\n                            setScrolling();\n                        } else {\n                            ul.css({maxHeight: \"\", overflow: \"\"});\n                        }\n\n                        li.data(ZINDEX, li.css(ZINDEX));\n                        var nextZindex = that.nextItemZIndex++;\n                        li.css(ZINDEX, nextZindex);\n\n                        if (that.options.scrollable) {\n                            li.parent().siblings(scrollButtonSelector).css({zIndex: ++nextZindex});\n                        }\n\n                        popup = ul.data(KENDOPOPUP);\n                        var root = li.parent().hasClass(MENU),\n                            parentHorizontal = root && horizontal,\n                            directions = parseDirection(direction, root, isRtl),\n                            effects = options.animation.open.effects,\n                            openEffects = effects !== undefined ? effects : \"slideIn:\" + getEffectDirection(direction, root);\n\n                        if (!popup) {\n                            popup = ul.kendoPopup({\n                                activate: function() { that._triggerEvent({ item: this.wrapper.parent(), type: ACTIVATE }); },\n                                deactivate: function(e) {\n                                    that._closing = false;\n                                    e.sender.element // Restore opacity after fade.\n                                        .removeData(\"targetTransform\")\n                                        .css({ opacity: \"\" });\n                                    that._triggerEvent({ item: this.wrapper.parent(), type: DEACTIVATE });\n                                },\n                                origin: directions.origin,\n                                position: directions.position,\n                                collision: options.popupCollision !== undefined ? options.popupCollision : (parentHorizontal ? \"fit\" : \"fit flip\"),\n                                anchor: li,\n                                appendTo: overflowWrapper || li,\n                                animation: {\n                                    open: extend(true, { effects: openEffects }, options.animation.open),\n                                    close: options.animation.close\n                                },\n                                open: proxy(that._popupOpen, that),\n                                close: function (e) {\n                                    that._closing = e.sender.element;\n                                    var li = e.sender.wrapper.parent();\n\n                                    if (overflowWrapper) {\n                                        var popupId = e.sender.element.data(POPUP_ID_ATTR);\n                                        if (popupId) {\n                                            li = (overflowWrapper || that.element).find(popupOpenerSelector(popupId));\n                                        }\n                                        e.sender.wrapper.children(scrollButtonSelector).hide();\n                                    }\n\n                                    if (!that._triggerEvent({ item: li[0], type: CLOSE })) {\n                                        li.css(ZINDEX, li.data(ZINDEX));\n                                        li.removeData(ZINDEX);\n\n                                        if (that.options.scrollable) {\n                                            li.parent().siblings(scrollButtonSelector).css({zIndex: \"\"});\n                                        }\n\n                                        if (touch || allPointers || kendo.support.mouseAndTouchPresent) {\n                                            li.removeClass(HOVERSTATE);\n                                            that._removeHoverItem();\n                                        }\n                                    } else {\n                                        e.preventDefault();\n                                    }\n                                }\n                            }).data(KENDOPOPUP);\n                        } else {\n                            popup = ul.data(KENDOPOPUP);\n                            popup.options.origin = directions.origin;\n                            popup.options.position = directions.position;\n                            popup.options.animation.open.effects = openEffects;\n                        }\n                        ul.removeAttr(\"aria-hidden\");\n                        li.attr(ARIA_EXPANDED, true);\n\n                        that._configurePopupOverflow(popup, li);\n\n                        popup._hovered = true;\n                        popup.open();\n\n                        that._initPopupScrolling(popup);\n                    }\n\n                }, that.options.hoverDelay));\n            });\n\n            return that;\n        },\n\n        _configurePopupOverflow: function(popup, popupOpener) {\n            var that = this;\n           if (that.options.scrollable) {\n                that._wrapPopupElement(popup);\n                if (!popupOpener.attr(\"data-groupparent\")) {\n                    var groupId = new Date().getTime();\n                    popupOpener.attr(\"data-groupparent\", groupId);\n                    popup.element.attr(\"data-group\", groupId);\n                }\n           }\n        },\n\n        _wrapPopupElement: function(popup){\n            if (!popup.element.parent().is(animationContainerSelector)) {\n                popup.wrapper = kendo.wrap(popup.element, popup.options.autosize)\n                    .css({\n                        overflow: \"hidden\",\n                        display: \"block\",\n                        position: \"absolute\"\n                    });\n            }\n        },\n\n        _initPopupScrolling: function(popup, isHorizontal, skipMouseEvents) {\n            var that = this;\n\n            if (that.options.scrollable && popup.element[0].scrollHeight > popup.element[0].offsetHeight) {\n                that._initPopupScrollButtons(popup, isHorizontal, skipMouseEvents);\n            }\n        },\n\n        _initPopupScrollButtons: function(popup, isHorizontal, skipMouseEvents) {\n            var that = this;\n            var scrollButtons = popup.wrapper.children(scrollButtonSelector);\n            var animation = that.options.animation;\n            var timeout = ((animation && animation.open && animation.open.duration) || 0) + DELAY;\n            setTimeout(function() {\n                if (!scrollButtons.length) {\n                    var backwardBtn = $(that.templates.scrollButton({direction: isHorizontal ? \"left\" : \"up\"}));\n                    var forwardBtn = $(that.templates.scrollButton({direction: isHorizontal ? \"right\": \"down\"}));\n\n                    scrollButtons = backwardBtn.add(forwardBtn).appendTo(popup.wrapper);\n\n                    that._initScrolling(popup.element, backwardBtn, forwardBtn, isHorizontal);\n                    if (!skipMouseEvents) {\n                        scrollButtons.on(MOUSEENTER + NS, function() {\n                            var overflowWrapper = that._overflowWrapper();\n                            $(getChildPopups(popup.element, overflowWrapper)).each(function(i, p){\n                                var popupOpener = overflowWrapper.find(popupOpenerSelector(p.data(POPUP_ID_ATTR)));\n                                that.close(popupOpener);\n                            });\n                        })\n                        .on(MOUSELEAVE + NS, function(){\n                            setTimeout(function(){\n                                if ($.isEmptyObject(that._openedPopups)) {\n                                    that._closeParentPopups(popup.element);\n                                }\n                            }, DELAY);\n                        });\n                    }\n                }\n                that._toggleScrollButtons(popup.element, scrollButtons.first(), scrollButtons.last(), isHorizontal);\n            }, timeout);\n        },\n\n        _popupOpen: function(e) {\n            if (!this._keyTriggered) {\n                e.sender.element.children(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n            }\n            if (this.options.scrollable) {\n                this._setPopupHeight(e.sender);\n            }\n        },\n\n        _setPopupHeight: function(popup, isFixed){\n            var popupElement = popup.element;\n            var popups = popupElement.add(popupElement.parent(animationContainerSelector));\n\n            popups.height((popupElement.hasClass(MENU) && this._initialHeight) || \"\");\n\n            var location = popup._location(isFixed);\n            var windowHeight = $(window).height();\n            var popupOuterHeight = location.height;\n            var popupOffsetTop = isFixed ? 0 : Math.max(location.top, 0);\n            var scrollTop = isFixed ? 0 : parentsScroll(this._overflowWrapper()[0], \"scrollTop\");\n            var bottomScrollbar = window.innerHeight - windowHeight;\n            var maxHeight = windowHeight - kendo.getShadows(popupElement).bottom + bottomScrollbar;\n            var canFit = maxHeight + scrollTop > popupOuterHeight + popupOffsetTop;\n\n            if (!canFit) {\n                var height = Math.min(maxHeight, maxHeight - popupOffsetTop + scrollTop);\n                popups.css({overflow: \"hidden\", height: height + \"px\"});\n            }\n        },\n\n        close: function (items, dontClearClose) {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n            var element = (overflowWrapper || that.element);\n\n            items = element.find(items);\n\n            if (!items.length) {\n                items = element.find(\">.k-item\");\n            }\n\n            var hasChildPopupsHovered = function(currentPopup){\n                var result = false;\n                if ($.isEmptyObject(that._openedPopups)) {\n                    return result;\n                }\n                $(getChildPopups(currentPopup, overflowWrapper)).each(function(i, popup){\n                    result = !!that._openedPopups[popup.data(POPUP_ID_ATTR).toString()];\n                    return !result;\n                });\n                return result;\n            };\n\n            var isPopupMouseLeaved = function(opener) {\n                var groupId = opener.data(POPUP_OPENER_ATTR);\n                return (!overflowWrapper || !groupId || !that._openedPopups[groupId.toString()]);\n            };\n\n            items.each(function () {\n                var li = $(this);\n\n                li.attr(ARIA_EXPANDED, false);\n\n                if (!dontClearClose && that._isRootItem(li)) {\n                    that.clicked = false;\n                }\n\n                clearTimeout(li.data(TIMER));\n\n                li.data(TIMER, setTimeout(function () {\n                    var popup = that._getPopup(li);\n                    if (popup && (isPopupMouseLeaved(li) || that._forceClose)) {\n                        if (!that._forceClose && hasChildPopupsHovered(popup.element)) {\n                            return;\n                        }\n\n                        popup.close();\n                        popup.element.attr(\"aria-hidden\", true);\n\n                        if (overflowWrapper) {\n                            if (that._forceClose && items.last().is(li[0])) {\n                                delete that._forceClose;\n                            }\n                        }\n                    }\n                }, that.options.hoverDelay));\n            });\n\n            return that;\n        },\n\n        _getPopup: function(li) {\n            var that = this;\n            var popup = li.find(\".k-menu-group:not(.k-list-container):not(.k-calendar-container):visible\").first().data(KENDOPOPUP);\n            var overflowWrapper = that._overflowWrapper();\n\n            if (!popup && overflowWrapper) {\n                var groupId = li.data(POPUP_OPENER_ATTR);\n                if (groupId) {\n                    var popupElement = overflowWrapper.find(popupGroupSelector(groupId));\n                    popup = popupElement.data(KENDOPOPUP);\n                }\n            }\n            return popup;\n        },\n\n        _toggleDisabled: function (items, enable) {\n            this.element.find(items).each(function () {\n                $(this)\n                    .toggleClass(DISABLEDSTATE, !enable)\n                    .attr(\"aria-disabled\", !enable);\n            });\n        },\n\n        _toggleHover: function(e) {\n            var target = $(kendo.eventTarget(e) || e.target).closest(allItemsSelector),\n                isEnter = e.type == MOUSEENTER || MOUSEDOWN.indexOf(e.type) !== -1;\n\n            target.siblings().removeClass(HOVERSTATE);\n\n            if (!target.parents(\"li.\" + DISABLEDSTATE).length) {\n                target.toggleClass(HOVERSTATE, isEnter || e.type == \"mousedown\" || e.type == \"pointerover\" || e.type == TOUCHSTART);\n            }\n\n            this._removeHoverItem();\n        },\n\n        _preventClose: function() {\n            if (!this.options.closeOnClick) {\n                this._closurePrevented = true;\n            }\n        },\n\n        _checkActiveElement: function(e) {\n            var that = this,\n                hoverItem = $(e ? e.currentTarget : this._hoverItem()),\n                target = that._findRootParent(hoverItem)[0];\n\n            if (!this._closurePrevented) {\n                setTimeout(function() {\n                    if (!document.hasFocus() || (!contains(target, kendo._activeElement()) && e && !contains(target, e.currentTarget))) {\n                        that.close(target);\n                    }\n                }, 0);\n            }\n\n            this._closurePrevented = false;\n        },\n\n        _removeHoverItem: function() {\n            var oldHoverItem = this._hoverItem();\n\n            if (oldHoverItem && oldHoverItem.hasClass(FOCUSEDSTATE)) {\n                oldHoverItem.removeClass(FOCUSEDSTATE);\n                this._oldHoverItem = null;\n            }\n        },\n\n        _updateClasses: function() {\n            var element = this.element,\n                nonContentGroupsSelector = \".k-menu-init div ul\",\n                items;\n\n            element.removeClass(\"k-menu-horizontal k-menu-vertical\");\n            element.addClass(\"k-widget k-reset k-menu-init \" + MENU).addClass(MENU + \"-\" + this.options.orientation);\n\n            if(this.options.orientation === \"vertical\") {\n                element.attr(\"aria-orientation\", \"vertical\");\n            } else {\n                element.attr(\"aria-orientation\", \"horizontal\");\n            }\n\n            element.find(\"li > ul\")\n                   .filter(function() {\n                       return !kendo.support.matchesSelector.call(this, nonContentGroupsSelector);\n                   })\n                   .addClass(\"k-group k-menu-group k-menu-group-md\")\n                   .attr(\"role\", \"menu\")\n                   .hide()\n                   .attr(\"aria-hidden\", element.is(\":visible\"))\n                   .parent(\"li\")\n                   .attr(\"aria-haspopup\", \"true\")\n                   .end()\n                   .find(\"li > div\")\n                   .addClass(\"k-content\")\n                   .attr(\"tabindex\", \"-1\"); // Capture the focus before the Menu\n\n            element.find(\"li[aria-haspopup]\").attr(ARIA_EXPANDED, false);\n\n            items = element.find(\"> li,.k-menu-group > li\");\n\n            element.removeClass(\"k-menu-init\");\n\n            items.each(function () {\n                updateItemClasses(this);\n            });\n        },\n\n        _mouseenter: function (e) {\n            var that = this;\n            var element = $(e.currentTarget);\n            var hasChildren = that._itemHasChildren(element);\n            var popupId = element.data(POPUP_OPENER_ATTR) || element.parent().data(POPUP_ID_ATTR);\n            var pointerTouch = isPointerTouch(e);\n            var isParentClosing = false;\n\n            if (popupId) {\n                that._openedPopups[popupId.toString()] = true;\n            }\n\n            if(that._closing) {\n                isParentClosing = !!that._closing.find(element).length;\n            }\n\n            if (isParentClosing || (e.delegateTarget != element.parents(menuSelector)[0] && e.delegateTarget != element.parents(\".k-menu-scroll-wrapper,.k-popups-wrapper\")[0])) {\n                return;\n            }\n\n            that._keyTriggered = false;\n\n            if ((that.options.openOnClick.rootMenuItems && that._isRootItem(element.closest(allItemsSelector))) ||\n                (that.options.openOnClick.subMenuItems && !that._isRootItem(element.closest(allItemsSelector)))) {\n                return;\n            }\n\n            if ((that.options.openOnClick === false ||\n                (that.options.openOnClick.rootMenuItems === false && that._isRootItem(element.closest(allItemsSelector))) ||\n                (that.options.openOnClick.subMenuItems === false && !that._isRootItem(element.closest(allItemsSelector))) || that.clicked) && !touch &&\n                !(pointerTouch && that._isRootItem(element.closest(allItemsSelector)))) {\n\n                if (!contains(e.currentTarget, e.relatedTarget) && hasChildren) {\n                    that.open(element);\n                }\n            }\n\n            if (that.options.openOnClick === true && that.clicked || touch) {\n                element.siblings().each(proxy(function (_, sibling) {\n                    that.close(sibling, true);\n                }, that));\n            }\n        },\n\n        _mousedown: function (e) {\n            var that = this;\n            var element = $(e.currentTarget);\n            // needs to close subMenuItems\n            if (that.options.openOnClick.subMenuItems && !that._isRootItem(element) || touch) {\n                element.siblings().each(proxy(function (_, sibling) {\n                    that.close(sibling, true);\n                }, that));\n            }\n        },\n\n        _mouseleave: function (e) {\n            var that = this;\n            var element = $(e.currentTarget);\n            var popupOpener = element.data(POPUP_OPENER_ATTR);\n            var hasChildren = (element.children(animationContainerSelector).length || element.children(groupSelector).length) || popupOpener;\n            var $window = $(window);\n\n            if (popupOpener) {\n                delete that._openedPopups[popupOpener.toString()];\n            }\n\n            if (element.parentsUntil(animationContainerSelector, \".k-list-container,.k-calendar-container\")[0]) {\n                e.stopImmediatePropagation();\n                return;\n            }\n\n            if ((that.options.openOnClick === false || (!that.options.openOnClick.rootMenuItems && that._isRootItem(element)) ||\n                (!that.options.openOnClick.subMenuItems && !that._isRootItem(element))) && !touch && !isPointerTouch(e) &&\n                !contains(e.currentTarget, e.relatedTarget || e.target) && hasChildren &&\n                !contains(e.currentTarget, kendo._activeElement())) {\n                    that.close(element, true);\n                    that._loading = false;\n                    return;\n            }\n\n            // Detect if cursor goes outside the viewport of the browser\n            if( (kendo.support.browser.msie && !e.toElement && !e.relatedTarget && !isPointerTouch(e)) ||\n                e.clientX < 0 || e.clientY < 0 ||\n                e.clientY > $window.height() ||\n                e.clientX > $window.width()){\n                that.close(element);\n            }\n        },\n\n        _mouseenterPopup: function(e){\n            var that = this;\n            var popupElement = $(e.currentTarget);\n\n            if (popupElement.parent().is(animationContainerSelector)) {\n                 return;\n            }\n\n            popupElement = popupElement.children(\"ul\");\n            var popupId = popupElement.data(POPUP_ID_ATTR);\n\n            if (popupId) {\n                that._openedPopups[popupId.toString()] = true;\n            }\n        },\n\n        _mouseleavePopup: function (e) {\n            var that = this;\n            var popupElement = $(e.currentTarget);\n\n            if (!isPointerTouch(e) && popupElement.is(animationContainerSelector)) {\n                that._closePopups(popupElement.children(\"ul\"));\n            }\n        },\n\n        _closePopups: function(rootPopup) {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n            var popupId = rootPopup.data(POPUP_ID_ATTR);\n\n            if (popupId) {\n                delete that._openedPopups[popupId.toString()];\n                var groupParent = overflowWrapper.find(popupOpenerSelector(popupId));\n\n                setTimeout(function() {\n                    if (that.options.openOnClick) {\n                        that._closeChildPopups(rootPopup);\n                    } else {\n                        if ($.isEmptyObject(that._openedPopups)) {\n                            var innerPopup = that._innerPopup(rootPopup);\n                            that._closeParentPopups(innerPopup);\n                        } else {\n                            that.close(groupParent, true);\n                        }\n                    }\n                }, 0);\n            }\n        },\n\n        _closeChildPopups: function(current){\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n            $(getChildPopups(current, overflowWrapper)).each(function(){\n                var popupOpener = overflowWrapper.find(popupOpenerSelector(this.data(POPUP_ID_ATTR)));\n                that.close(popupOpener, true);\n            });\n        },\n\n        _innerPopup: function(current) {\n            var overflowWrapper = this._overflowWrapper();\n            var popups = getChildPopups(current, overflowWrapper);\n            return popups[popups.length - 1] || current;\n        },\n\n        _closeParentPopups: function (current) {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n            var popupId = current.data(POPUP_ID_ATTR);\n            var popupOpener = overflowWrapper.find(popupOpenerSelector(popupId));\n            popupId = popupOpener.parent().data(POPUP_ID_ATTR);\n            that.close(popupOpener, true);\n            while (popupId && !that._openedPopups[popupId]) {\n                if (popupOpener.parent().is(menuSelector)) {\n                    break;\n                }\n                popupOpener = overflowWrapper.find(popupOpenerSelector(popupId));\n                that.close(popupOpener, true);\n                popupId = popupOpener.parent().data(POPUP_ID_ATTR);\n            }\n        },\n\n        _click: function (e) {\n            var that = this, openHandle,\n                options = that.options,\n                target = $(kendo.eventTarget(e)),\n                targetElement = target[0],\n                nodeName = target[0] ? target[0].nodeName.toUpperCase() : \"\",\n                formNode = (nodeName == \"INPUT\" || nodeName == \"SELECT\" || nodeName == \"BUTTON\" || nodeName == \"LABEL\"),\n                link = target.closest(LINK_SELECTOR),\n                element = target.closest(allItemsSelector),\n                itemElement = element[0],\n                href = link.attr(\"href\"), childGroup, childGroupVisible,\n                targetHref = target.attr(\"href\"),\n                sampleHref = $(\"<a href='#' />\").attr(\"href\"),\n                isLink = (!!href && href !== sampleHref),\n                isLocalLink = isLink && !!href.match(/^#/),\n                isTargetLink = (!!targetHref && targetHref !== sampleHref),\n                overflowWrapper = that._overflowWrapper(),\n                shouldCloseTheRootItem;\n\n            if(targetElement && (!targetElement.parentNode || !itemElement)){\n                return;\n            }\n\n            if($(target).hasClass('k-menu-expand-arrow-icon')){\n                this._lastClickedElement = itemElement;\n            }\n\n            while (targetElement && targetElement.parentNode != itemElement) {\n                targetElement = targetElement.parentNode;\n            }\n\n            if ($(targetElement).is(templateSelector)) {\n                return;\n            }\n\n            if (element.hasClass(DISABLEDSTATE)) {\n                e.preventDefault();\n                return;\n            }\n\n            if (!e.handled && that._triggerSelect(target, itemElement) && !formNode) { // We shouldn't stop propagation and shoudn't prevent form elements.\n                e.preventDefault();\n            }\n\n            e.handled = true;\n\n            childGroup = element.children(popupSelector);\n            if (overflowWrapper) {\n                var childPopupId = element.data(POPUP_OPENER_ATTR);\n                if (childPopupId) {\n                    childGroup = overflowWrapper.find(popupGroupSelector(childPopupId));\n                }\n            }\n            childGroupVisible = childGroup.is(\":visible\");\n            shouldCloseTheRootItem = options.openOnClick && childGroupVisible && that._isRootItem(element);\n\n            if (options.closeOnClick && (!isLink || isLocalLink) && (!childGroup.length || shouldCloseTheRootItem)) {\n                element.removeClass(HOVERSTATE).css(\"height\"); // Force refresh for Chrome\n                that._oldHoverItem = that._findRootParent(element);\n                var item = that._parentsUntil(link, that.element, allItemsSelector);\n                that._forceClose = !!overflowWrapper;\n                that.close(item);\n                that.clicked = false;\n                if (\"MSPointerUp\".indexOf(e.type) != -1) {\n                    e.preventDefault();\n                }\n                return;\n            }\n\n            if (isLink && e.enterKey) {\n                link[0].click();\n            }\n\n            if (((!that._isRootItem(element) || options.openOnClick === false) && !options.openOnClick.subMenuItems) && !kendo.support.touch && !(isPointerTouch(e) && that._isRootItem(element.closest(allItemsSelector)))) {\n                return;\n            }\n\n            if (!isLink && !formNode && !isTargetLink) {\n                e.preventDefault();\n            }\n\n            that.clicked = true;\n            openHandle = childGroup.is(\":visible\") ? CLOSE : OPEN;\n            if (!options.closeOnClick && openHandle == CLOSE) {\n                return;\n            }\n            that[openHandle](element);\n        },\n\n        _parentsUntil: function(context, top, selector) {\n            var overflowWrapper = this._overflowWrapper();\n            if (!overflowWrapper) {\n                return context.parentsUntil(top, selector);\n            } else {\n                var parents = overflowMenuParents(context, overflowWrapper);\n                var result = [];\n                $(parents).each(function(){\n                    var parent = $(this);\n                    if (parent.is(top)) {\n                        return false;\n                    }\n                    if (parent.is(selector)) {\n                        result.push(this);\n                    }\n                });\n                return $(result);\n            }\n        },\n\n        _triggerSelect: function (target, itemElement) {\n            target = target.is(\".k-link\") ? target : target.closest(\".k-link\");\n\n            var selectHandler = target.data(\"selectHandler\"),\n                itemSelectEventData;\n\n            if (selectHandler) {\n                itemSelectEventData = this._getEventData(target);\n                selectHandler.call(this, itemSelectEventData);\n            }\n\n            var isSelectItemDefaultPrevented = itemSelectEventData && itemSelectEventData.isDefaultPrevented();\n            var isSelectDefaultPrevented = this._triggerEvent({ item: itemElement, type: SELECT });\n            return isSelectItemDefaultPrevented || isSelectDefaultPrevented;\n        },\n\n        _getEventData: function (target) {\n            var eventData = {\n                sender: this,\n                target: target,\n                _defaultPrevented: false,\n                preventDefault: function () {\n                    this._defaultPrevented = true;\n                },\n                isDefaultPrevented: function () {\n                    return this._defaultPrevented;\n                }\n            };\n            return eventData;\n        },\n\n        _documentClick: function (e) {\n            var that = this;\n            var target = $(e.target).hasClass('k-menu-expand-arrow-icon') ? that._lastClickedElement : e.target;\n\n            if (contains((that._overflowWrapper() || that.element)[0], target)) {\n                that._lastClickedElement = undefined;\n                return;\n            }\n\n            that.clicked = false;\n        },\n\n        _focus: function (e) {\n            var that = this,\n                target = e.target,\n                hoverItem = that._hoverItem(),\n                active = activeElement();\n\n            if (target != that.wrapper[0] && !$(target).is(\":kendoFocusable\")) {\n                e.stopPropagation();\n                $(target).closest(\".k-content\").closest(\".k-menu-group\").closest(\".k-item\").addClass(FOCUSEDSTATE);\n                that.wrapper.trigger(\"focus\");\n                return;\n            }\n\n            if (active === e.currentTarget) {\n                if (hoverItem.length) {\n                    that._moveHover([], hoverItem);\n                } else if (!that._oldHoverItem) {\n                    that._moveHover([], that.wrapper.children().first());\n                }\n            }\n        },\n\n        _keydown: function (e) {\n            var that = this,\n                key = e.keyCode,\n                hoverItem = that._oldHoverItem,\n                target,\n                belongsToVertical,\n                hasChildren,\n                isRtl = kendo.support.isRtl(that.wrapper);\n\n            if (e.target != e.currentTarget && key != keys.ESC) {\n                return;\n            }\n\n            if (!hoverItem) {\n                hoverItem  = that._oldHoverItem = that._hoverItem();\n            }\n\n            belongsToVertical = that._itemBelongsToVertival(hoverItem);\n            hasChildren = that._itemHasChildren(hoverItem);\n            that._keyTriggered = true;\n\n            if (key == keys.RIGHT) {\n                target = that[isRtl ? \"_itemLeft\" : \"_itemRight\"](hoverItem, belongsToVertical, hasChildren);\n            } else if (key == keys.LEFT) {\n                target = that[isRtl ? \"_itemRight\" : \"_itemLeft\"](hoverItem, belongsToVertical, hasChildren);\n            } else if (key == keys.DOWN) {\n                target = that._itemDown(hoverItem, belongsToVertical, hasChildren);\n            } else if (key == keys.UP) {\n                target = that._itemUp(hoverItem, belongsToVertical, hasChildren);\n            } else if (key == keys.HOME) {\n                that._moveHover(hoverItem, hoverItem.parent().children().first());\n                e.preventDefault();\n            } else if (key == keys.END) {\n                that._moveHover(hoverItem, hoverItem.parent().children().last());\n                e.preventDefault();\n            } else if (key == keys.ESC) {\n                target = that._itemEsc(hoverItem, belongsToVertical);\n            } else if (key == keys.ENTER || key == keys.SPACEBAR) {\n                target = hoverItem.children(\".k-link\");\n                if (target.length > 0) {\n                    that._click({ target: target[0], preventDefault: function () {}, enterKey: true });\n                    if (hasChildren && !hoverItem.hasClass(DISABLEDSTATE)) {\n                        that.open(hoverItem);\n                        that._moveHover(hoverItem, that._childPopupElement(hoverItem).children().first());\n                    } else {\n                        that._moveHoverToRoot(hoverItem, that._findRootParent(hoverItem));\n                    }\n                }\n            } else if (key == keys.TAB) {\n                target = that._findRootParent(hoverItem);\n                that._moveHover(hoverItem, target);\n                that._checkActiveElement();\n                return;\n            }\n\n            if (target && target[0]) {\n                e.preventDefault();\n                e.stopPropagation(); // needed to handle ESC in column menu only when a root item is focused\n            }\n        },\n\n        _hoverItem: function() {\n            return this.wrapper.find(\".k-item.k-hover,.k-item.k-focus\").filter(\":visible\");\n        },\n\n        _itemBelongsToVertival: function (item) {\n            var menuIsVertical = this.wrapper.hasClass(\"k-menu-vertical\");\n\n            if (!item.length) {\n                return menuIsVertical;\n            }\n            return item.parent().hasClass(\"k-menu-group\") || menuIsVertical;\n        },\n\n        _itemHasChildren: function (item) {\n            if (!item || !item.length || !item[0].nodeType) {\n                return false;\n            }\n            return item.children(\".k-menu-group, div.k-animation-container\").length > 0 ||\n                (!!item.data(POPUP_OPENER_ATTR) && !!this._overflowWrapper().children(popupGroupSelector(item.data(POPUP_OPENER_ATTR))));\n        },\n\n        _moveHover: function (item, nextItem) {\n            var that = this,\n                id = that._ariaId;\n\n            if (item.length && nextItem.length) {\n                item.removeClass(FOCUSEDSTATE);\n            }\n\n            if (nextItem.length) {\n                if (nextItem[0].id) {\n                    id = nextItem[0].id;\n                }\n\n                nextItem.addClass(FOCUSEDSTATE);\n                that._oldHoverItem = nextItem;\n\n                if (id) {\n                    that.element.removeAttr(\"aria-activedescendant\");\n                    $(\"#\" + id).removeAttr(\"id\");\n                    nextItem.attr(\"id\", id);\n                    that.element.attr(\"aria-activedescendant\", id);\n                }\n                that._scrollToItem(nextItem);\n            }\n        },\n\n        _moveHoverToRoot: function (item, nextItem) {\n            this._moveHover(item, nextItem);\n        },\n\n        _findRootParent: function (item) {\n            if (this._isRootItem(item)) {\n                return item;\n            } else {\n                return this._parentsUntil(item, menuSelector, \"li.k-item\").last();\n            }\n        },\n\n        _isRootItem: function (item) {\n            return item.parent().hasClass(MENU);\n        },\n\n        _itemRight: function (item, belongsToVertical, hasChildren) {\n            var that = this,\n                nextItem,\n                parentItem,\n                overflowWrapper;\n\n            if (!belongsToVertical) {\n                nextItem = item.nextAll(itemSelector + exclusionSelector).eq(0);\n                if (!nextItem.length) {\n                    nextItem = item.prevAll(itemSelector + exclusionSelector).last();\n                }\n                that.close(item);\n            } else if (hasChildren && !item.hasClass(DISABLEDSTATE)) {\n                that.open(item);\n                nextItem = that._childPopupElement(item).children().first();\n            } else if (that.options.orientation == \"horizontal\") {\n                parentItem = that._findRootParent(item);\n                overflowWrapper = that._overflowWrapper();\n                if (overflowWrapper) {\n                    var rootPopup = itemPopup(parentItem, overflowWrapper);\n                    that._closeChildPopups(rootPopup);\n                }\n                that.close(parentItem);\n                nextItem = parentItem.nextAll(itemSelector + exclusionSelector).eq(0);\n            }\n\n            if (nextItem && !nextItem.length) {\n                nextItem = that.wrapper.children(\".k-item\").first();\n            } else if (!nextItem) {\n                nextItem = [];\n            }\n\n            that._moveHover(item, nextItem);\n            return nextItem;\n        },\n\n        _itemLeft: function (item, belongsToVertical) {\n            var that = this,\n                nextItem,\n                overflowWrapper;\n\n            if (!belongsToVertical) {\n                nextItem = item.prevAll(itemSelector + exclusionSelector).eq(0);\n                if (!nextItem.length) {\n                    nextItem = item.nextAll(itemSelector + exclusionSelector).last();\n                }\n                that.close(item);\n            } else {\n                nextItem = item.parent().closest(\".k-item\");\n                overflowWrapper = that._overflowWrapper();\n                if (!nextItem.length && overflowWrapper) {\n                    nextItem = popupParentItem(item.parent(), overflowWrapper);\n                }\n                that.close(nextItem);\n                if (that._isRootItem(nextItem) && that.options.orientation == \"horizontal\") {\n                    nextItem = nextItem.prevAll(itemSelector + exclusionSelector).eq(0);\n                }\n            }\n\n            if (!nextItem.length) {\n                nextItem = that.wrapper.children(\".k-item\").last();\n            }\n\n            that._moveHover(item, nextItem);\n            return nextItem;\n        },\n\n        _itemDown: function (item, belongsToVertical, hasChildren) {\n            var that = this,\n                nextItem;\n\n            if (!belongsToVertical) {\n                if (!hasChildren || item.hasClass(DISABLEDSTATE)) {\n                    return;\n                } else {\n                    that.open(item);\n                    nextItem = that._childPopupElement(item).children().first();\n                }\n            } else {\n                nextItem = item.nextAll(itemSelector + exclusionSelector).eq(0);\n            }\n\n            if (!nextItem.length && item.length) {\n                nextItem = item.parent().children().first();\n            } else if (!item.length) {\n                nextItem = that.wrapper.children(\".k-item\").first();\n            }\n\n            that._moveHover(item, nextItem);\n            return nextItem;\n        },\n\n        _itemUp: function (item, belongsToVertical) {\n            var that = this,\n                nextItem;\n\n            if (!belongsToVertical) {\n                return;\n            } else {\n                nextItem = item.prevAll(itemSelector + exclusionSelector).eq(0);\n            }\n\n            if (!nextItem.length && item.length) {\n                nextItem = item.parent().children().last();\n            } else if (!item.length) {\n                nextItem = that.wrapper.children(\".k-item\").last();\n            }\n\n            that._moveHover(item, nextItem);\n            return nextItem;\n        },\n\n        _scrollToItem: function(item){\n            var that = this;\n            if (that.options.scrollable && item && item.length) {\n                var ul = item.parent();\n                var isHorizontal = ul.hasClass(MENU) ? that.options.orientation == \"horizontal\" : false;\n                var scrollDir = isHorizontal ? \"scrollLeft\" : \"scrollTop\";\n                var getSize = isHorizontal ? kendo._outerWidth : kendo._outerHeight;\n                var currentScrollOffset = ul[scrollDir]();\n                var itemSize = getSize(item);\n                var itemOffset = item[0][isHorizontal ? \"offsetLeft\" : \"offsetTop\"];\n                var ulSize = getSize(ul);\n                var scrollButtons = ul.siblings(scrollButtonSelector);\n                var scrollButtonSize = scrollButtons.length ? getSize(scrollButtons.first()) : 0;\n                var itemPosition;\n\n                if (currentScrollOffset + ulSize < itemOffset + itemSize + scrollButtonSize) {\n                    itemPosition = itemOffset + itemSize - ulSize + scrollButtonSize;\n                } else if (currentScrollOffset > itemOffset - scrollButtonSize) {\n                    itemPosition = itemOffset - scrollButtonSize;\n                }\n\n                if (!isNaN(itemPosition)) {\n                    var scrolling = {};\n                    scrolling[scrollDir] = itemPosition;\n                    ul.finish().animate(scrolling, \"fast\", \"linear\", function () {\n                        that._toggleScrollButtons(ul, scrollButtons.first(), scrollButtons.last(), isHorizontal);\n                    });\n                }\n            }\n        },\n\n        _itemEsc: function (item, belongsToVertical) {\n            var that = this,\n                nextItem;\n\n            if (!belongsToVertical) {\n                return item;\n            } else {\n                nextItem = item.parent().closest(\".k-item\");\n                that.close(nextItem);\n                that._moveHover(item, nextItem);\n            }\n\n            return nextItem;\n        },\n\n        _childPopupElement: function(item) {\n            var popupElement = item.find(\".k-menu-group\");\n            var wrapper = this._overflowWrapper();\n            if (!popupElement.length && wrapper) {\n                popupElement = itemPopup(item, wrapper);\n            }\n            return popupElement;\n        },\n\n        _triggerEvent: function(e) {\n            var that = this;\n\n            return that.trigger(e.type, { type: e.type, item: e.item });\n        },\n\n        _focusHandler: function (e) {\n            var that = this,\n                item = $(kendo.eventTarget(e)).closest(allItemsSelector);\n\n            if (item.hasClass(DISABLEDSTATE)) {\n                return;\n            }\n\n            setTimeout(function () {\n                that._moveHover([], item);\n                if (item.children(\".k-content\")[0]) {\n                    item.parent().closest(\".k-item\").removeClass(FOCUSEDSTATE);\n                }\n            }, 200);\n        },\n\n        _animations: function(options) {\n            if (options && (\"animation\" in options) && !options.animation) {\n                options.animation = { open: { effects: {} }, close: { hide: true, effects: {} } };\n            }\n        },\n        _dataSource: function(options) {\n            var that = this,\n                dataSource = options ? options.dataSource : that.options.dataSource;\n\n            if (!dataSource) {\n                return;\n            }\n\n            dataSource = isArray(dataSource) ? { data: dataSource } : dataSource;\n\n            that._unbindDataSource();\n\n            if (!dataSource.fields) {\n                dataSource.fields = [\n                    { field: \"uid\" },\n                    { field: \"text\" },\n                    { field: \"url\" },\n                    { field: \"cssClass\" },\n                    { field: \"spriteCssClass\" },\n                    { field: \"imageUrl\" },\n                    { field: \"imageAttr\" },\n                    { field: \"attr\" },\n                    { field: \"contentAttr\" },\n                    { field: \"content\" },\n                    { field: \"encoded\" },\n                    { field: \"items\" },\n                    { field: \"select\" }\n                ];\n            }\n\n            that.dataSource = HierarchicalDataSource.create(dataSource);\n\n            that._bindDataSource();\n\n            that.dataSource.fetch();\n        },\n\n        _bindDataSource: function() {\n            this._refreshHandler = proxy(this.refresh, this);\n            this._errorHandler = proxy(this._error, this);\n\n            this.dataSource.bind(CHANGE, this._refreshHandler);\n            this.dataSource.bind(ERROR, this._errorHandler);\n        },\n\n        _unbindDataSource: function() {\n            var dataSource = this.dataSource;\n\n            if (dataSource) {\n                dataSource.unbind(CHANGE, this._refreshHandler);\n                dataSource.unbind(ERROR, this._errorHandler);\n            }\n        },\n\n        _error: function () {\n\n        },\n\n        findByUid: function (uid) {\n            var wrapperElement = this._overflowWrapper() || this.element;\n            return wrapperElement.find(\"[\" + kendo.attr(\"uid\") + \"=\" + uid + \"]\");\n        },\n\n        refresh: function (ev) {\n            var that = this;\n            var node = ev.node;\n            var action = ev.action;\n            var parentElement = node ? that.findByUid(node.uid) : that.element;\n            var itemsToUpdate = ev.items;\n            var index = ev.index;\n            var updateProxy = $.proxy(that._updateItem, that);\n            var removeProxy = $.proxy(that._removeItem, that);\n\n            if (action == \"add\") {\n                that._appendItems(itemsToUpdate, index, parentElement);\n            } else if (action == \"remove\") {\n                itemsToUpdate.forEach(removeProxy);\n            } else if (action == \"itemchange\") {\n                itemsToUpdate.forEach(updateProxy);\n            } else if (action === \"itemloaded\") {\n                that.append(ev.items, parentElement);\n            } else {\n                this._initData();\n            }\n\n            this.trigger(DATABOUND, { item: parentElement, dataItem: node });\n        },\n\n        _appendItems: function(items, index, parent) {\n            var that = this;\n            var referenceItem = parent.find(itemSelector).eq(index);\n\n            if(referenceItem.length){\n                that.insertBefore(items, referenceItem);\n            } else {\n                that.append(items, parent);\n            }\n        },\n\n        _removeItem: function(item) {\n            var that = this;\n            var element = that.findByUid(item.uid);\n            that.remove(element);\n        },\n\n        _updateItem: function(item) {\n            var that = this;\n            var element = that.findByUid(item.uid);\n            var nextElement = element.next();\n            var parentNode = item.parentNode();\n\n            that.remove(element);\n\n            if(nextElement.length) {\n                that.insertBefore(item, nextElement);\n            } else {\n                that.append(item, parentNode && that.findByUid(parentNode.uid));\n            }\n        },\n\n        _accessors: function() {\n            var that = this,\n                options = that.options,\n                i, field, textField,\n                element = that.element;\n\n            for (i in bindings) {\n                field = options[bindings[i]];\n                textField = element.attr(kendo.attr(i + \"-field\"));\n\n                if (!field && textField) {\n                    field = textField;\n                }\n\n                if (!field) {\n                    field = i;\n                }\n\n                if (!isArray(field)) {\n                    field = [field];\n                }\n\n                options[bindings[i]] = field;\n            }\n        },\n\n        _fieldAccessor: function(fieldName) {\n            var fieldBindings = this.options[bindings[fieldName]] || [],\n                count = fieldBindings.length,\n                result = \"(function(item) {\";\n\n            if (count === 0) {\n                result += \"return item['\" + fieldName + \"'];\";\n            } else {\n                result += \"var levels = [\" +\n                            $.map(fieldBindings, function(x) {\n                                return \"function(d){ return \" + kendo.expr(x) + \"}\";\n                            }).join(\",\") + \"];\";\n                result += \"if(item.level){return levels[Math.min(item.level(), \" + count + \"-1)](item);}else\";\n                result += \"{return levels[\"+ count + \"-1](item)}\";\n            }\n\n            result += \"})\";\n\n            return result;\n        },\n\n        _templates: function () {\n            var that = this,\n                options = that.options,\n                fieldAccessor = proxy(that._fieldAccessor, that);\n\n            if (options.template && typeof options.template == STRING) {\n                    options.template = template(options.template);\n            } else if (!options.template) {\n                    options.template = template(\n                    \"<span class='k-menu-link-text'>\" +\n                    \"# var text = \" + fieldAccessor(\"text\") + \"(data.item); #\" +\n                    \"# if (typeof data.item.encoded != 'undefined' && data.item.encoded === false) {#\" +\n                        \"#= text #\" +\n                    \"# } else { #\" +\n                        \"#: text #\" +\n                    \"# } #</span>\"\n                );\n            }\n\n            that.templates = {\n                content: template(\n                    \"#var contentHtml = \" + fieldAccessor(\"content\") + \"(item);#\" +\n                    \"<div #= contentCssAttributes(item.toJSON ? item.toJSON() : item) # tabindex='-1'>#= contentHtml || '' #</div>\"\n                ),\n                group: template(\n                    \"<ul class='#= groupCssClass(group) #'#= groupAttributes(group) # role='menu' aria-hidden='true'>\" +\n                        \"#= renderItems(data) #\" +\n                    \"</ul>\"\n                ),\n                itemWrapper: template(\n                    \"# var url = \" + fieldAccessor(\"url\") + \"(item); #\" +\n                    \"# var imageUrl = \" + fieldAccessor(\"imageUrl\") + \"(item); #\" +\n                    \"# var imgAttributes = \" + fieldAccessor(\"imageAttr\") + \"(item);#\" +\n                    \"# var tag = url ? 'a' : 'span' #\" +\n                    \"<#= tag # class='#= textClass(item) #' #if(url){#href='#= url #'#}#>\" +\n\n                    \"# if (imageUrl) { #\" +\n                              \"<img #= imageCssAttributes(imgAttributes) #  alt='' src='#= imageUrl #' />\" +\n                    \"# } #\" +\n\n                    \"#= sprite(item) #\" +\n                    \"#= data.menu.options.template(data) #\" +\n                    \"#= arrow(data) #\" +\n                    \"</#= tag #>\"\n                ),\n                item: template(\n                    \"#var contentHtml = \" + fieldAccessor(\"content\") + \"(item);#\" +\n                    \"<li class='#= wrapperCssClass(group, item) #' #= itemCssAttributes(item.toJSON ? item.toJSON() : item) # role='menuitem'  #=item.items ? \\\"aria-haspopup='true'\\\": \\\"\\\"#\" +\n                        \"#=item.enabled === false ? \\\"aria-disabled='true'\\\" : ''#\" +\n                        kendo.attr(\"uid\") + \"='#= item.uid #' \" +\n                        \"# if(item.items && item.items.length > 0) { # \" +\n                            \"# if(item.expanded) { # \" +\n                                \" aria-expanded='true'\" +\n                            \"# } else { #\" +\n                                \" aria-expanded='false'\" +\n                            \"# } #\" +\n                        \"# } #\" +\n                    \">\" +\n                        \"#= itemWrapper(data) #\" +\n                        \"#if (item.hasChildren || item.items) { #\" +\n                            \"#= subGroup({ items: item.items, menu: menu, group: { expanded: item.expanded } }) #\" +\n                        \"# } else if (item.content || item.contentUrl || contentHtml) { #\" +\n                            \"#= renderContent(data) #\" +\n                        \"# } #\" +\n                    \"</li>\"\n                ),\n                scrollButton: template(\n                    \"<span class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-menu-scroll-button k-scroll-#= direction #' unselectable='on'>\" +\n                        \"<span class='k-button-icon k-icon k-i-arrow-60-#= direction #'></span>\" +\n                    \"</span>\"\n                ),\n                arrow: template(\"<span class='k-menu-expand-arrow'><span class='#= arrowClass(item, group) #'></span></span>\"),\n                sprite: template(\"# var spriteCssClass = \" + fieldAccessor(\"spriteCssClass\") + \"(data); if(spriteCssClass) {#<span class='k-sprite #= spriteCssClass #'></span>#}#\"),\n                empty: template(\"\")\n            };\n        },\n\n        renderItem: function (options) {\n            var that = this;\n            options = extend({ menu: that, group: {} }, options);\n\n            var empty = that.templates.empty,\n                item = options.item;\n\n            return that.templates.item(extend(options, {\n                sprite: that.templates.sprite,\n                itemWrapper: that.templates.itemWrapper,\n                renderContent: that.renderContent,\n                arrow: item.items || item.content || item[that.options.dataContentField[0]] ? that.templates.arrow : empty,\n                subGroup: that.renderGroup\n            }, rendering));\n        },\n\n        renderGroup: function (options) {\n            var that = this;\n            var templates = that.templates || options.menu.templates;\n\n            return templates.group(extend({\n                renderItems: function(options) {\n                    var html = \"\",\n                        i = 0,\n                        items = options.items,\n                        len = items ? items.length : 0,\n                        group = extend({ length: len }, options.group);\n\n                    for (; i < len; i++) {\n                        html += options.menu.renderItem(extend(options, {\n                            group: group,\n                            item: extend({ index: i }, items[i])\n                        }));\n                    }\n\n                    return html;\n                }\n            }, options, rendering));\n        },\n\n        renderContent: function (options) {\n            return options.menu.templates.content(extend(options, rendering));\n        }\n    });\n\n    var ContextMenu = Menu.extend({\n        init: function(element, options) {\n            var that = this;\n\n            Menu.fn.init.call(that, element, options);\n\n            that.element.attr(\"role\", \"menu\");\n\n            that._marker = kendo.guid().substring(0, 8);\n\n            that.target = $(that.options.target);\n\n            that._popup();\n            that._wire();\n        },\n\n        _initOverflow: function(options){\n            var that = this;\n            if (options.scrollable && !that._overflowWrapper()) {\n                that._openedPopups = {};\n\n                that._popupsWrapper = (that.element.parent().is(animationContainerSelector) ? that.element.parent() : that.element)\n                    .wrap(\"<div class='k-popups-wrapper \" + options.orientation + \"'></div>\").parent();\n\n                if (that.options.orientation == \"horizontal\") {\n                    removeSpacesBetweenItems(that.element);\n                }\n\n                if (options.appendTo) {\n                    options.appendTo = $(options.appendTo);\n                    options.appendTo.append(that._popupsWrapper);\n                }\n\n                that._initialHeight = that.element[0].style.height;\n                that._initialWidth = that.element[0].style.width;\n            }\n        },\n\n        options: {\n            name: \"ContextMenu\",\n            filter: null,\n            showOn: \"contextmenu\",\n            orientation: \"vertical\",\n            alignToAnchor: false,\n            copyAnchorStyles : true,\n            target: \"body\"\n        },\n\n        events: [\n            OPEN,\n            CLOSE,\n            ACTIVATE,\n            DEACTIVATE,\n            SELECT\n        ],\n\n        setOptions: function(options) {\n            var that = this;\n\n            Menu.fn.setOptions.call(that, options);\n\n            that.target.off(that.showOn + NS + that._marker, that._showProxy);\n\n            if (that.userEvents) {\n                that.userEvents.destroy();\n            }\n\n            that.target = $(that.options.target);\n            if (options.orientation && that.popup.wrapper[0]) {\n                that.popup.element.unwrap();\n            }\n\n            that._wire();\n\n            Menu.fn.setOptions.call(this, options);\n        },\n\n        destroy: function() {\n            var that = this;\n\n            that.target.off(that.options.showOn + NS + that._marker);\n            DOCUMENT_ELEMENT.off(kendo.support.mousedown + NS + that._marker, that._closeProxy);\n\n            if (that.userEvents) {\n                that.userEvents.destroy();\n            }\n\n            Menu.fn.destroy.call(that);\n        },\n\n        open: function(x, y) {\n            var that = this;\n\n            x = $(x)[0];\n\n            if (contains(that.element[0], $(x)[0]) || that._itemHasChildren($(x))) { // call parent open for children elements\n                Menu.fn.open.call(that, x);\n            } else {\n                if (that._triggerEvent({ item: that.element, type: OPEN }) === false) {\n                    if (that.popup.visible() && that.options.filter) {\n                        that.popup.close(true);\n                        that.popup.element.kendoStop(true);\n                    }\n\n                    if (y !== undefined) {\n                        var overflowWrapper = that._overflowWrapper();\n                        if (overflowWrapper) {\n                            var offset = overflowWrapper.offset();\n                            x -= offset.left;\n                            y -= offset.top;\n                        }\n                        that.popup.wrapper.hide();\n                        that._configurePopupScrolling(x, y);\n                        that.popup.open(x, y);\n                    } else {\n                        that.popup.options.anchor = (x ? x : that.popup.anchor) || that.target;\n                        that.popup.element.kendoStop(true);\n                        that._configurePopupScrolling();\n                        that.popup.open();\n                    }\n\n                    DOCUMENT_ELEMENT.off(that.popup.downEvent, that.popup._mousedownProxy);\n                    DOCUMENT_ELEMENT\n                        .on(kendo.support.mousedown + NS + that._marker, that._closeProxy);\n\n                    that.element.trigger(\"focus\");\n                }\n            }\n\n            return that;\n        },\n\n        _configurePopupScrolling: function(x, y){\n            var that = this;\n            var popup = that.popup;\n            var isHorizontal = that.options.orientation == \"horizontal\";\n\n            if (that.options.scrollable) {\n                that._wrapPopupElement(popup);\n\n                popup.element.parent().css({\n                    position: \"\",\n                    height: \"\"\n                });\n\n                popup.element.css({\n                    visibility: \"hidden\",\n                    display: \"\",\n                    position: \"\"\n                });\n\n                if (isHorizontal) {\n                    that._setPopupWidth(popup, isNaN(x) ? undefined : {isFixed: true, x: x, y: y});\n                } else {\n                    that._setPopupHeight(popup, isNaN(x) ? undefined : {isFixed: true, x: x, y: y});\n                }\n\n                popup.element.css({\n                    visibility: \"\",\n                    display: \"none\",\n                    position: \"absolute\"\n                });\n\n                that._initPopupScrollButtons(popup, isHorizontal, true);\n                popup.element.siblings(scrollButtonSelector).hide();\n            }\n        },\n\n        _setPopupWidth: function(popup, isFixed){\n            var popupElement = popup.element;\n            var popups = popupElement.add(popupElement.parent(animationContainerSelector));\n\n            popups.width(this._initialWidth || \"\");\n\n            var location = popup._location(isFixed);\n            var windowWidth = $(window).width();\n            var popupOuterWidth = location.width;\n            var popupOffsetLeft = Math.max(location.left, 0);\n            var scrollLeft = isFixed ? 0 : parentsScroll(this._overflowWrapper()[0], \"scrollLeft\");\n            var shadow = kendo.getShadows(popupElement);\n            var maxWidth = windowWidth - shadow.left - shadow.right;\n            var canFit = maxWidth + scrollLeft > popupOuterWidth + popupOffsetLeft;\n\n            if (!canFit) {\n                popups.css({overflow: \"hidden\", width: (maxWidth - popupOffsetLeft + scrollLeft) + \"px\"});\n            }\n        },\n\n        close: function() {\n            var that = this;\n\n            if (contains(that.element[0], $(arguments[0])[0]) || that._itemHasChildren(arguments[0])) {\n                Menu.fn.close.call(that, arguments[0]);\n            } else {\n                if (that.popup.visible()) {\n                    if (that._triggerEvent({ item: that.element, type: CLOSE }) === false) {\n                        that._removeHoverItem();\n                        that.element.find(\"#\" + that._ariaId).removeAttr(\"id\");\n                        that.popup.close();\n                        DOCUMENT_ELEMENT.off(kendo.support.mousedown + NS + that._marker, that._closeProxy);\n                        that.unbind(SELECT, that._closeTimeoutProxy);\n                        that.popup.options.anchor.focus();\n                    }\n                }\n            }\n        },\n\n        _showHandler: function (e) {\n            var ev = e, offset,\n                that = this,\n                options = that.options,\n                target = kendo.support.mobileOS ? $(ev.target) : $(ev.currentTarget);\n\n            if (e.event) {\n                ev = e.event;\n                ev.pageX = e.x.location;\n                ev.pageY = e.y.location;\n            }\n\n            if (contains(that.element[0], e.relatedTarget || e.target)) {\n                return;\n            }\n\n            that._eventOrigin = ev;\n\n            ev.preventDefault();\n            ev.stopImmediatePropagation();\n\n            that.element.find(\".\" + FOCUSEDSTATE).removeClass(FOCUSEDSTATE);\n\n            if ((options.filter && target.is(options.filter)) || !options.filter) {\n                if (options.alignToAnchor) {\n                    that.popup.options.anchor = ev.currentTarget;\n                    that.open(ev.currentTarget);\n                } else {\n                    that.popup.options.anchor = ev.currentTarget;\n\n                    if (that._targetChild) {\n                        offset = that.target.offset();\n                        that.open(ev.pageX - offset.left, ev.pageY - offset.top);\n                    } else {\n                        that.open(ev.pageX, ev.pageY);\n                    }\n                }\n            }\n        },\n\n        _closeHandler: function (e) {\n            var that = this,\n                target = $(e.relatedTarget || e.target),\n                sameTarget = target.closest(that.target.selector)[0] == that.target[0],\n                item = target.closest(itemSelector),\n                children = that._itemHasChildren(item),\n                overflowWrapper = that._overflowWrapper(),\n                containment = contains(that.element[0], target[0]) || (overflowWrapper && contains(overflowWrapper[0], target[0]));\n\n            that._eventOrigin = e;\n\n            var normalClick = e.which !== 3;\n\n            if (that.popup.visible() && ((normalClick && sameTarget) || !sameTarget) && ((that.options.closeOnClick && !children && containment) || !containment)) {\n                if (containment) {\n                    this.unbind(SELECT, this._closeTimeoutProxy);\n                    that.bind(SELECT, that._closeTimeoutProxy);\n                } else {\n                    that.close();\n                }\n            }\n        },\n\n        _wire: function() {\n            var that = this,\n                options = that.options,\n                target = that.target;\n\n            that._preventProxy = null;\n            that._showProxy = proxy(that._showHandler, that);\n            that._closeProxy = proxy(that._closeHandler, that);\n            that._closeTimeoutProxy = proxy(that.close, that);\n\n            if (target[0]) {\n                if (kendo.support.mobileOS && options.showOn == \"contextmenu\") {\n                    that.userEvents = new kendo.UserEvents(target, {\n                        filter: options.filter,\n                        allowSelection: false\n                    });\n\n                    that._preventProxy = function() { return false; };\n\n                    that.userEvents.bind(\"hold\", that._showProxy);\n                }\n\n                if (options.filter) {\n                    target.on(options.showOn + NS + that._marker, options.filter, that._preventProxy || that._showProxy);\n                } else {\n                    target.on(options.showOn + NS + that._marker, that._preventProxy || that._showProxy);\n                }\n            }\n        },\n\n        _triggerEvent: function(e) {\n            var that = this,\n                anchor = $(that.popup.options.anchor)[0],\n                origin = that._eventOrigin;\n\n            that._eventOrigin = undefined;\n\n            return that.trigger(e.type, extend({ type: e.type, item: e.item || this.element[0], target: anchor }, origin ? { event: origin } : {} ));\n        },\n\n        _popup: function() {\n            var that = this;\n            var overflowWrapper = that._overflowWrapper();\n\n            that._triggerProxy = proxy(that._triggerEvent, that);\n\n            that.popup = that.element\n                            .addClass(\"k-context-menu\")\n                            .kendoPopup({\n                                autosize: that.options.orientation === \"horizontal\",\n                                anchor: that.target || \"body\",\n                                copyAnchorStyles: that.options.copyAnchorStyles,\n                                collision: that.options.popupCollision || \"fit\",\n                                animation: that.options.animation,\n                                activate: that._triggerProxy,\n                                deactivate: that._triggerProxy,\n                                appendTo: overflowWrapper || that.options.appendTo,\n                                close: !overflowWrapper ? $.noop : function(e) {\n                                    $(getChildPopups(e.sender.element, overflowWrapper)).each(function(i, p) {\n                                        var popup = p.data(KENDOPOPUP);\n                                        if (popup) {\n                                            popup.close(true);\n                                        }\n                                    });\n                                }\n                            }).data(KENDOPOPUP);\n\n            that._targetChild = contains(that.target[0], that.popup.element[0]);\n        },\n\n        _moveHoverToRoot: function (item, nextItem) {\n            this._moveHover(item, nextItem);\n            this.close();\n        },\n\n        _focus: function (e) {\n            var hoverItem  = this._oldHoverItem = this._hoverItem() || [];\n\n            Menu.fn._focus.call(this, e);\n\n            if (activeElement() === e.currentTarget) {\n                this._moveHover(hoverItem, this.wrapper.children().first());\n            }\n        }\n    });\n\n    ui.plugin(Menu);\n    ui.plugin(ContextMenu);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","ui","activeElement","_activeElement","touch","support","mobileOS","isArray","Array","HierarchicalDataSource","data","MOUSEDOWN","CLICK","DELAY","SCROLLSPEED","extend","proxy","each","template","keys","Widget","excludedNodesRegExp","NS","IMG","OPEN","MENU","LINK","LINK_SELECTOR","ICON_SELECTOR","LAST","CLOSE","TIMER","FIRST","IMAGE","SELECT","ZINDEX","ACTIVATE","DEACTIVATE","POINTERDOWN","pointers","msPointers","allPointers","CHANGE","ERROR","TOUCHSTART","MOUSEENTER","MOUSELEAVE","MOUSEWHEEL","RESIZE","resize","SCROLLWIDTH","SCROLLHEIGHT","OFFSETWIDTH","OFFSETHEIGHT","POPUP_ID_ATTR","POPUP_OPENER_ATTR","DOCUMENT_ELEMENT","document","documentElement","KENDOPOPUP","HOVERSTATE","FOCUSEDSTATE","DISABLEDSTATE","SELECTEDSTATE","menuSelector","groupSelector","animationContainerSelector","popupSelector","allItemsSelector","disabledSelector","itemSelector","availableItemsSelector","linkSelector","exclusionSelector","templateSelector","scrollButtonSelector","touchPointerTypes","2","STRING","DATABOUND","ARIA_EXPANDED","bindings","text","url","spriteCssClass","imageUrl","imageAttr","content","rendering","wrapperCssClass","group","item","result","index","enabled","firstLevel","length","cssClass","attr","hasOwnProperty","selected","itemCssAttributes","attributes","imageCssAttributes","imgAttributes","toJSON","contentCssAttributes","contentAttr","defaultClasses","textClass","arrowClass","horizontal","groupAttributes","expanded","groupCssClass","getEffectDirection","direction","root","split","replace","parseDirection","isRtl","output","origin","position","test","directions","reverse","join","contains","parent","child","e","updateItemClasses","omitWrap","addClass","children","filter","removeClass","empty","append","prop","contents","this","nodeName","match","nodeType","trim","nodeValue","wrapAll","idx","elm","wrap","updateArrow","updateFirstLast","find","remove","arrowCssClass","getArrowCssClass","hasClass","updateHasAriaPopup","parents","parentLi","eq","removeAttr","getParentLiItems","parentsUntil","storeItemSelectEventHandler","element","options","selectHandler","getItemSelectEventHandler","setItemData","items","i","select","isFunction","popupOpenerSelector","popupGroupSelector","selector","getChildPopups","currentPopup","overflowWrapper","childPopupOpener","opener","popupId","popup","push","popupParentItem","popupElement","itemPopup","overflowMenuParents","current","getParents","parentNode","is","elem","last","mousewheelDelta","delta","wheelDelta","Math","ceil","floor","detail","round","parentsScroll","scrollDirection","scroll","isNaN","isPointerTouch","originalEvent","pointerType","isTouch","ev","type","removeSpacesBetweenItems","ul","Menu","DataBoundWidget","init","that","fn","call","wrapper","_accessors","_templates","_dataSource","_updateClasses","_animations","nextItemZIndex","_tabindex","_initOverflow","_attachMenuEventsHandlers","openOnClick","clicked","_ariaId","format","notify","events","animation","open","duration","close","orientation","closeOnClick","hoverDelay","scrollable","popupCollision","_initData","dataSource","angular","elements","view","_overflowWrapper","_checkActiveProxy","_checkActiveElement","on","_focusHandler","_click","_preventClose","_mouseenter","_mouseleave","_mousedown","_toggleHover","_keydown","_focus","_removeHoverItem","_mouseleavePopup","_mouseenterPopup","_documentClickHandler","_documentClick","_detachMenuEventsHandlers","off","isHorizontal","backwardBtn","forwardBtn","_openedPopups","_scrollWrapper","templates","scrollButton","add","appendTo","_initScrolling","initialWidth","outerWidth","initialCssWidth","style","width","setTimeout","_setOverflowWrapperWidth","_toggleScrollButtons","_popupsWrapper","wrapperCssWidth","css","wrapperWidth","menuWidth","borders","offsetWidth","clientWidth","min","_reinitOverflow","overflowChanged","distance","_destroyOverflow","popupWrapper","popupParentLi","unwrap","scrollElement","isNumeric","mouseWheelDistance","backward","forward","backwardDouble","forwardDouble","scrolling","touchEvents","value","scrollValue","scrollLeft","scrollTop","finish","animate","mouseenterHandler","mousedownHandler","stop","currentTarget","trigger","stopPropagation","preventDefault","eventMap","down","ctrlKey","shiftKey","altKey","scrollSpeed","abs","_closeChildPopups","n","parseFloat","isFinite","currentScroll","scrollSize","offset","toggle","setOptions","destroy","enable","_toggleDisabled","disable","attemptGetItem","candidate","referenceItem","inserted","_insert","_childPopupElement","insertBefore","before","insertAfter","after","groups","plain","isPlainObject","ObservableObject","groupData","renderGroup","ObservableArray","map","get","renderItem","charAt","parentItems","container","_openAfterLoad","dataItem","loaded","_loading","one","getByUid","ns","hasChildren","load","visiblePopups","closePopup","closest","siblings","li","clearTimeout","first","overflowPopup","_getPopup","_triggerEvent","windowHeight","height","setScrolling","maxHeight","_outerHeight","getShadows","bottom","overflow","nextZindex","zIndex","parentHorizontal","effects","openEffects","kendoPopup","activate","deactivate","_closing","sender","removeData","opacity","collision","anchor","_popupOpen","hide","mouseAndTouchPresent","_configurePopupOverflow","_hovered","_initPopupScrolling","popupOpener","_wrapPopupElement","groupId","Date","getTime","autosize","display","skipMouseEvents","scrollHeight","offsetHeight","_initPopupScrollButtons","scrollButtons","timeout","p","isEmptyObject","_closeParentPopups","_keyTriggered","_setPopupHeight","isFixed","popups","_initialHeight","location","_location","popupOuterHeight","popupOffsetTop","max","top","bottomScrollbar","innerHeight","canFit","dontClearClose","hasChildPopupsHovered","toString","isPopupMouseLeaved","_isRootItem","_forceClose","toggleClass","target","eventTarget","isEnter","indexOf","_closurePrevented","hoverItem","_hoverItem","_findRootParent","hasFocus","oldHoverItem","_oldHoverItem","nonContentGroupsSelector","matchesSelector","end","_itemHasChildren","pointerTouch","isParentClosing","delegateTarget","rootMenuItems","subMenuItems","relatedTarget","_","sibling","$window","stopImmediatePropagation","browser","msie","toElement","clientX","clientY","_closePopups","rootPopup","groupParent","innerPopup","_innerPopup","openHandle","targetElement","toUpperCase","formNode","link","itemElement","href","childGroup","childGroupVisible","targetHref","sampleHref","isLink","isLocalLink","isTargetLink","shouldCloseTheRootItem","_lastClickedElement","handled","_triggerSelect","childPopupId","_parentsUntil","enterKey","click","context","itemSelectEventData","_getEventData","isSelectItemDefaultPrevented","isDefaultPrevented","isSelectDefaultPrevented","eventData","_defaultPrevented","active","_moveHover","key","keyCode","belongsToVertical","ESC","_itemBelongsToVertival","RIGHT","LEFT","DOWN","_itemDown","UP","_itemUp","HOME","END","_itemEsc","ENTER","SPACEBAR","_moveHoverToRoot","TAB","menuIsVertical","nextItem","_scrollToItem","_itemRight","parentItem","nextAll","prevAll","_itemLeft","scrollDir","getSize","_outerWidth","currentScrollOffset","itemSize","itemOffset","ulSize","scrollButtonSize","itemPosition","_unbindDataSource","fields","field","create","_bindDataSource","fetch","_refreshHandler","refresh","_errorHandler","_error","bind","unbind","findByUid","uid","wrapperElement","node","action","parentElement","itemsToUpdate","updateProxy","_updateItem","removeProxy","_removeItem","_appendItems","forEach","nextElement","next","textField","_fieldAccessor","fieldName","fieldBindings","count","x","expr","fieldAccessor","itemWrapper","arrow","sprite","menu","renderContent","dataContentField","subGroup","renderItems","html","len","ContextMenu","_marker","guid","substring","_popup","_wire","_initialWidth","showOn","alignToAnchor","copyAnchorStyles","_showProxy","userEvents","mousedown","_closeProxy","y","visible","kendoStop","left","_configurePopupScrolling","downEvent","_mousedownProxy","visibility","_setPopupWidth","windowWidth","popupOuterWidth","popupOffsetLeft","shadow","maxWidth","right","arguments","_closeTimeoutProxy","focus","_showHandler","event","pageX","pageY","_eventOrigin","_targetChild","_closeHandler","sameTarget","containment","normalClick","which","_preventProxy","UserEvents","allowSelection","_triggerProxy","noop","plugin","amd","a1","a2","a3"],"mappings":"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"}