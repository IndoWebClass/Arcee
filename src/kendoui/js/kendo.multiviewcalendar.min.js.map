{"version":3,"file":"kendo.multiviewcalendar.min.js","sources":["kendo.multiviewcalendar.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.multiviewcalendar',[ \"./kendo.core\", \"./kendo.selectable\", \"./kendo.calendar\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"multiviewcalendar\",\n    name: \"MultiViewCalendar\",\n    category: \"web\",\n    description: \"Multi-view calendar.\",\n    depends: [ \"core\", \"selectable\", \"calendar\"  ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        calendar = kendo.calendar,\n        support = kendo.support,\n        isInRange = calendar.isInRange,\n        toDateObject = calendar.toDateObject,\n        createDate = calendar.createDate,\n        isEqualDate = calendar.isEqualDate,\n        getToday = calendar.getToday,\n        keys = kendo.keys,\n        ui = kendo.ui,\n        Widget = ui.Widget,\n        Selectable = ui.Selectable,\n        template = kendo.template,\n        mobileOS = support.mobileOS,\n        ns = \".kendoMultiViewCalendar\",\n        CLICK = \"click\",\n        KEYDOWN = \"keydown\",\n        ID = \"id\",\n        MIN = \"min\",\n        MONTH = \"month\",\n        DOT = \".\",\n        CENTURY = \"century\",\n        DECADE = \"decade\",\n        CHANGE = \"change\",\n        NAVIGATE = \"navigate\",\n        VALUE = \"value\",\n        FOCUSED = \"k-state-focused\",\n        SELECTED = \"k-state-selected\",\n        MID = \"k-range-mid\",\n        SPLITEND = \"k-range-split-end\",\n        SPLITSTART = \"k-range-split-start\",\n        START = \"k-range-start\",\n        END = \"k-range-end\",\n        HOVER = \"k-state-hover\",\n        DISABLED = \"k-state-disabled\",\n        TODAY = \"k-nav-today\",\n        OTHERMONTH = \"k-other-month\",\n        OUTOFRANGE = \"k-out-of-range\",\n        CELLSELECTOR = \"td:has(.k-link):not(.\" + OUTOFRANGE + \")\",\n        CELLSELECTORVALID = \"td:has(.k-link):not(.\" + DISABLED + \"):not(.\" + OUTOFRANGE + \")\",\n        BLUR = \"blur\",\n        FOCUS = \"focus\",\n        MOUSEENTER = support.touch ? \"touchstart\" : \"mouseenter\",\n        MOUSELEAVE_NS = support.touch ? \"touchend\" + ns + \" touchmove\" + ns : \"mouseleave\" + ns,\n        PREVARROW = \"_prevArrow\",\n        NEXTARROW = \"_nextArrow\",\n        ARIA_SELECTED = \"aria-selected\",\n        INPUTSELECTOR = \"input,a,textarea,.k-multiselect-wrap,select,button,.k-button>span,.k-button>img,span.k-icon.k-i-arrow-60-down,span.k-icon.k-i-arrow-60-up\",\n        ARIA_DISABLED = \"aria-disabled\",\n        ARIA_LABEL = \"aria-label\",\n        proxy = $.proxy,\n        DATE = Date,\n        views = {\n            month: 0,\n            year: 1,\n            decade: 2,\n            century: 3\n        };\n\n    var RangeSelectable = Widget.extend({\n        init: function(element, options) {\n            var that = this;\n\n            Widget.fn.init.call(that, element, options);\n\n            that.calendar = options.calendar;\n\n            that.userEvents = new kendo.UserEvents(that.element, {\n                global: true,\n                allowSelection: true,\n                filter: that.options.filter,\n                tap: proxy(that._tap, that),\n                touchAction: \"none\"\n            });\n        },\n\n        events: [CHANGE],\n\n        options: {\n            name: \"RangeSelectable\",\n            filter: \">*\",\n            inputSelectors: INPUTSELECTOR,\n            multiple: false,\n            dragToSelect: true,\n            relatedTarget: $.noop\n        },\n\n        destroy: function () {\n            var that = this;\n\n            Widget.fn.destroy.call(that);\n\n            that.userEvents.destroy();\n            that.calendar = null;\n\n            that._lastActive = that.element = that.userEvents = that._start = that._end = null;\n        },\n\n        _allowSelection: function(target) {\n            if ($(target).is(this.options.inputSelectors)) {\n                this.userEvents.cancel();\n                return false;\n            }\n\n            return true;\n        },\n\n        start: function (element) {\n            if (element === undefined) {\n                return this._start;\n            }\n            element.addClass(START + \" \" + SELECTED);\n            this._start = element;\n        },\n\n        end: function(element) {\n            if (element === undefined) {\n                return this._start;\n            }\n            element.addClass(END + \" \" + SELECTED);\n            this._end = element;\n        },\n\n        mid: function(elements) {\n            var tables = this.element.find(\"table.k-month\");\n\n            elements.addClass(MID);\n            tables.each(function() {\n                var that = $(this);\n                var lastCell = that.find(CELLSELECTORVALID).last();\n                var firstCell = that.find(CELLSELECTORVALID).first();\n\n                if (lastCell.hasClass(MID)) {\n                    lastCell.addClass(SPLITEND);\n                }\n\n                if (firstCell.hasClass(MID)) {\n                    firstCell.addClass(SPLITSTART);\n                }\n            });\n        },\n\n        clear: function(clearVariables) {\n            this.element.find(CELLSELECTOR).removeClass(END + \" \" + SELECTED + \" \" + START + \" \" + MID + \" \" + SPLITEND + \" \" + SPLITSTART);\n\n            if (clearVariables) {\n                this._start = this._end = null;\n            }\n        },\n\n        selectFrom: function(start) {\n            var that = this;\n            var items;\n            var startIdx;\n\n            items = that.element.find(CELLSELECTOR);\n\n            startIdx = $.inArray($(start)[0], items);\n\n            that.clear();\n            that.start(start);\n\n            items = items.filter(function (index) {\n                return index > startIdx;\n            });\n            that.mid(items);\n        },\n\n        selectTo: function(end) {\n            var that = this;\n            var items;\n            var endIdx;\n\n            items = that.element.find(CELLSELECTOR);\n\n            endIdx = $.inArray($(end)[0], items);\n\n            that.clear();\n\n            items = items.filter(function (index) {\n                return index < endIdx;\n            });\n            that.mid(items);\n            that.end($(end));\n        },\n\n        range: function(start, end) {\n            var that = this;\n            var items;\n            var startIdx;\n            var endIdx;\n            var temp;\n\n            if (start === undefined) {\n                return { start: that._start, end: that._end };\n            }\n\n            items = that.element.find(CELLSELECTOR);\n\n            startIdx = $.inArray($(start)[0], items);\n            endIdx = $.inArray($(end)[0], items);\n\n            if (endIdx == -1) {\n                endIdx = items.length;\n            }\n\n            if (startIdx > endIdx) {\n                temp = end;\n                end = start;\n                start = temp;\n                temp = startIdx;\n                startIdx = endIdx;\n                endIdx = temp;\n            }\n            that.clear();\n            start.addClass(START + \" \" + SELECTED);\n            that._start = start;\n\n            items = items.filter(function (index) {\n                return index > startIdx && index < endIdx;\n            });\n            that.mid(items);\n\n            if (end) {\n                that.end($(end));\n            } else {\n                that._useEnd = true;\n            }\n        },\n\n        change: function() {\n            this.trigger(CHANGE);\n        },\n\n        _clearFlags: function () {\n            this._useStart = this._useEnd = false;\n        },\n\n        _tap: function(e) {\n            var target = $(e.target),\n                range = this.calendar.selectRange() || {},\n                start = range.start,\n                end = range.end,\n                that = this,\n                currentDate = toDateObject($(target).find(\"a\")),\n                items,\n                startIdx,\n                endIdx;\n\n\n            that._lastActive = target;\n\n            if (!start || +start > +currentDate) {\n                that.clear(true);\n                that.start(target);\n                that._clearFlags();\n                that.trigger(CHANGE);\n                return;\n            }\n\n            if (start && !end) {\n                items = that.element.find(CELLSELECTOR);\n\n                startIdx = $.inArray($(that._start)[0], items);\n                endIdx = $.inArray($(target)[0], items);\n\n                if (start) {\n                    that._useStart = true;\n                }\n\n                items = items.filter(function (index) {\n                    return index > startIdx && index < endIdx;\n                });\n                that.mid(items);\n                that.end($(target));\n                that.trigger(CHANGE);\n                that._clearFlags();\n                return;\n            }\n\n            if (start && end) {\n                if (target.hasClass(MID)) {\n                    if (!that._toggling) {\n                        that.range(target, that._end);\n                    } else {\n                        that.range(that._start, target);\n                    }\n                    that._toggling = !that._toggling;\n                    that.trigger(CHANGE);\n                    that._clearFlags();\n                    return;\n                }\n                that._toggling = false;\n                that._end = null;\n                that.clear();\n                that.start(target);\n                that.trigger(CHANGE);\n                that._clearFlags();\n            }\n        }\n    });\n\n\n    var MultiViewCalendar = Widget.extend({\n        init: function(element, options) {\n            var that = this;\n            var id;\n            var culture;\n\n            Widget.fn.init.call(that, element, options);\n\n            element = that.wrapper = that.element;\n            options = that.options;\n\n            that.options.disableDates = calendar.disabled(that.options.disableDates);\n\n            culture = kendo.getCulture(options.culture);\n            options.format = kendo._extractFormat(options.format || culture.calendars.standard.patterns.d);\n\n            that._templates();\n\n            that._header();\n\n            that._wrapper();\n\n            id = element\n                .addClass(\"k-widget k-calendar k-calendar-range\" + (options.weekNumber ? \" k-week-number\" : \"\"))\n                .on(KEYDOWN + ns, \"table.k-content\", proxy(that._move, that))\n                .on(BLUR + ns, \"table\", proxy(that._blur, that))\n                .on(CLICK + ns, CELLSELECTORVALID, function(e) {\n                    var link = e.currentTarget.firstChild;\n\n                    if (link.href.indexOf(\"#\") != -1) {\n                        e.preventDefault();\n                    }\n\n                    that._click($(link));\n                })\n                .on(MOUSEENTER + ns, CELLSELECTORVALID, proxy(that._mouseEnter, that))\n                .on(MOUSELEAVE_NS, CELLSELECTORVALID, function() {\n                    $(this).removeClass(HOVER);\n                })\n                .attr(ID);\n\n            if (id) {\n                that._cellID = id + \"_cell_selected\";\n            }\n\n            that._calendarWidth = that.element.width();\n\n            that._range = options.range;\n\n            that._initViews({ viewName: options.start, value: options.value});\n            that._selectable();\n\n            that._footer(that.footer);\n            that._selectDates = [];\n            that.value(options.value);\n\n            if (options.selectable == \"multiple\") {\n                that._selectDates = options.selectDates.length ? options.selectDates : that._selectDates;\n                that._restoreSelection();\n            }\n\n            if (options.selectable == \"range\") {\n                that.selectRange(that._range);\n            }\n\n            kendo.notify(that);\n        },\n\n        options: {\n            name: \"MultiViewCalendar\",\n            value: null,\n            min: new DATE(1900, 0, 1),\n            max: new DATE(2099, 11, 31),\n            dates: [],\n            disableDates: null,\n            culture: \"\",\n            footer : \"\",\n            format : \"\",\n            month : {},\n            range : { start: null, end: null },\n            weekNumber: false,\n            views: 2,\n            showViewHeader: false,\n            selectable: \"single\",\n            selectDates: [],\n            start: MONTH,\n            depth: MONTH,\n            messages: {\n                weekColumnHeader: \"\"\n            }\n        },\n\n        events: [\n            CHANGE,\n            NAVIGATE\n        ],\n\n        setOptions: function(options) {\n            var that = this;\n\n            calendar.normalize(options);\n\n            options.disableDates = calendar.disabled(options.disableDates);\n\n            Widget.fn.setOptions.call(that, options);\n\n            that._selectable();\n\n            that._templates();\n\n            that._footer(that.footer);\n\n            for (var i = 0; i < that._views.length; i++) {\n                that._views[i].off(ns).remove();\n            }\n\n            that._initViews({ viewName: options.start, value: options.value});\n\n            that._range = options.range || { start: null, end: null };\n\n            that._restoreSelection();\n        },\n\n        destroy: function() {\n            var that = this;\n\n            that._cell = null;\n            that._currentView = null;\n            that._current = null;\n\n            if (that._views) {\n                for (var i = 0; i < that._views.length; i++) {\n                    that._views[i].off(ns).remove();\n                }\n            }\n\n            that.element.off(ns);\n\n            if (that.header) {\n                that.header.off(ns);\n                that._title = null;\n                that.header = null;\n            }\n\n            if (that.selectable) {\n                that.selectable.destroy();\n                that.selectable = null;\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.destroy();\n                that.rangeSelectable = null;\n            }\n\n            if (that._today) {\n                kendo.destroy(that._today.off(ns));\n            }\n\n            that._views = null;\n\n            Widget.fn.destroy.call(that);\n        },\n\n        current: function() {\n            return this._current;\n        },\n\n        focus: function() {\n            var table;\n\n            if (this._cell) {\n                this._cell.closest(\"table\").trigger(\"focus\");\n            } else if (this._current && this._dateInViews(this._current)) {\n                this._cell = this._cellByDate(this._current);\n                this._cell.closest(\"table\").trigger(\"focus\");\n            } else {\n                table = this.element.find(\"table\").first().trigger(\"focus\");\n                this._cell = table.find(CELLSELECTORVALID).first();\n                this._current = toDateObject(this._cell.find(\"a\"));\n            }\n            this._cell.addClass(FOCUSED);\n        },\n\n        min: function(value) {\n            return this._option(MIN, value);\n        },\n\n        max: function(value) {\n            return this._option(\"max\", value);\n        },\n\n        view: function() {\n            return this._currentView;\n        },\n\n        navigateToPast: function() {\n            this._navigate(PREVARROW, -1);\n        },\n\n        navigateToFuture: function() {\n            this._navigate(NEXTARROW, 1);\n        },\n\n        navigateUp: function() {\n            var that = this,\n            index = that._index;\n\n            if (that._title.hasClass(DISABLED)) {\n                return;\n            }\n\n            that.navigate(that._current, ++index);\n        },\n\n        navigateDown: function(value) {\n            var that = this,\n            index = that._index,\n            depth = that.options.depth;\n\n            if (!value) {\n                return;\n            }\n\n            if (index === views[depth]) {\n                if (!isEqualDate(that._value, that._current) || !isEqualDate(that._value, value)) {\n                    that.value(value);\n                    that.trigger(CHANGE);\n                }\n                return;\n            }\n\n            that.navigate(value, --index);\n        },\n\n        navigate: function(value, view) {\n            view = isNaN(view) ? calendar.views[calendar.viewsEnum[view]] : calendar.views[view];\n\n            var that = this;\n            var options = that.options;\n            var min = options.min;\n            var max = options.max;\n\n            if (!value) {\n                that._current = value = new DATE(+calendar.restrictValue(value, min, max));\n            } else {\n                that._current = value;\n            }\n\n            if (view === undefined) {\n                view = that._currentView;\n            }\n\n            that._currentView = view;\n\n            for (var i = 0; i < that._views.length; i++) {\n                that._views[i].off(ns).remove();\n            }\n\n            that._initViews({ viewName: view.name, value: value });\n\n            that._restoreSelection();\n        },\n\n        _updateHeader: function() {\n            var that = this;\n            var view = that._currentView;\n            var title = that._title;\n            var value = that._firstViewValue;\n            var options = that.options;\n            var visibleRange = that._visibleRange();\n            var culture = options.culture;\n            var min = options.min;\n            var max = options.max;\n            var lastDate;\n            var disabled;\n            var prevDisabled;\n            var nextDisabled;\n\n\n            if (view.name === DECADE || view.name === CENTURY) {\n                lastDate = shiftDate(value, view.name, options.views - 1);\n                if (!isInRange(lastDate, min, max)) {\n                    lastDate = max;\n                }\n\n                title.html(view.first(value).getFullYear() + \" - \" + view.last(lastDate).getFullYear());\n            } else {\n                title.html(view.title(value, min, max, culture) + \" - \" + view.title(shiftDate(value, view.name, options.views - 1), min, max, culture));\n            }\n\n            disabled = view.name === CENTURY;\n            title.toggleClass(DISABLED, disabled).attr(ARIA_DISABLED, disabled);\n\n            prevDisabled = view.compare(visibleRange.start, that.options.min) < 1;\n            nextDisabled = view.compare(visibleRange.end, that.options.max) > -1;\n\n            if (prevDisabled && nextDisabled) {\n                if (that._navContainer) {\n                    that._navContainer.remove();\n                    that._navContainer = null;\n                }\n            } else {\n                if (!that._navContainer) {\n                    that._navContainer = $('<span class=\"k-calendar-nav k-hstack\">' +\n                    '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-prev-view\" ' + ARIA_LABEL + '=\"Previous\"><span class=\"k-button-icon k-icon k-i-arrow-60-left\"></span></a>' +\n                    '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-next-view\" ' + ARIA_LABEL + '=\"Next\"><span class=\"k-button-icon k-icon k-i-arrow-60-right\"></span></a>' +\n                    '</span>').appendTo(that.header);\n                    that[PREVARROW] = that._navContainer.find(\".k-prev-view\");\n                    that[NEXTARROW] = that._navContainer.find(\".k-next-view\");\n                }\n\n                that[PREVARROW].toggleClass(DISABLED, prevDisabled).attr(ARIA_DISABLED, prevDisabled);\n                if (that[PREVARROW].hasClass(DISABLED)) {\n                    that[PREVARROW].removeClass(HOVER);\n                }\n\n                that[NEXTARROW].toggleClass(DISABLED, nextDisabled).attr(ARIA_DISABLED, nextDisabled);\n                if (that[NEXTARROW].hasClass(DISABLED)) {\n                    that[NEXTARROW].removeClass(HOVER);\n                }\n            }\n        },\n\n        _mouseEnter: function(e) {\n            var that = this;\n            var cell = $(e.currentTarget);\n            var range;\n            var items;\n            var startIdx;\n            var endIdx;\n\n            cell.addClass(HOVER);\n\n            if (that.rangeSelectable && that._currentView.name === \"month\") {\n                range = that.selectRange();\n                if (range.start && !range.end) {\n                    if (that._dateInViews(that.selectRange().start)) {\n                        items = that.element.find(that.rangeSelectable.options.filter);\n                        startIdx = $.inArray($(that.rangeSelectable._start)[0], items);\n                        endIdx = $.inArray($(cell)[0], items);\n                        if (startIdx > endIdx) {\n                            return;\n                        }\n                        that.rangeSelectable.range(that.rangeSelectable._start, cell);\n                    } else if(+toDateObject(that.element.find(CELLSELECTOR).first().find(\"a\")) > +range.start) {\n                        that.rangeSelectable.selectTo(cell);\n                    }\n                    that.rangeSelectable._end = null;\n                }\n            }\n        },\n\n        _move: function(e, preventFocus) {\n            var that = this;\n            var options = that.options;\n            var key = e.keyCode;\n            var index = that._index;\n            var min = options.min;\n            var max = options.max;\n            var focusedCell = that.element.find(DOT+FOCUSED);\n            var table = focusedCell.closest(\"table\");\n            var currentValue = new DATE(+(that._current || toDateObject(focusedCell.find(\"a\"))));\n            var isRtl = kendo.support.isRtl(that.wrapper);\n            var navigate = false;\n            var value, prevent, method, cell, lastActive, cellIndex;\n\n            if (key == keys.RIGHT && !isRtl || key == keys.LEFT && isRtl) {\n                value = 1;\n                prevent = true;\n            } else if (key == keys.LEFT && !isRtl || key == keys.RIGHT && isRtl) {\n                value = -1;\n                prevent = true;\n            } else if (key == keys.UP) {\n                value = index === 0 ? -7 : -4;\n                prevent = true;\n            } else if (key == keys.DOWN) {\n                value = index === 0 ? 7 : 4;\n                prevent = true;\n            }\n            else if (key == keys.SPACEBAR) {\n                value = 0;\n                prevent = true;\n            }\n            else if (key == keys.HOME) {\n                prevent = true;\n                cell = table.find(CELLSELECTORVALID).eq(0);\n                if (cell.hasClass(FOCUSED)) {\n                    table = table.prev();\n                    if (table.length) {\n                        that._focusCell(table.find(CELLSELECTORVALID).eq(0));\n                    } else {\n                        navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                        that._navigate(PREVARROW, -1, preventFocus);\n                        that._focusCell(that.element.find(\"table\").first().find(CELLSELECTORVALID).first());\n                    }\n                } else {\n                    that._focusCell(cell);\n                }\n            } else if(key == keys.END) {\n                prevent = true;\n                cell = table.find(CELLSELECTORVALID).last();\n                if (cell.hasClass(FOCUSED)) {\n                    table = table.next();\n                    if (table.length) {\n                        that._focusCell(table.find(CELLSELECTORVALID).last());\n                    } else {\n                        navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                        that._navigate(NEXTARROW, 1, preventFocus);\n                        that._focusCell(that.element.find(\"table\").last().find(CELLSELECTORVALID).last());\n                    }\n                } else {\n                    that._focusCell(cell);\n                }\n            }\n\n            if (e.ctrlKey || e.metaKey) {\n                if (key == keys.RIGHT && !isRtl || key == keys.LEFT && isRtl) {\n                    navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                    that._navigate(NEXTARROW, 1, preventFocus);\n                    prevent = true;\n                } else if (key == keys.LEFT && !isRtl || key == keys.RIGHT && isRtl) {\n                    navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                    that._navigate(PREVARROW, -1, preventFocus);\n                    prevent = true;\n                } else if (key == keys.UP) {\n                    navigate = !that._title.hasClass(DISABLED);\n                    that.navigateUp();\n                    that._focusCell(that._cellByDate(that._current), !preventFocus);\n                    prevent = true;\n                } else if (key == keys.DOWN) {\n                    if (that._currentView.name === \"month\") {\n                        that.value(currentValue);\n                    } else {\n                        that.navigateDown(currentValue);\n                        that._focusCell(that._cellByDate(that._current), !preventFocus);\n                        navigate = true;\n                    }\n                    prevent = true;\n                } else if ((key == keys.ENTER || key == keys.SPACEBAR)) {\n                    if (options.selectable === \"multiple\") {\n                        that._toggleSelection(e);\n                    }\n                }\n            } else if (e.shiftKey && options.selectable !== \"single\") {\n                if (value !== undefined || method) {\n                    if (!method) {\n                        that._currentView.setDate(currentValue, value);\n                    }\n\n                    if (that._currentView.name !== \"month\") {\n                        return;\n                    }\n\n                    if (options.disableDates(currentValue)) {\n                        currentValue = that._nextNavigatable(currentValue, value);\n                    }\n\n                    min = createDate(min.getFullYear(), min.getMonth(), min.getDate());\n\n                    if (isInRange(currentValue, min, max)) {\n                        if (!that._dateInViews(currentValue)) {\n                            if (value > 0) {\n                                navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, 1, preventFocus);\n                            } else {\n                                navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                                that._navigate(PREVARROW, -1, preventFocus);\n                            }\n                        }\n                        cell = that._cellByDate(currentValue);\n                        that._current = currentValue;\n\n                        if (that.selectable) {\n                            that._selectRange(toDateObject((that.selectable._lastActive || focusedCell).find(\"a\")), currentValue);\n                            if (!that.selectable._lastActive) {\n                                that.selectable._lastActive = focusedCell;\n                            }\n                            that.trigger(CHANGE);\n                            that._focusCell(cell);\n                        }\n\n                        if (that.rangeSelectable) {\n                            lastActive = toDateObject((that.rangeSelectable._lastActive || focusedCell).find(\"a\"));\n                            if (!that._dateInViews(lastActive)) {\n                                if (+lastActive > +currentValue) {\n                                    that.rangeSelectable._end = that.rangeSelectable._lastActive;\n                                    that.rangeSelectable.selectFrom(cell);\n                                } else {\n                                    that.rangeSelectable.selectTo(cell);\n                                }\n                            } else {\n                                if (that.rangeSelectable._end && that.rangeSelectable._end.is(DOT+FOCUSED)) {\n                                    that.rangeSelectable._lastActive = that.rangeSelectable._start;\n                                } else {\n                                    that.rangeSelectable._lastActive = that._cellByDate(lastActive);\n                                }\n                                that.rangeSelectable.range(that.rangeSelectable._lastActive, cell);\n                            }\n                            that.rangeSelectable.change();\n                            that._focusCell(cell);\n                        }\n                    }\n                }\n            } else {\n                if (key == keys.ENTER || key == keys.SPACEBAR) {\n                    if (that._currentView.name === \"month\") {\n                        if (that.selectable) {\n                            that.selectable._lastActive = that._cellByDate(currentValue);\n                        }\n                        that.value(currentValue);\n                        if (that.rangeSelectable) {\n                            that.rangeSelectable.change();\n                        }\n                    } else {\n                        that._click($(that._cell[0].firstChild), preventFocus);\n                    }\n                    prevent = true;\n                } else if (key == keys.PAGEUP || key == keys.PAGEDOWN) {\n                    prevent = true;\n                    cellIndex = table.find(CELLSELECTORVALID).index(focusedCell);\n                    table = key == keys.PAGEUP ? table.prev() : table.next();\n                    if (!table.length) {\n                        if (key == keys.PAGEUP) {\n                            navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                            that.navigateToPast();\n                            table = that.element.find(\"table\").first();\n                        } else {\n                            navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                            that.navigateToFuture();\n                            table = that.element.find(\"table\").last();\n                        }\n                    }\n                    cell = table.find(CELLSELECTORVALID).eq(cellIndex);\n                    if (cell.length) {\n                        that._focusCell(cell);\n                    } else {\n                        that._focusCell(table.find(CELLSELECTORVALID).last());\n                    }\n                }\n\n                if (value || method) {\n                    if (!method) {\n                        that._currentView.setDate(currentValue, value);\n                    }\n\n                    min = createDate(min.getFullYear(), min.getMonth(), min.getDate());\n\n                    if (isInRange(currentValue, min, max)) {\n                        if (that.selectable && options.disableDates(currentValue)) {\n                            currentValue = that._nextNavigatable(currentValue, value);\n                        }\n                        if (!that._dateInViews(currentValue)) {\n                            if (value > 0) {\n                                navigate = that[NEXTARROW] && !that[NEXTARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, 1, preventFocus);\n                            } else {\n                                navigate = that[PREVARROW] && !that[PREVARROW].hasClass(DISABLED);\n                                that._navigate(NEXTARROW, -1, preventFocus);\n                            }\n                        }\n                        cell = that._cellByDate(currentValue);\n                        that._current = currentValue;\n                        that._focusCell(cell, !preventFocus);\n                    }\n                }\n            }\n\n            if (navigate) {\n                that.trigger(NAVIGATE);\n            }\n\n            if (prevent) {\n                e.preventDefault();\n            }\n\n            return that._current;\n\n        },\n\n        _visualizeSelectedDatesInView: function() {\n            var that = this;\n            var selectedDates = {};\n            var cells;\n\n            $.each(that._selectDates, function(index, value) {\n                selectedDates[kendo.calendar.views[0].toDateString(value)] = value;\n            });\n            that.selectable.clear();\n            cells = that.element.find(\"table\")\n                .find(CELLSELECTOR)\n                .filter(function(index, element) {\n                    return selectedDates[$(element.firstChild).attr(kendo.attr(VALUE))];\n                });\n\n            if (cells.length > 0) {\n                that.selectable._selectElement(cells, true);\n            }\n        },\n\n        _nextNavigatable: function(currentValue, value) {\n            var that = this;\n            var disabled = true;\n            var view = that._currentView;\n            var min = that.options.min;\n            var max = that.options.max;\n            var isDisabled = that.options.disableDates;\n            var navigatableDate = new Date(currentValue.getTime());\n\n            view.setDate(navigatableDate, -value);\n            while (disabled) {\n                view.setDate(currentValue, value);\n                 if (!isInRange(currentValue, min, max)) {\n                    currentValue = navigatableDate;\n                    break;\n                }\n                disabled = isDisabled(currentValue);\n            }\n            return currentValue;\n        },\n\n        _toggleSelection: function (event) {\n            var that = this;\n\n            that.selectable._lastActive = $(that._cell[0]);\n\n            if ($(that._cell[0]).hasClass(SELECTED)) {\n                that.selectable._unselect($(that._cell[0]));\n                that.selectable.trigger(CHANGE, { event: event});\n            }\n            else {\n                that.selectable.value($(that._cell[0]), { event: event});\n            }\n        },\n\n        _option: function(option, value) {\n            var that = this;\n            var options = that.options;\n            var currentValue = that._value || that._current;\n            var isBigger;\n\n            if (value === undefined) {\n                return options[option];\n            }\n\n            value = kendo.parseDate(value, options.format, options.culture);\n\n            if (!value) {\n                return;\n            }\n\n            options[option] = new DATE(+value);\n\n            if (option === MIN) {\n                isBigger = value > currentValue;\n            } else {\n                isBigger = currentValue > value;\n            }\n\n            if (isBigger) {\n                that._value = null;\n            }\n\n            that.navigate(that._value);\n\n            that._toggle();\n        },\n\n        _cellByDate: function(value) {\n            if (value instanceof Date) {\n                value = this._currentView.toDateString(value);\n            }\n            return this.element.find(\"table\").find(\"td:not(.\" + OTHERMONTH + \")\")\n            .filter(function() {\n                return $(this.firstChild).attr(kendo.attr(VALUE)) === value;\n            });\n        },\n\n        _selectable: function () {\n            var that = this;\n            var selectable = that.options.selectable;\n\n            if (that.selectable) {\n                that.selectable.destroy();\n                that.selectable = null;\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.destroy();\n                that.rangeSelectable = null;\n            }\n\n            if (selectable.toLowerCase() === \"range\") {\n                that.rangeSelectable = new RangeSelectable(that.wrapper, {\n                    calendar: that,\n                    filter: \"table.k-month \" + CELLSELECTORVALID,\n                    change: proxy(that._rangeSelection, that)\n                });\n            } else {\n                that.selectable = new Selectable(that.wrapper, {\n                    aria: true,\n                    dragToSelect: false,\n                    inputSelectors: \"input,textarea,.k-multiselect-wrap,select,button,.k-button>span,.k-button>img,span.k-icon.k-i-arrow-60-down,span.k-icon.k-i-arrow-60-up\",\n                    multiple: Selectable.parseOptions(selectable).multiple,\n                    filter: \"table.k-content \" + CELLSELECTORVALID,\n                    change: proxy(that._selection, that),\n                    relatedTarget: proxy(that._onRelatedTarget, that),\n                    unselect: proxy(that._unselecting, that)\n                });\n            }\n        },\n\n        _onRelatedTarget: function(target) {\n            var that = this;\n\n            if (that.selectable.options.multiple && target.is(CELLSELECTORVALID) && target.length > 1) {\n                that._focusCell(target.first(), true);\n            }\n        },\n\n        _getFirstViewDate: function(currentView) {\n            var that = this;\n            var options = that.options;\n            var ranges = [];\n            var start;\n            var end;\n            var current = new Date(+that._current);\n            var i;\n\n            for (i = 0; i < options.views; i++) {\n                start = currentView.first(current);\n                end =  currentView.last(current);\n\n                if (+end > +options.max) {\n                    if (+start <= +options.max) {\n                        ranges.push({start: start, end: new Date(+options.max)});\n                    }\n                    break;\n                }\n\n                ranges.push({start: start, end: end});\n\n                current = new Date(+shiftDate(end, currentView.name, 1));\n            }\n\n            current = new Date(+that._current);\n\n            for (i = 0; i < options.views; i++) {\n                start = currentView.first(current);\n                end = currentView.last(current);\n\n                if (+start < +options.min) {\n                    if (+end >= +options.min) {\n                        ranges.push({start: new Date(+options.min), end: end});\n                    }\n                    break;\n                }\n\n                ranges.push({start: start, end: end});\n\n                current = new Date(+shiftDate(start, currentView.name, -1));\n            }\n\n            start = ranges[0].start;\n\n            for (i = 0; i < options.views + 1; i++) {\n                if (!ranges[i]) {\n                    break;\n                }\n\n                if (+start > +ranges[i].start) {\n                    start = ranges[i].start;\n                }\n            }\n\n            return new Date(+start);\n        },\n\n        _canRenderNextView: function(viewDate) {\n            var fullYear = viewDate.getFullYear();\n            var month = viewDate.getMonth();\n            var date = viewDate.getDate();\n            var max = this.options.max;\n            var maxYear = max.getFullYear();\n            var maxMonth = max.getMonth();\n\n\n            if (fullYear < maxYear) {\n                return true;\n            }\n\n            if (fullYear === maxYear && month < maxMonth) {\n                return true;\n            }\n\n            if (fullYear === maxYear &&  month === maxMonth &&  date < max.getDate()) {\n                return true;\n            }\n\n            if (fullYear === maxYear &&  month === maxMonth &&  date === max.getDate()) {\n                return true;\n            }\n\n            return false;\n        },\n\n        _initViews: function(viewOptions) {\n            var that = this;\n            var options = that.options;\n            var index = calendar.viewsEnum[viewOptions.viewName];\n            var currentView = calendar.views[index];\n            var viewDate;\n\n            that._current = new DATE(+calendar.restrictValue(viewOptions.value, options.min, options.max));\n            that._views = [];\n            that._index = index;\n            viewDate = that._getFirstViewDate(currentView);\n            viewDate.setDate(1);\n\n            that._firstViewValue = new Date(+viewDate);\n\n            for (var i = 0; i < options.views; i++) {\n                viewDate = i ? shiftDate(viewDate, currentView.name, 1): viewDate;\n                viewDate.setDate(1);\n\n                if (!that._canRenderNextView(viewDate)) {\n                    break;\n                }\n\n                that._table = $(currentView.content($.extend({\n                    min: options.min,\n                    max: options.max,\n                    date: viewDate,\n                    url: options.url,\n                    dates: options.dates,\n                    format: options.format,\n                    culture: options.culture,\n                    disableDates: options.disableDates,\n                    showHeader: options.showViewHeader,\n                    isWeekColumnVisible: options.weekNumber,\n                    otherMonth: options.otherMonth,\n                    messages: options.messages,\n                    contentClasses: \"k-content\"\n                }, that[currentView.name])));\n\n                that._table.appendTo(that.tablesWrapper).addClass(\"k-\" + currentView.name);\n                that._views.push(that._table);\n            }\n\n            // that.wrapper.width(visibleViews * that._calendarWidth);\n\n            that._currentView = currentView;\n\n            that.tablesWrapper.attr(\"class\", \"k-calendar-view k-calendar-\" + currentView.name + \"view k-hstack k-align-items-start k-justify-content-center\");\n\n            that._updateHeader();\n        },\n\n        _rangeSelection: function(e) {\n            var that = this;\n            var range = e.sender.range();\n            var useEnd = e.sender._useEnd;\n            var useStart = e.sender._useStart;\n            var initialRange = that.selectRange() || {};\n            var start;\n            var end;\n\n            if (range.start) {\n                start = toDateObject(range.start.find(\"a\"));\n            }\n\n            if (range.end) {\n                end = toDateObject(range.end.find(\"a\"));\n            }\n\n            that._range = { start: useStart ? initialRange.start : start, end: useEnd ? initialRange.end : end };\n\n            if (!that._preventChange) {\n                that.trigger(CHANGE);\n            }\n        },\n\n        _selection: function(e) {\n            var that = this;\n            var selectElements = e.sender.value();\n            var domEvent = e.event;\n            var currentTarget = $(domEvent && domEvent.currentTarget);\n            var isCell = currentTarget.is(\"td\");\n            var currentValue;\n\n            if (that.options.selectable === \"single\") {\n                that._validateValue(selectElements[0] ? toDateObject(selectElements.first().find(\"a\")) : e.sender._lastActive ? toDateObject(e.sender._lastActive.find(\"a\")) : that.value());\n            }\n\n            if (that.options.selectable == \"multiple\") {\n\n                if (isCell) {\n                    currentValue = toDateObject(currentTarget.find(\"a\"));\n                }\n\n                if (domEvent && domEvent.ctrlKey) {\n                    if (isCell) {\n                        if (currentTarget.hasClass(SELECTED)) {\n                            that._selectDates.push(currentValue);\n                        } else {\n                            that._deselect(currentValue);\n                        }\n                    } else {\n                        that.element.find(\"table \" + CELLSELECTORVALID).each(function(index, element){\n                            var value = toDateObject($(element).find(\"a\"));\n                            that._deselect(value);\n                        });\n                        that._addSelectedCellsToArray();\n                    }\n                } else if (domEvent && domEvent.shiftKey) {\n                    that._selectRange(toDateObject(e.sender._lastActive ? e.sender._lastActive.find(\"a\") : selectElements.first().find(\"a\")), currentValue);\n                } else if (isCell) {\n                    that._selectDates  = [];\n                    that._selectDates.push(currentValue);\n                } else {\n                    that._selectDates = [];\n                    that._addSelectedCellsToArray();\n                }\n            }\n\n            if (!that._preventChange) {\n                that.trigger(CHANGE);\n            }\n        },\n\n        _addSelectedCellsToArray: function() {\n            var that = this;\n            that.selectable.value().each(function(index, item) {\n                var date = toDateObject($(item.firstChild));\n                if (!that.options.disableDates(date)) {\n                    that._selectDates.push(date);\n                }\n            });\n        },\n\n        _deselect: function(date) {\n            var that = this;\n            var currentDateIndex = that._selectDates.map(Number).indexOf(+date);\n             if (currentDateIndex != -1) {\n                that._selectDates.splice(currentDateIndex, 1);\n            }\n        },\n\n        _unselecting: function(e) {\n            var that = this;\n            var element = e.element;\n\n            if (that.options.selectable === \"single\" && !mobileOS && element.hasClass(FOCUSED)) {\n                e.preventDefault();\n            }\n        },\n\n        _visibleRange: function () {\n            var tables = this.element.find(\".k-calendar-view table\");\n            var firstDateInView = toDateObject(tables.first().find(CELLSELECTOR).first().find(\"a\"));\n            var lastDateInView = toDateObject(tables.last().find(CELLSELECTOR).last().find(\"a\"));\n            return { start : firstDateInView, end: lastDateInView };\n        },\n\n        _dateInViews: function(date) {\n            var that = this;\n            var tables = that.element.find(\".k-calendar-view table\");\n            var firstDateInView = toDateObject(tables.first().find(CELLSELECTOR).first().find(\"a\"));\n            var lastDateInView = toDateObject(tables.last().find(CELLSELECTOR).last().find(\"a\"));\n\n            date = new Date(date.toDateString());\n\n            return +date <= +lastDateInView && +date >= +firstDateInView;\n        },\n\n        _fillRange: function(start, end) {\n            var that = this;\n            var daysDifference;\n\n            that._selectDates = [];\n            daysDifference = daysBetweenTwoDates(start, end);\n            addDaysToArray(that._selectDates, daysDifference, start, that.options.disableDates);\n        },\n\n        _selectRange: function(start, end) {\n            var that = this;\n            var current;\n\n            if (+end < +start) {\n                current = end;\n                end = start;\n                start = current;\n            }\n\n            that._fillRange(start, end);\n            that._visualizeSelectedDatesInView();\n        },\n\n        _header: function() {\n            var that = this;\n            var element = that.element;\n            var buttons;\n            var header = element.find(\".k-calendar-header\");\n\n            if (!header.length) {\n                header = $('<div class=\"k-calendar-header k-hstack\">' +\n                    '<a href=\"#\" role=\"button\" class=\"k-calendar-title k-title k-button k-button-md k-rounded-md k-button-flat k-button-flat-base\" aria-live=\"assertive\" aria-atomic=\"true\"></a>' +\n                    '<span class=\"k-spacer\"></span>' +\n                    '<span class=\"k-calendar-nav k-hstack\">' +\n                        '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-prev-view\" ' + ARIA_LABEL + '=\"Previous\"><span class=\"k-button-icon k-icon k-i-arrow-60-left\"></span></a>' +\n                        '<a href=\"#\" role=\"button\" class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-next-view\" ' + ARIA_LABEL + '=\"Next\"><span class=\"k-button-icon k-icon k-i-arrow-60-right\"></span></a>' +\n                    '</span>' +\n                '</div>').prependTo(element);\n            }\n\n            that.header = header;\n\n            header.on(MOUSEENTER + ns + \" \" + MOUSELEAVE_NS + \" \" + FOCUS + ns + \" \" + BLUR + ns, \".k-button\", mousetoggle).on(\"click\", function() { return false; })\n                .on(CLICK + ns, \".k-button.k-calendar-title\", function() { that.navigateUp(); that._focusCell(that._cellByDate(that._current), true); that.trigger(NAVIGATE); })\n                .on(CLICK + ns, \".k-button.k-prev-view\", function(e) { e.preventDefault(); that.navigateToPast(); that.trigger(NAVIGATE); })\n                .on(CLICK + ns, \".k-button.k-next-view\", function(e) { e.preventDefault(); that.navigateToFuture(); that.trigger(NAVIGATE); });\n\n            buttons = header.find(\".k-button\");\n\n            that._title = buttons.filter(\".k-calendar-title\");\n            that._navContainer= header.find(\".k-calendar-nav\");\n            that[PREVARROW] = buttons.filter(\".k-prev-view\");\n            that[NEXTARROW] = buttons.filter(\".k-next-view\");\n        },\n\n        _wrapper: function() {\n            this.tablesWrapper = $('<div class=\"k-calendar-view\" />').insertAfter(this.element[0].firstChild);\n        },\n\n        _templates: function() {\n            var that = this;\n            var options = that.options;\n            var month = options.month;\n            var content = month.content;\n            var weekNumber = month.weekNumber;\n            var empty = month.empty;\n\n            that.month = {\n                content: template('<td class=\"#=data.cssClass#\" role=\"gridcell\"><a tabindex=\"-1\" class=\"k-link#=data.linkClass#\" href=\"#=data.url#\" ' + kendo.attr(VALUE) + '=\"#=data.dateString#\" title=\"#=data.title#\">' + (content || \"#=data.value#\") + '</a></td>', { useWithBlock: !!content }),\n                empty: template('<td role=\"gridcell\"' + (empty ? '>' : ' class=\"k-calendar-td k-out-of-range\">') + (empty || \"<a class='k-link'></a>\") + \"</td>\", { useWithBlock: !!empty }),\n                weekNumber: template('<td class=\"k-calenar-td k-alt\">' + (weekNumber || \"#= data.weekNumber #\") + \"</td>\", { useWithBlock: !!weekNumber })\n            };\n        },\n\n        _footer: function() {\n            var that = this;\n            var options = that.options;\n            var template = options.footer !== false ? kendo.template(that.options.footer || '#= kendo.toString(data,\"D\",\"' + options.culture +'\") #', { useWithBlock: false }) : null;\n            var today = getToday();\n            var element = that.element;\n            var footer = element.find(\".k-footer\");\n\n            if (!template) {\n                that._toggle(false);\n                footer.hide();\n                return;\n            }\n\n            if (!footer[0]) {\n                footer = $('<div class=\"k-footer\"><a href=\"#\" class=\"k-link k-nav-today\"></a></div>').appendTo(element);\n            }\n\n            that._today = footer.show()\n                .find(\".k-link\")\n                .html(template(today))\n                .attr(\"title\", kendo.toString(today, \"D\", that.options.culture));\n\n            that._toggle();\n        },\n\n        _navigate: function(arrow, modifier, preventFocus) {\n            var that = this;\n            var index = that._index + 1;\n            var currentValue = new DATE(+that._current);\n            var originaValue = new DATE(+that._current);\n            var offset;\n\n            arrow = that[arrow];\n\n            offset = that._cellByDate(currentValue).closest(\"table\").index();\n\n            if (modifier > 0) {\n                offset = 1 - offset;\n            } else {\n                offset = offset + 1;\n            }\n\n            if (!arrow || !arrow.hasClass(DISABLED)) {\n                if (index > 3) {\n                    currentValue.setFullYear(currentValue.getFullYear() + 100 * (modifier * offset));\n                } else {\n                    calendar.views[index].setDate(currentValue, (modifier * offset));\n                }\n\n                that.navigate(currentValue);\n\n                if (that._dateInViews(originaValue)) {\n                    that._focusCell(that._cellByDate(originaValue), !preventFocus);\n                    that._current = originaValue;\n                } else {\n                    if (index > 3) {\n                        originaValue.setFullYear(originaValue.getFullYear() + 100 * modifier);\n                    } else {\n                        calendar.views[index].setDate(originaValue, modifier);\n                    }\n                    that._focusCell(that._cellByDate(originaValue), !preventFocus);\n                    that._current = originaValue;\n                }\n            }\n        },\n\n        _toggle: function(toggle) {\n            var that = this;\n            var options = that.options;\n            var isTodayDisabled = options.selectable !== \"range\" && that.options.disableDates(getToday());\n            var link = that._today;\n\n            if (toggle === undefined) {\n                toggle = isInRange(getToday(), options.min, options.max);\n            }\n\n            if (link) {\n                link.off(CLICK + ns);\n\n                if (toggle && !isTodayDisabled) {\n                    link.addClass(TODAY)\n                    .removeClass(DISABLED)\n                    .on(CLICK + ns, proxy(that._todayClick, that));\n                } else {\n                    link.removeClass(TODAY)\n                    .addClass(DISABLED)\n                    .on(CLICK + ns, function prevent (e) {\n                        e.preventDefault();\n                    });\n                }\n            }\n        },\n\n        _click: function(link, preventFocus) {\n            var that = this;\n            var options = that.options;\n            var currentValue = new Date(+that._current);\n            var value = toDateObject(link);\n\n            kendo.date.adjustDST(value, 0);\n\n            that._currentView.setDate(currentValue, value);\n            that._current = value;\n\n            if (that._currentView.name !== options.depth) {\n                that.navigateDown(calendar.restrictValue(currentValue, options.min, options.max));\n                that._focusCell(that._cellByDate(that._current), !preventFocus);\n                that.trigger(NAVIGATE);\n            } else {\n                that._focusCell(link.closest(\"td\"), !preventFocus);\n            }\n        },\n\n        _blur: function() {\n            var that = this;\n\n            if (that._cell) {\n                that._cell.removeClass(FOCUSED);\n            }\n        },\n\n        _focus: function(e) {\n            var that = this;\n            var table = $(e.currentTarget);\n            var cell = that._cell;\n\n            if (!cell || !$.contains(table[0], cell[0])) {\n                cell = table.find(CELLSELECTORVALID).first();\n            }\n\n            that._focusCell(cell);\n        },\n\n        _focusCell: function(cell, focusTable) {\n            var that = this;\n            var cellId = that._cellID;\n            var table = cell.closest(\"table\");\n\n            if (that._cell && that._cell.length) {\n                that._cell[0].removeAttribute(ARIA_SELECTED);\n                that._cell[0].removeAttribute(ARIA_LABEL);\n                that._cell.removeClass(FOCUSED);\n                that._cell[0].removeAttribute(ID);\n                that._cell.closest(\"table\")[0].removeAttribute(\"aria-activedescendant\");\n            }\n\n            that._cell = cell;\n\n            if (focusTable) {\n                table.trigger(\"focus\");\n            }\n\n            if (cellId) {\n                cell.attr(ID, cellId);\n                table.attr(\"aria-activedescendant\", cellId);\n            }\n\n            cell.attr(ARIA_SELECTED, true).addClass(FOCUSED);\n\n            if (cell.length && that._currentView.name == \"month\") {\n                that._current = toDateObject(cell.find(\"a\"));\n            }\n        },\n\n        _todayClick: function(e) {\n            var that = this;\n            var disabled = that.options.disableDates;\n            var today = getToday();\n            var navigate = false;\n\n            e.preventDefault();\n\n            if (disabled(today)) {\n                return;\n            }\n\n            that._value = today;\n\n            if (that.options.selectable === \"multiple\") {\n                that._selectDates = [today];\n            }\n\n            if (that.options.selectable === \"range\") {\n                that.rangeSelectable.clear(true);\n                that._range = { start: today, end: null };\n            }\n\n            if (that._currentView.name != \"month\" || !that._dateInViews(today)) {\n                navigate = true;\n            }\n\n            that.navigate(today, that.options.depth);\n\n            if (that.options.selectable === \"single\") {\n                that.selectable._lastActive = null;\n            }\n\n            if (navigate) {\n                that.trigger(NAVIGATE);\n            }\n\n            that.trigger(CHANGE);\n        },\n\n        _validateValue: function(value) {\n            var that = this;\n            var options = that.options;\n            var min = options.min;\n            var max = options.max;\n\n            value = kendo.parseDate(value, options.format, options.culture);\n\n            if (value !== null) {\n                value = new DATE(+value);\n\n                if (!isInRange(value, min, max)) {\n                    value = null;\n                }\n            }\n\n            if (value === null || !that.options.disableDates(new Date(+value))) {\n                that._value = value;\n            } else if (that._value === undefined) {\n                that._value = null;\n            }\n\n            return that._value;\n        },\n\n        _updateAria: function (ariaTemplate, date) {\n            var that = this;\n            var cell = that._cellByDate(date || that.current());\n            var valueType = that.view().valueType();\n            var current = date || that.current();\n            var text;\n\n            that._focusCell(cell);\n\n            if (valueType === \"month\") {\n                text = kendo.toString(current, \"MMMM\");\n            } else if (valueType === \"date\") {\n                text = kendo.toString(current, \"D\");\n            } else {\n                text = cell.text();\n            }\n\n            cell.attr(\"aria-label\", ariaTemplate({ current: current, valueType: valueType, text: text }));\n            return cell.attr(\"id\");\n        },\n\n        clearSelection: function () {\n            var that = this;\n\n            if (that.selectable) {\n                that.element.find(DOT+SELECTED).removeClass(SELECTED);\n            }\n\n            if (that.rangeSelectable) {\n                that.rangeSelectable.clear(true);\n            }\n        },\n\n        _restoreSelection: function() {\n            var that = this;\n            var range;\n            var selectable = that.options.selectable;\n\n            if (that._currentView.name !== that.options.depth) {\n                return;\n            }\n\n            that._preventChange = true;\n\n            if (selectable === \"range\") {\n                range = that.selectRange();\n\n                if (!range || !range.start) {\n                    that._preventChange = false;\n                    return;\n                }\n\n                that.selectRange(range);\n            }\n\n            if (selectable === \"single\" && that.value()) {\n                that.selectable.value(that._cellByDate(that.value()));\n            }\n\n            if (selectable === \"multiple\") {\n                that._visualizeSelectedDatesInView();\n            }\n\n            that._preventChange = false;\n        },\n\n        value: function(value) {\n            var that = this;\n            var cell;\n\n            if (value === undefined) {\n                return that._value;\n            }\n\n            value = that._validateValue(value);\n\n            that.clearSelection();\n\n            if (value && !that._dateInViews(value)) {\n                that.navigate(value);\n            }\n\n            if (value !== null && that._currentView.name === MONTH) {\n                cell = that._cellByDate(value);\n\n                if (that.selectable) {\n                    that.selectable.value(cell);\n                }\n\n                if (that.rangeSelectable) {\n                    that.rangeSelectable.start(cell);\n                    that.rangeSelectable._lastActive = cell;\n                }\n            }\n        },\n\n        selectDates: function(dates) {\n            var that = this;\n            var validSelectedDates;\n            var datesUnique;\n\n            if(dates === undefined) {\n                return that._selectDates;\n            }\n\n            datesUnique = dates\n                .map(function (date) { return date.getTime(); })\n                .filter(function (date, position, array) {\n                    return array.indexOf(date) === position;\n                })\n                .map(function (time) { return new Date(time); });\n\n            validSelectedDates = $.grep(datesUnique, function(value) {\n                if(value) {\n                    return +that._validateValue(new Date(value.setHours(0, 0, 0, 0))) === +value;\n                }\n            });\n            that._selectDates = validSelectedDates.length > 0 ? validSelectedDates : (datesUnique.length === 0 ? datesUnique : that._selectDates);\n            that._visualizeSelectedDatesInView();\n        },\n\n        selectRange: function(range) {\n            var that = this;\n            var startInRange;\n            var endInRange;\n            var visibleRange;\n\n            if (range === undefined) {\n                return that._range;\n            }\n\n            that._range = range;\n\n            if (!range.start) {\n                return;\n            }\n\n            visibleRange = that._visibleRange();\n\n            startInRange = that._dateInViews(range.start);\n            endInRange = range.end && that._dateInViews(range.end);\n\n            if (!startInRange && endInRange) {\n                that.rangeSelectable.selectTo(that._cellByDate(range.end));\n            }\n\n            if (startInRange && endInRange) {\n                that.rangeSelectable.range(that._cellByDate(range.start), that._cellByDate(range.end));\n            }\n\n            if (range.end && startInRange && !endInRange) {\n                that.rangeSelectable.selectFrom(that._cellByDate(range.start));\n            }\n\n            if (!range.end && startInRange) {\n                that.rangeSelectable.start(that._cellByDate(range.start));\n            }\n\n            if (+visibleRange.start > +range.start && +visibleRange.end < +range.end) {\n                that.rangeSelectable.mid(that.element.find(CELLSELECTORVALID));\n            }\n        }\n    });\n\n    kendo.ui.plugin(MultiViewCalendar);\n\n    function mousetoggle(e) {\n        var disabled = $(this).hasClass(\"k-state-disabled\");\n\n        if (!disabled) {\n            $(this).toggleClass(HOVER, MOUSEENTER.indexOf(e.type) > -1 || e.type == FOCUS);\n        }\n    }\n\n    function addDaysToArray(array, numberOfDays, fromDate, disableDates) {\n        for(var i = 0; i <= numberOfDays; i++) {\n            var nextDay = new Date(fromDate.getTime());\n            nextDay = new Date(nextDay.setDate(nextDay.getDate() + i));\n            if(!disableDates(nextDay)) {\n                array.push(nextDay);\n            }\n        }\n    }\n\n    function daysBetweenTwoDates(startDate, endDate) {\n        if(+endDate < +startDate) {\n            var temp = +startDate;\n            calendar.views[0].setDate(startDate, endDate);\n            calendar.views[0].setDate(endDate, new Date(temp));\n        }\n        var fromDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());\n        var endDateUTC = Date.UTC(endDate.getFullYear(), endDate.getMonth(), endDate.getDate());\n\n        return Math.ceil((+endDateUTC - +fromDateUTC) / kendo.date.MS_PER_DAY);\n    }\n\n    function shiftDate(value, dimension, numberOfViews) {\n        var current;\n        if (dimension === \"month\") {\n            current = new DATE(value.getFullYear(), value.getMonth() + numberOfViews, value.getDate());\n            current.setFullYear(value.getFullYear());\n            if (Math.abs(current.getMonth() - value.getMonth()) > numberOfViews || numberOfViews > 10) {\n                current.setMonth(value.getMonth() + numberOfViews);\n                current = calendar.views[0].last(current);\n            }\n            return current;\n        } else if (dimension === \"year\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + numberOfViews);\n                current = calendar.views[1].last(current);\n            }\n            return current;\n        } else if (dimension === \"decade\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + 10*numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > 10*numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + 10*numberOfViews);\n                current = calendar.views[2].last(current);\n            }\n            return current;\n        } else if (dimension === \"century\") {\n            current = new DATE(1, value.getMonth(), value.getDate());\n            current.setFullYear(value.getFullYear() + 100*numberOfViews);\n            if (Math.abs(current.getFullYear() - value.getFullYear()) > 100*numberOfViews) {\n                current = new DATE(1, value.getMonth(), 1);\n                current.setFullYear(value.getFullYear() + 100*numberOfViews);\n                current = calendar.views[3].last(current);\n            }\n            return current;\n        }\n    }\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","$","window","kendo","jQuery","undefined","calendar","support","isInRange","toDateObject","createDate","isEqualDate","getToday","keys","ui","Widget","Selectable","template","mobileOS","ns","CLICK","KEYDOWN","ID","MIN","MONTH","DOT","CENTURY","DECADE","CHANGE","NAVIGATE","VALUE","FOCUSED","SELECTED","MID","SPLITEND","SPLITSTART","START","END","HOVER","DISABLED","TODAY","OTHERMONTH","OUTOFRANGE","CELLSELECTOR","CELLSELECTORVALID","BLUR","FOCUS","MOUSEENTER","touch","MOUSELEAVE_NS","PREVARROW","NEXTARROW","ARIA_SELECTED","INPUTSELECTOR","ARIA_DISABLED","ARIA_LABEL","proxy","DATE","Date","views","month","year","decade","century","RangeSelectable","extend","init","element","options","that","this","fn","call","userEvents","UserEvents","global","allowSelection","filter","tap","_tap","touchAction","events","inputSelectors","multiple","dragToSelect","relatedTarget","noop","destroy","_lastActive","_start","_end","_allowSelection","target","is","cancel","start","addClass","end","mid","elements","tables","find","each","lastCell","last","firstCell","first","hasClass","clear","clearVariables","removeClass","selectFrom","items","startIdx","inArray","index","selectTo","endIdx","range","temp","length","_useEnd","change","trigger","_clearFlags","_useStart","e","selectRange","currentDate","_toggling","MultiViewCalendar","culture","wrapper","disableDates","disabled","getCulture","format","_extractFormat","calendars","standard","patterns","d","_templates","_header","_wrapper","weekNumber","on","_move","_blur","link","currentTarget","firstChild","href","indexOf","preventDefault","_click","_mouseEnter","attr","_cellID","_calendarWidth","width","_range","_initViews","viewName","value","_selectable","_footer","footer","_selectDates","selectable","selectDates","_restoreSelection","notify","min","max","dates","showViewHeader","depth","messages","weekColumnHeader","setOptions","normalize","i","_views","off","remove","_cell","_currentView","_current","header","_title","rangeSelectable","_today","current","focus","table","closest","_dateInViews","_cellByDate","_option","view","navigateToPast","_navigate","navigateToFuture","navigateUp","_index","navigate","navigateDown","_value","isNaN","viewsEnum","restrictValue","_updateHeader","title","_firstViewValue","visibleRange","_visibleRange","lastDate","prevDisabled","nextDisabled","shiftDate","html","getFullYear","toggleClass","compare","_navContainer","appendTo","cell","preventFocus","key","keyCode","focusedCell","currentValue","isRtl","prevent","method","lastActive","cellIndex","RIGHT","LEFT","UP","DOWN","SPACEBAR","HOME","eq","prev","_focusCell","next","ctrlKey","metaKey","ENTER","_toggleSelection","shiftKey","setDate","_nextNavigatable","getMonth","getDate","_selectRange","PAGEUP","PAGEDOWN","_visualizeSelectedDatesInView","selectedDates","cells","toDateString","_selectElement","isDisabled","navigatableDate","getTime","event","_unselect","option","isBigger","parseDate","_toggle","toLowerCase","_rangeSelection","aria","parseOptions","_selection","_onRelatedTarget","unselect","_unselecting","_getFirstViewDate","currentView","ranges","push","_canRenderNextView","viewDate","fullYear","date","maxYear","maxMonth","viewOptions","_table","content","url","showHeader","isWeekColumnVisible","otherMonth","contentClasses","tablesWrapper","sender","useEnd","useStart","initialRange","_preventChange","selectElements","domEvent","isCell","_validateValue","_deselect","_addSelectedCellsToArray","item","currentDateIndex","map","Number","splice","firstDateInView","lastDateInView","_fillRange","daysDifference","daysBetweenTwoDates","addDaysToArray","buttons","prependTo","mousetoggle","insertAfter","empty","useWithBlock","today","hide","show","toString","arrow","modifier","originaValue","offset","setFullYear","toggle","isTodayDisabled","_todayClick","adjustDST","_focus","contains","focusTable","cellId","removeAttribute","_updateAria","ariaTemplate","valueType","text","clearSelection","validSelectedDates","datesUnique","position","array","time","grep","setHours","startInRange","endInRange","type","numberOfDays","fromDate","nextDay","startDate","endDate","fromDateUTC","UTC","endDateUTC","Math","ceil","MS_PER_DAY","dimension","numberOfViews","abs","setMonth","plugin","amd","a1","a2","a3"],"mappings":"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"}