{"version":3,"file":"kendo.orgchart.min.js","sources":["kendo.orgchart.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('orgchart/data',[\"../kendo.data\", \"../kendo.treelist\"], f);\n})(function(){\n\n(function($, undefined) {\n    var extend = $.extend,\n        proxy = $.proxy,\n\n        data = kendo.data,\n        Query = data.Query,\n        DataSource = data.DataSource,\n        TreeListDataSource = data.TreeListDataSource,\n        Model = data.Model,\n        ObservableArray = data.ObservableArray;\n\n    var OrgChartModel = Model.define({\n        id: \"id\",\n        parentId: \"parentId\",\n\n        fields: {\n            id: { type: \"number\", editable: false },\n            parentId: { type: \"number\", nullable: true },\n            name: { type: \"string\", validation: { required: true } },\n            title: { type: \"string\" },\n            avatar: { type: \"string\" }\n        },\n\n        init: function(value) {\n            Model.fn.init.call(this, value);\n\n            this._loaded = false;\n\n            if (!this.parentIdField) {\n                this.parentIdField = \"parentId\";\n            }\n            if (!this.nameField) {\n                this.nameField = \"name\";\n            }\n            if (!this.titleField) {\n                this.titleField = \"title\";\n            }\n            if (!this.avatarField) {\n                this.avatarField = \"avatar\";\n            }\n\n            this.parentId = this.get(this.parentIdField);\n            this.name = this.get(this.nameField);\n            this.title = this.get(this.titleField);\n            this.avatar = this.get(this.avatarField);\n        },\n\n        accept: function(data) {\n            Model.fn.accept.call(this, data);\n\n            this.parentId = this.get(this.parentIdField);\n            this.name = this.get(this.nameField);\n            this.title = this.get(this.titleField);\n            this.avatar = this.get(this.avatarField);\n        },\n\n        set: function(field, value, initiator) {\n            if (field == \"parentId\" && this.nameField != \"parentId\") {\n                this[this.parentIdField] = value;\n            }\n            if (field == \"name\" && this.nameField != \"name\") {\n                this[this.nameField] = value;\n            }\n            if (field == \"title\" && this.titleField != \"title\") {\n                this[this.titleField] = value;\n            }\n            if (field == \"avatar\" && this.avatarField != \"avatar\") {\n                this[this.avatarField] = value;\n            }\n\n            Model.fn.set.call(this, field, value, initiator);\n\n            if (field == this.parentIdField) {\n                this.parentId = this.get(this.parentIdField);\n            }\n            if (field == this.nameField) {\n                this.name = this.get(this.nameField);\n            }\n            if (field == this.titleField) {\n                this.title = this.get(this.titleField);\n            }\n            if (field == this.avatarField) {\n                this.avatar = this.get(this.avatarField);\n            }\n        },\n\n        loaded: function(value) {\n            if (value !== undefined) {\n                this._loaded = value;\n            } else {\n                return this._loaded;\n            }\n        },\n\n        shouldSerialize: function(field) {\n            return Model.fn.shouldSerialize.call(this, field) && field !== \"_loaded\" && field != \"_error\" && field != \"_edit\" && !(this.parentIdField !== \"parentId\" && field === \"parentId\");\n        }\n    });\n\n    OrgChartModel.parentIdField = \"parentId\";\n    OrgChartModel.nameField = \"name\";\n    OrgChartModel.titleField = \"title\";\n    OrgChartModel.avatarField = \"avatar\";\n\n    OrgChartModel.define = function(base, options) {\n        if (options === undefined) {\n            options = base;\n            base = OrgChartModel;\n        }\n\n        var parentId = options.parentId || \"parentId\";\n        var name = options.name || \"name\";\n        var title = options.title || \"title\";\n        var avatar = options.avatar || \"avatar\";\n\n        options.parentIdField = parentId;\n        options.nameField = name;\n        options.titleField = title;\n        options.avatarField = avatar;\n\n        var model = Model.define(base, options);\n\n        if (parentId) {\n            model.parentIdField = parentId;\n        }\n        if (name) {\n            model.nameField = name;\n        }\n        if (title) {\n            model.titleField = title;\n        }\n        if (avatar) {\n            model.avatarField = avatar;\n        }\n\n        return model;\n    };\n\n    var OrgChartDataSource = TreeListDataSource.extend({\n        init: function(options) {\n            TreeListDataSource.fn.init.call(this, extend(true, {}, {\n                schema: {\n                    modelBase: OrgChartModel,\n                    model: OrgChartModel\n                }\n            }, options));\n        },\n\n        groupedItemsTree: function(field) {\n            var map = this._childrenMap(this.view()),\n                defaultParentId = this._defaultParentId(),\n                currentChildren = map[defaultParentId] || [],\n                grouped = new Query(currentChildren).group({ field: field }).toArray();\n\n            return this._innerGroupedItemsTree(field, grouped, map);\n        },\n\n        itemChildren: function(item, fromView) {\n            var filter = {\n                field: \"parentId\",\n                operator: \"eq\",\n                value: null\n            };\n\n            var order = (this._sort && this._sort.length) ? this._sort : {};\n            var itemId, data;\n\n            if(fromView) {\n                data = this.view();\n            } else {\n                data = this.data();\n            }\n\n            if (!!item) {\n                itemId = item.get(\"id\");\n\n                if (itemId === undefined || itemId === null || itemId === \"\") {\n                    return [];\n                }\n\n                filter.value = itemId;\n            }\n\n            data = new Query(data).filter(filter).sort(order).toArray();\n\n            return data;\n        },\n\n        itemsTree: function(item, field) {\n            var data = [],\n                current,\n                items = this.itemChildren(item, true),\n                children, i;\n\n            for (i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if (current.get(\"expanded\")) {\n                    children = this.itemsTree(current, field);\n\n                    current = extend(true, {}, current);\n                    current.children = children;\n                }\n\n                current = extend(true, {}, current);\n                data.push(current);\n            }\n\n            if(field !== null && field !== undefined) {\n                data = new Query(data).group({ field: field }).toArray();\n            }\n\n            return data;\n        },\n\n        prospectParents: function(skippedItem, item) {\n            var data = [],\n                current,\n                items = this.itemChildren(item, false),\n                children, i;\n\n            for (i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if(current.get(\"id\") === skippedItem.get(\"id\")) {\n                    continue;\n                }\n\n                data.push(current);\n\n                if (current.get(\"hasChildren\")) {\n                    children = this.prospectParents(skippedItem, current);\n\n                    data = data.concat(children);\n                }\n            }\n\n            return data;\n        },\n\n        read: function(data) {\n            return DataSource.fn.read.call(this, data).then(proxy(this._loadExpanded, this, data));\n        },\n\n        toggleChildren: function(item, expand) {\n            var defaultPromise = $.Deferred().resolve().promise(),\n                loaded = item.loaded();\n\n            // reset error state\n            if (item._error) {\n                item.expanded = false;\n                item._error = undefined;\n            }\n\n            // toggle expanded state\n            if (typeof expand == \"undefined\") {\n                expand = !item.expanded;\n            }\n\n            item.expanded = expand;\n\n            if (!loaded) {\n                defaultPromise = this.load(item);\n            }\n\n            return defaultPromise;\n        },\n\n        _innerGroupedItemsTree: function(field, grouped, map) {\n            var group, i, j, itemId, innerGrouped, children, current, hasChildren;\n\n\n            for(i = 0; i < grouped.length; i++) {\n                group = grouped[i];\n                children = [];\n                hasChildren = false;\n\n                for(j = 0; j < group.items.length; j++) {\n                    current = group.items[j];\n\n                    if(!group.hasChildren && current.hasChildren) {\n                        group.hasChildren = true;\n                    }\n\n                    if(current.expanded) {\n                        group.expanded = true;\n                    }\n\n                    itemId = group.items[j].get(\"id\");\n                    children = children.concat(map[itemId]);\n                }\n\n                if(group.expanded) {\n                    innerGrouped = new Query(children).group({ field: field }).toArray();\n                    group.children = this._innerGroupedItemsTree(field, innerGrouped, map);\n                }\n\n                if(!group.hasChildren && children.length > 0) {\n                    group.hasChildren = true;\n                }\n            }\n\n            return grouped;\n        },\n\n        _loadExpanded: function(data) {\n            var items, i, current;\n\n            if(!data) {\n                return;\n            }\n\n            if(data.id !== null && data.id !== undefined) {\n                items = this._byParentId(data.id);\n            } else {\n                items = this._byParentId(this._defaultParentId());\n            }\n\n            for(i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if(current.expanded && !current.loaded()) {\n                    this.toggleChildren(current, true);\n                }\n            }\n        }\n    });\n\n    OrgChartDataSource.create = function(options) {\n        if ($.isArray(options)) {\n            options = { data: options };\n        } else if (options instanceof ObservableArray) {\n            options = { data: options.toJSON() };\n        }\n\n        if (!(options instanceof OrgChartDataSource) && options instanceof DataSource) {\n            throw new Error(\"Incorrect DataSource type. Only OrgChartDataSource instances are supported\");\n        }\n\n        return options instanceof OrgChartDataSource ? options : new OrgChartDataSource(options);\n    };\n\n    extend(true, kendo.data, {\n        OrgChartModel: OrgChartModel,\n        OrgChartDataSource: OrgChartDataSource\n    });\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n(function(f, define){\n    define('orgchart/view',[\"../kendo.core\"], f);\n})(function(){\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        keys = kendo.keys,\n        extend = $.extend,\n        proxy = $.proxy,\n\n        NS = \".kendoOrgChartView\",\n\n        BLUR = \"blur\",\n        CLICK = \"click\",\n        COLLAPSE = \"collapse\",\n        EXPAND = \"expand\",\n        FOCUS = \"focus\",\n        KEYDOWN = \"keydown\",\n        MENU = \"menu\",\n        SELECT = \"select\",\n\n        DOT = \".\",\n        SPACE = \" \",\n        COMMA = \",\",\n        HASH = \"#\",\n        STRING = \"string\",\n        TABINDEX = \"tabindex\",\n        ID = \"id\",\n        UID = \"uid\",\n        PX = \"px\",\n        PLUS = \"plus\",\n        MINUS = \"minus\",\n\n        ARIA_OWNS = \"aria-owns\",\n        ARIA_SELECTED = \"aria-selected\";\n\n    var ORGCHART_STYLES = {\n        wrapper: \"k-orgchart\",\n        container: \"k-orgchart-container\",\n        line: \"k-orgchart-line\",\n        lineVertical: \"k-orgchart-line-v\",\n        lineHorizontal: \"k-orgchart-line-h\",\n        lineVerticalTop: \"k-orgchart-line-v-top\",\n        group: \"k-orgchart-group\",\n        groupVertical: \"k-orgchart-group-v\",\n        groupHorizontal: \"k-orgchart-group-h\",\n        nodesGroup: \"k-orgchart-node-group\",\n        nodesGroupContainer: \"k-orgchart-node-group-container\",\n        nodeContainer: \"k-orgchart-node-container\",\n        node: \"k-orgchart-node\",\n        card: \"k-orgchart-card\",\n        cardMenu: \"k-orgchart-card-menu\",\n        button: \"k-orgchart-button\",\n        focused: \"k-state-focus\",\n        plusIcon: \"k-i-plus\",\n        menuItem: \"k-item\",\n        avatarPreview: \"k-orgchart-avatar-preview\",\n        update: \"k-orgchart-update\",\n        cancel: \"k-orgchart-cancel\",\n        vstack: \"k-vstack\",\n        hstack: \"k-hstack\"\n    };\n\n    var ROOT_TEMPLATE = '<div role=\"tree\" aria-orientation=\"horizontal\" aria-label=\"#: label #\" class=\"k-orgchart-group k-orgchart-level-1 k-pos-absolute k-hstack k-justify-content-center\"></div>';\n\n    var GROUP_TEMPLATE = '<div role=\"group\" id=\"#: guid #\" class=\"k-orgchart-level-#: level # k-orgchart-group k-pos-absolute k-justify-content-around\"></div>';\n\n    var NODE_GROUP_CONTAINER = '<div role=\"treeitem\" ' +\n        '# if(data.hasChildren && data.guid) { #' +\n            'aria-owns=\"#: guid #\" ' +\n            '# if(!!data.expanded) { #' +\n                'aria-expanded=\"true\" ' +\n            '# } else { #' +\n                'aria-expanded=\"false\" ' +\n            '# } #' +\n        '# } #' +\n    'aria-keyshortcuts=\"Enter\" aria-level=\"#: level #\" aria-selected=\"false\" class=\"k-orgchart-node-group-container\">';\n\n    var NODE_CONTAINER = '<div class=\"k-orgchart-node-container k-justify-content-around\" style=\"width:100%\"></div>';\n\n    var NODE_CONTAINER_GROUPED = '<div role=\"group\" class=\"k-orgchart-node-container k-justify-content-around k-hstack\" style=\"width:100%\"></div>';\n\n    var ITEM_TEMPLATE = '<div class=\"k-orgchart-node k-vstack k-align-items-center\"></div>';\n\n    var BUTTON_TEMPLATE = '<button aria-label=\"#: label #\" tabindex=\"-1\" class=\"k-orgchart-button k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button\">' +\n            '<span class=\"k-button-icon k-icon k-i-#: buttonSign #\"></span>' +\n    '</button>';\n\n    var CARD_TEMPLATE = '<div class=\"k-card-body k-hstack\" style=\"border-color:#: color #\">' +\n        '# if(!!data.avatar) { #' +\n            '<div class=\"k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full\">' +\n                '<span class=\"k-avatar-image\">' +\n                    '<img alt=\"#: name #\" src=\"#: avatar #\">' +\n                '</span>' +\n            '</div>' +\n        '# } #' +\n        '<div class=\"k-vstack k-card-title-wrap\">' +\n            '<div class=\"k-card-title k-text-ellipsis\">#: name #</div>' +\n            '# if(data.title) { #' +\n                '<span class=\"k-spacer\"></span>' +\n                '<div class=\"k-card-subtitle k-text-ellipsis\">#: title #</div>' +\n            '# } #' +\n        '</div>' +\n        '# if(editable) { #' +\n            '<span class=\"k-spacer\"></span>' +\n            '<div class=\"k-card-body-actions\">' +\n                '<button class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-orgchart-card-menu\" role=\"button\" aria-label=\"#: menuLabel #\" tabindex=\"-1\">' +\n                    '<span class=\"k-button-icon k-icon k-i-more-vertical\"></span>' +\n                '</button>' +\n            '</div>' +\n        '# } #' +\n    '</div>';\n\n    var CARD_WRAPPER = '<div role=\"treeitem\" data-uid=\"#: uid #\" ' +\n            '# if(data.hasChildren && data.guid) { #' +\n                'aria-owns=\"#: guid #\" ' +\n                '# if(!!data.expanded) { #' +\n                    'aria-expanded=\"true\" ' +\n                '# } else { #' +\n                    'aria-expanded=\"false\" ' +\n                '# } #' +\n            '# } #' +\n        'class=\"k-orgchart-card k-card ' +\n            '# if(!!data.cssClass) { #' +\n                '#: data.cssClass #' +\n            '# } #' +\n        '\" aria-keyshortcuts=\"Enter\" aria-level=\"#: level #\" aria-selected=\"false\">' +\n    '</div>';\n\n    var GROUPED_CARD_WRAPPER = '<div role=\"treeitem\" data-uid=\"#: uid #\" aria-level=\"#: level #\" aria-selected=\"false\" aria-keyshortcuts=\"Enter\" ' +\n    'class=\"k-orgchart-card k-card ' +\n        '# if(!!data.cssClass) { #' +\n            '#: data.cssClass #' +\n        '# } #' +\n    '\"></div>';\n\n    var View = kendo.Observable.extend({\n        init: function(element, options) {\n            this.element = element;\n            this.options = options || {};\n\n            kendo.Observable.fn.init.call(this);\n\n            this._attachEvents();\n        },\n\n        events: [\n            COLLAPSE,\n            EXPAND,\n            SELECT,\n            MENU\n        ],\n\n        destroy: function() {\n            kendo.ui.Widget.fn.destroy.call(this);\n            this.element.off(NS);\n        },\n\n        collapse: function() {\n            return false;\n        },\n\n        expand: function() {\n            return false;\n        },\n\n        jqueryGroupElement: function(group) {\n            if(!group) {\n                return;\n            }\n\n            var jQueryElement = this._processItem(group);\n\n            if(!jQueryElement.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                jQueryElement = jQueryElement.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n\n            return jQueryElement && jQueryElement.length ? jQueryElement : null;\n        },\n\n        jqueryItemElement: function(item) {\n            if(!item) {\n                return;\n            }\n\n            var jQueryElement = this._processItem(item);\n\n            if(!jQueryElement.hasClass(ORGCHART_STYLES.card)) {\n                jQueryElement = jQueryElement.closest(DOT + ORGCHART_STYLES.card);\n            }\n\n            return jQueryElement && jQueryElement.length ? jQueryElement : null;\n        },\n\n        refresh: function() {\n            this._cacheFocused();\n            this._clearContent();\n            this._generateItemsTree();\n            this._calculateLevels();\n            this._render();\n        },\n\n        select: function(item) {\n            var $item = this._getToSelect(item),\n                previousSelection = this.element.find(\"[tabindex=0]\");\n\n            if(!$item) {\n                return;\n            }\n\n            previousSelection.removeAttr(TABINDEX)\n                .removeClass(ORGCHART_STYLES.focused)\n                .attr(ARIA_SELECTED, false);\n\n            $item.attr(TABINDEX, \"0\")\n                .addClass(ORGCHART_STYLES.focused)\n                .trigger(\"focus\")\n                .attr(ARIA_SELECTED, true);\n        },\n\n        _attachEvents: function() {\n            var itemsSelector = DOT + ORGCHART_STYLES.card + COMMA + DOT + ORGCHART_STYLES.nodesGroupContainer;\n\n            this.element.on(KEYDOWN + NS, itemsSelector, proxy(this._onKeyDown, this))\n                .on(CLICK + NS, itemsSelector, proxy(this._onSelect, this))\n                .on(CLICK + NS, DOT + ORGCHART_STYLES.button, proxy(this._onButtonClick, this))\n                .on(FOCUS + NS, itemsSelector, proxy(this._onFocus, this))\n                .on(BLUR + NS, DOT + ORGCHART_STYLES.focused, proxy(this._onBlur, this));\n        },\n\n        _cacheFocused: function() {\n            var focusableItem = this.element.find(\"[tabindex='0']\"),\n                focusableDataItem = this._dataItems(focusableItem);\n\n            if(!focusableItem.length || !focusableDataItem || !focusableDataItem.length || !!this._idTabIndex) {\n                return;\n            }\n\n            this._idTabIndex = focusableDataItem[0].get(ID);\n\n            if(focusableItem.hasClass(ORGCHART_STYLES.focused)) {\n                this._shouldRestoreSelection = true;\n            } else {\n                this._shouldRestoreSelection = false;\n            }\n        },\n\n        _calculateDimensions: function() {\n            var itemElement = this.element.find(DOT + this._selector).first();\n\n            if(!this._buttonHeight) {\n                this._buttonHeight = this.element.find(DOT + ORGCHART_STYLES.button).first().outerHeight();\n            }\n\n            if(!this._spacing) {\n                this._spacing = this.element.find(DOT + ORGCHART_STYLES.lineVertical).first().outerHeight();\n            }\n\n            if(!this._itemWidth) {\n                this._itemWidth = this._calculateItemWidth();\n            }\n\n            if(!this._itemHeight) {\n                this._itemHeight = itemElement.outerHeight(true);\n            }\n        },\n\n        _calculateItemWidth: function() {\n            return false;\n        },\n\n        _calculateLevel: function() {\n            return false;\n        },\n\n        _calculateLevels: function() {\n            return false;\n        },\n\n        _clearContent: function() {\n            this.element.empty();\n        },\n\n        _dataItem: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if(!$item || !$item.data(UID)) {\n                return;\n            }\n\n            return this.dataSource.getByUid($item.data(UID));\n        },\n\n        _dataItems: function() {\n            return false;\n        },\n\n        _generateItemsTree: function() {\n            return false;\n        },\n\n        _getToSelect: function() {\n            return false;\n        },\n\n        _groupIsVertical: function() {\n            return false;\n        },\n\n        _keyCollapse: function() {\n            return false;\n        },\n\n        _keyExpand: function() {\n            return false;\n        },\n\n        _keyNext: function() {\n            return false;\n        },\n\n        _keyPrev: function() {\n            return false;\n        },\n\n        _keyEnter: function() {\n            return false;\n        },\n\n        _keyEscape: function() {\n            return false;\n        },\n\n        _keyEnd: function() {\n            var target = this.element.find(DOT + ORGCHART_STYLES.card).last(),\n                previous = this.element.find(\"[tabindex=0]\");\n\n\n            if(previous[0] === target[0]) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: [this._dataItem(target)]\n            });\n        },\n\n        _keyHome: function() {\n            var target = this.element.find(DOT + ORGCHART_STYLES.card).first(),\n                previous = this.element.find(\"[tabindex=0]\");\n\n\n            if(previous[0] === target[0]) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: [this._dataItem(target)]\n            });\n        },\n\n        _onBlur: function() {\n            this.element.find(DOT + ORGCHART_STYLES.focused).removeClass(ORGCHART_STYLES.focused);\n        },\n\n        _onKeyDown: function(e) {\n            var key = e.keyCode,\n                focused = this.element.find(\"[tabindex=0]\"),\n                isRtl = kendo.support.isRtl(this.element),\n                nextKey = isRtl ? [ keys.LEFT ] : [ keys.RIGHT ],\n                prevKey = isRtl ? [ keys.RIGHT ] : [ keys.LEFT ],\n                expandKey = keys.DOWN,\n                collapseKey = keys.UP,\n                groupIsVertical;\n\n            if(!focused) {\n                return;\n            }\n\n            groupIsVertical = this._groupIsVertical(focused);\n\n            if(groupIsVertical) {\n                nextKey.push(keys.DOWN);\n                prevKey.push(keys.UP);\n            }\n\n            if(key === keys.HOME) {\n                this._keyHome();\n            } else if(key === keys.END) {\n                this._keyEnd();\n            } else if(nextKey.indexOf(key) > -1) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyNext(focused);\n            } else if(prevKey.indexOf(key) > -1) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyPrev(focused);\n            } else if(key === expandKey) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyExpand(focused);\n            } else if(key === collapseKey) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyCollapse(focused);\n            } else if(key === keys.ENTER) {\n                this._keyEnter(focused);\n            } else if(key === keys.ESC) {\n                this._keyEscape(focused);\n            }\n        },\n\n        _onButtonClick: function(e) {\n            var that = this,\n                target = $(e.currentTarget),\n                shouldExpand = target.find(DOT + ORGCHART_STYLES.plusIcon).length > 0 ? true : false,\n                el = target.siblings(DOT + this._selector),\n                items = this._dataItems(el),\n                i;\n\n            if(shouldExpand) {\n                if(that.trigger(EXPAND, { item: el, dataItems: items })) {\n                    return;\n                }\n            } else {\n                if(that.trigger(COLLAPSE, { item: el, dataItems: items })) {\n                    return;\n                }\n            }\n\n            for(i = 0; i < items.length; i++) {\n                that.dataSource.toggleChildren(items[i], shouldExpand).then(proxy(this.refresh, this));\n            }\n        },\n\n        _onFocus: function() {\n            return false;\n        },\n\n        _onSelect: function() {\n            return false;\n        },\n\n        _orientation: function() {\n            return false;\n        },\n\n        _processItem: function(el) {\n            var jQueryElement;\n\n            // Substitute with kendo.type() when merged and taken from master\n            if($.type(el) === STRING) {\n                jQueryElement = this.element.find(el);\n            } else if(kendo.isElement(el)) {\n                jQueryElement = $(el);\n            } else if(el instanceof jQuery) {\n                jQueryElement = el;\n            }\n\n            return jQueryElement;\n        },\n\n        _render: function() {\n            var items = this._itemsTree,\n                root = $(kendo.template(ROOT_TEMPLATE)({ label: this.options.messages.label })),\n                wrapperContainer = this.element,\n                total = this._total,\n                widgetPadding = wrapperContainer.closest(DOT + ORGCHART_STYLES.wrapper).css(\"padding-left\"),\n                totalWidth;\n\n            wrapperContainer.append(root);\n\n            this._renderGroup(root, items, 1, this._total, 0);\n            totalWidth = total * this._itemWidth + (total - 1) * this._spacing;\n            root.width(totalWidth);\n            wrapperContainer.width(totalWidth + Number(widgetPadding.split(PX)[0]));\n\n            this._setHeight();\n            this._restoreSelection();\n        },\n\n        _renderNode: function(cardWrapperTemplate, contentTemplate, item, level, guid) {\n            var messages = this.options.messages,\n                borderColors = this.options.cardsColors || kendo.getSeriesColors(),\n                node = $(ITEM_TEMPLATE),\n                content, cardWrapper;\n\n            cardWrapper = $(cardWrapperTemplate(extend(true, {}, item, {\n                menuLabel: messages.menuLabel,\n                level: level,\n                guid: guid,\n                editable: !!this.options.editable,\n                color: borderColors[level - 1] || borderColors[0]\n            })));\n\n            if(item.attributes) {\n                cardWrapper.attr(JSON.parse(JSON.stringify(item.attributes)));\n            }\n\n            content = $(contentTemplate(extend(true, {}, item, {\n                menuLabel: messages.menuLabel,\n                level: level,\n                guid: guid,\n                editable: !!this.options.editable,\n                color: borderColors[level - 1] || borderColors[0]\n            })));\n\n            cardWrapper.append(content);\n            node.append(cardWrapper);\n\n            return node;\n        },\n\n        _renderGroup: function() {\n            return false;\n        },\n\n        _restoreSelection: function() {\n            var toFocusItem, toFocus;\n\n            if(!this._idTabIndex) {\n                toFocus = this.element.find(DOT + this._selector).first();\n\n                toFocus.attr(TABINDEX, \"0\");\n            } else {\n                toFocusItem = this.dataSource.get(this._idTabIndex);\n                toFocus = toFocusItem ? this._getToFocus(toFocusItem) : this.element.find(DOT + this._selector).first();\n                toFocus.attr(TABINDEX, \"0\");\n\n                this._idTabIndex = null;\n            }\n\n            if(this._shouldRestoreSelection) {\n                this._shouldRestoreSelection = false;\n                this._preventTriggerSelect = true;\n                toFocus.trigger(\"focus\");\n                toFocus.addClass(ORGCHART_STYLES.focused);\n            }\n        },\n\n        _setHeight: function() {\n            var selector = this._selector,\n                elements = this.element.find(DOT + ORGCHART_STYLES.button + COMMA + DOT + selector),\n                min = Number.MAX_VALUE, max = 0,\n                buttonHeight;\n\n            this._calculateDimensions();\n\n            buttonHeight = this._buttonHeight;\n            this.element.find(DOT + ORGCHART_STYLES.lineVerticalTop).height(this._spacing + buttonHeight / 2);\n\n            elements.each(function(i, el) {\n                var top = $(el).offset().top,\n                    bottom = top + $(el).outerHeight(true);\n\n                if(top < min) {\n                    min = top;\n                }\n\n                if(bottom > max) {\n                    max = bottom;\n                }\n            });\n\n            this.element.height(max - min);\n        }\n    });\n\n    var SingleView = View.extend({\n        init: function(element, options) {\n            View.fn.init.call(this, element, options);\n\n            this._selector = ORGCHART_STYLES.card;\n        },\n\n        collapse: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if(!$item) {\n                return;\n            }\n\n            this.dataSource.toggleChildren(this._dataItem($item), false).then(proxy(this.refresh, this));\n        },\n\n        expand: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if(!$item) {\n                return;\n            }\n\n            this.dataSource.toggleChildren(this._dataItem($item), true).then(proxy(this.refresh, this));\n        },\n\n        _calculateItemWidth: function() {\n            return this.element.find(DOT + this._selector).first().outerWidth(true);\n        },\n\n        _calculateLevel: function(items, level) {\n            var itemsLength = items.length,\n                maxColumnsPerLevel = this._maxColumnsPerLevel,\n                nestedChildren = false,\n                shouldReset = false,\n                previousMax, i, item;\n\n            if(!maxColumnsPerLevel[level] || maxColumnsPerLevel[level] < itemsLength) {\n                previousMax = maxColumnsPerLevel[level];\n                shouldReset = true;\n                maxColumnsPerLevel[level] = itemsLength;\n            }\n\n            for(i = 0; i < itemsLength; i++) {\n                item = items[i];\n\n                if(item.hasChildren) {\n                    nestedChildren = true;\n\n                    if(item.expanded) {\n                        this._calculateLevel(item.children, level + 1);\n                    }\n                }\n            }\n\n            if(!nestedChildren && shouldReset && level > 0) {\n                shouldReset = false;\n                maxColumnsPerLevel[level] = previousMax || 1;\n            }\n        },\n\n        _calculateLevels: function() {\n            var items = this._itemsTree,\n                maxColumnsPerLevel = this._maxColumnsPerLevel = [],\n                total = 1,\n                i;\n\n            this._calculateLevel(items, 0);\n\n            for(i = 0; i < maxColumnsPerLevel.length; i++) {\n                total = total * maxColumnsPerLevel[i];\n            }\n\n            this._total = total;\n        },\n\n        _dataItems: function(container) {\n            var item = this.dataSource.getByUid(container.data(UID));\n\n            if(item) {\n                return [item];\n            } else {\n                return null;\n            }\n        },\n\n        _generateItemsTree: function() {\n            this._itemsTree = this.dataSource.itemsTree();\n        },\n\n        _getToFocus: function(item) {\n            return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\");\n        },\n\n        _getToSelect: function(el) {\n            return this.jqueryItemElement(el);\n        },\n\n        _groupIsVertical: function(focused) {\n            var itemGroup = focused.closest(DOT + ORGCHART_STYLES.group);\n\n            return itemGroup.hasClass(ORGCHART_STYLES.groupVertical);\n        },\n\n        _keyCollapse: function(focused) {\n            var dataItem = this._dataItem(focused),\n                parentUid, parentItem;\n\n            if(dataItem.expanded) {\n                if(!this.trigger(COLLAPSE, { item: focused, dataItems: [dataItem] })) {\n                    this.collapse(focused);\n                }\n            } else if(dataItem.parentId) {\n                parentUid = this.dataSource.get(dataItem.parentId).get(UID);\n                parentItem = this.element.find(\"[data-uid='\" + parentUid + \"']\");\n\n                this.trigger(SELECT, {\n                    item: parentItem,\n                    dataItems: [this._dataItem(parentItem)]\n                });\n            }\n        },\n\n        _keyEnter: function(focused) {\n            if(focused.find(DOT + ORGCHART_STYLES.cardMenu).length > 0) {\n                this.trigger(MENU, focused);\n            }\n        },\n\n        _keyExpand: function(focused) {\n            var dataItem = this._dataItem(focused),\n                ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS)),\n                childItem;\n\n            if(!dataItem.hasChildren) {\n                return;\n            }\n\n            if(!dataItem.expanded) {\n                if(!this.trigger(EXPAND, { item: focused, dataItems: [dataItem] })) {\n                    this.expand(focused);\n                }\n            } else {\n                childItem = ownedGroup.find(DOT + this._selector).first();\n\n                this.trigger(SELECT, {\n                    item: childItem,\n                    dataItems: [this._dataItem(childItem)]\n                });\n            }\n        },\n\n        _keyNext: function(focused) {\n            var dataItem = this._dataItem(focused),\n                next = focused.parent().next(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS));\n\n            if(!next.length && dataItem.hasChildren && dataItem.expanded) {\n                next = ownedGroup.find(DOT + ORGCHART_STYLES.card).first();\n            }\n\n            if(next.length === 0 || next.hasClass(ORGCHART_STYLES.focused)) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: next,\n                dataItems: [this._dataItem(next)]\n            });\n        },\n\n        _keyPrev: function(focused) {\n            var dataItem = this._dataItem(focused),\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                parentUid;\n\n            if(!prev.length && dataItem.parentId) {\n                parentUid = this.dataSource.get(dataItem.parentId).get(UID);\n                prev = this.element.find(\"[data-uid='\" + parentUid + \"']\");\n            }\n\n            if(prev.length === 0 || prev.hasClass(ORGCHART_STYLES.focused)) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: prev,\n                dataItems: [this._dataItem(prev)]\n            });\n        },\n\n        _onFocus: function(e) {\n            var currentTarget = $(e.currentTarget),\n                target = $(e.target);\n\n            if(this._preventTriggerSelect) {\n                e.stopPropagation();\n                this._preventTriggerSelect = false;\n                return;\n            }\n\n            if(target.hasClass(ORGCHART_STYLES.cardMenu)) {\n                if(target.closest(\"[tabindex='0']\").length > 0) {\n                    e.stopPropagation();\n                    return;\n                } else {\n                    this._preventTriggerSelect = true;\n                }\n            }\n\n            if(!currentTarget.hasClass(ORGCHART_STYLES.card)) {\n                currentTarget = currentTarget.closest(DOT + ORGCHART_STYLES.card);\n            }\n\n            if(!currentTarget.hasClass(ORGCHART_STYLES.focused)) {\n                this.trigger(SELECT, {\n                    item: currentTarget,\n                    dataItems: [this._dataItem(currentTarget)]\n                });\n            }\n        },\n\n        _onSelect: function(e) {\n            var target = $(e.currentTarget),\n                item = target.hasClass(ORGCHART_STYLES.card) ? target : target.closest(DOT + ORGCHART_STYLES.card),\n                menuButtonTarget = $(e.target).hasClass(ORGCHART_STYLES.cardMenu) ? $(e.target) : $(e.target).closest(DOT + ORGCHART_STYLES.cardMenu);\n\n            if(menuButtonTarget.length > 0) {\n                return;\n            }\n\n            if(!target.hasClass(ORGCHART_STYLES.focused)) {\n                this.trigger(SELECT, {\n                    item: item,\n                    dataItems: [this._dataItem(item)]\n                });\n            }\n        },\n\n        _orientation: function(group, level, vertical) {\n            var vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical);\n\n            if(vertical && level > 1) {\n                group.addClass(ORGCHART_STYLES.groupVertical + SPACE + ORGCHART_STYLES.vstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.vstack);\n\n                if(group.find(DOT + ORGCHART_STYLES.button).length === 0 || group.find(DOT + ORGCHART_STYLES.card).length === 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).before(vLine.clone());\n                    group.find(DOT + ORGCHART_STYLES.node).first().find(DOT + ORGCHART_STYLES.lineVertical).addClass(ORGCHART_STYLES.lineVerticalTop);\n                } else if(level > 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).first().before(vLine.clone());\n                }\n            } else {\n                group.addClass(ORGCHART_STYLES.groupHorizontal + SPACE + ORGCHART_STYLES.hstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.hstack);\n\n                if(level > 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).before(vLine.clone().addClass(ORGCHART_STYLES.lineVerticalTop));\n                }\n            }\n        },\n\n        _renderGroup: function(group, items, level, parentColumns, parentLeft) {\n            var vertical = true,\n                nodeContainer;\n\n                nodeContainer = $(NODE_CONTAINER);\n                group.append(nodeContainer);\n                vertical = this._renderInner(nodeContainer, items, level, parentColumns, parentLeft);\n\n                this._orientation(group, level, vertical);\n        },\n\n        _renderInner: function(nodeContainer, items, level, parentColumns, parentLeft) {\n            var buttonTemplate = kendo.template(BUTTON_TEMPLATE),\n                cardWrapperTemplate = kendo.template(CARD_WRAPPER),\n                numberOfColumns = parentColumns / items.length,\n                vertical = true,\n                vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical),\n                hLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineHorizontal),\n                messages = this.options.messages,\n                i, item, guid, node, button, innerGroup, itemWidth, spacing, contentTemplate;\n\n            if(!this.options.template) {\n                contentTemplate = kendo.template(CARD_TEMPLATE);\n            } else if (typeof this.options.template === \"function\") {\n                contentTemplate = this.options.template;\n            } else {\n                contentTemplate = kendo.template(this.options.template);\n            }\n\n            for(i = 0; i < items.length; i++) {\n                item = items[i];\n                guid = kendo.guid();\n\n                node = this._renderNode(cardWrapperTemplate, contentTemplate, item, level, guid);\n\n                if(item.hasChildren) {\n                    node.append(vLine.clone());\n                    button = $(buttonTemplate({ buttonSign: item.expanded ? MINUS : PLUS, label: item.expanded ? messages.collapse : messages.expand }));\n                    node.append(button);\n                }\n\n                nodeContainer.append(node);\n\n                this._calculateDimensions();\n\n                itemWidth =  this._itemWidth;\n                spacing = this._spacing;\n\n                if(item.hasChildren) {\n                    vertical = false;\n\n                    if(item.expanded) {\n                        innerGroup = this._renderInnerGroup(item, numberOfColumns, parentLeft, i, level, guid);\n                    }\n                }\n\n                if(!!innerGroup && innerGroup.hasClass(ORGCHART_STYLES.groupHorizontal) && item.expanded && !!item.children && item.children.length > 1) {\n                    button.after(hLine.clone().css({\n                        width: (numberOfColumns - numberOfColumns / item.children.length) * (itemWidth + spacing) + PX,\n                        \"margin-top\": this._buttonHeight / -2 + PX\n                    }));\n                }\n            }\n\n            if(numberOfColumns > 1 && !vertical) {\n                nodeContainer.find(DOT + ORGCHART_STYLES.node).width((numberOfColumns - 1) * (spacing + itemWidth));\n            }\n\n            return vertical;\n        },\n\n        _renderInnerGroup: function(item, numberOfColumns, parentLeft, i, level, guid) {\n            var itemWidth =  this._itemWidth,\n                spacing = this._spacing,\n                width = numberOfColumns * itemWidth + (numberOfColumns - 1) * spacing,\n                left = (i * numberOfColumns * itemWidth) + parentLeft,\n                groupTemplate = kendo.template(GROUP_TEMPLATE),\n                offsetDirection = kendo.support.isRtl(this.element) ? \"right\" : \"left\",\n                top = level * (this._itemHeight + this._buttonHeight + spacing) + spacing * (level - 1) - this._buttonHeight / 2,\n                innerGroup;\n\n            if(i > 0) {\n                left += (i * numberOfColumns * spacing);\n            }\n\n            innerGroup = $(groupTemplate({\n                guid: guid,\n                level: level + 1\n            }));\n\n            innerGroup.css({\n                width: width + PX,\n                top: top + PX\n            });\n\n            innerGroup.css(offsetDirection, left + PX);\n\n            this.element.append(innerGroup);\n            this._renderGroup(innerGroup, item.children, level + 1, numberOfColumns, left);\n\n            return innerGroup;\n        }\n    });\n\n    var GroupedView = View.extend({\n        init: function(element, options) {\n            View.fn.init.call(this, element, options);\n\n            this._selector = ORGCHART_STYLES.nodesGroupContainer;\n        },\n\n        collapse: function(group) {\n            var $group = this.jqueryGroupElement(group),\n                dataItems, i;\n\n            if(!$group) {\n                return;\n            }\n\n            dataItems = this._dataItems($group);\n\n            for(i = 0; i < dataItems.length; i++) {\n                this.dataSource.toggleChildren(dataItems[i], false).then(proxy(this.refresh, this));\n            }\n        },\n\n        expand: function(group) {\n            var $group = this.jqueryGroupElement(group),\n                dataItems, i;\n\n            if(!$group) {\n                return;\n            }\n\n            dataItems = this._dataItems($group);\n\n            for(i = 0; i < dataItems.length; i++) {\n                this.dataSource.toggleChildren(dataItems[i], true).then(proxy(this.refresh, this));\n            }\n        },\n\n        _dataItems: function(container) {\n            var ds = this.dataSource,\n                dataItems = [],\n                items, item, current;\n\n            if(container.hasClass(ORGCHART_STYLES.card)) {\n                item = ds.getByUid(container.data(UID));\n\n                if(item) {\n                    dataItems.push(item);\n                }\n            } else if(container.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                this._groupFocused = true;\n\n                items = container.find(DOT + ORGCHART_STYLES.card);\n\n                items.each(function(i, item) {\n                    current = ds.getByUid(item.getAttribute(\"data-uid\"));\n\n                    if(current) {\n                        dataItems.push(current);\n                    }\n                });\n            }\n\n            return dataItems;\n        },\n\n        _calculateItemWidth: function() {\n            var itemElement = this.element.find(DOT + this._selector).first(),\n                cardWidth = this.element.find(DOT + ORGCHART_STYLES.card).first().outerWidth(true),\n                padding = Number(itemElement.css(\"padding-left\").split(PX)[0]),\n                border = Number(itemElement.css(\"border-left\").split(PX)[0]);\n\n            return cardWidth+ 2 * padding + 2* border;\n        },\n\n        _calculateLevel: function(groups, level) {\n            var groupsLength = groups.length,\n                nestedChildren = false,\n                maxColumns = 0,\n                currentLength, i, group;\n\n            this._maxColumnsPerLevel[level] = this._maxColumnsPerLevel[level] || 0;\n            this._maxGroups[level] = this._maxGroups[level] || 0;\n\n            for(i = 0; i < groupsLength; i++) {\n                group = groups[i];\n                currentLength = group.items.length;\n\n                if (currentLength > maxColumns) {\n                    maxColumns = currentLength;\n                }\n\n                group = groups[i];\n\n                if(group.hasChildren) {\n                    nestedChildren = true;\n\n                    if(group.expanded) {\n                        this._calculateLevel(group.children, level + 1);\n                    }\n                }\n            }\n\n            if(groupsLength > this._maxGroups[level]) {\n                this._maxGroups[level] = groupsLength;\n            }\n\n            if(!nestedChildren) {\n                maxColumns = 1;\n            }\n\n            if(maxColumns > this._maxColumnsPerLevel[level]) {\n                this._maxColumnsPerLevel[level] = maxColumns;\n            }\n        },\n\n        _calculateLevels: function() {\n            var items = this._itemsTree,\n                maxColumnsPerLevel = this._maxColumnsPerLevel = [],\n                maxGroups = this._maxGroups = [],\n                total = 1,\n                i, currentTotal;\n\n            this._calculateLevel(items, 0);\n\n            for(i = maxColumnsPerLevel.length - 1; i >= 0; i--) {\n                currentTotal = maxColumnsPerLevel[i] * maxGroups[i];\n\n                if(total > maxColumnsPerLevel[i]) {\n                    total = total * maxGroups[i];\n                } else if(total < currentTotal) {\n                    total = currentTotal;\n                }\n            }\n\n            this._total = total;\n        },\n\n        _generateItemsTree: function() {\n            this._itemsTree = this.dataSource.groupedItemsTree(this.options.groupField);\n        },\n\n        _getToFocus: function(item) {\n            if(!this._groupFocused) {\n                return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\");\n            } else {\n                this._groupFocused = false;\n                return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\").closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n        },\n\n        _getToSelect: function(el) {\n            var item = this.jqueryItemElement(el);\n\n            return item || this.jqueryGroupElement(el);\n        },\n\n        _groupIsVertical: function(focused) {\n            var itemGroup = focused.closest(DOT + ORGCHART_STYLES.nodeContainer);\n\n            return itemGroup.hasClass(ORGCHART_STYLES.vstack);\n        },\n\n        _keyCollapse: function(focused) {\n            var dataItems = [],\n                parentUid, expanded;\n\n            dataItems = this._dataItems(focused);\n\n            expanded = dataItems.some(function(item) {\n                return item.expanded;\n            });\n\n            if(expanded) {\n                if(focused.hasClass(ORGCHART_STYLES.card)) {\n                    focused = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                    dataItems = this._dataItems(focused);\n                }\n\n                if(!this.trigger(COLLAPSE, { item: focused, dataItems: dataItems })) {\n                    this.collapse(focused);\n                }\n            } else if(dataItems[0].parentId) {\n                parentUid = this.dataSource.get(dataItems[0].parentId).get(UID);\n\n                this.trigger(SELECT, {\n                    item: this.element.find(\"[data-uid='\" + parentUid + \"']\").closest(DOT + this._selector),\n                    dataItems: dataItems\n                });\n            }\n        },\n\n        _keyEnter: function(focused) {\n            var toSelect,\n                dataItems = [];\n\n            if(focused.hasClass(ORGCHART_STYLES.card) && focused.find(DOT + ORGCHART_STYLES.cardMenu).length > 0) {\n                this.trigger(MENU, focused);\n            } else {\n                toSelect = focused.find(DOT + ORGCHART_STYLES.card).first();\n                dataItems = this._dataItems(toSelect);\n\n                this.trigger(SELECT, {\n                    item: toSelect,\n                    dataItems: dataItems\n                });\n            }\n        },\n\n        _keyEscape: function(focused) {\n            if(!focused.hasClass(ORGCHART_STYLES.card)) {\n                return;\n            }\n\n            var group = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer),\n                dataItems = this._dataItems(group);\n\n            this.trigger(SELECT, {\n                item: group,\n                dataItems: dataItems\n            });\n        },\n\n        _keyExpand: function(focused) {\n            var ownedGroupId = focused.attr(ARIA_OWNS) || focused.closest(DOT + this._selector).attr(ARIA_OWNS),\n                ownedGroup = this.element.find(HASH + ownedGroupId),\n                dataItems = this._dataItems(focused),\n                hasChildren, expanded, item;\n\n            hasChildren = dataItems.some(function(item) {\n                return item.hasChildren;\n            });\n\n            if(!hasChildren) {\n                return;\n            }\n\n            expanded = dataItems.some(function(item) {\n                return item.expanded;\n            });\n\n            if(!expanded) {\n                if(focused.hasClass(ORGCHART_STYLES.card)) {\n                    focused = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                    dataItems = this._dataItems(focused);\n                }\n\n                if(!this.trigger(EXPAND, { item: focused, dataItems: dataItems })) {\n                    this.expand(focused);\n                }\n            } else {\n                item = ownedGroup.find(DOT + this._selector).first();\n\n                this.trigger(SELECT, {\n                    item: item,\n                    dataItems: this._dataItems(item)\n                });\n            }\n        },\n\n        _keyNext: function(focused) {\n            var ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS)),\n                dataItems = this._dataItems(focused),\n                hasChildren = dataItems.some(function(item) {\n                    return item.hasChildren;\n                }),\n                expanded = dataItems.some(function(item) {\n                    return item.expanded;\n                }),\n                next;\n\n                if(focused.hasClass(ORGCHART_STYLES.card)) {\n                    next = focused.parent().next(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card);\n                } else {\n                    next = focused.parent().next(DOT + ORGCHART_STYLES.nodesGroup).find(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n            if(!next.length && hasChildren && expanded) {\n                next = ownedGroup.find(DOT + this._selector).first();\n            }\n\n            if(next.length === 0) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: next,\n                dataItems: this._dataItems(next)\n            });\n        },\n\n        _keyPrev: function(focused) {\n            var dataItems = this._dataItems(focused),\n                parentUid, prev;\n\n            if(focused.hasClass(ORGCHART_STYLES.card)) {\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card);\n            } else {\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.nodesGroup).find(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n\n            if(!prev.length && dataItems[0].parentId) {\n                parentUid = this.dataSource.get(dataItems[0].parentId).get(UID);\n                prev = this.element.find(\"[data-uid='\" + parentUid + \"']\").closest(DOT + this._selector);\n            }\n\n            if(prev.length === 0) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: prev,\n                dataItems: this._dataItems(prev)\n            });\n        },\n\n        _onFocus: function(e) {\n            var target = $(e.target),\n                items, current;\n\n            if(this._preventTriggerSelect) {\n                e.stopPropagation();\n                this._preventTriggerSelect = false;\n                return;\n            }\n\n            if(target.hasClass(ORGCHART_STYLES.cardMenu)) {\n                if(target.closest(\"[tabindex='0']\").length > 0) {\n                    e.stopPropagation();\n                    return;\n                } else {\n                    this._preventTriggerSelect = true;\n                }\n            }\n\n            if(!target.hasClass(ORGCHART_STYLES.card) && !target.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                current = target.closest(DOT + ORGCHART_STYLES.card);\n\n                if(!current.length) {\n                    current = target.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n                target = current;\n            }\n\n            if(target.length === 0) {\n                return;\n            }\n\n            items = this._dataItems(target);\n\n            if(!target.hasClass(ORGCHART_STYLES.focused)) {\n                e.stopPropagation();\n                this.trigger(SELECT, {\n                    item: target,\n                    dataItems: items\n                });\n            }\n        },\n\n        _onSelect: function(e) {\n            var target = $(e.target),\n                previousSelection = this.element.find(\"[tabindex=0]\"),\n                items, current;\n\n            if(!target.hasClass(ORGCHART_STYLES.card) && !target.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                current = target.closest(DOT + ORGCHART_STYLES.card);\n\n                if(!current.length) {\n                    current = target.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n                target = current;\n            }\n\n            if(target.length === 0 || previousSelection[0] === target[0]) {\n                return;\n            }\n\n            items = this._dataItems(target);\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: items\n            });\n        },\n\n        _orientation: function(group, level, vertical) {\n            var vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical + SPACE + ORGCHART_STYLES.lineVerticalTop);\n\n            group.addClass(ORGCHART_STYLES.hstack);\n\n            if(level > 1) {\n                group.find(DOT + ORGCHART_STYLES.nodesGroupContainer).before(vLine.clone());\n            }\n\n            if(vertical && level > 1) {\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).removeClass(ORGCHART_STYLES.hstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.vstack);\n            } else {\n                group.addClass(ORGCHART_STYLES.groupHorizontal);\n            }\n        },\n\n        _renderChildren: function(item, index, numberOfColumns, level, nodesGroup, parentLeft, guid) {\n            var buttonTemplate = kendo.template(BUTTON_TEMPLATE),\n                groupTemplate = kendo.template(GROUP_TEMPLATE),\n                vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical),\n                hLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineHorizontal),\n                messages = this.options.messages,\n                vertical = true,\n                offsetDirection = kendo.support.isRtl(this.element) ? \"right\" : \"left\",\n                innerGroup, button, left, top, width, nodesGroupWidth, spacing;\n\n            if(item.hasChildren) {\n                vertical = false;\n                nodesGroup.append(vLine.clone());\n                button = $(buttonTemplate({ buttonSign: item.expanded ? MINUS : PLUS, label: item.expanded ? messages.collapse : messages.expand }));\n\n                nodesGroup.append(button);\n\n                this._calculateDimensions();\n\n                nodesGroupWidth =  this._itemWidth;\n                spacing = this._spacing;\n\n                if(item.expanded) {\n                    width = nodesGroupWidth * numberOfColumns + (numberOfColumns - 1) * spacing;\n                    left = (index * numberOfColumns * nodesGroupWidth) + parentLeft;\n                    top = level * (this._itemHeight + this._buttonHeight + spacing) + spacing * (level - 1) - this._buttonHeight / 2;\n\n                    if(index > 0) {\n                        left += (index * numberOfColumns * spacing);\n                    }\n\n                    innerGroup = $(groupTemplate({\n                        guid: guid,\n                        level: level + 1\n                    }));\n\n                    innerGroup.css({\n                        width: width + PX,\n                        top: top + PX\n                    });\n\n                    innerGroup.css(offsetDirection, left + PX);\n\n                    this.element.append(innerGroup);\n                    this._renderGroup(innerGroup, item.children, level + 1, numberOfColumns, left);\n                }\n            }\n\n            if(!!innerGroup && item.expanded && !!item.children && item.children.length > 1) {\n                button.after(hLine.clone().css({\n                    width: (numberOfColumns - numberOfColumns / item.children.length) * (nodesGroupWidth + spacing) + PX,\n                    \"margin-top\": this._buttonHeight / -2 + PX\n                }));\n            }\n\n            return vertical;\n        },\n\n        _renderGroup: function(group, items, level, parentColumns, parentLeft) {\n            var vertical = true,\n                numberOfColumns = parentColumns / items.length,\n                nodeContainer, nodesGroup, i, guid, currentVertical, item;\n\n            for(i = 0; i < items.length; i++) {\n                guid = kendo.guid();\n                item = items[i];\n                nodeContainer = this._renderNodesContainer(group, extend(true, {}, item, {\n                    guid: guid,\n                    level: level\n                }));\n                nodesGroup = nodeContainer.closest(DOT + ORGCHART_STYLES.nodesGroup);\n\n                this._renderItems(nodeContainer, item.items, level, guid);\n                currentVertical = this._renderChildren(item, i, numberOfColumns, level, nodesGroup, parentLeft, guid);\n\n                if(vertical) {\n                    vertical = currentVertical;\n                }\n            }\n\n            var width = this._itemWidth * numberOfColumns + (numberOfColumns - 1) * this._spacing;\n            group.find(DOT + ORGCHART_STYLES.nodesGroup).width(width);\n\n            this._orientation(group, level, vertical);\n        },\n\n        _renderItems: function(nodeContainer, items, level, guid) {\n            var cardWrapperTemplate = kendo.template(GROUPED_CARD_WRAPPER),\n                i, item, node, contentTemplate;\n\n            if(!this.options.template) {\n                contentTemplate = kendo.template(CARD_TEMPLATE);\n            } else if (typeof this.options.template === \"function\") {\n                contentTemplate = this.options.template;\n            } else {\n                contentTemplate = kendo.template(this.options.template);\n            }\n\n            for(i = 0; i < items.length; i++) {\n                item = items[i];\n                node = this._renderNode(cardWrapperTemplate, contentTemplate, item, level, guid);\n                nodeContainer.append(node);\n            }\n        },\n\n        _renderNodesContainer: function(group, data) {\n            var nodeGroupContainerTemplate = kendo.template(NODE_GROUP_CONTAINER),\n                nodeGroup = $('<div class=\"k-orgchart-node-group k-align-items-center k-vstack\">'),\n                nodeContainer = $(NODE_CONTAINER_GROUPED),\n                nodeGroupContainer = $(nodeGroupContainerTemplate(data)),\n                groupHeaderTemplate;\n\n                if (typeof this.options.groupHeaderTemplate === \"function\") {\n                    groupHeaderTemplate = this.options.groupHeaderTemplate;\n                } else {\n                    groupHeaderTemplate = kendo.template(this.options.groupHeaderTemplate);\n                }\n\n            nodeGroupContainer.append(groupHeaderTemplate({\n                value: data.value,\n                field: data.field\n            }));\n            nodeGroupContainer.append(nodeContainer);\n\n            nodeGroup.append(nodeGroupContainer);\n            group.append(nodeGroup);\n\n            return nodeContainer;\n        }\n    });\n\n    kendo.orgChart = {\n        View: View,\n        SingleView: SingleView,\n        GroupedView: GroupedView\n    };\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n(function(f, define){\n    define('kendo.orgchart',[ \"./orgchart/data\", \"./orgchart/view\", \"./kendo.menu\", \"./kendo.dialog\", \"./kendo.form\", \"./kendo.upload\", \"./kendo.window\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"orgchart\",\n    name: \"OrgChart\",\n    category: \"web\",\n    description: \"The OrgChart widget displays hierarchical organizational structure.\",\n    depends: [ \"core\", \"menu\", \"dialog\", \"form\", \"upload\", \"window\" ]\n};\n\n(function ($, undefined) {\n    var kendo = window.kendo,\n        DataBoundWidget = kendo.ui.DataBoundWidget,\n        OrgChartDataSource = kendo.data.OrgChartDataSource,\n        ContextMenu = kendo.ui.ContextMenu,\n\n        extend = $.extend,\n        proxy = $.proxy,\n        isArray = Array.isArray,\n\n        NS = \".kendoOrgChart\",\n\n        CANCEL = \"cancel\",\n        CHANGE = \"change\",\n        CLICK = \"click\",\n        COLLAPSE = \"collapse\",\n        CREATE = \"create\",\n        DATABINDING = \"dataBinding\",\n        DATABOUND = \"dataBound\",\n        DELETE = \"delete\",\n        DESTROY = \"destroy\",\n        EDIT = \"edit\",\n        ERROR = \"error\",\n        EXPAND = \"expand\",\n        FOCUS = \"focus\",\n        KENDOKEYDOWN = \"kendoKeydown\",\n        MENU = \"menu\",\n        PROGRESS = \"progress\",\n        SAVE = \"save\",\n        SELECT = \"select\",\n        REQUEST_START = \"requestStart\",\n\n        DOT = \".\",\n        SPACE = \" \",\n        COMMA = \",\",\n        ID = \"id\",\n        UID = \"uid\",\n        ACTION = \"action\";\n\n    var ORGCHART_STYLES = {\n        wrapper: \"k-orgchart\",\n        container: \"k-orgchart-container\",\n        line: \"k-orgchart-line\",\n        lineVertical: \"k-orgchart-line-v\",\n        lineHorizontal: \"k-orgchart-line-h\",\n        lineVerticalTop: \"k-orgchart-line-v-top\",\n        group: \"k-orgchart-group\",\n        groupVertical: \"k-orgchart-group-v\",\n        groupHorizontal: \"k-orgchart-group-h\",\n        nodesGroup: \"k-orgchart-node-group\",\n        nodesGroupContainer: \"k-orgchart-node-group-container\",\n        nodeContainer: \"k-orgchart-node-container\",\n        node: \"k-orgchart-node\",\n        card: \"k-orgchart-card\",\n        cardMenu: \"k-orgchart-card-menu\",\n        button: \"k-orgchart-button\",\n        focused: \"k-state-focus\",\n        plusIcon: \"k-i-plus\",\n        menuItem: \"k-item\",\n        avatarPreview: \"k-orgchart-avatar-preview\",\n        update: \"k-orgchart-update\",\n        cancel: \"k-orgchart-cancel\",\n        vstack: \"k-vstack\",\n        hstack: \"k-hstack\",\n        closeButton: \"k-i-close\"\n    };\n\n    var MENU_ITEMS = {\n        edit: \"<li data-action='edit'>#: edit #</li>\",\n        create: \"<li data-action='create'>#: create #</li>\",\n        destroy: \"<li data-action='destroy'>#: destroy #</li>\"\n    };\n\n    var GROUP_HEADER_TEMPLATE = '<div>' +\n        '<div class=\"k-orgchart-node-group-title\">#: value #</div>' +\n        '<div class=\"k-orgchart-node-group-subtitle\">#: field #</div>' +\n    '</div>';\n\n    var AVATAR_PREVIEW_TEMPLATE = '<div class=\"k-orgchart-avatar-preview k-hstack k-align-items-center k-pb-lg\">' +\n        '<div class=\"k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full\">' +\n            '<span class=\"k-avatar-image\">' +\n                '<img src=\"#: avatar #\" alt=\"#: name #\">' +\n            '</span>' +\n        '</div>' +\n        '<div class=\"k-px-md\">#: fileName #</div>' +\n        '<button class=\"k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button\" aria-label=\"#: destroy #\">' +\n            '<span class=\"k-button-icon k-icon k-i-delete\"></span>' +\n        '</button>' +\n    '</div>';\n\n    var EDITOR_BUTTONS_TEMPLATE = '<div class=\"k-edit-buttons\">' +\n        '<button type=\"button\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-orgchart-cancel\">' +\n            '<span class=\"k-button-text\">#: cancel #</span>' +\n        '</button>' +\n        '<button type=\"button\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary k-orgchart-update\">' +\n            '<span class=\"k-button-text\">#: save #</span>' +\n        '</button>' +\n    '</div>';\n\n    var OrgChart = DataBoundWidget.extend({\n        init: function(element, options, events) {\n            if (isArray(options)) {\n                options = { dataSource: options };\n            }\n\n            options = options || {};\n\n            DataBoundWidget.fn.init.call(this, element, options);\n\n            if (events) {\n                this._events = events;\n            }\n\n            this._wrapper();\n            this._view();\n            this._dataSource();\n            this._contextMenu();\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n\n            kendo.notify(this);\n        },\n\n        options: {\n            name: \"OrgChart\",\n            autoBind: true,\n            cardsColors: null,\n            dataSource: {},\n            editable: {\n                create: true,\n                destroy: true,\n                fields: true,\n                form: {\n                    buttonsTemplate: \"\",\n                    orientation: \"vertical\"\n                },\n                parent: true\n            },\n            groupField: null,\n            groupHeaderTemplate: GROUP_HEADER_TEMPLATE,\n            template: null,\n            messages: {\n                label: \"Org Chart\",\n                edit: \"Edit\",\n                create: \"Create\",\n                destroy: \"Delete\",\n                destroyContent: \"Are you sure you want to delete this item and all its children?\",\n                destroyTitle: \"Delete item\",\n                cancel: \"Cancel\",\n                save: \"Save\",\n                menuLabel: \"Edit menu\",\n                uploadAvatar: \"Upload new avatar\",\n                parent: \"Parent\",\n                name: \"Name\",\n                title: \"Title\",\n                none: \"--None--\",\n                expand: \"expand\",\n                collapse: \"collapse\"\n            }\n        },\n\n        events: [\n            CANCEL,\n            CHANGE,\n            COLLAPSE,\n            CREATE,\n            DATABINDING,\n            DATABOUND,\n            DELETE,\n            EDIT,\n            EXPAND,\n            KENDOKEYDOWN,\n            SAVE,\n            SELECT\n         ],\n\n        destroy: function() {\n            if(this._menu) {\n                this._menu.destroy();\n            }\n            if(this._editWindow) {\n                this._editWindow.destroy();\n            }\n            if(this._confirmDestroy) {\n                this._confirmDestroy.destroy();\n            }\n\n            this.view.destroy();\n\n            DataBoundWidget.fn.destroy.call(this);\n            this.wrapper.off(NS);\n        },\n\n        setDataSource: function(dataSource) {\n            this.options.dataSource = dataSource;\n            this._dataSource();\n\n            if (this.options.autoBind) {\n                dataSource.fetch();\n            }\n        },\n\n        setOptions: function(options) {\n            var that = this;\n\n            DataBoundWidget.fn.setOptions.call(that, options);\n        },\n\n        append: function(item, parent) {\n            var that = this,\n                $parent = that.view.jqueryItemElement(parent),\n                parentItem = that.dataItem($parent);\n\n            if(!$parent || !parentItem) {\n                return;\n            }\n\n            if(!parentItem.loaded()) {\n                that.dataSource.read({ id: parentItem.id })\n                    .then(function() {\n                        that.dataSource.add(extend({}, item, { parentId: parentItem.id }));\n                        that.dataSource.sync();\n                    });\n            } else {\n                that.dataSource.add(extend({}, item, { parentId: parentItem.id }));\n                that.dataSource.sync();\n            }\n        },\n\n        cancelChanges: function() {\n            if(this.dataSource.hasChanges()) {\n                this.dataSource.cancelChanges();\n            }\n        },\n\n        collapse: function(item) {\n            return this.view.collapse(item);\n        },\n\n        dataItem: function(item) {\n            var $item = this.view.jqueryItemElement(item);\n\n            if(!$item || !$item.data(UID)) {\n                return;\n            }\n\n            return this.dataSource.getByUid($item.data(UID));\n        },\n\n        delete: function(item) {\n            var $item = this.view.jqueryItemElement(item);\n\n            if(!$item) {\n                return;\n            }\n\n            this.dataSource.remove(this.dataItem($item));\n            this.dataSource.sync();\n        },\n\n        edit: function(item) {\n            var $item = this.view.jqueryItemElement(item),\n                dataItem = this.dataItem($item);\n\n            if(!$item || !dataItem) {\n                return;\n            }\n\n            this._edit(dataItem);\n        },\n\n        expand: function(item) {\n            return this.view.expand(item);\n        },\n\n        getCollapsedNodes: function() {\n            return this.wrapper.find(\"[aria-expanded='false']\");\n        },\n\n        items: function() {\n            return this.wrapper.find(DOT + ORGCHART_STYLES.card);\n        },\n\n        parent: function(item) {\n            var $item = this.view.jqueryItemElement(item),\n                id;\n\n            if(!$item) {\n                return;\n            }\n\n            id = $item.closest(DOT + ORGCHART_STYLES.group).attr(ID);\n\n            return this.wrapper.find(\"[aria-owns='\" + id + \"']\");\n        },\n\n        saveChanges: function() {\n            this.dataSource.sync();\n        },\n\n        select: function(item) {\n            var $item = this.view._getToSelect(item);\n\n            if(!$item) {\n                return;\n            } else {\n                return this.view.select($item);\n            }\n        },\n\n        _avatarPreview: function(item, fileName) {\n            var form = this._form,\n                avatar = item.avatar,\n                avatarRemove = function() {\n                    formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview).remove();\n                    item.set(\"avatar\", null);\n                },\n                formWrapper, data;\n\n            if(!form) {\n                return;\n            }\n\n            if (!fileName) {\n                fileName = avatar.split('\\\\').pop().split('/').pop();\n\n                if (!fileName || fileName.indexOf('.') == -1) {\n                    fileName = item.name;\n                }\n            }\n\n            data = {\n                name: item.name,\n                avatar: avatar,\n                fileName: fileName,\n                destroy: this.options.messages.destroy\n            };\n\n            formWrapper = form.wrapper;\n            formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview).remove();\n\n            formWrapper.find('[type=\"file\"]').closest(DOT + \"k-form-field\").prepend(kendo.template(AVATAR_PREVIEW_TEMPLATE)(data));\n            formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview + SPACE + DOT + \"k-button\").on(CLICK, avatarRemove);\n        },\n\n        _contextMenu: function() {\n            var options = this.options,\n                editable = options.editable,\n                messages = options.messages,\n                menuOptions = {\n                    target: this.wrapper,\n                    filter: DOT + ORGCHART_STYLES.cardMenu,\n                    select: this._onMenuItemClick.bind(this),\n                    activate: this._onMenuOpen.bind(this),\n                    deactivate: this._onMenuClose.bind(this),\n                    showOn: \"click\",\n                    animation: false\n                },\n                menuElement;\n\n            if(editable === true ||\n                (editable !== false &&\n                    (editable.create || editable.destroy || editable.fields || editable.parent))) {\n                        menuElement = \"<ul>\";\n\n                        if(editable === true) {\n                            menuElement += MENU_ITEMS.edit;\n                            menuElement += MENU_ITEMS.create;\n                            menuElement += MENU_ITEMS.destroy;\n                        } else {\n                            if (editable.fields || editable.parent) {\n                                menuElement += MENU_ITEMS.edit;\n                            }\n                            if (editable.create) {\n                                menuElement += MENU_ITEMS.create;\n                            }\n                            if (editable.destroy) {\n                                menuElement += MENU_ITEMS.destroy;\n                            }\n                        }\n\n                        menuElement = kendo.template(menuElement)(messages);\n\n                        this._menu = new ContextMenu(menuElement, menuOptions);\n                    }\n        },\n\n        _dataSource: function() {\n            var ds = this.dataSource,\n                dsOptions = this.options.dataSource;\n\n            if (ds) {\n                ds.unbind(CHANGE, this._dataSourceChangeHandler);\n                ds.unbind(ERROR, this._errorHandler);\n                ds.unbind(PROGRESS, this._progressHandler);\n                ds.unbind(REQUEST_START, this._requestStartHandler);\n            }\n\n            this._dataSourceChangeHandler = proxy(this._onDataSourceChange, this);\n            this._errorHandler = proxy(this._onDataSourceError, this);\n            this._progressHandler = proxy(this._progress, this);\n            this._requestStartHandler = proxy(this._onDataSourceRequestStart, this);\n\n            ds = this.dataSource = OrgChartDataSource.create(dsOptions);\n\n            ds.bind(CHANGE, this._dataSourceChangeHandler);\n            ds.bind(ERROR, this._errorHandler);\n            ds.bind(PROGRESS, this._progressHandler);\n            ds.bind(REQUEST_START, this._requestStartHandler);\n\n            this.view.dataSource = ds;\n        },\n\n        _destroyItem: function(item) {\n            var that = this,\n                el = $(\"<div></div>\"),\n                messages = that.options.messages,\n                restoreFocus = function() {\n                    that.wrapper\n                        .find(DOT + ORGCHART_STYLES.card + \"[tabindex=0]\" + COMMA + DOT + ORGCHART_STYLES.nodesGroup + \"[tabindex=0]\")\n                        .addClass(ORGCHART_STYLES.focused)\n                        .trigger(\"focus\");\n                },\n                confirm = this._confirmDestroy = new kendo.ui.Confirm(el, {\n                    title: messages.destroyTitle,\n                    content: messages.destroyContent,\n                    messages:{\n                      okText: messages.destroy,\n                      cancel: messages.cancel\n                    },\n                    show: function() {\n                        setTimeout(function() {\n                            confirm.element.trigger(\"focus\");\n                        });\n                    }\n                });\n\n            confirm.open();\n\n            confirm.result.done(function() {\n                if(!that.trigger(DELETE, { dataItem: item })) {\n                    that.dataSource.remove(item);\n                    that.dataSource.sync();\n                }\n\n                that.view._shouldRestoreSelection = true;\n                that.view._restoreSelection();\n            });\n\n            confirm.result.fail(restoreFocus);\n        },\n\n        _edit: function(dataItem) {\n            var that = this,\n                formElement = $(\"<div>\"),\n                windowElement = $(\"<div>\"),\n                messages = this.options.messages,\n                formOptions = this._formOptions(dataItem),\n                save;\n\n            if(!formOptions) {\n                return;\n            }\n\n            that._form = new kendo.ui.Form(formElement, formOptions);\n\n            if(!!dataItem.avatar) {\n                that._avatarPreview(dataItem);\n            }\n\n            windowElement.append(formElement);\n\n            that._editWindow = new kendo.ui.Window(windowElement, {\n                title: messages.edit,\n                width: \"380 px\",\n                modal: true,\n                close: function(e) {\n                    if(!save) {\n                        if(!that.trigger(CANCEL, { dataItem: dataItem })) {\n                            that.cancelChanges();\n                        } else {\n                            e.preventDefault();\n                        }\n                    } else {\n                        save = false;\n                    }\n                },\n                deactivate: function() {\n                    windowElement.off(CLICK);\n                    that._editWindow.destroy();\n                    that._editWindow = null;\n                    that.view._restoreSelection();\n                }\n            });\n\n            windowElement.append(kendo.template(EDITOR_BUTTONS_TEMPLATE)({\n                save: messages.save,\n                cancel: messages.cancel\n            }));\n\n            that._editWindow.center().open();\n\n            windowElement.on(CLICK, DOT + ORGCHART_STYLES.update, function() {\n                if(that._form.validate()) {\n                    save = true;\n\n                    if(!that.trigger(SAVE, { dataItem: dataItem })) {\n                        that._editWindow.close();\n                        that.saveChanges();\n                    }\n                }\n            });\n\n            windowElement.on(CLICK, DOT + ORGCHART_STYLES.cancel, function() {\n                that._editWindow.close();\n            });\n        },\n\n        _formOptions: function(item) {\n            var options = this.options,\n                messages = options.messages,\n                optionsForm = options.editable.form,\n                items = [],\n                parentsDs, optionsItems;\n\n            if(optionsForm) {\n                optionsItems = optionsForm.items;\n            }\n\n            if((!optionsItems || optionsItems.length === 0) &&\n                (options.editable === true || (options.editable && options.editable.parent))) {\n\n                parentsDs = [{\n                    id: null,\n                    name: messages.none\n                }].concat(this.dataSource.prospectParents(item));\n\n                items.push({\n                    field: \"parentId\",\n                    editor: \"DropDownList\",\n                    label: messages.parent,\n                    editorOptions: {\n                        dataSource: parentsDs,\n                        dataValueField: \"id\",\n                        dataTextField: \"name\",\n                        valuePrimitive: true\n                    }\n                });\n            }\n\n            if((!optionsItems || optionsItems.length === 0) &&\n                (options.editable === true || (options.editable && options.editable.fields))) {\n\n                items = items.concat([{\n                    field: \"name\",\n                    label: messages.name,\n                    validation: { required: true }\n                }, {\n                    field: \"title\",\n                    label: messages.title\n                }, {\n                    field: \"avatar\",\n                    label: messages.uploadAvatar,\n                    editor: proxy(this._uploadEditor, this, item)\n                }]);\n            }\n\n            if(optionsForm) {\n                delete optionsForm.formData;\n            }\n\n            if(items.length > 0 || (optionsItems && optionsItems.length > 0)) {\n                return extend(true, {}, {\n                    formData: item,\n                    items: items\n                }, optionsForm);\n            } else {\n                return false;\n            }\n        },\n\n        _onDataSourceChange: function(e) {\n            if(e.action === \"add\" || e.action === \"itemchange\" && this._editWindow) {\n                return;\n            }\n\n            if (!e.action || e.action === \"sync\") {\n                if (this.trigger(DATABINDING, e)) {\n                    this._progress(false);\n                    return;\n                }\n            }\n\n            this._progress(true);\n            this.view.refresh();\n\n            if (!e.action || e.action === \"sync\") {\n                this.trigger(DATABOUND);\n            }\n\n            this._progress(false);\n        },\n\n        _onDataSourceError: function() {\n            this._progress(false);\n        },\n\n        _onDataSourceRequestStart: function() {\n            this.view._cacheFocused();\n        },\n\n        _onMenuClose: function() {\n            if($(document.activeElement).closest(\"[role='alertdialog']\").length === 0) {\n                this.wrapper.find(\"[tabindex='0']\")\n                    .addClass(ORGCHART_STYLES.focused)\n                    .trigger(\"focus\");\n            }\n        },\n\n        _onMenuItemClick: function(e) {\n            var that = this,\n                targetItem = $(e.target).closest(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                dataItem = that.dataItem(targetItem),\n                action = $(e.item).data(ACTION),\n                newItem;\n\n            if(!dataItem) {\n                return;\n            }\n\n            if(action === EDIT) {\n                if(!that.trigger(EDIT, { dataItem: dataItem })) {\n                    that._edit(dataItem);\n                }\n            } else if(action === CREATE) {\n                if(!that.trigger(CREATE, { dataItem: dataItem })) {\n                    if(!dataItem.loaded()) {\n                        that.dataSource.read({ id: dataItem.id })\n                            .then(function() {\n                                newItem = that.dataSource.add({\n                                    parentId: dataItem.id\n                                });\n\n                                that._edit(newItem);\n                            });\n                    } else {\n                        newItem = that.dataSource.add({\n                            parentId: dataItem.id\n                        });\n\n                        that._edit(newItem);\n                    }\n                }\n            } else if(action === DESTROY) {\n                that._destroyItem(dataItem);\n            }\n        },\n\n        _onMenuOpen: function() {\n            this.view._cacheFocused();\n            this.wrapper.find(DOT + ORGCHART_STYLES.focused).removeClass(ORGCHART_STYLES.focused);\n            this._menu.element.find(DOT + ORGCHART_STYLES.menuItem).first().trigger(FOCUS);\n        },\n\n        _openMenu: function(focused) {\n            if(this._menu) {\n                this._menu.open(focused.find(DOT + ORGCHART_STYLES.cardMenu));\n            }\n        },\n\n        _progress: function(toggle) {\n            kendo.ui.progress(this.container, toggle);\n        },\n\n        _triggerCollapse: function(e) {\n            if(this.trigger(COLLAPSE, { item: e.item, dataItems: e.dataItems })) {\n                e.preventDefault();\n            }\n        },\n\n        _triggerExpand: function(e) {\n            if(this.trigger(EXPAND, { item: e.item, dataItems: e.dataItems })) {\n                e.preventDefault();\n            }\n        },\n\n        _triggerSelect: function(e) {\n            if(!this.trigger(SELECT, { item: e.item, dataItems: e.dataItems })) {\n                this.view.select(e.item);\n                this.trigger(CHANGE, { item: e.item, dataItems: e.dataItems });\n            }\n        },\n\n        _uploadEditor: function(item, container) {\n            var that = this;\n\n            $('<input type=\"file\">')\n                .appendTo(container)\n                .kendoUpload({\n                    async: false,\n                    multiple: false,\n                    select: function(e) {\n                        var fileInfo = e.files[0];\n                        var raw = fileInfo.rawFile;\n                        var reader  = new FileReader();\n\n                        if(fileInfo.validationErrors && fileInfo.validationErrors.length > 0) {\n                            return;\n                        }\n\n                        if (raw) {\n                            reader.onloadend = function () {\n                                item.set(\"avatar\", this.result);\n                                that._avatarPreview(item, raw.name);\n                            };\n\n                          reader.readAsDataURL(raw);\n                        }\n                    },\n                    validation: {\n                        allowedExtensions: [\".gif\", \".jpg\", \".png\"],\n                        maxFileSize: 1048576\n                    }\n                });\n        },\n\n        _view: function() {\n            if(this.options.groupField !== null && this.options.groupField !== undefined) {\n                this.view = new kendo.orgChart.GroupedView(this.container, this.options);\n            } else {\n                this.view = new kendo.orgChart.SingleView(this.container, this.options);\n            }\n\n            this.view.bind(SELECT, proxy(this._triggerSelect, this));\n            this.view.bind(EXPAND, proxy(this._triggerExpand, this));\n            this.view.bind(COLLAPSE, proxy(this._triggerCollapse, this));\n            this.view.bind(MENU, proxy(this._openMenu, this));\n\n        },\n\n        _wrapper: function() {\n            var container = $(\"<div class='k-orgchart-container'>\");\n\n            this.wrapper = this.element;\n            this.container = container;\n\n            this.wrapper.addClass(ORGCHART_STYLES.wrapper);\n            this.wrapper.append(container);\n        }\n    });\n\n    kendo.ui.plugin(OrgChart);\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n// add validation to upload images only in the edit pop-up;\n"],"names":["define","$","window","kendo","jQuery","undefined","extend","proxy","data","Query","DataSource","TreeListDataSource","Model","ObservableArray","OrgChartModel","id","parentId","fields","type","editable","nullable","name","validation","required","title","avatar","init","value","fn","call","this","_loaded","parentIdField","nameField","titleField","avatarField","get","accept","set","field","initiator","loaded","shouldSerialize","OrgChartDataSource","base","options","model","schema","modelBase","groupedItemsTree","map","_childrenMap","view","defaultParentId","_defaultParentId","currentChildren","grouped","group","toArray","_innerGroupedItemsTree","itemChildren","item","fromView","filter","operator","order","_sort","length","itemId","sort","itemsTree","current","items","children","i","push","prospectParents","skippedItem","concat","read","then","_loadExpanded","toggleChildren","expand","defaultPromise","Deferred","resolve","promise","_error","expanded","load","j","innerGrouped","hasChildren","_byParentId","create","isArray","toJSON","Error","amd","a1","a2","a3","keys","NS","BLUR","CLICK","COLLAPSE","EXPAND","FOCUS","KEYDOWN","MENU","SELECT","DOT","SPACE","COMMA","HASH","STRING","TABINDEX","ID","UID","PX","PLUS","MINUS","ARIA_OWNS","ARIA_SELECTED","ORGCHART_STYLES","wrapper","container","line","lineVertical","lineHorizontal","lineVerticalTop","groupVertical","groupHorizontal","nodesGroup","nodesGroupContainer","nodeContainer","node","card","cardMenu","button","focused","plusIcon","menuItem","avatarPreview","update","cancel","vstack","hstack","ROOT_TEMPLATE","GROUP_TEMPLATE","NODE_GROUP_CONTAINER","NODE_CONTAINER","NODE_CONTAINER_GROUPED","ITEM_TEMPLATE","BUTTON_TEMPLATE","CARD_TEMPLATE","CARD_WRAPPER","GROUPED_CARD_WRAPPER","View","Observable","element","_attachEvents","events","destroy","ui","Widget","off","collapse","jqueryGroupElement","jQueryElement","_processItem","hasClass","closest","jqueryItemElement","refresh","_cacheFocused","_clearContent","_generateItemsTree","_calculateLevels","_render","select","$item","_getToSelect","previousSelection","find","removeAttr","removeClass","attr","addClass","trigger","itemsSelector","on","_onKeyDown","_onSelect","_onButtonClick","_onFocus","_onBlur","focusableItem","focusableDataItem","_dataItems","_idTabIndex","_shouldRestoreSelection","_calculateDimensions","itemElement","_selector","first","_buttonHeight","outerHeight","_spacing","_itemWidth","_calculateItemWidth","_itemHeight","_calculateLevel","empty","_dataItem","dataSource","getByUid","_groupIsVertical","_keyCollapse","_keyExpand","_keyNext","_keyPrev","_keyEnter","_keyEscape","_keyEnd","target","last","previous","dataItems","_keyHome","e","key","keyCode","isRtl","support","nextKey","LEFT","RIGHT","prevKey","expandKey","DOWN","collapseKey","UP","groupIsVertical","HOME","END","indexOf","preventDefault","stopPropagation","ENTER","ESC","that","currentTarget","shouldExpand","el","siblings","_orientation","isElement","_itemsTree","root","template","label","messages","wrapperContainer","total","_total","widgetPadding","css","totalWidth","append","_renderGroup","width","Number","split","_setHeight","_restoreSelection","_renderNode","cardWrapperTemplate","contentTemplate","level","guid","borderColors","cardsColors","getSeriesColors","content","cardWrapper","menuLabel","color","attributes","JSON","parse","stringify","toFocusItem","toFocus","_getToFocus","_preventTriggerSelect","selector","elements","min","MAX_VALUE","max","buttonHeight","height","each","top","offset","bottom","SingleView","outerWidth","itemsLength","maxColumnsPerLevel","_maxColumnsPerLevel","nestedChildren","shouldReset","previousMax","itemGroup","dataItem","parentUid","parentItem","ownedGroup","childItem","next","parent","prev","menuButtonTarget","vertical","vLine","before","clone","parentColumns","parentLeft","_renderInner","buttonTemplate","numberOfColumns","hLine","innerGroup","itemWidth","spacing","buttonSign","_renderInnerGroup","after","margin-top","left","groupTemplate","offsetDirection","GroupedView","$group","ds","_groupFocused","getAttribute","cardWidth","padding","border","groups","groupsLength","maxColumns","currentLength","_maxGroups","maxGroups","currentTotal","groupField","some","toSelect","ownedGroupId","_renderChildren","index","nodesGroupWidth","currentVertical","_renderNodesContainer","_renderItems","nodeGroupContainerTemplate","nodeGroup","nodeGroupContainer","groupHeaderTemplate","orgChart","__meta__","category","description","depends","DataBoundWidget","ContextMenu","Array","CANCEL","CHANGE","CREATE","DATABINDING","DATABOUND","DELETE","DESTROY","EDIT","ERROR","KENDOKEYDOWN","PROGRESS","SAVE","REQUEST_START","ACTION","closeButton","MENU_ITEMS","edit","GROUP_HEADER_TEMPLATE","AVATAR_PREVIEW_TEMPLATE","EDITOR_BUTTONS_TEMPLATE","OrgChart","_events","_wrapper","_view","_dataSource","_contextMenu","autoBind","fetch","notify","form","buttonsTemplate","orientation","destroyContent","destroyTitle","save","uploadAvatar","none","_menu","_editWindow","_confirmDestroy","setDataSource","setOptions","$parent","add","sync","cancelChanges","hasChanges","delete","remove","_edit","getCollapsedNodes","saveChanges","_avatarPreview","fileName","_form","avatarRemove","formWrapper","pop","prepend","menuOptions","_onMenuItemClick","bind","activate","_onMenuOpen","deactivate","_onMenuClose","showOn","animation","menuElement","dsOptions","unbind","_dataSourceChangeHandler","_errorHandler","_progressHandler","_requestStartHandler","_onDataSourceChange","_onDataSourceError","_progress","_onDataSourceRequestStart","_destroyItem","restoreFocus","confirm","Confirm","okText","show","setTimeout","open","result","done","fail","formElement","windowElement","formOptions","_formOptions","Form","Window","modal","close","center","validate","optionsForm","parentsDs","optionsItems","editor","editorOptions","dataValueField","dataTextField","valuePrimitive","_uploadEditor","formData","action","document","activeElement","targetItem","newItem","_openMenu","toggle","progress","_triggerCollapse","_triggerExpand","_triggerSelect","appendTo","kendoUpload","async","multiple","fileInfo","files","raw","rawFile","reader","FileReader","validationErrors","onloadend","readAsDataURL","allowedExtensions","maxFileSize","plugin"],"mappings":"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"}