/** 
 * Kendo UI v2022.1.301 (http://www.telerik.com/kendo-ui)                                                                                                                                               
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.                                                                                      
 *                                                                                                                                                                                                      
 * Kendo UI commercial licenses may be obtained at                                                                                                                                                      
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete                                                                                                                                  
 * If you do not own a commercial license, this file shall be governed by the trial license terms.                                                                                                      
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       

*/
!function(define){define("kendo.pivotgrid.min",["./kendo.pivot.common.min","./kendo.dom.min","./kendo.data.min"],function(){var e={id:"pivotgrid",name:"PivotGrid",category:"web",description:"The PivotGrid widget is a data summarization tool.",depends:["dom","data","data.xml","sortable","pivot.common"],features:[{id:"pivotgrid-configurator",name:"Configurator",description:"The PivotConfigurator widget allows the user to select data slices displayed in PivotGrid",depends:["pivot.configurator"]},{id:"pivotgrid-filtering",name:"Filtering",description:"Support for filtering",depends:["pivot.fieldmenu"]},{id:"pivotgrid-excel-export",name:"Excel export",description:"Export pivot grid data as Excel spreadsheet",depends:["ooxml"]},{id:"pivotgrid-pdf-export",name:"PDF export",description:"Export pivot grid data as PDF",depends:["pdf","drawing"]},{id:"mobile-scroller",name:"Mobile scroller",description:"Support for kinetic scrolling in mobile device",depends:["mobile.scroller"]}]},x=window.kendo.jQuery,H=void 0,E=window.kendo,l=E.ui,t=E.Class,u=E.data.Comparer,a=l.Widget,c=E.data.DataSource,h=E._outerWidth,d=E._outerHeight,r=window.kendo.pivotgrid.common,p=r.fetchDiscover,m=E.data.Query.normalizeFilter,f=E.data.Query.normalizeSort,v={}.toString,g=function(e){return e},_=x.map,n=x.extend,w=E.isFunction,b=r.fetchData,S=r.createDataState,N=r.toColumns,y=r.toRows,C=r.toTree,T=r.toData,M=r.headersReducer,I="resize",A="read",i="change",D="error",L="requestStart",P="progress",O="requestEnd",F="Measures",B="stateReset",U="auto",q="<div></div>",o=".kendoPivotGrid",W="__row_total__",z="dataBinding",G="dataBound",j="expandMember",V='<th data-key="#:key#" class="#:headerClass#" #if (colspan) {#colspan="#:colspan#"#}# #if (rowspan) {#rowspan="#:rowspan#"#}#>'+'#if (expandable) {# <span class="k-icon k-i-arrow-chevron-#:iconClass# k-color-inherit" role="presentation"></span>#}#'+"</th>",Y="collapseMember",K="k-i-collapse",Q="k-i-expand",$="<span>#: data.member.caption || data.member.name #</span>",J='<span class="k-icon k-i-kpi-status-#=data.dataItem.value > 0 ? "open" : data.dataItem.value < 0 ? "deny" : "hold"#" title="#:data.dataItem.value#"></span>',X='<span class="k-icon k-i-kpi-trend-#=data.dataItem.value > 0 ? "increase" : data.dataItem.value < 0 ? "decrease" : "equal"#" title="#:data.dataItem.value#"></span>',Z='#= data.dataItem ? kendo.htmlEncode(data.dataItem.fmtValue || data.dataItem.value) || "&nbsp;" : "&nbsp;" #',ee='<table class="k-pivot-layout">'+"<tr>"+"<td>"+'<div class="k-pivot-rowheaders"></div>'+"</td>"+"<td>"+'<div class="k-pivot-table"></div>'+"</td>"+"</tr>"+"</table>",te="rows",re="columns";function ae(e){var t=typeof e==="string"?[{name:e}]:e;var r=v.call(t)==="[object Array]"?t:t!==H?[t]:[];return _(r,function(e){if(typeof e==="string")return{name:e};return{name:e.name,type:e.type}})}function R(e){var t=typeof e==="string"?[{name:[e],expand:false}]:e;var r=v.call(t)==="[object Array]"?t:t!==H?[t]:[];return _(r,function(e){if(typeof e==="string")return{name:[e],expand:false};return{name:v.call(e.name)==="[object Array]"?e.name.slice():[e.name],expand:e.expand}})}function se(e){if(e.indexOf(" ")!==-1)e='["'+e+'"]';return e}function ne(e,t,r,a){var s,n;var i;var o;if(!r)r=t;if(!a)a=0;o=r.members[a];if(!o||o.measure)return;i=o.children;n=i.length;if(r===t)e[E.stringify([o.name])]=!!n;else if(n)e[E.stringify(xt(r,a))]=true;if(n)for(s=0;s<n;s++)ne(e,t,i[s],a);ne(e,t,r,a+1)}function ie(e){var t={};if(e.length)ne(t,e[0]);var r=[];for(var a in t)r.push({name:JSON.parse(a),expand:t[a]});return r}function oe(e,t){var r=t.tuples||[];var a=r[0];if(a&&e.length<a.members.length){var s=a.members;for(var n=0;n<s.length;n++){if(s[n].measure)continue;var i=false;for(var o=0;o<e.length;o++)if(Ye(e[o]).indexOf(s[n].hierarchy)===0){i=true;break}if(!i)e.push({name:[s[n].name],expand:false})}}}function le(e){var t=[];var r=e.members;for(var a=0;a<r.length;a++){if(r[a].measure)continue;t.push({name:[r[a].name],expand:r[a].children.length>0})}return t}function ue(e,t,r){e=e||{};oe(t,e);if(r.length>1)t.push({name:F,measure:true,children:R(r)});var a={members:t};if(e.tuples){var s=Ae(e.tuples,a);if(s.tuple)t=le(s.tuple)}return t}function ce(r){var a=E.getter(r.field,true);return function(e,t){return r.aggregate(a(e.dataItem),t,e)}}function s(e){return typeof e==="number"&&!isNaN(e)}function he(e){return e&&e.getTime}function de(){var e=0;var t;if(document&&document.createElement){t=document.createElement("div");t.style.cssText="overflow:scroll;overflow-x:hidden;zoom:1;clear:both;display:block";t.innerHTML="&nbsp;";document.body.appendChild(t);e=t.offsetWidth-t.scrollWidth;document.body.removeChild(t)}return e}var pe={sum:function(e,t){var r=t.accumulator;if(!s(r))r=e;else if(s(e))r+=e;return r},count:function(e,t){return(t.accumulator||0)+1},average:{aggregate:function(e,t){var r=t.accumulator;if(t.count===H)t.count=0;if(!s(r))r=e;else if(s(e))r+=e;if(s(e))t.count++;return r},result:function(e){var t=e.accumulator;if(s(t))t=t/e.count;return t}},max:function(e,t){var r=t.accumulator;if(!s(r)&&!he(r))r=e;if(r<e&&(s(e)||he(e)))r=e;return r},min:function(e,t){var r=t.accumulator;if(!s(r)&&!he(r))r=e;if(r>e&&(s(e)||he(e)))r=e;return r}},me=t.extend({init:function(e){this.options=n({},this.options,e);this.dimensions=this._normalizeDescriptors("field",this.options.dimensions);this.measures=this._normalizeDescriptors("name",this.options.measures)},_normalizeDescriptors:function(e,t){t=t||{};var r={};var a;if(v.call(t)==="[object Array]"){for(var s=0,n=t.length;s<n;s++){a=t[s];if(typeof a==="string")r[a]={};else if(a[e])r[a[e]]=a}t=r}return t},_rootTuples:function(e,t){var r=t.length||1;var c=this.dimensions||[];var a,s,n;var i=0;var o;var l=e.length;var u=[];var h=[];if(l||t.length){for(i=0;i<r;i++){a={members:[]};for(o=0;o<l;o++){s=e[o];n=s.split("&");a.members[a.members.length]={children:[],caption:(c[s]||{}).caption||"All",name:s,levelName:s,levelNum:"0",hasChildren:true,parentName:n.length>1?n[0]:H,hierarchy:s}}if(r>1)a.members[a.members.length]={children:[],caption:t[i].caption,name:t[i].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:false,parentName:H,hierarchy:"MEASURES"};u[u.length]=a}h.push(W)}return{keys:h,tuples:u}},_sortMap:function(e,t){var r=[];var a=[];var s=[];var n;var i;for(i in e)if(!e[i].directParentName)a.push(x.extend({},{name:i,parentName:e[i].parentName}));if(!a.length)for(i in e)a.push(x.extend({},{name:i,parentName:e[i].parentName}));we(a,e);for(var o=0;o<t.length;o++)xe(t[o].field.split(".").pop(),a,u.create({field:"name",dir:t[o].dir}));s=_e(a);for(var l=0;l<s.length;l++){n=e[s[l].name];n.index=l;r[l]=n}return r},_expandedTuples:function(e,c,t,r){var h=t.length||1;var d=this.dimensions||[];var a;var s;var p;var n;var i;var m;var f=[];var v=[];var o;var g;var _;var l;var u;if(r&&r.length&&!x.isEmptyObject(e))e=this._sortMap(e,r);for(p in e){n=e[p];o=this._findExpandedMember(c,n.uniquePath);i=f[o.index]||[];m=v[o.index]||[];g=o.member.names;for(a=0;a<h;a++){s={members:[]};for(u=0;u<g.length;u++)if(u===o.member.expandedIdx){s.members[s.members.length]={children:[],caption:n.value,name:n.name,hasChildren:false,levelNum:1,levelName:n.parentName+n.name,parentName:n.parentName,hierarchy:n.parentName+n.name};if(a===0)m.push(xt(s,u).join(""))}else{l=g[u];_=l.split("&");s.members[s.members.length]={children:[],caption:(d[l]||{}).caption||"All",name:l,levelName:l,levelNum:"0",hasChildren:true,parentName:_.length>1?_[0]:H,hierarchy:l}}if(h>1)s.members[s.members.length]={children:[],caption:t[a].caption,name:t[a].descriptor.name,levelName:"MEASURES",levelNum:"0",hasChildren:true,parentName:H,hierarchy:"MEASURES"};i[i.length]=s}f[o.index]=i;v[o.index]=m}return{keys:v,tuples:f}},_findExpandedMember:function(e,t){for(var r=0;r<e.length;r++)if(e[r].uniquePath===t)return{member:e[r],index:r}},_asTuples:function(e,t,r,a){r=r||[];var s=this._rootTuples(t.root,r);var n=this._expandedTuples(e,t.expanded,r,a);return{keys:[].concat.apply(s.keys,n.keys),tuples:[].concat.apply(s.tuples,n.tuples)}},_measuresInfo:function(e,t){var r=0;var a=e&&e.length;var s=[];var n={};var i={};var o=this.measures||{};var l;var u;for(;r<a;r++){u=e[r].descriptor.name;l=o[u]||{};s.push(u);if(l.result)n[u]=l.result;if(l.format)i[u]=l.format}return{names:s,formats:i,resultFuncs:n,rowAxis:t}},_toDataArray:function(c,e,h,d){var p=[];var t;var r,a,s,n,i;var o,l,m;var f=1;var v=[];var u;var g=h.length||1;var _=d.length||1;if(e.rowAxis){v=e.names;f=v.length}else u=e.names;for(a=0;a<g;a++){o=c[h[a]||W];for(i=0;i<f;i++){if(e.rowAxis)u=[v[i]];for(s=0;s<_;s++){m=d[s]||W;l=o.items[m];if(m===W)t=o.aggregates;else t=l?l.aggregates:{};for(n=0;n<u.length;n++){r=u[n];this._addData(p,t[r],e.formats[r],e.resultFuncs[r])}}}}return p},_addData:function(e,t,r,a){var s="";var n;if(t){t=a?a(t):t.accumulator;s=r?E.format(r,t):t}n=e.length;e[n]={ordinal:n,value:t||"",fmtValue:s}},_matchDescriptors:function(e,t,r){var a;var s;var n;var i=t.names;var o=t.expandedIdx;var l;while(o>0){a=i[--o].split("&");if(a.length>1){s=a[0];n=a[1];l=r[s](e);l=l!==H&&l!==null?l.toString():l;if(l!=n)return false}}return true},_calculateAggregate:function(e,t,r){var a={};var s;var n;for(var i=0;i<e.length;i++){n=e[i].descriptor.name;s=r.aggregates[n]||{};s.accumulator=e[i].aggregator(t,s);a[n]=s}return a},_processColumns:function(c,e,h,t,d,p,m,f){var r;var a;var s;var v;var n,i,o,l;var g=d.dataItem;var u=0;for(;u<e.length;u++){a=e[u];if(!this._matchDescriptors(g,a,h))continue;l=a.names.slice(0,a.expandedIdx).join("");i=a.names[a.expandedIdx];r=h[i](g);r=r!==H&&r!==null?r.toString():r;o=i;i=i+"&"+r;n=l+i;s=t[n]||{index:m.columnIndex,parentName:o,name:i,directParentName:l.indexOf("&")!==-1?l:"",uniquePath:l+o,childrenMap:{},value:r};if(l&&t[l]&&!t[l].childrenMap[l+o+"&"+r])t[l].childrenMap[l+o+"&"+r]=true;v=p.items[n]||{aggregates:{}};p.items[n]={index:s.index,aggregates:this._calculateAggregate(c,d,v)};if(f){if(!t[n])m.columnIndex++;t[n]=s}}},_measureAggregators:function(e){var t=e.measures||[];var r=this.measures||{};var a=[];var s,n,i,o;var l,u;if(t.length)for(i=0,o=t.length;i<o;i++){s=t[i];n=r[s.name];l=null;if(n){u=n.aggregate;if(typeof u==="string"){l=pe[u.toLowerCase()];if(!l)throw new Error("There is no such aggregate function");n.aggregate=l.aggregate||l;n.result=l.result}a.push({descriptor:s,caption:n.caption,result:n.result,aggregator:ce(n)})}}else a.push({descriptor:{name:"default"},caption:"default",aggregator:function(){return 1}});return a},_buildGetters:function(e){var t={};var r;var a;for(var s=0;s<e.length;s++){a=e[s];r=a.split("&");if(r.length>1)t[r[0]]=E.getter(r[0],true);else t[a]=E.getter(se(a),true)}return t},_parseDescriptors:function(e){var t=$e(e);var r=Ke(t.root);var a=t.expanded;var s=[];for(var n=0;n<a.length;n++)s.push(Qe(a[n].name,r));return{root:r,expanded:s}},_filter:function(e,t){if(!t)return e;var r;var a=0;var s=t.filters;for(;a<s.length;a++){r=s[a];if(r.operator==="in")s[a]=this._normalizeFilter(r)}return new E.data.Query(e).filter(t).data},_normalizeFilter:function(e){var t=e.value.split(",");var r=[];if(!t.length)return t;for(var a=0;a<t.length;a++)r.push({field:e.field,operator:"eq",value:t[a]});return{logic:"or",filters:r}},process:function(e,t){e=e||[];t=t||{};e=this._filter(e,t.filter);var c=t.measures||[];var r=t.measuresAxis==="rows";var a=t.columns||[];var s=t.rows||[];if(!a.length&&s.length&&(!c.length||c.length&&r)){a=s;s=[];r=false}if(!a.length&&!s.length)r=false;if(!a.length&&c.length)a=R(t.measures);a=this._parseDescriptors(a);s=this._parseDescriptors(s);var n={};var i={};var h={};var o;var d={columnIndex:0};var l=this._measureAggregators(t);var p=this._buildGetters(a.root);var m=this._buildGetters(s.root);var f=false;var v=a.expanded;var g=s.expanded;var _;var x;var w=g.length!==0;var b,S,u,N;var y,E,k,C;var T,M;var I=e.length;var A=0;if(a.root.length||s.root.length){f=true;for(A=0;A<I;A++){_=e[A];x={dataItem:_,index:A};N=n[W]||{items:{},aggregates:{}};this._processColumns(l,v,p,i,x,N,d,!w);N.aggregates=this._calculateAggregate(l,x,N);n[W]=N;for(b=0;b<g.length;b++){S=g[b];if(!this._matchDescriptors(_,S,m)){this._processColumns(l,v,p,i,x,{items:{},aggregates:{}},d,true);continue}E=S.names.slice(0,S.expandedIdx).join("");u=S.names[S.expandedIdx];k=u;o=m[u](_);o=o!==H?o.toString():o;u=u+"&"+o;y=E+u;h[y]={uniquePath:E+k,parentName:k,name:u,value:o};C=n[y]||{items:{},aggregates:{}};this._processColumns(l,v,p,i,x,C,d,true);C.aggregates=this._calculateAggregate(l,x,C);n[y]=C}}}if(f&&I){if(l.length>1&&(!t.columns||!t.columns.length))a={root:[],expanded:[]};T=this._asTuples(i,a,r?[]:l,t.sort?t.sort:[]);M=this._asTuples(h,s,r?l:[],t.sort?t.sort:[]);i=T.tuples;h=M.tuples;n=this._toDataArray(n,this._measuresInfo(l,r),M.keys,T.keys)}else n=i=h=[];return{axes:{columns:{tuples:i},rows:{tuples:h}},data:n}}}),fe=t.extend({init:function(e,t){this.transport=t;this.options=t.options||{};if(!this.transport.discover)if(w(e.discover))this.discover=e.discover},read:function(e){return this.transport.read(e)},update:function(e){return this.transport.update(e)},create:function(e){return this.transport.create(e)},destroy:function(e){return this.transport.destroy(e)},discover:function(e){if(this.transport.discover)return this.transport.discover(e);e.success({})},catalog:function(e){var t=this.options||{};if(e===H)return(t.connection||{}).catalog;var r=t.connection||{};r.catalog=e;this.options.connection=r;x.extend(this.transport.options,{connection:r})},cube:function(e){var t=this.options||{};if(e===H)return(t.connection||{}).cube;var r=t.connection||{};r.cube=e;this.options.connection=r;n(true,this.transport.options,{connection:r})}}),ve=c.extend({init:function(e){c.fn.init.call(this,n(true,{},{},e));var t=this.options.transport||{};if((this.options.type||"xmla").toLowerCase()==="xmla"){this._online=true;this.transport=new nt(t)}this._columns=R(this.options.columns);this._rows=R(this.options.rows);var r=this.options.measures||[];if(v.call(r)==="[object Object]"){this._measuresAxis=r.axis||"columns";r=r.values||[]}this._measures=ae(r)},options:{serverSorting:true,serverPaging:true,serverFiltering:true,serverGrouping:true,serverAggregates:true},axes:function(){return{columns:Ce(this.columns()),rows:Ce(this.rows())}},catalog:function(e){if(e===H)return this.transport.catalog();this.transport.catalog(e);this._mergeState({});this.read()},cube:function(e){if(e===H)return this.transport.cube();this.transport.cube(e);this._mergeState({});this.read()},measuresAxis:function(){return this._measuresAxis||"columns"},fetch:function(){if(this.options.type.toLowerCase()==="xmla"&&(this._data===H||this._data.length===0))this._query()},read:function(e){var t=this;var r=t.trigger(L,{type:A});var a=t._params(e);if(!r){t.trigger(P);t.transport.read({data:a,success:function(e){t._saveState(e);t.trigger(O,{response:e,type:A});t.trigger(i);if(t._preventRefresh)t._preventRefresh=false},error:function(e){t.trigger(D,{error:e})}})}},_params:function(e){var t=this;var r=c.fn._params.call(t,e);r=n({connection:t.options.transport.connection,columnAxes:JSON.parse(JSON.stringify(t._columns)),rowAxes:JSON.parse(JSON.stringify(t._rows)),measuresAxis:t.measuresAxis(),measureAxes:t._measures},r);if(r.filter){r.filter=m(r.filter);r.filter=(r.filter||{}).filters}if(r.sort)r.sort=f(r.sort);return r},discover:function(e){var t=this,r=t.transport;if(r.discover)return r.discover(e)},schemaMeasures:function(){var e=this;return e.discover({command:"schemaMeasures",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaKPIs:function(){var e=this;return e.discover({command:"schemaKPIs",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaDimensions:function(){var e=this;return e.discover({command:"schemaDimensions",restrictions:{catalogName:e.transport.catalog(),cubeName:e.transport.cube()}},function(e){return e})},schemaHierarchies:function(e){var t=this;return t.discover({command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}},function(e){return e})},schemaLevels:function(e){var t=this;return t.discover({command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}},function(e){return e})},schemaCubes:function(){var e=this;return e.discover({command:"schemaCubes",restrictions:{catalogName:e.transport.catalog()}},function(e){return e})},schemaCatalogs:function(){var e=this;return e.discover({command:"schemaCatalogs"},function(e){return e})},schemaMembers:function(e){var t=this;return t.discover({command:"schemaMembers",restrictions:n({catalogName:t.transport.catalog(),cubeName:t.transport.cube()},e)},function(e){return e})},_saveState:function(e){var t=this;t._columnTuples=e.columns;t._rowTuples=e.rows;t._view=e.data},columns:function(e){if(e===H)return this._columns;this._columns=R(e);this.read()},rows:function(e){if(e===H)return this._rows;this._rows=R(e);this.read()},measures:function(e){if(e===H)return this._measures;this._measures=ae(e);this.read()},_mergeState:function(e){e=c.fn._mergeState.call(this,e);return e},_query:function(e){var t=this;var r=n({},{sort:t.sort(),measuresAxis:t.measuresAxis(),filter:t.filter()},e);var a=this._mergeState(r);return this.read(a)}}),ge=c.extend({init:function(e){var t=((e||{}).schema||{}).cube;var r="columns";var a;var s={axes:g,cubes:g,catalogs:g,measures:g,dimensions:g,hierarchies:g,levels:g,members:g};if(t){s=x.extend(s,this._cubeSchema(t));this.cubeBuilder=new me(t)}c.fn.init.call(this,n(true,{},{schema:s},e));this.transport=new fe(this.options.transport||{},this.transport);this._columns=R(this.options.columns);this._rows=R(this.options.rows);a=this.options.measures||[];if(v.call(a)==="[object Object]"){r=a.axis||"columns";a=a.values||[]}this._measures=ae(a);this._measuresAxis=r;this._skipNormalize=0;this._axes={}},_cubeSchema:function(h){return{dimensions:function(){var e=[];var t=h.dimensions;for(var r in t)e.push({name:r,caption:t[r].caption||r,uniqueName:r,defaultHierarchy:r,type:1});if(h.measures)e.push({name:F,caption:F,uniqueName:F,type:2});return e},hierarchies:function(){return[]},measures:function(){var e=[];var t=h.measures;for(var r in t)e.push({name:r,caption:r,uniqueName:r,aggregator:r});return e},members:x.proxy(function(c,e){var t=e.levelUniqueName||e.memberUniqueName;var r=this.options.schema.data;var a=w(r)?r:E.getter(r,true);var s=this.options.data&&a(this.options.data)||this._rawData||[];var n=[];var i;var o;var l=0;var u={};if(t)t=t.split(".")[0];if(!e.treeOp){n.push({caption:h.dimensions[t].caption||t,childrenCardinality:"1",dimensionUniqueName:t,hierarchyUniqueName:t,levelUniqueName:t,name:t,uniqueName:t});return n}i=E.getter(se(t),true);for(;l<s.length;l++){o=i(s[l]);if((o||o===0)&&!u[o]){u[o]=true;n.push({caption:o,childrenCardinality:"0",dimensionUniqueName:t,hierarchyUniqueName:t,levelUniqueName:t,name:o,uniqueName:o})}}return n},this)}},options:{serverSorting:true,serverPaging:true,serverFiltering:true,serverGrouping:true,serverAggregates:true},catalog:function(e){if(e===H)return this.transport.catalog();this.transport.catalog(e);this._mergeState({});this._axes={};this.data([])},cube:function(e){if(e===H)return this.transport.cube();this.transport.cube(e);this._axes={};this._mergeState({});this.data([])},axes:function(){return this._axes},columns:function(e){if(e===H)return this._columns;this._skipNormalize+=1;this._clearAxesData=true;this._columns=R(e);this.query({columns:e,rows:this.rowsAxisDescriptors(),measures:this.measures(),sort:this.sort(),filter:this.filter()})},rows:function(e){if(e===H)return this._rows;this._skipNormalize+=1;this._clearAxesData=true;this._rows=R(e);this.query({columns:this.columnsAxisDescriptors(),rows:e,measures:this.measures(),sort:this.sort(),filter:this.filter()})},measures:function(e){if(e===H)return this._measures;this._skipNormalize+=1;this._clearAxesData=true;this.query({columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:ae(e),sort:this.sort(),filter:this.filter()})},measuresAxis:function(){return this._measuresAxis||"columns"},_expandPath:function(e,t){var r=t==="columns"?"columns":"rows";var a=t==="columns"?"rows":"columns";var s=R(e);var n=Ye(s[s.length-1]);this._lastExpanded=r;s=ue(this.axes()[r],s,this.measures());for(var i=0;i<s.length;i++){var o=Ye(s[i]);if(o===n){if(s[i].expand)return;s[i].expand=true}else s[i].expand=false}var l={};l[r]=s;l[a]=this._descriptorsForAxis(a);this._query(l)},_descriptorsForAxis:function(e){var t=this.axes();var r=this[e]()||[];if(t&&t[e]&&t[e].tuples&&t[e].tuples[0])r=ie(t[e].tuples||[]);return r},columnsAxisDescriptors:function(){return this._descriptorsForAxis("columns")},rowsAxisDescriptors:function(){return this._descriptorsForAxis("rows")},_process:function(e,t){this._view=e;t=t||{};t.items=t.items||this._view;this.trigger(i,t)},_query:function(e){var t=this;if(!e){this._skipNormalize+=1;this._clearAxesData=true}return t.query(n({},{page:t.page(),pageSize:t.pageSize(),sort:t.sort(),filter:t.filter(),group:t.group(),aggregate:t.aggregate(),columns:this.columnsAxisDescriptors(),rows:this.rowsAxisDescriptors(),measures:this.measures()},e))},query:function(e){var t=this._mergeState(e);if(this._data.length&&this.cubeBuilder){this._params(t);this._updateLocalData(this._pristineData);return x.Deferred().resolve().promise()}return this.read(t)},_mergeState:function(e){e=c.fn._mergeState.call(this,e);if(e!==H){this._measures=ae(e.measures);if(e.columns)e.columns=R(e.columns);else if(!e.columns)this._columns=[];if(e.rows)e.rows=R(e.rows);else if(!e.rows)this._rows=[]}return e},filter:function(e){if(e===H)return this._filter;this._skipNormalize+=1;this._clearAxesData=true;this._query({filter:e,page:1})},expandColumn:function(e){this._expandPath(e,"columns")},expandRow:function(e){this._expandPath(e,"rows")},success:function(e){var t;if(this.cubeBuilder)t=(this.reader.data(e)||[]).slice(0);c.fn.success.call(this,e);if(t)this._pristineData=t},_processResult:function(e,t){if(this.cubeBuilder){var r=this.cubeBuilder.process(e,this._requestData);e=r.data;t=r.axes}var a,c;var s,n,i,o;var l=this.columns();var u=this.rows();var h=t.columns&&t.columns.tuples;if(!l.length&&u.length&&h&&(this._rowMeasures().length||!this.measures().length))t={columns:{},rows:t.columns};if(!l.length&&!u.length&&this.measuresAxis()==="rows"&&h)t={columns:{},rows:t.columns};this._axes={columns:Ce(this._axes.columns),rows:Ce(this._axes.rows)};t={columns:Ce(t.columns),rows:Ce(t.rows)};a=this._normalizeTuples(t.columns.tuples,this._axes.columns.tuples,l,this._columnMeasures());c=this._normalizeTuples(t.rows.tuples,this._axes.rows.tuples,u,this._rowMeasures());if(this._skipNormalize>0)this._skipNormalize-=1;if(!this.cubeBuilder)e=this._normalizeData({columnsLength:t.columns.tuples.length,rowsLength:t.rows.tuples.length,columnIndexes:a,rowIndexes:c,data:e});if(this._lastExpanded=="rows"){s=t.columns.tuples;i=this._columnMeasures();n=Se(t.columns,this._axes.columns,i);if(n){o="columns";t.columns=n;Ne(s,n.tuples,t.rows.tuples.length,i,e);if(!this.cubeBuilder)e=this._normalizeData({columnsLength:ke(t.columns.tuples,i),rowsLength:t.rows.tuples.length,data:e})}}else if(this._lastExpanded=="columns"){s=t.rows.tuples;i=this._rowMeasures();n=Se(t.rows,this._axes.rows,i);if(n){o="rows";t.rows=n;ye(s,n.tuples,t.columns.tuples.length,i,e);if(!this.cubeBuilder)e=this._normalizeData({columnsLength:ke(t.rows.tuples,i),rowsLength:t.columns.tuples.length,data:e})}}this._lastExpanded=null;var d=this._mergeAxes(t,e,o);this._axes=d.axes;return d.data},_readData:function(e){var t=this.reader.axes(e);var r=this.reader.data(e);if(this.cubeBuilder)this._rawData=r;return this._processResult(r,t)},_createTuple:function(c,e,h){var d=c.members;var p=d.length;var t={members:[]};var r,a;var s,n;var i;var o;var l;var u;var m=0;if(e)p-=1;for(;m<p;m++){u=d[m];a=Number(u.levelNum);s=u.name;n=u.parentName;l=u.caption||s;i=u.hasChildren;o=u.hierarchy;r=u.levelName;if(h){l="All";if(a===0)n=u.name;else a-=1;i=true;s=o=r=n}t.members.push({name:s,children:[],caption:l,levelName:r,levelNum:a.toString(),hasChildren:i,hierarchy:o,parentName:!h?n:""})}if(e)t.members.push({name:e.name,children:[]});return t},_hasRoot:function(e,t,r){if(t.length)return Ae(t,e).tuple;var a=e.members;var s;var n;var i=true;var o;for(var l=0,u=a.length;l<u;l++){s=a[l];o=Number(s.levelNum)||0;n=r[l];if(!(o===0||n&&s.name===Ye(n))){i=false;break}}return i},_mergeAxes:function(e,t,c){var r=this._columnMeasures();var a=this._rowMeasures();var s=this.axes();var n,i;var h=ke(s.rows.tuples,a);var d=e.rows.tuples.length;var p=ke(s.columns.tuples,r);var o=e.columns.tuples.length;if(c=="columns"){o=p;i=e.columns.tuples}else{i=Pe(e.columns.tuples,r);t=Fe(i,t)}var l=Me(s.columns.tuples,i,r);if(c=="rows"){d=ke(e.rows.tuples,a);i=e.rows.tuples}else{i=Pe(e.rows.tuples,a);t=Oe(i,t)}var u=Me(s.rows.tuples,i,a);s.columns.tuples=l.tuples;s.rows.tuples=u.tuples;if(p!==ke(s.columns.tuples,r)){n=l.index+Te(l.parsedRoot,l.memberIndex,r);var m=p+o;t=this._mergeColumnData(t,n,d,o,m)}else if(h!==ke(s.rows.tuples,a)){n=u.index+Te(u.parsedRoot,u.memberIndex,a);t=this._mergeRowData(t,n,d,o)}if(s.columns.tuples.length===0&&s.rows.tuples.length===0)t=[];return{axes:s,data:t}},_mergeColumnData:function(e,t,r,c,a){var s=this.data().toJSON();var n,i,o=0,l;var u=Math.max(this._columnMeasures().length,1);r=Math.max(r,1);if(s.length>0){o=u;a-=u}for(n=0;n<r;n++){i=t+n*a;l=e.splice(0,c);l.splice(0,o);[].splice.apply(s,[i,0].concat(l))}return s},_mergeRowData:function(e,t,r,a){var s=this.data().toJSON();var n,i,o;var l=Math.max(this._rowMeasures().length,1);a=Math.max(a,1);if(s.length>0){r-=l;e.splice(0,a*l)}for(n=0;n<r;n++){o=e.splice(0,a);i=t*a+n*a;[].splice.apply(s,[i,0].concat(o))}return s},_columnMeasures:function(){var e=this.measures();var t=[];if(this.measuresAxis()==="columns")if(this.columns().length===0)t=e;else if(e.length>1)t=e;return t},_rowMeasures:function(){var e=this.measures();var t=[];if(this.measuresAxis()==="rows")if(this.rows().length===0)t=e;else if(e.length>1)t=e;return t},_updateLocalData:function(e,t){if(this.cubeBuilder){if(t)this._requestData=t;e=this._processResult(e)}this._data=this._observe(e);this._ranges=[];this._addRange(this._data);this._total=this._data.length;this._pristineTotal=this._total;this._process(this._data)},data:function(e){var t=this;if(e!==H){this._pristineData=e.slice(0);this._updateLocalData(e,{columns:this.columns(),rows:this.rows(),measures:this.measures()})}else return t._data},_normalizeTuples:function(e,c,h,t){var r=t.length||1;var a=0;var s=[];var n={};var i=0;var o,l,u;if(!e.length)return;if(this._skipNormalize<=0&&!this._hasRoot(e[0],c,h)){this._skipNormalize=0;for(;a<r;a++){s.push(this._createTuple(e[0],t[a],true));n[a]=a}e.splice.apply(e,[0,e.length].concat(s).concat(e));a=r}if(t.length){u=o=e[a];l=o.members.length-1;while(o){if(i>=r)i=0;if(o.members[l].name!==t[i].name){e.splice(a,0,this._createTuple(o,t[i]));n[a]=a}a+=1;i+=1;o=e[a];if(r>i&&(!o||wt(u,l-1)!==wt(o,l-1))){for(;i<r;i++){e.splice(a,0,this._createTuple(u,t[i]));n[a]=a;a+=1}o=e[a]}u=o}}return n},_addMissingDataItems:function(e,t){while(t.rowIndexes[parseInt(e.length/t.columnsLength,10)]!==H)for(var r=0;r<t.columnsLength;r++)e=be(e);while(t.columnIndexes[e.length%t.columnsLength]!==H)e=be(e);return e},_normalizeOrdinals:function(e,t,r){var a=r.lastOrdinal;if(!t)return be(e);if(t.ordinal-a>1){a+=1;while(a<t.ordinal&&e.length<r.length){e=this._addMissingDataItems(be(e),r);a+=1}}t.ordinal=e.length;e[e.length]=t;return e},_normalizeData:function(e){var t=e.data;var r=0;var a;var s=[];var n;var i;e.lastOrdinal=0;e.columnIndexes=e.columnIndexes||{};e.rowIndexes=e.rowIndexes||{};e.columnsLength=e.columnsLength||1;e.rowsLength=e.rowsLength||1;e.length=e.columnsLength*e.rowsLength;i=e.length;if(t.length===i)return t;while(s.length<i){a=t[r++];if(a)n=a.ordinal;s=this._normalizeOrdinals(this._addMissingDataItems(s,e),a,e);e.lastOrdinal=n}return s},discover:function(e,t){var s=this,r=s.transport;return x.Deferred(function(a){r.discover(n({success:function(e){e=s.reader.parse(e);if(s._handleCustomErrors(e))return;if(t)e=t(e);a.resolve(e)},error:function(e,t,r){a.reject(e);s.error(e,t,r)}},e))}).promise().done(function(){s.trigger("schemaChange")})},schemaMeasures:function(){var t=this;return t.discover({data:{command:"schemaMeasures",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube()}}},function(e){return t.reader.measures(e)})},schemaKPIs:function(){var t=this;return t.discover({data:{command:"schemaKPIs",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube()}}},function(e){return t.reader.kpis(e)})},schemaDimensions:function(){var t=this;return t.discover({data:{command:"schemaDimensions",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube()}}},function(e){return t.reader.dimensions(e)})},schemaHierarchies:function(e){var t=this;return t.discover({data:{command:"schemaHierarchies",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),dimensionUniqueName:e}}},function(e){return t.reader.hierarchies(e)})},schemaLevels:function(e){var t=this;return t.discover({data:{command:"schemaLevels",restrictions:{catalogName:t.transport.catalog(),cubeName:t.transport.cube(),hierarchyUniqueName:e}}},function(e){return t.reader.levels(e)})},schemaCubes:function(){var t=this;return t.discover({data:{command:"schemaCubes",restrictions:{catalogName:t.transport.catalog()}}},function(e){return t.reader.cubes(e)})},schemaCatalogs:function(){var t=this;return t.discover({data:{command:"schemaCatalogs"}},function(e){return t.reader.catalogs(e)})},schemaMembers:function(e){var r=this;var t=function(t){return function(e){return r.reader.members(e,t)}}(e);return r.discover({data:{command:"schemaMembers",restrictions:n({catalogName:r.transport.catalog(),cubeName:r.transport.cube()},e)}},t)},_params:function(e){if(this._clearAxesData){this._axes={};this._data=this._observe([]);this._clearAxesData=false;this.trigger(B)}var t=c.fn._params.call(this,e);t=n({measures:this.measures(),measuresAxis:this.measuresAxis(),columns:this.columns(),rows:this.rows()},t);if(this.cubeBuilder)this._requestData=t;return t}});function _e(e){var t=[];for(var r=0;r<e.length;r++){t.push(e[r]);if(e[r].children)t=t.concat(_e(e[r].children))}return t}function xe(e,t,r){for(var a=0;a<t.length;a++)if(t[a].children&&t[a].children.length)xe(e,t[a].children,r);if(t[0].parentName!=e)return;t=t.sort(r)}function we(e,t){for(var r=0;r<e.length;r++){var a=t[e[r].name];if(!x.isEmptyObject(a.childrenMap)){e[r].children=[];for(var s in a.childrenMap)e[r].children.push(x.extend({},{name:s,parentName:t[s].parentName}));we(e[r].children,t)}}}function be(e){e[e.length]={value:"",fmtValue:"",ordinal:e.length};return e}function Se(e,t,r){if(e.tuples.length<ke(t.tuples,r))return t;return}function Ne(e,t,r,a,s){var n,i,o;var l=e.length;var c=ke(t,a);var u=a.length||1;for(i=0;i<r;i++)for(n=0;n<l;n++){o=Ee(e[n],t)*u;o+=n%u;s[i*l+n].ordinal=i*c+o}}function ye(e,t,r,a,s){var n,i,o;var l=e.length;var u=a.length||1;for(i=0;i<l;i++){o=Ee(e[i],t);o*=u;o+=i%u;for(n=0;n<r;n++)s[i*r+n].ordinal=o*r+n}}function Ee(e,t){return Ae(t,e).index}function ke(e,t){if(!e.length)return 0;var r=e.slice();var a=r.shift();var s=1;while(a){if(a.members)[].push.apply(r,a.members);else if(a.children){if(!a.measure)s+=a.children.length;[].push.apply(r,a.children)}a=r.shift()}if(t.length)s=s*t.length;return s}function Ce(e){if(!e)e={tuples:[]};if(!e.tuples)e.tuples=[];return e}function Te(e,t,r){if(!e)return 0;var a=Math.max(r.length,1);var s=e.members.slice(0,t);var n=s.shift();var i=a;while(n){if(n.name===F)i+=a-1;else if(n.children)[].push.apply(s,n.children);else{i++;[].push.apply(s,n.members)}n=s.shift()}return i}function Me(e,t,r){if(!t[0])return{parsedRoot:null,tuples:e,memberIndex:0,index:0};var a=Ae(e,t[0]);if(!a.tuple)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};var s=a.tuple.members;var n=t[0].members;var i=-1;if(s.length!==n.length)return{parsedRoot:null,tuples:t,memberIndex:0,index:0};for(var o=0,l=s.length;o<l;o++)if(!s[o].measure&&n[o].children[0]){if(i==-1&&n[o].children.length)i=o;s[o].children=n[o].children}r=Math.max(r.length,1);return{parsedRoot:a.tuple,index:a.index*r,memberIndex:i,tuples:e}}function Ie(e,t){var r=true;var a,s;e=e.members;t=t.members;for(a=0,s=e.length;a<s;a++){if(e[a].measure||t[a].measure)continue;r=r&&Ye(e[a])===Ye(t[a])}return r}function Ae(e,t){var r,a,s,n,i=0;var o,l,u;for(r=0,a=e.length;r<a;r++){s=e[r];if(Ie(s,t))return{tuple:s,index:i};i++;for(o=0,l=s.members.length;o<l;o++){u=s.members[o];if(u.measure)continue;n=Ae(u.children,t);i+=n.index;if(n.tuple)return{tuple:n.tuple,index:i}}}return{index:i}}function He(e,t){var r,a,s,n="";for(a=0,s=e.length;a<s;a++){r=e[a];n+=r.name;if(!t[n])t[n]=r}}function Re(e,t){var r=e.members;var a,s,n,i="";var o="";var l;for(a=0,s=r.length;a<s;a++){n=r[a];if(l)if(t[i+n.name]){i+=n.name;l=t[i];continue}else if(t[i+n.parentName])return t[i+n.parentName];else if(t[o+n.parentName])return t[o+n.parentName];else return t[o];i+=n.name;l=t[n.parentName];if(!l){l=t[i];if(!l)return null}if(l)o+=l.name}return l}function De(e,t){if(t.length===0)return-1;var r=t[0];var a=e.members;for(var s=0,n=a.length;s<n;s++)if(a[s].name==r.name)return s}function Le(e,t){if(t<0)return;var r={name:F,measure:true,children:[x.extend({members:[],dataIndex:e.dataIndex},e.members[t])]};e.members.splice(t,1,r);e.dataIndex=H}function Pe(e,t){if(e.length<1)return[];var r=[];var a={};var s=De(e[0],t);for(var n=0;n<e.length;n++){var i=e[n];i.dataIndex=n;Le(i,s);var o=Re(i,a);if(o)if(s<0||!o.measure)o.children.push(i);else o.children.push(i.members[s].children[0]);else r.push(i);He(i.members,a)}return r}function Oe(e,t){if(!e||!e.length)return t;var r=[];var a=Be(e);var s=a.length;var n=Math.max(t.length/s,1);var i,o,l,c;var u;for(i=0;i<s;i++){l=n*i;c=n*a[i];for(o=0;o<n;o++){u=parseInt(c+o,10);r[parseInt(l+o,10)]=t[u]||{value:"",fmtValue:"",ordinal:u}}}return r}function Fe(e,t){if(!e||!e.length)return t;var r=[];var a=Be(e);var s=a.length;var n=Math.max(t.length/s,1);var i,o,l,u;for(o=0;o<n;o++){l=s*o;for(i=0;i<s;i++){u=a[i]+l;r[l+i]=t[u]||{value:"",fmtValue:"",ordinal:u}}}return r}function Be(e){e=e.slice();var t=[];var r=e.shift();var a,s,n,i,o;while(r){if(r.dataIndex!==H)t.push(r.dataIndex);n=0;for(a=0,s=r.members.length;a<s;a++){o=r.members[a];i=o.children;if(o.measure)[].splice.apply(e,[0,0].concat(i));else[].splice.apply(e,[n,0].concat(i));n+=i.length}r=e.shift()}return t}function Ue(e){var t=e.split(".");if(t.length>2)return t[0]+"."+t[1];return e}function qe(e,t){var r=e.length-1;var a=e[r];var s;s=We(t,a);if(s&&s.dir)a="ORDER("+a+".Children,"+s.field+".CurrentMember.MEMBER_CAPTION,"+s.dir+")";else a+=".Children";e[r]=a;return e}function We(e,t){for(var r=0,a=e.length;r<a;r++)if(t.indexOf(e[r].field)===0)return e[r];return null}function ze(e){var t="CROSSJOIN({";var r;if(e.length>2){r=e.pop();t+=ze(e)}else{t+=e.shift();r=e.pop()}t+="},{";t+=r;t+="})";return t}function Ge(e,t){var r=e.slice(0);if(t.length>1)r.push("{"+je(t).join(",")+"}");return ze(r)}function je(e){var t=0;var r=e.length;var a=[];var s;for(;t<r;t++){s=e[t];a.push(s.name!==H?s.name:s)}return a}function Ve(e,t){var r,a,s=-1;for(r=0,a=t.length;r<a;r++)if(Ye(t[r])===e){s=r;break}return s}function Ye(e){e=e.name||e;if(v.call(e)==="[object Array]")e=e[e.length-1];return e}function Ke(e){var t=e.length;var r=[];var a=0;for(;a<t;a++)r.push(e[a].name[0]);return r}function Qe(e,t){var r;var a;var s;var n=0;var i=e.length;var o=t.length;t=t.slice(0);for(;n<i;n++){r=e[n];for(s=0;s<o;s++){a=Ue(t[s]);if(r.indexOf(a)!==-1){t[s]=r;break}}}return{names:t,expandedIdx:s,uniquePath:t.slice(0,s+1).join("")}}function $e(e){var t=[];var r=[];var a=[];var s;var n,i;var o=0;var c=e.length;var l;var h;var u;for(;o<c;o++){s=e[o];l=s.name;u=false;if(v.call(l)!=="[object Array]")s.name=l=[l];if(l.length>1)r.push(s);else{h=Ue(l[0]);for(n=0,i=a.length;n<i;n++)if(a[n].name[0].indexOf(h)===0){u=true;break}if(!u)a.push(s);if(s.expand)t.push(s)}}t=t.concat(r);return{root:a,expanded:t}}function Je(e,t,r){var a="";e=e||[];var s=$e(e);var c=s.root;var n=Ke(c);var i=[];s=s.expanded;var h=s.length;var o=0;var l;var u=[];if(n.length>1||t.length>1){i.push(Ge(n,t));for(;o<h;o++){l=qe(s[o].name,r);u=Qe(l,n).names;i.push(Ge(u,t))}a+=i.join(",")}else{for(;o<h;o++){l=qe(s[o].name,r);u.push(l[0])}a+=n.concat(u).join(",")}return a}ve.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},r=t.data;t.data=r;if(!(t instanceof ve)&&t instanceof E.data.DataSource)throw new Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof ve?t:new ve(t)},ge.create=function(e){e=e&&e.push?{data:e}:e;var t=e||{},r=t.data;t.data=r;if(!(t instanceof ge)&&t instanceof E.data.DataSource)throw new Error("Incorrect DataSource type. Only PivotDataSource instances are supported");return t instanceof ge?t:new ge(t)};var Xe={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}")',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"'};function Ze(e){var t="";var r=e.value;var a=e.field;var s=e.operator;if(s=="in"){t+="{";t+=r;t+="}"}else{t+=s=="neq"||s=="doesnotcontain"?"-":"";t+="Filter(";t+=a+".MEMBERS";t+=E.format(Xe[s],a,r);t+=")"}return t}function et(e,t){var r="",a;var s=e.filters;var n=s.length;var i;for(i=n-1;i>=0;i--){a="SELECT (";a+=Ze(s[i]);a+=") ON 0";if(i==n-1){a+=" FROM ["+t+"]";r=a}else r=a+" FROM ( "+r+" )"}return r}function tt(e,t,r){var a="";if(t){a+="<"+e+">";var s;for(var n in t){s=t[n];if(r)n=n.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"");a+="<"+n+">"+s+"</"+n+">"}a+="</"+e+">"}else a+="<"+e+"/>";return a}var rt={schemaCubes:"MDSCHEMA_CUBES",schemaCatalogs:"DBSCHEMA_CATALOGS",schemaMeasures:"MDSCHEMA_MEASURES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaLevels:"MDSCHEMA_LEVELS",schemaMembers:"MDSCHEMA_MEMBERS",schemaKPIs:"MDSCHEMA_KPIS"},at={read:function(e){var t='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>';t+="SELECT NON EMPTY {";var r=e.columns||[];var a=e.rows||[];var s=e.measures||[];var n=e.measuresAxis==="rows";var i=e.sort||[];if(!r.length&&a.length&&(!s.length||s.length&&n)){r=a;a=[];n=false}if(!r.length&&!a.length)n=false;if(r.length)t+=Je(r,!n?s:[],i);else if(s.length&&!n)t+=je(s).join(",");t+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS";if(a.length||n&&s.length>1){t+=", NON EMPTY {";if(a.length)t+=Je(a,n?s:[],i);else t+=je(s).join(",");t+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"}if(e.filter){t+=" FROM ";t+="(";t+=et(e.filter,e.connection.cube);t+=")"}else t+=" FROM ["+e.connection.cube+"]";if(s.length==1&&r.length)t+=" WHERE ("+je(s).join(",")+")";t+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>";return t.replace(/\&/g,"&amp;")},discover:function(e){e=e||{};var t='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';t+="<RequestType>"+(rt[e.command]||e.command)+"</RequestType>";t+="<Restrictions>"+tt("RestrictionList",e.restrictions,true)+"</Restrictions>";if(e.connection&&e.connection.catalog)e.properties=x.extend({},{Catalog:e.connection.catalog},e.properties);t+="<Properties>"+tt("PropertyList",e.properties)+"</Properties>";t+="</Discover></Body></Envelope>";return t}},st=E.data.RemoteTransport.extend({init:function(e){var t=e;e=this.options=n(true,{},this.options,e);E.data.RemoteTransport.call(this,e);if(w(t.discover))this.discover=t.discover;else if(typeof t.discover==="string")this.options.discover={url:t.discover};else if(!t.discover)this.options.discover=this.options.read},setup:function(e,t){e.data=e.data||{};x.extend(true,e.data,{connection:this.options.connection});return E.data.RemoteTransport.fn.setup.call(this,e,t)},options:{read:{dataType:"text",contentType:"text/xml",type:"POST"},discover:{dataType:"text",contentType:"text/xml",type:"POST"},parameterMap:function(e,t){return at[t](e,t)}},discover:function(e){return x.ajax(this.setup(e,"discover"))}}),nt=t.extend({init:function(e){e=this.options=n(true,{},this.options,e)},setup:function(e){return x.extend(true,e||{},{connection:this.options.connection})},read:function(e){var t=this,r,a;var s=t.setup(e.data,A);r=e.success||x.noop;a=e.error||x.noop;if(e.parameterMap)s=t.parameterMap(s,A);b({url:t.options.read},s).then(S).then(function(e){r(e)}).catch(function(e){a(e)})},catalog:function(e){var t=this.options||{};if(e===H)return(t.connection||{}).catalog;var r=t.connection||{};r.catalog=e;this.options.connection=r;x.extend(this.transport.options,{connection:r})},cube:function(e){var t=this.options||{};if(e===H)return(t.connection||{}).cube;var r=t.connection||{};r.cube=e;this.options.connection=r;n(true,this.transport.options,{connection:r})},discover:function(e){return p({url:this.options.read},e)}});function it(e){if(e==null)return[];var t=v.call(e);if(t!=="[object Array]")return[e];return e}function ot(e){var t={tuples:[]};var r=it(E.getter("Tuples.Tuple",true)(e));var a=E.getter("Caption['#text']");var s=E.getter("UName['#text']");var n=E.getter("LName['#text']");var c=E.getter("LNum['#text']");var h=E.getter("CHILDREN_CARDINALITY['#text']",true);var d=E.getter("['@Hierarchy']");var p=E.getter("PARENT_UNIQUE_NAME['#text']",true);for(var i=0;i<r.length;i++){var o=[];var l=it(r[i].Member);for(var u=0;u<l.length;u++)o.push({children:[],caption:a(l[u]),name:s(l[u]),levelName:n(l[u]),levelNum:c(l[u]),hasChildren:parseInt(h(l[u]),10)>0,parentName:p(l[u]),hierarchy:d(l[u])});t.tuples.push({members:o})}return t}var lt={cubes:{name:E.getter("CUBE_NAME['#text']",true),caption:E.getter("CUBE_CAPTION['#text']",true),description:E.getter("DESCRIPTION['#text']",true),type:E.getter("CUBE_TYPE['#text']",true)},catalogs:{name:E.getter("CATALOG_NAME['#text']",true),description:E.getter("DESCRIPTION['#text']",true)},measures:{name:E.getter("MEASURE_NAME['#text']",true),caption:E.getter("MEASURE_CAPTION['#text']",true),uniqueName:E.getter("MEASURE_UNIQUE_NAME['#text']",true),description:E.getter("DESCRIPTION['#text']",true),aggregator:E.getter("MEASURE_AGGREGATOR['#text']",true),groupName:E.getter("MEASUREGROUP_NAME['#text']",true),displayFolder:E.getter("MEASURE_DISPLAY_FOLDER['#text']",true),defaultFormat:E.getter("DEFAULT_FORMAT_STRING['#text']",true)},kpis:{name:E.getter("KPI_NAME['#text']",true),caption:E.getter("KPI_CAPTION['#text']",true),value:E.getter("KPI_VALUE['#text']",true),goal:E.getter("KPI_GOAL['#text']",true),status:E.getter("KPI_STATUS['#text']",true),trend:E.getter("KPI_TREND['#text']",true),statusGraphic:E.getter("KPI_STATUS_GRAPHIC['#text']",true),trendGraphic:E.getter("KPI_TREND_GRAPHIC['#text']",true),description:E.getter("KPI_DESCRIPTION['#text']",true),groupName:E.getter("MEASUREGROUP_NAME['#text']",true)},dimensions:{name:E.getter("DIMENSION_NAME['#text']",true),caption:E.getter("DIMENSION_CAPTION['#text']",true),description:E.getter("DESCRIPTION['#text']",true),uniqueName:E.getter("DIMENSION_UNIQUE_NAME['#text']",true),defaultHierarchy:E.getter("DEFAULT_HIERARCHY['#text']",true),type:E.getter("DIMENSION_TYPE['#text']",true)},hierarchies:{name:E.getter("HIERARCHY_NAME['#text']",true),caption:E.getter("HIERARCHY_CAPTION['#text']",true),description:E.getter("DESCRIPTION['#text']",true),uniqueName:E.getter("HIERARCHY_UNIQUE_NAME['#text']",true),dimensionUniqueName:E.getter("DIMENSION_UNIQUE_NAME['#text']",true),displayFolder:E.getter("HIERARCHY_DISPLAY_FOLDER['#text']",true),origin:E.getter("HIERARCHY_ORIGIN['#text']",true),defaultMember:E.getter("DEFAULT_MEMBER['#text']",true)},levels:{name:E.getter("LEVEL_NAME['#text']",true),caption:E.getter("LEVEL_CAPTION['#text']",true),description:E.getter("DESCRIPTION['#text']",true),uniqueName:E.getter("LEVEL_UNIQUE_NAME['#text']",true),dimensionUniqueName:E.getter("DIMENSION_UNIQUE_NAME['#text']",true),displayFolder:E.getter("LEVEL_DISPLAY_FOLDER['#text']",true),orderingProperty:E.getter("LEVEL_ORDERING_PROPERTY['#text']",true),origin:E.getter("LEVEL_ORIGIN['#text']",true),hierarchyUniqueName:E.getter("HIERARCHY_UNIQUE_NAME['#text']",true)},members:{name:E.getter("MEMBER_NAME['#text']",true),caption:E.getter("MEMBER_CAPTION['#text']",true),uniqueName:E.getter("MEMBER_UNIQUE_NAME['#text']",true),dimensionUniqueName:E.getter("DIMENSION_UNIQUE_NAME['#text']",true),hierarchyUniqueName:E.getter("HIERARCHY_UNIQUE_NAME['#text']",true),levelUniqueName:E.getter("LEVEL_UNIQUE_NAME['#text']",true),childrenCardinality:E.getter("CHILDREN_CARDINALITY['#text']",true)}},ut=["axes","catalogs","cubes","dimensions","hierarchies","levels","measures"],ct=E.data.XmlDataReader.extend({init:function(e){E.data.XmlDataReader.call(this,e);this._extend(e)},_extend:function(e){var t=0;var r=ut.length;var a;var s;for(;t<r;t++){a=ut[t];s=e[a];if(s&&s!==g)this[a]=s}},parse:function(e){var t=E.data.XmlDataReader.fn.parse(e.replace(/<(\/?)(\w|-)+:/g,"<$1"));return E.getter("['Envelope']['Body']",true)(t)},errors:function(e){var t=E.getter("['Fault']",true)(e);if(t)return[{faultstring:E.getter("faultstring['#text']",true)(t),faultcode:E.getter("faultcode['#text']",true)(t)}];return null},axes:function(e){e=E.getter('ExecuteResponse["return"].root',true)(e);var t=it(E.getter("Axes.Axis",true)(e));var r;var a={columns:{},rows:{}};for(var s=0;s<t.length;s++){r=t[s];if(r["@name"].toLowerCase()!=="sliceraxis")if(!a.columns.tuples)a.columns=ot(r);else a.rows=ot(r)}return a},data:function(e){e=E.getter('ExecuteResponse["return"].root',true)(e);var t=it(E.getter("CellData.Cell",true)(e));var r=[];var a=E.getter("['@CellOrdinal']");var s=E.getter("Value['#text']");var n=E.getter("FmtValue['#text']");for(var i=0;i<t.length;i++)r.push({value:s(t[i]),fmtValue:n(t[i]),ordinal:parseInt(a(t[i]),10)});return r},_mapSchema:function(e,t){e=E.getter('DiscoverResponse["return"].root',true)(e);var r=it(E.getter("row",true)(e));var a=[];for(var s=0;s<r.length;s++){var n={};for(var i in t)n[i]=t[i](r[s]);a.push(n)}return a},measures:function(e){return this._mapSchema(e,lt.measures)},kpis:function(e){return this._mapSchema(e,lt.kpis)},hierarchies:function(e){return this._mapSchema(e,lt.hierarchies)},levels:function(e){return this._mapSchema(e,lt.levels)},dimensions:function(e){return this._mapSchema(e,lt.dimensions)},cubes:function(e){return this._mapSchema(e,lt.cubes)},catalogs:function(e){return this._mapSchema(e,lt.catalogs)},members:function(e){return this._mapSchema(e,lt.members)}}),ht=(n(true,E.data,{PivotDataSource:ge,PivotDataSourceV2:ve,XmlaTransport:st,XmlaDataReader:ct,PivotCubeBuilder:me,transports:{xmla:st},readers:{xmla:ct}}),function(e,t){if(!e)return null;for(var r=0,a=e.length;r<a;r++)if(e[r].field===t)return e[r];return null}),dt=function(e,t){var r=[];for(var a=0,s=e.length;a<s;a++)if(e[a].field!==t)r.push(e[a]);return r},pt=(E.ui.PivotSettingTarget=a.extend({init:function(e,t){var n=this;a.fn.init.call(n,e,t);n.element.addClass("k-pivot-setting");n.dataSource=E.data.PivotDataSource.create(t.dataSource);n._refreshHandler=x.proxy(n.refresh,n);n.dataSource.first(i,n._refreshHandler);if(!t.template){var r="";if(n.options.enabled)r='<span class="k-setting-delete k-chip-action"><span class="k-icon k-i-close"></span></span>';n.options.template=""+'<span class="k-chip k-chip-md k-rounded-full k-chip-solid k-chip-solid-base" data-'+E.ns+'name="${data.name || data}">'+'<span class="k-chip-content">'+'<span class="k-chip-text">${data.name || data}</span>'+"</span>"+'<span class="k-chip-actions">'+r+"</span>"+"</span>"}n.template=E.template(n.options.template);n.emptyTemplate=E.template(n.options.emptyTemplate);n._sortable();n.element.on("click"+o,".k-chip, .k-button",function(e){var t=x(e.target);var r=t.closest(".k-chip-action");var a=t.closest("["+E.attr("name")+"]").attr(E.attr("name"));if(!a)return;if(r.hasClass("k-setting-delete")){n.remove(a);return}if(t.closest(".k-chip-actions").length>0)return;if(n.options.sortable){var s=x(e.currentTarget).find(".k-i-sort-asc-sm").length?"desc":"asc";n.sort({field:a,dir:s})}});if(t.filterable||t.sortable)n.fieldMenu=new l.PivotFieldMenu(n.element,{messages:n.options.messages.fieldMenu,filter:".k-setting-fieldmenu",filterable:t.filterable,sortable:t.sortable,dataSource:n.dataSource});n.refresh()},options:{name:"PivotSettingTarget",template:null,filterable:false,sortable:false,emptyTemplate:"<div class='k-empty'>${data}</div>",setting:"columns",enabled:true,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(i,this._refreshHandler);this.dataSource=this.options.dataSource=e;if(this.fieldMenu)this.fieldMenu.setDataSource(e);e.first(i,this._refreshHandler);this.refresh()},_sortable:function(){var r=this;if(r.options.enabled)this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,hint:r.options.hint,filter:">*:not(.k-empty)",cursor:"move",start:function(e){e.item.trigger("focus").trigger("blur")},change:function(e){var t=e.item.attr(E.attr("name"));if(e.action=="receive")r.add(t);else if(e.action=="remove")r.remove(t);else if(e.action=="sort")r.move(t,e.newIndex)}}).data("kendoSortable")},_isKPI:function(e){return e.type==="kpi"||e.measure},validate:function(e){var t=e.type==2||"aggregator"in e||this._isKPI(e);if(t)return this.options.setting==="measures";if(this.options.setting==="measures")return t;var r=this.dataSource[this.options.setting]();var a=e.defaultHierarchy||e.uniqueName;if(Ve(a,r)>-1)return false;r=this.dataSource[this.options.setting==="columns"?"rows":"columns"]();if(Ve(a,r)>-1)return false;return true},add:function(e){var t=this.dataSource[this.options.setting]();var r,a;e=Array.isArray(e)?e.slice(0):[e];for(r=0,a=e.length;r<a;r++)if(Ve(e[r],t)!==-1){e.splice(r,1);r-=1;a-=1}if(e.length){t=t.concat(e);this.dataSource[this.options.setting](t)}},move:function(e,t){var r=this.dataSource[this.options.setting]();var a=Ve(e,r);if(a>-1){e=r.splice(a,1)[0];r.splice(t,0,e);this.dataSource[this.options.setting](r)}},remove:function(e){var t=this.dataSource[this.options.setting]();var r=Ve(e,t);var a=this.dataSource.sort();var s=this.dataSource.filter();if(r>-1){if(s){s.filters=dt(s.filters,e);this.dataSource._filter.filters=s.filters;if(!s.filters.length)this.dataSource._filter=null}if(a){a=dt(a,e);this.dataSource._sort=a}t.splice(r,1);this.dataSource[this.options.setting](t)}},sort:function(e){var t=this.options.sortable;var r=t===true||t.allowUnsort;var a=r&&e.dir==="asc";var s=this.dataSource.sort()||[];var n=dt(s,e.field);if(a&&s.length!==n.length)e=null;if(e)n.push(e);this.dataSource.sort(n)},refresh:function(){var e="";var t=this.dataSource[this.options.setting]();var r=t.length;var a=0;var s;if(r)for(;a<r;a++){s=t[a];s=s.name===H?{name:s}:s;e+=this.template(n({sortIcon:this._sortIcon(s.name)},s))}else e=this.emptyTemplate(this.options.messages.empty);this.element.html(e)},destroy:function(){a.fn.destroy.call(this);this.dataSource.unbind(i,this._refreshHandler);this.element.off(o);if(this.sortable)this.sortable.destroy();if(this.fieldMenu)this.fieldMenu.destroy();this.element=null;this._refreshHandler=null},_sortIcon:function(e){var t=this.dataSource.sort();var r=ht(t,Ye(e));var a="";if(r)a="k-i-sort-"+r.dir;return a}}),E.ui.PivotSettingTargetV2=a.extend({init:function(e,t){var s=this;a.fn.init.call(s,e,t);s.dataSource=E.data.PivotDataSourceV2.create(t.dataSource);s._refreshHandler=x.proxy(s.refresh,s);s.dataSource.first(i,s._refreshHandler);s.template=E.template(s.options.template);s._sortable();s.element.on("click"+o,".k-i-close-circle",function(e){var t=x(e.target);var r=t.closest(".k-chip");var a=r.find(".k-chip-label").text();if(!a)return;s.remove(a);r.remove();s.trigger("remove",{name:a})});if(t.filterable||t.sortable)s.fieldMenu=new l.PivotFieldMenuV2(s.element,{messages:s.options.messages.fieldMenu,filterable:t.filterable,filter:".k-i-more-vertical",sortable:t.sortable,dataSource:s.dataSource});s.refresh()},events:["remove"],options:{name:"PivotSettingTargetV2",template:null,filterable:false,sortable:false,setting:"columns",enabled:true,messages:{empty:"Drop Fields Here"}},setDataSource:function(e){this.dataSource.unbind(i,this._refreshHandler);this.dataSource=this.options.dataSource=e;if(this.fieldMenu)this.fieldMenu.setDataSource(e);e.first(i,this._refreshHandler);this.refresh()},_applyState:function(){if(this._sortState!==H){this.dataSource._sort=this._sortState;this._sortState=H}if(this._stateFilter!==H){this.dataSource._filter=this._stateFilter;this._stateFilter=H}this.dataSource["_"+this.options.setting]=this.options.setting==="measures"?ae(this._savedState):R(this._savedState)},_cancelChanges:function(){this._sortState=H;this._stateFilter=H;this._savedState=E.deepExtend([],this._initialState);this._redraw()},_state:function(e,t){var r=this;if(!e)return r._savedState||[];else{if(!r._savedState||t)r._initialState=E.deepExtend([],e);r._savedState=E.deepExtend([],e)}},_sortable:function(){var r=this;this.sortable=this.element.kendoSortable({connectWith:this.options.connectWith,hint:r.options.hint,filter:">*:not(.k-empty)",cursor:"move",start:function(e){e.item.focus().blur()},change:function(e){var t=e.item.find(".k-chip-label").text();if(e.action=="receive")r.add(t);else if(e.action=="remove")r.remove(t);else if(e.action=="sort")r.move(t,e.newIndex)}}).data("kendoSortable")},add:function(e){var t=this._state();var r,a;e=x.isArray(e)?e.slice(0):[e];for(r=0,a=e.length;r<a;r++)if(Ve(e[r],t)!==-1){e.splice(r,1);r-=1;a-=1}if(e.length){t=t.concat(e);this._state(t);this._redraw()}},move:function(e,t){var r=this._state();var a=Ve(e,r);if(a>-1){e=r.splice(a,1)[0];r.splice(t,0,e);this._state(r);this._redraw()}},remove:function(e){var t=this._state();var r=Ve(e,t);var a=this.dataSource.sort();var s=this.dataSource.filter();if(r>-1){if(s){s.filters=dt(s.filters,e);this._savedFilter=this.dataSource._filter;this._savedFilter.filters=s.filters;if(!s.filters.length)this._savedFilter=null}if(a){a=dt(a,e);this._sortState=a}t.splice(r,1);this._state(t);this._redraw()}},_emptyState:function(e){var t=this;if(e)t.element.html(this.options.messages.empty).addClass("k-settings-description").removeClass("k-chip-list");else t.element.removeClass("k-settings-description").addClass("k-chip-list")},_redraw:function(){var e=this._state()||[];this._emptyState(!e.length);if(e.length)this.element.html(this._targetsHTML(e))},_targetsHTML:function(e){var t;var r="";var a=0;var s=this.options;var n=false;if(this.options.setting!="measures")n=s.filterable||s.sortable;if(e.length)for(;a<e.length;a++){t=e[a];t=t.name===H?{name:t}:t;r+=this.template({name:t.name,menuenabled:n})}return r},refresh:function(){if(this.dataSource._preventRefresh)return;var e=this.dataSource[this.options.setting]();this._emptyState(!this._state().length);this._state(e,true);if(e.length)this.element.html(this._targetsHTML(e))},destroy:function(){a.fn.destroy.call(this);this.dataSource.unbind(i,this._refreshHandler);this.element.off(o);if(this.sortable)this.sortable.destroy();if(this.fieldMenu)this.fieldMenu.destroy();this.element=null;this._refreshHandler=null}}),a.extend({init:function(e,t){var r=this;a.fn.init.call(r,e,t);r.element=x(e);r._element();r._attachEvents()},options:{name:"PivotConfiguratorButton",text:"Change settings",configurator:""},destroy:function(){this.element.off(o)},setOptions:function(e){var t=this;E.deepExtend(t.options,e);this.init(this.element,this.options)},toggle:function(){var e=E.attr("role");var t=this.element.closest("["+e+"=pivotcontainer]").find("["+e+"=pivotgridv2]");var r;x("#"+this.options.configurator).toggleClass("k-hidden");if(t.length){r=t.getKendoPivotGridV2();r._setContentWidth();r._updateDimensions()}},_attachEvents:function(){this.element.on("click"+o,x.proxy(this.toggle,this))},_element:function(){var e=this.options;this.element.addClass("k-pivotgrid-configurator-button");this.element.html(E.format("<span>{0}<span class='k-icon k-i-gear k-color-inherit'></span></span>",e.text))}})),mt=a.extend({init:function(e,t){var r=this;a.fn.init.call(r,e,t);r.element=x(e);r.options=t;r._addClasses()},options:{name:"PivotContainer",configuratorPosition:"left"},setOptions:function(e){var t=this;E.deepExtend(t.options,e);this.init(this.element,this.options)},_addClasses:function(){var e=this.options;var t;this.element.removeClass("k-flex-row k-flex-row-reverse k-flex-column k-flex-column-reverse");switch(e.configuratorPosition){case"right":t="k-flex-row";break;case"left":t="k-flex-row-reverse";break;case"bottom":t="k-flex-column";break;case"top":t="k-flex-column-reverse";break;default:t="k-flex-row"}this.element.addClass("k-d-flex k-pos-relative").addClass(t)}}),ft=a.extend({init:function(e,t){var u=this;a.fn.init.call(u,e,t);u._dataSource();u._bindConfigurator();u._wrapper();u._columnHeadersWrapper=x('<div class="k-pivotgrid-column-headers"></div>');u._rowHeadersWrapper=x('<div class="k-pivotgrid-row-headers"></div>');u._contentWrapper=x('<div class="k-pivotgrid-values"></div>');u.wrapper.append(u._columnHeadersWrapper);u.wrapper.append(u._rowHeadersWrapper);u.wrapper.append(u._contentWrapper);u._columnBuilder=new St({template:this.options.columnHeaderTemplate,axes:"columns"});u._rowBuilder=new St({template:this.options.rowHeaderTemplate,axes:"rows"});u._contentBuilder=new bt({template:this.options.dataCellTemplate||Z});u._scrollable();u._rowHeadersWrapper.add(u._columnHeadersWrapper).on("click","span.k-icon",function(){var e=x(this);var t=e.parent().attr(E.attr("key"));var r=e.hasClass("k-i-arrow-chevron-up");var a=e.closest(".k-pivotgrid-row-headers").length!==0;var s=t.split(",");var n=r?Y:j;if(u.trigger(n,{path:s,axis:a?"rows":"columns"}))return;var i={type:"HEADERS_ACTION_TOGGLE",payload:s,tree:a?u._rowBuilder.getTree():u._columnBuilder.getTree()};var o=a?u.dataSource._rows:u.dataSource._columns;var l=M(o,i);u.dataSource._preventRefresh=true;if(a)u.dataSource.rows(l);else u.dataSource.columns(l)});if(u.options.autoBind)u.dataSource.fetch();E.notify(u)},events:[z,G,j,Y],options:{name:"PivotGridV2",autoBind:true,height:null,columnWidth:null,configurator:"",columnHeaderTemplate:null,rowHeaderTemplate:null,dataCellTemplate:null},destroy:function(){var e=this;a.fn.destroy.call(e);if(e._windowResizeHandler){x(window).off(I+o,e._windowResizeHandler);e._windowResizeHandler=null}},_dataSource:function(){var e=this;var t=e.options.dataSource;t=x.isArray(t)?{data:t}:t;if(e.dataSource&&this._refreshHandler)e.dataSource.unbind(i,e._refreshHandler).unbind(P,e._progressHandler).unbind(D,e._errorHandler);else{e._refreshHandler=x.proxy(e.refresh,e);e._progressHandler=x.proxy(e._requestStart,e);e._errorHandler=x.proxy(e._error,e)}e.dataSource=E.data.PivotDataSourceV2.create(t).bind(i,e._refreshHandler).bind(P,e._progressHandler).bind(D,e._errorHandler)},_resize:function(){var e=this;e.wrapper[0].style.setProperty("--kendo-scrollbar-width",E.format("{0}px",de()))},_scrollable:function(){var e=this;var t=e._columnHeadersWrapper;var r=e._rowHeadersWrapper;e._resize();e._windowResizeHandler=x.proxy(e._resize,e);e._contentWrapper.scroll(function(){E.scrollLeft(t,this.scrollLeft);r.scrollTop(this.scrollTop)});r.bind("DOMMouseScroll"+o+" mousewheel"+o,x.proxy(e._wheelScroll,e));x(window).on(I+o,e._windowResizeHandler)},_wheelScroll:function(e){if(e.ctrlKey)return;var t=E.wheelDeltaY(e);var r=this._contentWrapper.scrollTop();if(t){e.preventDefault();x(e.currentTarget).one("wheel"+o,false);this._rowHeadersWrapper.scrollTop(r+-t);this._contentWrapper.scrollTop(r+-t)}},_wrapper:function(){var e=this.options.height;this.wrapper=this.element.addClass("k-widget k-pivotgrid");this.wrapper.append('<span class="k-pivotgrid-empty-cell" />');if(e)this.wrapper.css("height",e)},_progress:function(e){E.ui.progress(this.wrapper,e)},_error:function(){this._progress(false)},_requestStart:function(){this._progress(true)},_updateDimensions:function(){var e=this;e.wrapper.css({"grid-template-columns":E.format("{0}px 1fr",e._rowHeadersWrapper.find(".k-pivotgrid-table")[0].offsetWidth),"grid-template-rows":E.format("{0}px 1fr",e._columnHeadersWrapper.find(".k-pivotgrid-table")[0].offsetHeight)})},_setContentWidth:function(){if(!this.options.columnWidth)return;var e=this._contentWrapper.find("table");var t=this._columnHeadersWrapper.children("table");var r=e.children("colgroup").children().length;var a=r*this.options.columnWidth;var s=Math.ceil(a/this._contentWrapper.width()*100);if(s<100)s=100;e.add(t).css("width",s+"%")},_bindConfigurator:function(){var e=this.options.configurator;if(e)x(e).kendoPivotConfiguratorV2("setDataSource",this.dataSource)},cellInfoByElement:function(e){e=x(e);return this.cellInfo(e.index(),e.parent("tr").index())},cellInfo:function(e,t){var r=this._contentBuilder;var a;var s;if(e>=r.columnsCount||e<0||t>=r.rowsCount||t<0)return null;a=t*r.columnsCount+e;s=r.hash[a<0?0:a];return{columnTuple:s.columnTuple,rowTuple:s.rowTuple,dataItem:s.data}},refresh:function(){var e=this;var t=e.dataSource;if(e.trigger(z,{action:"rebind"}))return;e._columnBuilder.setTuples(t._columnTuples);e._columnHeadersWrapper.html(e._columnBuilder.build());e._rowBuilder.setTuples(t._rowTuples);e._rowHeadersWrapper.html(e._rowBuilder.build());e._contentBuilder.setRowColumnInfo({columnHeaderLeafs:e._columnBuilder.getHeaderLeafs(),rowHeaderLeafs:e._rowBuilder.getHeaderLeafs(),columnHeaderBreadth:e._columnBuilder.getBreadth(),rowHeaderDepth:e._rowBuilder.getBreadth(),data:t._view});e._contentWrapper.html(e._contentBuilder.build());e._setContentWidth();e._updateDimensions();e._progress(false);e.trigger(G)}}),vt=(l.plugin(pt),l.plugin(mt),l.plugin(ft),a.extend({init:function(e,t){var u=this;var c;var h;a.fn.init.call(u,e,t);u._dataSource();u._bindConfigurator();u._wrapper();u._createLayout();u._columnBuilder=c=new Nt;u._rowBuilder=h=new yt;u._contentBuilder=new Et;u._templates();u.columnsHeader.add(u.rowsHeader).on("click","span.k-icon",function(){var e=x(this);var t=c;var r="expandColumn";var a;var s=e.attr(E.attr("path"));var n={axis:"columns",path:x.parseJSON(s)};if(e.parent().is("td")){t=h;r="expandRow";n.axis="rows"}var i=e.hasClass(K);var o=t.metadata[s];var l=o.expanded===H;a=i?Y:j;n.childrenLoaded=o.maxChildren>o.children;if(u.trigger(a,n))return;t.metadata[s].expanded=!i;e.toggleClass(K,!i).toggleClass(Q,i);if(!i&&l)u.dataSource[r](n.path);else u.refresh()});u._scrollable();if(u.options.autoBind)u.dataSource.fetch();E.notify(u)},events:[z,G,j,Y],options:{name:"PivotGrid",autoBind:true,reorderable:true,filterable:false,sortable:false,height:null,columnWidth:100,configurator:"",columnHeaderTemplate:null,rowHeaderTemplate:null,dataCellTemplate:null,kpiStatusTemplate:null,kpiTrendTemplate:null,messages:{measureFields:"Drop Data Fields Here",columnFields:"Drop Column Fields Here",rowFields:"Drop Rows Fields Here"}},_templates:function(){var e=this.options.columnHeaderTemplate;var t=this.options.rowHeaderTemplate;var r=this.options.dataCellTemplate;var a=this.options.kpiStatusTemplate;var s=this.options.kpiTrendTemplate;this._columnBuilder.template=E.template(e||$,{useWithBlock:!!e});this._contentBuilder.dataTemplate=E.template(r||Z,{useWithBlock:!!r});this._contentBuilder.kpiStatusTemplate=E.template(a||J,{useWithBlock:!!a});this._contentBuilder.kpiTrendTemplate=E.template(s||X,{useWithBlock:!!s});this._rowBuilder.template=E.template(t||$,{useWithBlock:!!t})},_bindConfigurator:function(){var e=this.options.configurator;if(e)x(e).kendoPivotConfigurator("setDataSource",this.dataSource)},cellInfoByElement:function(e){e=x(e);return this.cellInfo(e.index(),e.parent("tr").index())},cellInfo:function(e,t){var r=this._contentBuilder;var a=r.columnIndexes[e||0];var s=r.rowIndexes[t||0];var n;if(!a||!s)return null;n=s.index*r.rowLength+a.index;return{columnTuple:a.tuple,rowTuple:s.tuple,measure:a.measure||s.measure,dataItem:this.dataSource.view()[n]}},setDataSource:function(e){this.options.dataSource=e;this._dataSource();if(this.measuresTarget)this.measuresTarget.setDataSource(e);if(this.rowsTarget)this.rowsTarget.setDataSource(e);if(this.columnsTarget)this.columnsTarget.setDataSource(e);this._bindConfigurator();if(this.options.autoBind)e.fetch()},setOptions:function(e){a.fn.setOptions.call(this,e);this._templates()},destroy:function(){a.fn.destroy.call(this);clearTimeout(this._headerReflowTimeout)},_dataSource:function(){var e=this;var t=e.options.dataSource;t=Array.isArray(t)?{data:t}:t;if(e.dataSource&&this._refreshHandler)e.dataSource.unbind(i,e._refreshHandler).unbind(B,e._stateResetHandler).unbind(P,e._progressHandler).unbind(D,e._errorHandler);else{e._refreshHandler=x.proxy(e.refresh,e);e._progressHandler=x.proxy(e._requestStart,e);e._stateResetHandler=x.proxy(e._stateReset,e);e._errorHandler=x.proxy(e._error,e)}e.dataSource=E.data.PivotDataSource.create(t).bind(i,e._refreshHandler).bind(P,e._progressHandler).bind(B,e._stateResetHandler).bind(D,e._errorHandler)},_error:function(){this._progress(false)},_requestStart:function(){this._progress(true)},_stateReset:function(){this._columnBuilder.reset();this._rowBuilder.reset()},_wrapper:function(){var e=this.options.height;this.wrapper=this.element.addClass("k-widget k-pivot");if(e)this.wrapper.css("height",e)},_measureFields:function(){this.measureFields=x(q).addClass("k-pivot-toolbar k-toolbar k-settings-measures");this.measuresTarget=this._createSettingTarget(this.measureFields,{setting:"measures",messages:{empty:this.options.messages.measureFields}})},_createSettingTarget:function(e,t){var r;var a=t.sortable;var s="";if(a){s+="#if (data.sortIcon) {#";s+='<span class="k-chip-action"><span class="k-icon ${data.sortIcon}-sm"></span></span>';s+="#}#"}if(t.filterable||a)s+='<span class="k-setting-fieldmenu k-chip-action"><span class="k-icon k-i-more-vertical"></span></span>';if(this.options.reorderable)s+='<span class="k-setting-delete k-chip-action"><span class="k-icon k-i-close"></span></span>';r=""+'<span class="k-chip k-chip-md k-rounded-full k-chip-solid k-chip-solid-base" tabindex="0" data-'+E.ns+'name="${data.name}">'+'<span class="k-chip-content">'+'<span class="k-chip-text">${data.name}</span>'+"</span>"+'<span class="k-chip-actions k-field-actions">'+s+"</span>"+"</span>";return new E.ui.PivotSettingTarget(e,x.extend({dataSource:this.dataSource,template:r,emptyTemplate:'<span class="k-empty">${data}</span>',enabled:this.options.reorderable},t))},_initSettingTargets:function(){this.columnsTarget=this._createSettingTarget(this.columnFields,{connectWith:this.rowFields,setting:"columns",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.columnFields,fieldMenu:this.options.messages.fieldMenu}});this.rowsTarget=this._createSettingTarget(this.rowFields,{connectWith:this.columnFields,setting:"rows",filterable:this.options.filterable,sortable:this.options.sortable,messages:{empty:this.options.messages.rowFields,fieldMenu:this.options.messages.fieldMenu}})},_createLayout:function(){var e=this;var t=x(ee);var r=t.find(".k-pivot-rowheaders");var a=t.find(".k-pivot-table");var s=x(q).addClass("k-grid k-widget");e._measureFields();e.columnFields=x(q).addClass("k-pivot-toolbar k-toolbar k-settings-columns");e.rowFields=x(q).addClass("k-pivot-toolbar k-toolbar k-settings-rows");e.columnsHeader=x('<div class="k-grid-header-wrap" />').wrap('<div class="k-grid-header" />');e.columnsHeader.parent().css("padding-right",E.support.scrollbar());e.rowsHeader=x('<div class="k-grid k-widget k-alt"/>');e.content=x('<div class="k-grid-content" />');r.append(e.measureFields);r.append(e.rowFields);r.append(e.rowsHeader);s.append(e.columnsHeader.parent());s.append(e.content);a.append(e.columnFields);a.append(s);e.wrapper.append(t);e.columnsHeaderTree=new E.dom.Tree(e.columnsHeader[0]);e.rowsHeaderTree=new E.dom.Tree(e.rowsHeader[0]);e.contentTree=new E.dom.Tree(e.content[0]);e._initSettingTargets()},_progress:function(e){E.ui.progress(this.wrapper,e)},_resize:function(){if(this.content[0].firstChild){this._setSectionsWidth();this._setSectionsHeight();this._setContentWidth();this._setContentHeight();this._columnHeaderReflow()}},_columnHeaderReflow:function(){var e=this.columnsHeader.children("table");if(!E.support.browser.mozilla)return;clearTimeout(this._headerReflowTimeout);e.css("table-layout","auto");this._headerReflowTimeout=setTimeout(function(){e.css("table-layout","")})},_setSectionsWidth:function(){var e=this.rowsHeader;var t=e.parent(".k-pivot-rowheaders").width(U);var r;r=Math.max(h(this.measureFields),h(this.rowFields));r=Math.max(e.children("table").width(),r);t.width(r)},_setSectionsHeight:function(){var e=this.measureFields.height(U).height();var t=this.columnFields.height(U).height();var r=this.rowFields.height(U).innerHeight();var a=this.columnsHeader.height(U).innerHeight();var s=r-this.rowFields.height();var n=t>e?t:e;var i=a>r?a:r;this.measureFields.height(n);this.columnFields.height(n);this.rowFields.height(i-s);this.columnsHeader.height(i)},_setContentWidth:function(){var e=this.content.find("table");var t=this.columnsHeader.children("table");var r=e.children("colgroup").children().length;var a=r*this.options.columnWidth;var s=Math.ceil(a/this.content.width()*100);if(s<100)s=100;e.add(t).css("width",s+"%");this._resetColspan(t)},_setContentHeight:function(){var e=this;var t=e.content;var r=e.rowsHeader;var a=e.wrapper.innerHeight();var s=E.support.scrollbar();var n=t[0].offsetHeight===t[0].clientHeight;var i=e.options.height;if(e.wrapper.is(":visible")){if(!a||!i){if(n)s=0;t.height("auto");r.height(t.height()-s);return}a-=d(e.columnFields);a-=d(e.columnsHeader.parent());if(a<=s*2){a=s*2+1;if(!n)a+=s}t.height(a);if(n)s=0;r.height(a-s)}},_resetColspan:function(e){var t=this;var r=e.children("tbody").children().first().children().first();if(t._colspan===H)t._colspan=r.attr("colspan");r.attr("colspan",1);clearTimeout(t._layoutTimeout);t._layoutTimeout=setTimeout(function(){r.attr("colspan",t._colspan);t._colspan=H})},_axisMeasures:function(e){var t=[];var r=this.dataSource;var a=r.measures();var s=a.length>1||a[0]&&a[0].type;if(r.measuresAxis()===e)if(r[e]().length===0||s)t=a;return t},items:function(){return[]},refresh:function(){var t=this;var e=t.dataSource;var r=e.axes();var a=(r.columns||{}).tuples||[];var s=(r.rows||{}).tuples||[];var n=t._columnBuilder;var i=t._rowBuilder;var o={};var l={};if(t.trigger(z,{action:"rebind"}))return;n.measures=t._axisMeasures(re);i.measures=t._axisMeasures(te);t.columnsHeaderTree.render(n.build(a));t.rowsHeaderTree.render(i.build(s));o={indexes:n._indexes,measures:n.measures,metadata:n.metadata};l={indexes:i._indexes,measures:i.measures,metadata:i.metadata};t.contentTree.render(t._contentBuilder.build(e.view(),o,l));t._resize();if(t.touchScroller)t.touchScroller.contentResized();else{var u=E.touchScroller(t.content);if(u&&u.movable){t.touchScroller=u;u.movable.bind("change",function(e){E.scrollLeft(t.columnsHeader,-e.sender.x);t.rowsHeader.scrollTop(-e.sender.y)})}}t._progress(false);t.trigger(G)},_scrollable:function(){var e=this;var t=e.columnsHeader;var r=e.rowsHeader;e.content.on("scroll",function(){E.scrollLeft(t,this.scrollLeft);r.scrollTop(this.scrollTop)});r.on("DOMMouseScroll"+o+" mousewheel"+o,x.proxy(e._wheelScroll,e))},_wheelScroll:function(e){if(e.ctrlKey)return;var t=E.wheelDeltaY(e);var r=this.content.scrollTop();if(t){e.preventDefault();x(e.currentTarget).one("wheel"+o,false);this.rowsHeader.scrollTop(r+-t);this.content.scrollTop(r+-t)}}})),k=E.dom.element,gt=E.dom.html,_t=function(e,t){return{maxChildren:0,children:0,maxMembers:0,members:0,measures:1,levelNum:e,parentMember:t!==0}},xt=function(e,t){var r=[];var a=0;for(;a<=t;a++)r.push(e.members[a].name);return r},wt=function(e,t){var r="";var a=0;for(;a<=t;a++)r+=e.members[a].name;return r},bt=t.extend({init:function(e){this.template=E.template(e.template);this.hash=[]},setRowColumnInfo:function(e){this.data=e.data;this.columnHeaderLeafs=e.columnHeaderLeafs;this.rowHeaderLeafs=e.rowHeaderLeafs;this.columnHeaderBreadth=e.columnHeaderBreadth;this.rowHeaderDepth=e.rowHeaderDepth;this.hash.length=0},addColElements:function(e){var t="";for(var r=0;r<e;r++)t+="<col>";this.table.find("colgroup").append(t)},addRowElements:function(e){var t=this;var r=t.table.find("tbody");var a;for(var s=0;s<e.length;s++){a=x('<tr class="k-pivotgrid-row"></tr>');r.append(a);t.addColumCell(a,e[s],s)}this.rowsCount=e.length},addColumCell:function(e,t,r){var a=this;for(var s=0;s<t.cells.length;s++){var n=t.cells[s];if(n){var i=x('<td class="k-pivotgrid-cell"></td>');if(this.rowHeaderLeafs[r].total||this.columnHeaderLeafs[s].total)i.addClass("k-pivotgrid-header-total");i.append(a.template({dataItem:n.data,rowTuple:n.rowTuple,columnTuple:n.columnTuple}));this.hash.push(n);e.append(i)}}},build:function(){var e=T((this.data||[]).slice(),this.columnHeaderLeafs,this.rowHeaderLeafs,this.columnHeaderBreadth,this.rowHeaderDepth);var t=this;var r=x("<table class='k-pivotgrid-table'><colgroup></colgroup><tbody class='k-pivotgrid-tbody'></tbody></table>");t.table=r;t.addColElements(this.columnHeaderLeafs.length);t.addRowElements(e);this.rowsCount=e.length;this.columnsCount=this.columnHeaderLeafs.length;return t.table}}),St=t.extend({init:function(e){this.tuples=e.tuples;this.axes=e.axes;this.headerTemplate=E.template(V);if(e.template)this.template=E.template(e.template)},setTuples:function(e){this.tuples=e},addColElements:function(e){var t="";for(var r=0;r<e;r++)t+="<col>";this.table.find("colgroup").append(t)},addRowElements:function(e){var t=this;var r=t.table.find("tbody");var a;for(var s=0;s<e.length;s++){a=x('<tr class="k-pivotgrid-row"></tr>');r.append(a);t.addColumCell(a,e[s])}},addColumCell:function(e,t){var r=this;var a;var s;for(var n=0;n<t.cells.length;n++){s=t.cells[n];if(s){a=x(r.headerTemplate({rowspan:s.rowSpan,colspan:s.colSpan,key:s.path.join(",")+(s.total?"|[TOTAL]":""),iconClass:s.children&&s.children.length?"up":"down",expandable:s.hasChildren&&!s.total,headerClass:E.format("k-pivotgrid-cell{0}{1}",s.total?" k-pivotgrid-header-total":"",s.levelNum===0?" k-pivotgrid-header-root":"")}));a.append(r.template?r.template({member:s}):s.caption);e.append(a)}}},build:function(){var e=C((this.tuples||[]).slice());var t=this.axes=="columns"?N(e):y(e);var r=t[0];var a=t[1];var s=t[2];var n=t[3];var i=this;i._tree=e;i._breadth=s;i._headerLeafs=a;var o=x("<table class='k-pivotgrid-table'><colgroup></colgroup><tbody class='k-pivotgrid-tbody'></tbody></table>");i.table=o;i.addColElements(this.axes=="columns"?a.length:n);i.addRowElements(r);return i.table},getTree:function(){return this._tree},getBreadth:function(){return this._breadth},getHeaderLeafs:function(){return this._headerLeafs}}),Nt=t.extend({init:function(){this.measures=1;this.metadata={}},build:function(e){var t=this._tbody(e);var r=this._colGroup();return[k("table",null,[r,t])]},reset:function(){this.metadata={}},_colGroup:function(){var e=this._rowLength();var t=[];var r=0;for(;r<e;r++)t.push(k("col",null));return k("colgroup",null,t)},_tbody:function(e){var t=e[0];this.map={};this.rows=[];this.rootTuple=t;this._indexes=[];if(t){this._buildRows(t,0);this._normalize()}else this.rows.push(k("tr",null,[k("th",null,[gt("&nbsp;")])]));return k("tbody",null,this.rows)},_normalize:function(){var e=this.rows;var t=e.length;var r=0;var a;var s;var n;var i;var o;for(;r<t;r++){a=e[r];if(a.rowSpan===1)continue;i=a.children;n=0;s=i.length;for(;n<s;n++){o=i[n];if(o.tupleAll)o.attr.rowSpan=a.rowSpan}}},_rowIndex:function(e){var t=this.rows;var r=t.length;var a=0;for(;a<r;a++)if(t[a]===e)break;return a},_rowLength:function(){var e=this.rows[0]?this.rows[0].children:[];var t=e.length;var r=0;var a=0;if(t)for(;a<t;a++)r+=e[a].attr.colSpan||1;if(!r)r=this.measures;return r},_row:function(e,t,r){var a=this.rootTuple.members[t].name;var s=e.members[t].levelNum;var n=a+s;var i=this.map;var o;var l;var u=i[n];if(!u){u=k("tr",null,[]);u.parentMember=r;u.collapsed=0;u.colSpan=0;u.rowSpan=1;i[n]=u;o=i[a+(Number(s)-1)];if(o){l=o.children;if(l[1]&&l[1].attr.className.indexOf("k-alt")===-1)u.notFirst=true;else u.notFirst=o.notFirst}this.rows.splice(this._rowIndex(o)+1,0,u)}else{u.notFirst=false;if(!u.parentMember||u.parentMember!==r){u.parentMember=r;u.collapsed=0;u.colSpan=0}}return u},_measures:function(e,t,r){var a=this.map;var s=a.measureRow;var n;if(!s){s=k("tr",null,[]);a.measureRow=s;this.rows.push(s)}for(var i=0,o=e.length;i<o;i++){n=e[i];s.children.push(this._cell(r||"",[this._content(n,t)],n))}return o},_content:function(e,t){return gt(this.template({member:e,tuple:t}))},_cell:function(e,t,r){var a=k("th",{className:"k-header"+e},t);a.value=r.caption||r.name;return a},_buildRows:function(e,t,c){var h=e.members;var r=h[t];var a=h[t+1];var s,n,i,o;var d,p,m;var f=[];var v;var g=0;var l;var u;var _=0;var x=0;if(r.measure){this._measures(r.children,e);return}v=E.stringify(xt(e,t));s=this._row(e,t,c);i=r.children;o=i.length;l=this.metadata[v];if(!l){this.metadata[v]=l=_t(Number(r.levelNum),t);l.rootLevelNum=Number(this.rootTuple.members[t].levelNum)}this._indexes.push({path:v,tuple:e});if(r.hasChildren){if(l.expanded===false){_=l.maxChildren;s.collapsed+=_;l.children=0;o=0}m={className:"k-icon "+(o?K:Q)};m[E.attr("path")]=v;f.push(k("span",m))}f.push(this._content(r,e));d=this._cell(s.notFirst?" k-first":"",f,r);s.children.push(d);s.colSpan+=1;if(o){p=this._cell(" k-alt",[this._content(r,e)],r);s.children.push(p);for(;g<o;g++)n=this._buildRows(i[g],t,r);u=n.colSpan;_=n.collapsed;d.attr.colSpan=u;l.children=u;l.members=1;s.colSpan+=u;s.collapsed+=_;s.rowSpan=n.rowSpan+1;if(a){if(a.measure)u=this._measures(a.children,e," k-alt");else{n=this._buildRows(e,t+1);u=n.colSpan;s.collapsed+=n.collapsed;x=n.collapsed}p.attr.colSpan=u;u-=1;l.members+=u;s.colSpan+=u}}else if(a){if(a.measure)u=this._measures(a.children,e);else{n=this._buildRows(e,t+1);u=n.colSpan;s.collapsed+=n.collapsed;x=n.collapsed}l.members=u;if(u>1){d.attr.colSpan=u;s.colSpan+=u-1}}if(l.maxMembers<l.members+x)l.maxMembers=l.members+x;i=l.children+_;if(l.maxChildren<i)l.maxChildren=i;(p||d).tupleAll=true;return s}}),yt=t.extend({init:function(){this.metadata={}},build:function(e){var t=this._tbody(e);var r=this._colGroup();return[k("table",null,[r,t])]},reset:function(){this.metadata={}},_rowLength:function(){var e=this.rows[0].children;var t=0;var r=0;var a=e[r];while(a){t+=a.attr.colSpan||1;a=e[++r]}return t},_colGroup:function(){var e=this._rowLength();var t=[];var r=0;for(;r<e;r++)t.push(k("col",null));return k("colgroup",null,t)},_tbody:function(e){var t=e[0];this.rootTuple=t;this.rows=[];this.map={};this._indexes=[];if(t){this._buildRows(t,0);this._normalize()}else this.rows.push(k("tr",null,[k("td",null,[gt("&nbsp;")])]));return k("tbody",null,this.rows)},_normalize:function(){var e=this.rows;var c=e.length;var t=0;var r=this.rootTuple.members;var a=r[0].name;var h=r.length;var s=0;var n;var i;var o;var l=this.map;var u;for(;t<c;t++){n=e[t];for(s=0;s<h;s++){o=this[r[s].name];i=n.colSpan["dim"+s];if(i&&i.colSpan<o)i.attr.colSpan=o-i.colSpan+1}}n=l[a];u=l[a+"all"];if(n)n.children[0].attr.className="k-first";if(u)u.children[0].attr.className+=" k-first"},_row:function(e){var t=k("tr",null,e);t.rowSpan=1;t.colSpan={};this.rows.push(t);return t},_content:function(e,t){return gt(this.template({member:e,tuple:t}))},_cell:function(e,t,r){var a=k("td",{className:e},t);a.value=r.caption||r.name;return a},_buildRows:function(e,t){var c=this.map;var h;var d=e.members;var r=d[t];var p=d[t+1];var a=r.children;var s=a.length;var m=Number(r.levelNum);var f=this.rootTuple.members[t].name;var v=xt(e,t-1).join("");var g=Number(this.rootTuple.members[t].levelNum);var _=v+(g===m?"":r.parentName||"");var n=c[_+"all"]||c[_];var x=m+1;var i,o;var w,b;var l;var S;var N=[];var y;var u;if(!n||n.hasChild)n=this._row();else n.hasChild=true;if(r.measure){S=n.allCell?"k-grid-footer":"";n.children.push(this._cell(S,[this._content(a[0],e)],a[0]));n.rowSpan=s;for(u=1;u<s;u++)this._row([this._cell(S,[this._content(a[u],e)],a[u])]);return n}c[v+r.name]=n;h=E.stringify(xt(e,t));l=this.metadata[h];if(!l){this.metadata[h]=l=_t(m,t);l.rootLevelNum=g}this._indexes.push({path:h,tuple:e});if(r.hasChildren){if(l.expanded===false){s=0;l.children=0}y={className:"k-icon "+(s?K:Q)};y[E.attr("path")]=h;N.push(k("span",y))}N.push(this._content(r,e));S=n.allCell&&!s?"k-grid-footer":"";i=this._cell(S,N,r);i.colSpan=x;n.children.push(i);n.colSpan["dim"+t]=i;if(!this[f]||this[f]<x)this[f]=x;if(s){n.allCell=false;n.hasChild=false;for(u=0;u<s;u++){w=this._buildRows(a[u],t);if(n!==w)n.rowSpan+=w.rowSpan}if(n.rowSpan>1)i.attr.rowSpan=n.rowSpan;l.children=n.rowSpan;o=this._cell("k-grid-footer",[this._content(r,e)],r);o.colSpan=x;b=this._row([o]);b.colSpan["dim"+t]=o;b.allCell=true;c[v+r.name+"all"]=b;if(p){w=this._buildRows(e,t+1);o.attr.rowSpan=w.rowSpan}n.rowSpan+=b.rowSpan;l.members=b.rowSpan}else if(p){n.hasChild=false;this._buildRows(e,t+1);(o||i).attr.rowSpan=n.rowSpan;l.members=n.rowSpan}if(l.maxChildren<l.children)l.maxChildren=l.children;if(l.maxMembers<l.members)l.maxMembers=l.members;return n}}),Et=t.extend({init:function(){this.columnAxis={};this.rowAxis={}},build:function(e,t,r){var a=t.indexes[0];var s=t.metadata[a?a.path:H];this.columnAxis=t;this.rowAxis=r;this.data=e;this.rowLength=s?s.maxChildren+s.maxMembers:t.measures.length||1;if(!this.rowLength)this.rowLength=1;var n=this._tbody();var i=this._colGroup();return[k("table",null,[i,n])]},_colGroup:function(){var e=this.columnAxis.measures.length||1;var t=[];var r=0;if(this.rows[0])e=this.rows[0].children.length;for(;r<e;r++)t.push(k("col",null));return k("colgroup",null,t)},_tbody:function(){this.rows=[];if(this.data[0]){this.columnIndexes=this._indexes(this.columnAxis,this.rowLength);this.rowIndexes=this._indexes(this.rowAxis,Math.ceil(this.data.length/this.rowLength));this._buildRows()}else this.rows.push(k("tr",null,[k("td",null,[gt("&nbsp;")])]));return k("tbody",null,this.rows)},_indexes:function(e,c){var t=[];var r;var h=e.indexes;var d=e.metadata;var a=e.measures;var s=a.length||1;var n;var i=0;var o=0;var p=0;var m=h.length;var l;var f;var u;var v;if(!m){for(l=0;l<s;l++)t[l]={index:l,measure:a[l],tuple:null};return t}for(;p<m;p++){r=h[p];n=d[r.path];u=n.children+n.members;v=0;if(u)u-=s;if(n.expanded===false&&n.children!==n.maxChildren)v=n.maxChildren;if(n.parentMember&&n.levelNum===n.rootLevelNum)u=-1;if(u>-1){for(l=0;l<s;l++){f=u+l;if(!n.children)f+=o;t[u+o+l]={children:u,index:i,measure:a[l],tuple:r.tuple};i+=1}while(t[o]!==H)o+=1}if(o===c)break;i+=v}return t},_buildRows:function(){var e=this.rowIndexes;var t=e.length;var r=0;for(;r<t;r++){var a=e[r];if(a)this.rows.push(this._buildRow(a))}},_buildRow:function(e){var c=e.index*this.rowLength;var t=this.columnIndexes;var h=t.length;var r;var d=[];var a=0;var s;var n,i;var o,l,u;for(;a<h;a++){r=t[a];if(r===H)continue;o={};if(r.children)o.className="k-alt";i="";l=this.data[c+r.index];u=r.measure||e.measure;s={columnTuple:r.tuple,rowTuple:e.tuple,measure:u,dataItem:l};if(l.value!==""&&u&&u.type)if(u.type==="status")i=this.kpiStatusTemplate(s);else if(u.type==="trend")i=this.kpiTrendTemplate(s);if(!i)i=this.dataTemplate(s);n=k("td",o,[gt(i)]);n.value=l.value;d.push(n)}o={};if(e.children)o.className="k-grid-footer";return k("tr",o,d)}}),kt=(l.plugin(vt),E.PivotExcelExporter=E.Class.extend({init:function(e){this.options=e;this.widget=e.widget;this.dataSource=this.widget.dataSource},_columns:function(){var e=this.widget.columnsHeaderTree.children[0];var t=this.widget.rowsHeaderTree.children[0];var r=e.children[0].children.length;var a=t.children[0].children.length;var s=this.widget.options.columnWidth;var n=[];var i;if(a&&this.dataSource.data()[0])for(i=0;i<a;i++)n.push({autoWidth:true});for(i=0;i<r;i++)n.push({autoWidth:false,width:s});return n},_cells:function(e,t,r){var a=[];var s=0;var c=e.length;var n;var i,o;var l,u;for(;s<c;s++){i=[];o=e[s].children;n=o.length;for(l=0;l<n;l++){u=o[l];i.push({background:"#7a7a7a",color:"#fff",value:u.value,colSpan:u.attr.colSpan||1,rowSpan:u.attr.rowSpan||1})}if(r)r(i,s);a.push({cells:i,type:t})}return a},_rows:function(){var e=this.widget.columnsHeaderTree.children[0];var t=this.widget.rowsHeaderTree.children[0];var i=e.children[0].children.length;var r=t.children[0].children.length;var a=e.children[1].children;var s=t.children[1].children;var o=this.widget.contentTree.children[0].children[1].children;var n=this._cells(a,"header");if(r)n[0].cells.splice(0,0,{background:"#7a7a7a",color:"#fff",value:"",colSpan:r,rowSpan:a.length});var l=function(e,t){var r=0;var a,s;var n=o[t].children;for(;r<i;r++){a=n[r];s=Number(a.value);if(isNaN(s))s=a.value;e.push({background:"#dfdfdf",color:"#333",value:s,colSpan:1,rowSpan:1})}};var u=this._cells(s,"data",l);return n.concat(u)},_freezePane:function(){var e=this.widget.columnsHeaderTree.children[0];var t=this.widget.rowsHeaderTree.children[0];var r=t.children[0].children.length;var a=e.children[1].children;return{colSplit:r,rowSplit:a.length}},workbook:function(){var e;if(this.dataSource.view()[0]){e=x.Deferred();e.resolve()}else e=this.dataSource.fetch();return e.then(x.proxy(function(){return{sheets:[{columns:this._columns(),rows:this._rows(),freezePane:this._freezePane(),filter:null}]}},this))}}),{extend:function(e){e.events.push("excelExport");e.options.excel=x.extend(e.options.excel,this.options);e.saveAsExcel=this.saveAsExcel},options:{proxyURL:"",filterable:false,fileName:"Export.xlsx"},saveAsExcel:function(){var r=this.options.excel||{};var e=new E.PivotExcelExporter({widget:this});e.workbook().then(x.proxy(function(t){if(!this.trigger("excelExport",{workbook:t})){var e=new E.ooxml.Workbook(t);e.toDataURLAsync().then(function(e){E.saveAs({dataURI:e,fileName:t.fileName||r.fileName,proxyURL:r.proxyURL,forceProxy:r.forceProxy})})}},this))}});if(E.PivotExcelMixin=kt,E.ooxml&&E.ooxml.Workbook)kt.extend(vt.prototype);if(E.PDFMixin){E.PDFMixin.extend(vt.prototype);vt.fn._drawPDF=function(){return this._drawPDFShadow({width:this.wrapper.width()},{avoidLinks:this.options.pdf.avoidLinks})}}if(E.PDFMixin){E.PDFMixin.extend(ft.prototype);ft.fn._drawPDF=function(){return this._drawPDFShadow({width:this.wrapper.width()},{avoidLinks:this.options.pdf.avoidLinks})}}return window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()});
//# sourceMappingURL=kendo.pivotgrid.min.js.map
