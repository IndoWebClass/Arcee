{"version":3,"file":"kendo.popup.min.js","sources":["kendo.popup.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.popup',[ \"./kendo.core\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"popup\",\n    name: \"Pop-up\",\n    category: \"framework\",\n    depends: [ \"core\" ],\n    advanced: true\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        Widget = ui.Widget,\n        Class = kendo.Class,\n        support = kendo.support,\n        getOffset = kendo.getOffset,\n        outerWidth = kendo._outerWidth,\n        outerHeight = kendo._outerHeight,\n        OPEN = \"open\",\n        CLOSE = \"close\",\n        DEACTIVATE = \"deactivate\",\n        ACTIVATE = \"activate\",\n        CENTER = \"center\",\n        LEFT = \"left\",\n        RIGHT = \"right\",\n        TOP = \"top\",\n        BOTTOM = \"bottom\",\n        ABSOLUTE = \"absolute\",\n        HIDDEN = \"hidden\",\n        BODY = \"body\",\n        LOCATION = \"location\",\n        POSITION = \"position\",\n        VISIBLE = \"visible\",\n        EFFECTS = \"effects\",\n        ACTIVE = \"k-state-active\",\n        ACTIVEBORDER = \"k-state-border\",\n        ACTIVEBORDERREGEXP = /k-state-border-(\\w+)/,\n        ACTIVECHILDREN = \".k-picker-wrap, .k-dropdown-wrap, .k-link\",\n        MOUSEDOWN = \"down\",\n        DOCUMENT_ELEMENT = $(document.documentElement),\n        proxy = $.proxy,\n        WINDOW = $(window),\n        SCROLL = \"scroll\",\n        cssPrefix = support.transitions.css,\n        TRANSFORM = cssPrefix + \"transform\",\n        extend = $.extend,\n        NS = \".kendoPopup\",\n        styles = [\"font-size\",\n                  \"font-family\",\n                  \"font-stretch\",\n                  \"font-style\",\n                  \"font-weight\",\n                  \"line-height\"];\n\n    function contains(container, target) {\n        if (!container || !target) {\n            return false;\n        }\n        return container === target || $.contains(container, target);\n    }\n\n    var Popup = Widget.extend({\n        init: function(element, options) {\n            var that = this, parentPopup;\n\n            options = options || {};\n\n            if (options.isRtl) {\n                options.origin = options.origin || BOTTOM + \" \" + RIGHT;\n                options.position = options.position || TOP + \" \" + RIGHT;\n            }\n\n            Widget.fn.init.call(that, element, options);\n\n            element = that.element;\n            options = that.options;\n\n            that.collisions = options.collision ? options.collision.split(\" \") : [];\n            that.downEvent = kendo.applyEventMap(MOUSEDOWN, kendo.guid());\n\n            if (that.collisions.length === 1) {\n                that.collisions.push(that.collisions[0]);\n            }\n\n            parentPopup = $(that.options.anchor).closest(\".k-popup,.k-group\").filter(\":not([class^=km-])\"); // When popup is in another popup, make it relative.\n\n            options.appendTo = $($(options.appendTo)[0] || parentPopup[0] || document.body);\n\n            that.element.hide()\n                .addClass(\"k-popup k-group k-reset\")\n                .toggleClass(\"k-rtl\", !!options.isRtl)\n                .css({ position : ABSOLUTE })\n                .appendTo(options.appendTo)\n                .attr(\"aria-hidden\", true)\n                .on(\"mouseenter\" + NS, function() {\n                    that._hovered = true;\n                })\n                .on(\"wheel\" + NS, function(e) {\n                    var list = $(e.target).find(\".k-list\");\n                    var scrollArea = list.parent();\n                    if (list.length && list.is(\":visible\") && ((scrollArea.scrollTop() === 0 && e.originalEvent.deltaY < 0) ||\n                        (scrollArea.scrollTop() === scrollArea.prop('scrollHeight') - scrollArea.prop('offsetHeight') && e.originalEvent.deltaY > 0))) {\n                           e.preventDefault();\n                    }\n                })\n                .on(\"mouseleave\" + NS, function() {\n                    that._hovered = false;\n                });\n\n            that.wrapper = $();\n\n            if (options.animation === false) {\n                options.animation = { open: { effects: {} }, close: { hide: true, effects: {} } };\n            }\n\n            extend(options.animation.open, {\n                complete: function() {\n                    that.wrapper.css({ overflow: VISIBLE }); // Forcing refresh causes flickering in mobile.\n                    that._activated = true;\n                    that._trigger(ACTIVATE);\n                }\n            });\n\n            extend(options.animation.close, {\n                complete: function() {\n                    that._animationClose();\n                }\n            });\n\n            that._mousedownProxy = function(e) {\n                that._mousedown(e);\n            };\n\n            if (support.mobileOS.android) {\n                that._resizeProxy = function(e) {\n                    setTimeout(function() {\n                        that._resize(e);\n                    }, 600); //Logic from kendo.onResize\n                };\n            } else {\n                that._resizeProxy = function(e) {\n                    that._resize(e);\n                };\n            }\n\n            if (options.toggleTarget) {\n                $(options.toggleTarget).on(options.toggleEvent + NS, $.proxy(that.toggle, that));\n            }\n        },\n\n        events: [\n            OPEN,\n            ACTIVATE,\n            CLOSE,\n            DEACTIVATE\n        ],\n\n        options: {\n            name: \"Popup\",\n            toggleEvent: \"click\",\n            origin: BOTTOM + \" \" + LEFT,\n            position: TOP + \" \" + LEFT,\n            anchor: BODY,\n            appendTo: null,\n            collision: \"flip fit\",\n            viewport: window,\n            copyAnchorStyles: true,\n            autosize: false,\n            modal: false,\n            adjustSize: {\n                width: 0,\n                height: 0\n            },\n            animation: {\n                open: {\n                    effects: \"slideIn:down\",\n                    transition: true,\n                    duration: 200\n                },\n                close: { // if close animation effects are defined, they will be used instead of open.reverse\n                    duration: 100,\n                    hide: true\n                }\n            },\n            omitOriginOffsets: false\n        },\n\n        _animationClose: function() {\n            var that = this;\n            var location = that.wrapper.data(LOCATION);\n\n            that.wrapper.hide();\n\n            if (location) {\n                that.wrapper.css(location);\n            }\n\n            if (that.options.anchor != BODY) {\n                that._hideDirClass();\n            }\n\n            that._closing = false;\n            that._trigger(DEACTIVATE);\n        },\n\n        destroy: function() {\n            var that = this,\n                options = that.options,\n                element = that.element.off(NS),\n                parent;\n\n            Widget.fn.destroy.call(that);\n\n            if (options.toggleTarget) {\n                $(options.toggleTarget).off(NS);\n            }\n\n            if (!options.modal) {\n                DOCUMENT_ELEMENT.off(that.downEvent, that._mousedownProxy);\n                that._toggleResize(false);\n            }\n\n            kendo.destroy(that.element.children());\n            element.removeData();\n\n            if (options.appendTo[0] === document.body) {\n                parent = element.parent(\".k-animation-container\");\n\n                if (parent[0]) {\n                    parent.remove();\n                } else {\n                    element.remove();\n                }\n            }\n        },\n\n        open: function(x, y) {\n            var that = this,\n                fixed = { isFixed: !isNaN(parseInt(y,10)), x: x, y: y },\n                element = that.element,\n                options = that.options,\n                animation, wrapper,\n                anchor = $(options.anchor),\n                mobile = element[0] && element.hasClass(\"km-widget\");\n\n            if (!that.visible()) {\n                if (options.copyAnchorStyles) {\n                    if (mobile && styles[0] == \"font-size\") {\n                        styles.shift();\n                    }\n                    element.css(kendo.getComputedStyles(anchor[0], styles));\n                }\n\n                if (element.data(\"animating\") || that._trigger(OPEN)) {\n                    return;\n                }\n\n                that._activated = false;\n\n                if (!options.modal) {\n                    DOCUMENT_ELEMENT.off(that.downEvent, that._mousedownProxy)\n                                .on(that.downEvent, that._mousedownProxy);\n\n                    // this binding hangs iOS in editor\n                    // all elements in IE7/8 fire resize event, causing mayhem\n                    that._toggleResize(false);\n                    that._toggleResize(true);\n                }\n\n                that.wrapper = wrapper = kendo.wrap(element, options.autosize)\n                                        .css({\n                                            overflow: HIDDEN,\n                                            display: \"block\",\n                                            position: ABSOLUTE\n                                        })\n                                        .attr(\"aria-hidden\", false);\n\n                if (support.mobileOS.android) {\n                    wrapper.css(TRANSFORM, \"translatez(0)\"); // Android is VERY slow otherwise. Should be tested in other droids as well since it may cause blur.\n                }\n\n                wrapper.css(POSITION);\n\n                if ($(options.appendTo)[0] == document.body) {\n                    wrapper.css(TOP, \"-10000px\");\n                }\n\n                that.flipped = that._position(fixed);\n                animation = that._openAnimation();\n\n                if (options.anchor != BODY) {\n                    that._showDirClass(animation);\n                }\n\n                if (!element.is(\":visible\") && element.data(\"olddisplay\") === undefined) {\n                    element.show();\n                    element.data(\"olddisplay\", element.css(\"display\"));\n                    element.hide();\n                }\n\n                element.data(EFFECTS, animation.effects)\n                       .kendoStop(true)\n                       .kendoAnimate(animation)\n                       .attr(\"aria-hidden\", false);\n            }\n        },\n\n        _location: function(isFixed) {\n            var that = this,\n                element = that.element,\n                options = that.options,\n                wrapper,\n                anchor = $(options.anchor),\n                mobile = element[0] && element.hasClass(\"km-widget\");\n\n            if (options.copyAnchorStyles) {\n                if (mobile && styles[0] == \"font-size\") {\n                    styles.shift();\n                }\n                element.css(kendo.getComputedStyles(anchor[0], styles));\n            }\n\n            that.wrapper = wrapper = kendo.wrap(element, options.autosize)\n                                    .css({\n                                        overflow: HIDDEN,\n                                        display: \"block\",\n                                        position: ABSOLUTE\n                                    });\n\n            if (support.mobileOS.android) {\n                wrapper.css(TRANSFORM, \"translatez(0)\"); // Android is VERY slow otherwise. Should be tested in other droids as well since it may cause blur.\n            }\n\n            wrapper.css(POSITION);\n\n            if ($(options.appendTo)[0] == document.body) {\n                wrapper.css(TOP, \"-10000px\");\n            }\n\n            that._position(isFixed || {});\n\n            var offset = wrapper.offset();\n            return {\n                width: kendo._outerWidth(wrapper),\n                height: kendo._outerHeight(wrapper),\n                left: offset.left,\n                top: offset.top\n            };\n        },\n\n        _openAnimation: function() {\n            var animation = extend(true, {}, this.options.animation.open);\n            animation.effects = kendo.parseEffects(animation.effects, this.flipped);\n\n            return animation;\n        },\n\n        _hideDirClass: function() {\n            var anchor = $(this.options.anchor);\n            var direction = ((anchor.attr(\"class\") || \"\").match(ACTIVEBORDERREGEXP) || [\"\", \"down\"])[1];\n            var dirClass = ACTIVEBORDER + \"-\" + direction;\n\n            anchor\n                .removeClass(dirClass)\n                .children(ACTIVECHILDREN)\n                .removeClass(ACTIVE)\n                .removeClass(dirClass);\n\n            this.element.removeClass(ACTIVEBORDER + \"-\" + kendo.directions[direction].reverse);\n        },\n\n        _showDirClass: function(animation) {\n            var direction = animation.effects.slideIn ? animation.effects.slideIn.direction : \"down\";\n            var dirClass = ACTIVEBORDER + \"-\" + direction;\n\n            $(this.options.anchor)\n                .addClass(dirClass)\n                .children(ACTIVECHILDREN)\n                .addClass(ACTIVE)\n                .addClass(dirClass);\n\n            this.element.addClass(ACTIVEBORDER + \"-\" + kendo.directions[direction].reverse);\n        },\n\n        position: function() {\n            if (this.visible()) {\n                this.flipped = this._position();\n                //this._hideDirClass();\n                //this._showDirClass(this._openAnimation());\n            }\n        },\n\n        toggle: function() {\n            var that = this;\n\n            that[that.visible() ? CLOSE : OPEN]();\n        },\n\n        visible: function() {\n            return this.element.is(\":\" + VISIBLE);\n        },\n\n        close: function(skipEffects) {\n            var that = this,\n                options = that.options, wrap,\n                animation, openEffects, closeEffects;\n\n            if (that.visible()) {\n                wrap = (that.wrapper[0] ? that.wrapper : kendo.wrap(that.element).hide());\n\n                that._toggleResize(false);\n\n                if (that._closing || that._trigger(CLOSE)) {\n                    that._toggleResize(true);\n                    return;\n                }\n\n                // Close all inclusive popups.\n                that.element.find(\".k-popup\").each(function () {\n                    var that = $(this),\n                        popup = that.data(\"kendoPopup\");\n\n                    if (popup) {\n                        popup.close(skipEffects);\n                    }\n                });\n\n                DOCUMENT_ELEMENT.off(that.downEvent, that._mousedownProxy);\n\n                if (skipEffects) {\n                    animation = { hide: true, effects: {} };\n                } else {\n                    animation = extend(true, {}, options.animation.close);\n                    openEffects = that.element.data(EFFECTS);\n                    closeEffects = animation.effects;\n\n                    if (!closeEffects && !kendo.size(closeEffects) && openEffects && kendo.size(openEffects)) {\n                        animation.effects = openEffects;\n                        animation.reverse = true;\n                    }\n\n                    that._closing = true;\n                }\n\n                that.element\n                        .kendoStop(true)\n                        .attr(\"aria-hidden\", true);\n                wrap\n                    .css({ overflow: HIDDEN }) // stop callback will remove hidden overflow\n                    .attr(\"aria-hidden\", true);\n                that.element.kendoAnimate(animation);\n\n                if (skipEffects) {\n                    that._animationClose();\n                }\n            }\n        },\n\n        _trigger: function(ev) {\n            return this.trigger(ev, { type: ev });\n        },\n\n        _resize: function(e) {\n            var that = this;\n\n            if (support.resize.indexOf(e.type) !== -1) {\n                clearTimeout(that._resizeTimeout);\n                that._resizeTimeout = setTimeout(function() {\n                    that._position();\n                    that._resizeTimeout = null;\n                }, 50);\n            } else {\n                if (!that._hovered || (that._activated && that.element.find(\".k-list\").length > 0)) {\n                    that.close();\n                }\n            }\n        },\n\n        _toggleResize: function(toggle) {\n            var method = toggle ? \"on\" : \"off\";\n            var eventNames = support.resize;\n\n            if (!(support.mobileOS.ios || support.mobileOS.android || support.browser.safari)) {\n                eventNames += \" \" + SCROLL;\n            }\n\n            if (toggle && !this.scrollableParents) {\n                this.scrollableParents = this._scrollableParents();\n            }\n\n            if (this.scrollableParents && this.scrollableParents.length) {\n                this.scrollableParents[method](SCROLL, this._resizeProxy);\n            }\n\n            WINDOW[method](eventNames, this._resizeProxy);\n        },\n\n        _mousedown: function(e) {\n            var that = this,\n                container = that.element[0],\n                options = that.options,\n                anchor = $(options.anchor)[0],\n                toggleTarget = options.toggleTarget,\n                target = kendo.eventTarget(e),\n                popup = $(target).closest(\".k-popup\"),\n                mobile = popup.parent().parent(\".km-shim\").length;\n\n            popup = popup[0];\n            if (!mobile && popup && popup !== that.element[0]){\n                return;\n            }\n\n            // This MAY result in popup not closing in certain cases.\n            if ($(e.target).closest(\"a\").data(\"rel\") === \"popover\") {\n                return;\n            }\n\n            if (!contains(container, target) && !contains(anchor, target) && !(toggleTarget && contains($(toggleTarget)[0], target))) {\n                that.close();\n            }\n        },\n\n        _fit: function(position, size, viewPortSize) {\n            var output = 0;\n\n            if (position + size > viewPortSize) {\n                output = viewPortSize - (position + size);\n            }\n\n            if (position < 0) {\n                output = -position;\n            }\n\n            return output;\n        },\n\n        _flip: function(offset, size, anchorSize, viewPortSize, origin, position, boxSize) {\n            var output = 0;\n                boxSize = boxSize || size;\n\n            if (position !== origin && position !== CENTER && origin !== CENTER) {\n                if (offset + boxSize > viewPortSize) {\n                    output += -(anchorSize + size);\n                }\n\n                if (offset + output < 0) {\n                    output += anchorSize + size;\n                }\n            }\n            return output;\n        },\n\n        _scrollableParents: function() {\n            return $(this.options.anchor)\n                       .parentsUntil(\"body\")\n                       .filter(function(index, element) {\n                           return kendo.isScrollable(element);\n                       });\n        },\n\n        _position: function(fixed) {\n            var that = this,\n                //element = that.element.css(POSITION, \"\"), /* fixes telerik/kendo-ui-core#790, comes from telerik/kendo#615 */\n                element = that.element,\n                wrapper = that.wrapper,\n                options = that.options,\n                viewport = $(options.viewport),\n                zoomLevel = support.zoomLevel(),\n                isWindow = !!((viewport[0] == window) && window.innerWidth && (zoomLevel <= 1.02)),\n                anchor = $(options.anchor),\n                origins = options.origin.toLowerCase().split(\" \"),\n                positions = options.position.toLowerCase().split(\" \"),\n                collisions = that.collisions,\n                siblingContainer, parents,\n                parentZIndex, zIndex = 10002,\n                idx = 0,\n                docEl = document.documentElement,\n                length, viewportOffset, viewportWidth, viewportHeight;\n\n            if (options.viewport === window) {\n                viewportOffset = {\n                    top: (window.pageYOffset || document.documentElement.scrollTop || 0),\n                    left: (window.pageXOffset || document.documentElement.scrollLeft || 0)\n                };\n            } else {\n                viewportOffset = viewport.offset();\n            }\n\n            if (isWindow) {\n                viewportWidth = window.innerWidth;\n                viewportHeight = window.innerHeight;\n            } else {\n                viewportWidth = viewport.width();\n                viewportHeight = viewport.height();\n            }\n\n            if (isWindow && docEl.scrollHeight - docEl.clientHeight > 0) {\n                 var sign = options.isRtl ? -1 : 1;\n\n                 viewportWidth -= sign * kendo.support.scrollbar();\n            }\n\n            siblingContainer = anchor.parents().filter(wrapper.siblings());\n\n            if (siblingContainer[0]) {\n                parentZIndex = Math.max(Number(siblingContainer.css(\"zIndex\")), 0);\n\n                // set z-index to be more than that of the container/sibling\n                // compensate with more units for window z-stack\n                if (parentZIndex) {\n                    zIndex = parentZIndex + 10;\n                } else {\n                    parents = anchor.parentsUntil(siblingContainer);\n                    for (length = parents.length; idx < length; idx++) {\n                        parentZIndex = Number($(parents[idx]).css(\"zIndex\"));\n                        if (parentZIndex && zIndex < parentZIndex) {\n                            zIndex = parentZIndex + 10;\n                        }\n                    }\n                }\n            }\n\n            wrapper.css(\"zIndex\", zIndex);\n\n            if (fixed && fixed.isFixed) {\n                wrapper.css({ left: fixed.x, top: fixed.y });\n            } else {\n                wrapper.css(that._align(origins, positions));\n            }\n\n            var pos = getOffset(wrapper, POSITION, anchor[0] === wrapper.offsetParent()[0]),\n                offset = getOffset(wrapper),\n                anchorParent = anchor.offsetParent().parent(\".k-animation-container,.k-popup,.k-group\"); // If the parent is positioned, get the current positions\n\n            if (anchorParent.length) {\n                pos = getOffset(wrapper, POSITION, true);\n                offset = getOffset(wrapper);\n            }\n\n            offset.top -= viewportOffset.top;\n            offset.left -= viewportOffset.left;\n\n            if (!that.wrapper.data(LOCATION)) { // Needed to reset the popup location after every closure - fixes the resize bugs.\n                wrapper.data(LOCATION, extend({}, pos));\n            }\n\n            var offsets = extend({}, offset),\n                location = extend({}, pos),\n                adjustSize = options.adjustSize;\n\n            if (collisions[0] === \"fit\") {\n                location.top += that._fit(offsets.top, outerHeight(wrapper) + adjustSize.height, viewportHeight / zoomLevel);\n            }\n\n            if (collisions[1] === \"fit\") {\n                location.left += that._fit(offsets.left, outerWidth(wrapper) + adjustSize.width, viewportWidth / zoomLevel);\n            }\n\n            var flipPos = extend({}, location);\n            var elementHeight = outerHeight(element);\n            var wrapperHeight =  outerHeight(wrapper);\n\n            if (!wrapper.height() && elementHeight) {\n                wrapperHeight = wrapperHeight + elementHeight;\n            }\n\n            if (collisions[0] === \"flip\") {\n                location.top += that._flip(offsets.top, elementHeight, outerHeight(anchor), viewportHeight / zoomLevel, origins[0], positions[0], wrapperHeight);\n            }\n\n            if (collisions[1] === \"flip\") {\n                location.left += that._flip(offsets.left, outerWidth(element), outerWidth(anchor), viewportWidth / zoomLevel, origins[1], positions[1], outerWidth(wrapper));\n            }\n\n            element.css(POSITION, ABSOLUTE);\n            wrapper.css(location);\n\n            return (location.left != flipPos.left || location.top != flipPos.top);\n        },\n\n        _align: function(origin, position) {\n            var that = this,\n                element = that.wrapper,\n                anchor = $(that.options.anchor),\n                verticalOrigin = origin[0],\n                horizontalOrigin = origin[1],\n                verticalPosition = position[0],\n                horizontalPosition = position[1],\n                anchorOffset = getOffset(anchor),\n                appendTo = $(that.options.appendTo),\n                appendToOffset,\n                width = outerWidth(element),\n                height = outerHeight(element) || outerHeight(element.children().first()),\n                anchorWidth = outerWidth(anchor),\n                anchorHeight = outerHeight(anchor),\n                top = that.options.omitOriginOffsets ? 0 : anchorOffset.top,\n                left = that.options.omitOriginOffsets ? 0 : anchorOffset.left,\n                round = Math.round;\n\n            if (appendTo[0] != document.body) {\n                appendToOffset = getOffset(appendTo);\n                top -= appendToOffset.top;\n                left -= appendToOffset.left;\n            }\n\n\n            if (verticalOrigin === BOTTOM) {\n                top += anchorHeight;\n            }\n\n            if (verticalOrigin === CENTER) {\n                top += round(anchorHeight / 2);\n            }\n\n            if (verticalPosition === BOTTOM) {\n                top -= height;\n            }\n\n            if (verticalPosition === CENTER) {\n                top -= round(height / 2);\n            }\n\n            if (horizontalOrigin === RIGHT) {\n                left += anchorWidth;\n            }\n\n            if (horizontalOrigin === CENTER) {\n                left += round(anchorWidth / 2);\n            }\n\n            if (horizontalPosition === RIGHT) {\n                left -= width;\n            }\n\n            if (horizontalPosition === CENTER) {\n                left -= round(width / 2);\n            }\n\n            return {\n                top: top,\n                left: left\n            };\n        }\n    });\n\n    ui.plugin(Popup);\n\n    var stableSort = kendo.support.stableSort;\n    var tabKeyTrapNS = \"kendoTabKeyTrap\";\n    var focusableNodesSelector = \"a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex], *[contenteditable]\";\n    var TabKeyTrap = Class.extend({\n        init: function(element) {\n            this.element = $(element);\n            this.element.autoApplyNS(tabKeyTrapNS);\n        },\n\n        trap: function() {\n            this.element.on(\"keydown\", proxy(this._keepInTrap, this));\n        },\n\n        removeTrap: function() {\n            this.element.kendoDestroy(tabKeyTrapNS);\n        },\n\n        destroy: function() {\n            this.element.kendoDestroy(tabKeyTrapNS);\n            this.element = undefined;\n        },\n\n        shouldTrap: function () {\n            return true;\n        },\n\n        _keepInTrap: function(e) {\n            if (e.which !== 9 || !this.shouldTrap() || e.isDefaultPrevented()) {\n                return;\n            }\n\n            var elements = this._focusableElements();\n            var sortedElements = this._sortFocusableElements(elements);\n            var next = this._nextFocusable(e, sortedElements);\n\n            this._focus(next);\n\n            e.preventDefault();\n        },\n        _focusableElements: function(){\n            var elements = this.element.find(focusableNodesSelector).filter(function(i, item){\n                return item.tabIndex >= 0 && $(item).is(':visible') && !$(item).is('[disabled]');\n            });\n\n            if (this.element.is(\"[tabindex]\")) {\n                elements.push(this.element[0]);\n            }\n\n            return elements;\n        },\n        _sortFocusableElements: function(elements){\n            var sortedElements;\n\n            if (stableSort) {\n                sortedElements = elements.sort(function(prev, next) {\n                    return prev.tabIndex - next.tabIndex;\n                });\n            } else {\n                var attrName = \"__k_index\";\n                elements.each(function(i, item){\n                    item.setAttribute(attrName, i);\n                });\n\n                sortedElements = elements.sort(function(prev, next) {\n                    return prev.tabIndex === next.tabIndex ?\n                        parseInt(prev.getAttribute(attrName), 10) - parseInt(next.getAttribute(attrName), 10) :\n                        prev.tabIndex - next.tabIndex;\n                });\n\n                elements.removeAttr(attrName);\n            }\n\n            return sortedElements;\n        },\n        _nextFocusable: function(e, elements){\n            var count = elements.length;\n            var current = elements.index(e.target);\n\n            return elements.get((current + (e.shiftKey ? -1 : 1)) % count);\n        },\n        _focus: function(element){\n            if (element.nodeName == \"IFRAME\") {\n                element.contentWindow.document.body.focus();\n                return;\n            }\n\n            element.focus();\n\n            if (element.nodeName == \"INPUT\" && element.setSelectionRange && this._haveSelectionRange(element)) {\n                element.setSelectionRange(0, element.value.length);\n            }\n        },\n        _haveSelectionRange: function(element){\n            var elementType = element.type.toLowerCase();\n\n            return elementType === \"text\" || elementType === \"search\" ||\n            elementType === \"url\" || elementType === \"tel\" ||\n            elementType === \"password\";\n        }\n    });\n    ui.Popup.TabKeyTrap = TabKeyTrap;\n})(window.kendo.jQuery);\n\n\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","depends","advanced","$","window","kendo","jQuery","undefined","ui","Widget","Class","support","getOffset","outerWidth","_outerWidth","outerHeight","_outerHeight","OPEN","CLOSE","DEACTIVATE","ACTIVATE","CENTER","LEFT","RIGHT","TOP","BOTTOM","ABSOLUTE","HIDDEN","BODY","LOCATION","POSITION","VISIBLE","EFFECTS","ACTIVE","ACTIVEBORDER","ACTIVEBORDERREGEXP","ACTIVECHILDREN","MOUSEDOWN","DOCUMENT_ELEMENT","document","documentElement","proxy","WINDOW","SCROLL","cssPrefix","TRANSFORM","transitions","css","extend","NS","styles","contains","container","target","Popup","init","element","options","that","this","parentPopup","isRtl","origin","position","fn","call","collisions","collision","split","downEvent","applyEventMap","guid","length","push","anchor","closest","filter","appendTo","body","hide","addClass","toggleClass","attr","on","_hovered","e","list","find","scrollArea","parent","is","scrollTop","originalEvent","deltaY","prop","preventDefault","wrapper","animation","open","effects","close","complete","overflow","_activated","_trigger","_animationClose","_mousedownProxy","_mousedown","mobileOS","android","_resizeProxy","setTimeout","_resize","toggleTarget","toggleEvent","toggle","events","viewport","copyAnchorStyles","autosize","modal","adjustSize","width","height","transition","duration","omitOriginOffsets","location","data","_hideDirClass","_closing","destroy","off","_toggleResize","children","removeData","remove","x","y","fixed","isFixed","isNaN","parseInt","mobile","hasClass","visible","shift","getComputedStyles","wrap","display","flipped","_position","_openAnimation","_showDirClass","show","kendoStop","kendoAnimate","_location","offset","left","top","parseEffects","direction","match","dirClass","removeClass","directions","reverse","slideIn","skipEffects","openEffects","closeEffects","each","popup","size","ev","trigger","type","resize","indexOf","clearTimeout","_resizeTimeout","method","eventNames","ios","browser","safari","scrollableParents","_scrollableParents","eventTarget","_fit","viewPortSize","output","_flip","anchorSize","boxSize","parentsUntil","index","isScrollable","zoomLevel","isWindow","innerWidth","origins","toLowerCase","positions","siblingContainer","parents","parentZIndex","zIndex","idx","docEl","viewportOffset","viewportWidth","viewportHeight","pageYOffset","pageXOffset","scrollLeft","innerHeight","scrollHeight","clientHeight","sign","scrollbar","siblings","Math","max","Number","_align","pos","offsetParent","anchorParent","offsets","flipPos","elementHeight","wrapperHeight","verticalOrigin","horizontalOrigin","verticalPosition","horizontalPosition","anchorOffset","appendToOffset","first","anchorWidth","anchorHeight","round","stableSort","plugin","tabKeyTrapNS","focusableNodesSelector","TabKeyTrap","autoApplyNS","trap","_keepInTrap","removeTrap","kendoDestroy","shouldTrap","which","isDefaultPrevented","elements","_focusableElements","sortedElements","_sortFocusableElements","next","_nextFocusable","_focus","i","item","tabIndex","sort","prev","attrName","setAttribute","getAttribute","removeAttr","count","current","get","shiftKey","nodeName","contentWindow","focus","setSelectionRange","_haveSelectionRange","value","elementType","amd","a1","a2","a3"],"mappings":"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"}