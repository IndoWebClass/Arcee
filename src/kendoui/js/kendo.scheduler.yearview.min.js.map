{"version":3,"file":"kendo.scheduler.yearview.min.js","sources":["kendo.scheduler.yearview.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.scheduler.yearview',[ \"./kendo.scheduler.view\", \"./kendo.multiviewcalendar\", \"./kendo.tooltip\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"scheduler.yearview\",\n    name: \"Scheduler Year View\",\n    category: \"web\",\n    description: \"The Scheduler Year View\",\n    depends: [ \"scheduler.view\", \"multiviewcalendar\", \"tooltip\" ],\n    hidden: true\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        SchedulerView = ui.SchedulerView,\n        extend = $.extend,\n        proxy = $.proxy,\n        template = kendo.template,\n        firstDayOfYear = kendo.date.firstDayOfYear,\n        firstDayOfMonth = kendo.date.firstDayOfMonth,\n        lastDayOfMonth = kendo.date.lastDayOfMonth,\n        NAVIGATE = \"navigate\",\n        KEYDOWN = \"keydown\",\n        ACTIVATE = \"activate\",\n        SHOW = \"show\",\n        HIDE = \"hide\",\n        CLICK = \"click\",\n        DOT = \".\",\n        NS = \".kendoYearView\";\n\n    var YearViewStyles = {\n        layout: \"k-scheduler-layout k-scheduler-layout-flex k-scheduler-yearview\",\n        body: \"k-scheduler-body\",\n        tooltip: \"k-scheduler-tooltip\",\n        indicator: \"k-day-indicator\",\n        event: \"k-tooltip-event\",\n        hidden: \"k-hidden\"\n    };\n\n    var TOOLTIP_TEMPLATE = template(\n        \"<div class='k-tooltip-title k-text-center'>\" +\n            \"<div class='k-month'>#:kendo.format('{0:MMM}', date)#</div>\" +\n            \"<div tabindex='0' class='k-link k-day k-text-primary'>#:kendo.format('{0:dd}', date)#</div>\" +\n        \"</div>\" +\n        \"#if(events.length){#\" +\n            \"<div class='k-tooltip-events-container'>\" +\n                \"<div class='k-tooltip-events'>\" +\n                    \"#for(var i = 0; i < events.length; i+=1){#\" +\n                        \"#var event = events[i]#\" +\n                        \"<div class='k-tooltip-event k-event' title='#:event.title#'\" +\n                            \"# if (event.resources[0]) { #\" +\n                                \"style='background-color: #: event.resources[0].color #; border-color: #: event.resources[0].color #;'\" +\n                            \"#}#>\" +\n                            \"<div class='k-event-title k-text-ellipsis'>#:event.title#</div>\" +\n                            \"<span class='k-spacer'></span>\" +\n                            \"<span class='k-event-time'>#:kendo.format('{0:t}', event.start)#</span>\" +\n                        \"</div>\" +\n                    \"#}#\" +\n                \"</div>\" +\n            \"</div>\" +\n        \"#} else {#\" +\n            \"<div class='k-no-data k-text-center'>#:messages.noData#</div>\" +\n        \"#}#\"\n    );\n\n    var YearView = SchedulerView.extend({\n        init: function(element, options) {\n            var that = this;\n\n            SchedulerView.fn.init.call(that, element, options);\n\n            that._yearRange();\n\n            that._templates();\n\n            that._layout();\n\n            that._initCalendar();\n\n            that._initTooltip();\n        },\n\n        options: {\n            title: \"Year\",\n            name: \"year\",\n            months: 12,\n            startDate: null,\n            messages: {\n                noData: \"No events on this date.\"\n            },\n            selectedDateFormat: \"{0:yyyy}\",\n            selectedShortDateFormat: \"{0:yyyy}\",\n            selectedMobileDateFormat: \"{0:yyyy}\",\n            tooltipTemplate: TOOLTIP_TEMPLATE\n        },\n\n        name: \"year\",\n\n        events: [ NAVIGATE ],\n\n        _yearRange: function () {\n            var that = this,\n                options = that.options,\n                tempEnd;\n\n            that._startDate = options.startDate ? firstDayOfMonth(options.startDate) : firstDayOfYear(options.date);\n            that._startDate.setFullYear(options.date.getFullYear());\n\n            tempEnd = new Date(that._startDate);\n            tempEnd.setMonth(tempEnd.getMonth() + options.months);\n            that._endDate = tempEnd;\n        },\n\n        _templates: function() {\n            var options = this.options,\n                settings = extend({}, kendo.Template, options.templateSettings);\n\n            this.tooltipTemplate = kendo.template(options.tooltipTemplate, settings);\n        },\n\n        _layout: function() {\n            var that = this,\n                styles = YearViewStyles;\n\n            that.content = $(\"<div/>\").addClass(styles.layout);\n            that.element.append(that.content);\n\n            that.body = $(\"<div/>\").addClass(styles.body);\n            that.content.append(that.body);\n        },\n\n        _initCalendar: function () {\n            var that = this,\n                options = that.options,\n                calendarElement = $(\"<div/>\");\n\n            that.body.append(calendarElement);\n\n            that.calendar = new ui.MultiViewCalendar(calendarElement, {\n                views: options.months,\n                value: that.startDate(),\n                showViewHeader: true,\n                footer: false\n            });\n\n            if (!options.selectable) {\n                that._disableCalendarSelection();\n            }\n\n            that.calendar.value(null);\n\n            that.calendar.header.toggleClass(YearViewStyles.hidden);\n\n            that.calendar.element.on(CLICK + NS, \"td[role='gridcell']\", proxy(that._calendarCellClick, that));\n\n            that.calendar.element.on(KEYDOWN + NS, \"table.k-content\", proxy(that._calendarKeydown, that));\n\n            that.calendar.bind(NAVIGATE, proxy(that._calendarNavigate, that));\n\n            that.calendar.element.find(\"table\").attr(\"tabindex\", \"-1\");\n        },\n\n        _calendarCellClick: function(ev) {\n            var that = this,\n                target = that.calendar.selectable.value().first();\n\n            ev.preventDefault();\n            ev.stopPropagation();\n\n            that._displayTooltip(target);\n        },\n\n        _calendarKeydown: function(ev) {\n            var that = this,\n                keys = kendo.keys,\n                keyCode = ev.keyCode;\n\n            if (keyCode == keys.ENTER || keyCode == keys.SPACEBAR) {\n                ev.preventDefault();\n\n                that._displayTooltip(that.calendar.selectable.value().first());\n            }\n        },\n\n        _calendarNavigate: function(ev) {\n            var that = this,\n                calendar = ev.sender,\n                isPrevious = calendar._firstViewValue < that.startDate(),\n                navigationDate = isPrevious ?  that.previousDate() : that.nextDate();\n\n            that.trigger(NAVIGATE, { view: \"year\", date: navigationDate });\n\n            that._focusCellOnNavigate();\n        },\n\n        _focusCellOnNavigate: function() {\n            var that = this,\n                calendar = that.calendar || that.element.find(\".k-calendar\").getKendoMultiViewCalendar(),\n                isPrevious,\n                focusDate;\n\n            if (!calendar) {\n                return;\n            }\n\n            isPrevious = calendar._firstViewValue < that.startDate();\n            focusDate = isPrevious ?  that.lastDateInRange() : that.nextDate();\n\n            if (that.options.selectable) {\n                calendar.value(focusDate);\n            }\n\n            calendar._focusCell(calendar._cellByDate(focusDate), true);\n        },\n\n        _disableCalendarSelection: function() {\n            var that = this;\n\n            if (!that.calendar) {\n                return;\n            }\n\n            that.calendar.value(null);\n            that.calendar.element.off(KEYDOWN, that.calendar._move);\n            that.calendar.element.find(\"table\").attr(\"tabindex\", \"-1\");\n        },\n\n        _initTooltip: function() {\n            var that = this,\n                tooltipElement = that.content,\n                tooltipTemplate = that._buildTooltipTemplate.bind(that);\n\n            that.tooltip = new ui.Tooltip(tooltipElement, {\n                filter: \".k-calendar td[role='gridcell']\",\n                showOn: CLICK,\n                position: \"right\",\n                content: tooltipTemplate,\n                width: 220\n            });\n\n            that._initTooltipPopup();\n\n            that.tooltip.bind(SHOW, proxy(that._tooltipShow, that));\n\n            that.tooltip.bind(HIDE, proxy(that._tooltipHide, that));\n        },\n\n        _initTooltipPopup: function() {\n            var that = this,\n                tooltip = that.tooltip;\n\n            if (!that.tooltip) {\n                return;\n            }\n\n            tooltip._initPopup();\n\n            tooltip.popup.element.addClass(YearViewStyles.tooltip);\n\n            tooltip.popup.element.on(CLICK + NS, \".k-tooltip-title > .k-day\", proxy(that._tooltipTitleClick, that));\n\n            tooltip.popup.element.on(KEYDOWN + NS, that, proxy(that._tooltipKeydown, that));\n        },\n\n        _buildTooltipTemplate: function() {\n            var that = this,\n                date = kendo.parseDate(that.calendar.current()),\n                data = that.eventsByDate || [];\n\n            data = data.filter(function(dateData) {\n                return kendo.toString(new Date(dateData.value), \"d\") == kendo.toString(date, \"d\");\n            });\n\n            if (data && data[0]) {\n                data[0].items.map(function(event) {\n                    event.resources = that.eventResources(event) || [];\n                });\n            }\n\n            return that.tooltipTemplate({\n                date: date,\n                events: data[0] ? data[0].items : [],\n                messages: that.options.messages\n            });\n        },\n\n        _inverseTooltipEventsColor: function() {\n            var that = this;\n\n            $.each(that.tooltip.popup.element.find(DOT + YearViewStyles.event), function(){\n                that._inverseEventColor($(this));\n            });\n        },\n\n        _tooltipShow: function(ev) {\n            var that = this,\n                tooltip = ev.sender;\n\n            tooltip.refresh();\n\n            that._inverseTooltipEventsColor();\n\n            tooltip.popup.element.find(\":kendoFocusable\").first().trigger(\"focus\");\n        },\n\n        _tooltipHide: function() {\n            if(!this.calendar) {\n                return;\n            }\n\n            this.calendar._focusCell(this.calendar.selectable.value().first(), true);\n        },\n\n        _tooltipTitleClick: function() {\n            this._navigateToDayView();\n        },\n\n        _tooltipKeydown: function(ev) {\n            var that = this,\n                element = that.tooltip.popup.element,\n                target = $(ev.target),\n                keys = kendo.keys,\n                keyCode = ev.keyCode,\n                shiftKey = ev.shiftKey;\n\n            if (target.is(\".k-day\") && keyCode == keys.ENTER || keyCode == keys.SPACEBAR) {\n                ev.preventDefault();\n\n                that._navigateToDayView();\n            }\n\n            if (keyCode == keys.TAB) {\n                var firstFocusable = element.find(\":kendoFocusable\").first();\n                var lastFocusable = element.find(\":kendoFocusable\").last();\n\n                if (shiftKey && target.is(firstFocusable)) {\n                    lastFocusable.trigger(\"focus\");\n                    ev.preventDefault();\n                } else if (target.is(lastFocusable)) {\n                    firstFocusable.trigger(\"focus\");\n                    ev.preventDefault();\n                }\n            }\n        },\n\n        _navigateToDayView: function() {\n            var dayViewEnabled = $.grep(this.options.views, function(view) {\n                return ($.isPlainObject(view) && view.type == \"kendo.ui.DayView\") || view === \"day\";\n            }).length;\n\n            if (dayViewEnabled) {\n                this.trigger(NAVIGATE, { view: \"day\", date: this.calendar.current() });\n            }\n        },\n\n        _displayTooltip: function(target) {\n            var that = this;\n\n            if (!target.length) {\n                return;\n            }\n\n            if (!that.options.selectable) {\n                target.removeClass(\"k-state-selected\");\n            }\n\n            setTimeout(function() {\n                that.tooltip.show(target);\n            }, 50);\n        },\n\n        _renderEventIndicators: function() {\n            var that = this,\n                calendar = that.calendar,\n                current,\n                cell;\n\n            calendar.element.find(\".\" + YearViewStyles.indicator).remove();\n\n            that.eventsByDate.forEach(function(date) {\n                current = calendar._currentView.toDateString(new Date(date.value));\n                cell = calendar.element[0].querySelector(\"[data-value='\" + current + \"']\");\n\n                if (date.items.length) {\n                    $(\"<span/>\").addClass(YearViewStyles.indicator).appendTo(cell);\n                }\n            });\n        },\n\n        _groupEventsByDate: function(events) {\n            var eventsByDate = [],\n                eventsFormatted;\n\n            if (!events.length) {\n                return [];\n            }\n\n            eventsFormatted = events.map(function(event) {\n                event.formattedDate = event.start.toDateString();\n                return event;\n            });\n\n            eventsByDate = new kendo.data.Query(eventsFormatted)\n                .sort([\n                    { field: \"start\", dir: \"asc\" },\n                    { field: \"end\", dir: \"desc\" }\n                ])\n                .group({\n                    field: \"formattedDate\"\n                })\n                .toArray();\n\n            return eventsByDate;\n        },\n\n        lastDateInRange: function() {\n            var end = new Date(this.previousDate());\n\n            end.setMonth((end.getMonth() - 1) + this.options.months);\n\n           return lastDayOfMonth(end);\n        },\n\n        nextDate: function() {\n            return kendo.date.nextYear(this._startDate);\n        },\n\n        previousDate: function() {\n            return kendo.date.previousYear(this._startDate);\n        },\n\n        startDate: function() {\n            return this._startDate;\n        },\n\n        endDate: function() {\n            return this._endDate;\n        },\n\n        moveToEvent: function() {\n            return false;\n        },\n\n        constrainSelection: function() {\n            return false;\n        },\n\n        inRange: function() {\n            return true;\n        },\n\n        select: function(selection) {\n            this.clearSelection();\n\n            if (selection.start >= this.startDate() && selection.start < this.endDate()) {\n                this.calendar.value(selection.start);\n            } else {\n                this.calendar.value(this.calendar._firstViewValue);\n                selection.start = selection.end = this.calendar.value();\n            }\n\n            this.current(this.calendar.selectable.value()[0]);\n        },\n\n        selectionByElement: function(cell) {\n            if (!cell.length) {\n                return;\n            }\n\n            cell = $(cell);\n\n            return {\n                index: this.calendar._index,\n                start: kendo.calendar.toDateObject(cell),\n                end: kendo.calendar.toDateObject(cell),\n                isAllDay: false,\n                uid: 0\n            };\n        },\n\n        current: function(candidate) {\n            if (candidate !== undefined) {\n                this._current = candidate;\n            } else {\n                return this._current;\n            }\n        },\n\n        move: function(selection, key) {\n            var handled = false,\n                selectable = this.options.selectable;\n\n            if (!selectable || !selection) {\n                return;\n            }\n\n            if (key === kendo.keys.DOWN || key === kendo.keys.UP ||\n                key === kendo.keys.LEFT || key === kendo.keys.RIGHT) {\n                    handled = true;\n                    this.calendar.focus();\n            }\n\n            if (key === kendo.keys.ENTER || key === kendo.keys.SPACEBAR) {\n                handled = true;\n            }\n\n            if (handled) {\n                selection.start = selection.end = this.calendar.value();\n            }\n\n            return handled;\n        },\n\n        render: function(events) {\n            var that = this;\n\n            that._cachedEvents = events;\n\n            that.eventsByDate = that._groupEventsByDate(events) || [];\n\n            that._renderEventIndicators();\n\n            that.trigger(ACTIVATE);\n        },\n\n        destroy: function() {\n            var that = this;\n\n            if (that.tooltip) {\n                that.tooltip.destroy();\n                that.tooltip = null;\n            }\n\n            if (that.calendar) {\n                that.calendar.destroy();\n                that.calendar = null;\n            }\n\n            if (that.element) {\n                that.content.remove();\n                that.element.off(NS);\n            }\n\n            SchedulerView.fn.destroy.call(this);\n        }\n    });\n\n    extend(true, ui, {\n        YearView: YearView\n    });\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","description","depends","hidden","$","window","kendo","jQuery","undefined","ui","SchedulerView","extend","proxy","template","firstDayOfYear","date","firstDayOfMonth","lastDayOfMonth","NAVIGATE","KEYDOWN","ACTIVATE","SHOW","HIDE","CLICK","DOT","NS","YearViewStyles","layout","body","tooltip","indicator","event","TOOLTIP_TEMPLATE","YearView","init","element","options","that","this","fn","call","_yearRange","_templates","_layout","_initCalendar","_initTooltip","title","months","startDate","messages","noData","selectedDateFormat","selectedShortDateFormat","selectedMobileDateFormat","tooltipTemplate","events","tempEnd","_startDate","setFullYear","getFullYear","Date","setMonth","getMonth","_endDate","settings","Template","templateSettings","styles","content","addClass","append","calendarElement","calendar","MultiViewCalendar","views","value","showViewHeader","footer","selectable","_disableCalendarSelection","header","toggleClass","on","_calendarCellClick","_calendarKeydown","bind","_calendarNavigate","find","attr","ev","target","first","preventDefault","stopPropagation","_displayTooltip","keys","keyCode","ENTER","SPACEBAR","sender","isPrevious","_firstViewValue","navigationDate","previousDate","nextDate","trigger","view","_focusCellOnNavigate","getKendoMultiViewCalendar","focusDate","lastDateInRange","_focusCell","_cellByDate","off","_move","tooltipElement","_buildTooltipTemplate","Tooltip","filter","showOn","position","width","_initTooltipPopup","_tooltipShow","_tooltipHide","_initPopup","popup","_tooltipTitleClick","_tooltipKeydown","parseDate","current","data","eventsByDate","dateData","toString","items","map","resources","eventResources","_inverseTooltipEventsColor","each","_inverseEventColor","refresh","_navigateToDayView","shiftKey","is","TAB","firstFocusable","lastFocusable","last","dayViewEnabled","grep","isPlainObject","type","length","removeClass","setTimeout","show","_renderEventIndicators","cell","remove","forEach","_currentView","toDateString","querySelector","appendTo","_groupEventsByDate","eventsFormatted","formattedDate","start","Query","sort","field","dir","group","toArray","end","nextYear","previousYear","endDate","moveToEvent","constrainSelection","inRange","select","selection","clearSelection","selectionByElement","index","_index","toDateObject","isAllDay","uid","candidate","_current","move","key","handled","DOWN","UP","LEFT","RIGHT","focus","render","_cachedEvents","destroy","amd","a1","a2","a3"],"mappings":"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"}