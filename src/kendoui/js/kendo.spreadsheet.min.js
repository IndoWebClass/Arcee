/** 
 * Kendo UI v2022.1.301 (http://www.telerik.com/kendo-ui)                                                                                                                                               
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.                                                                                      
 *                                                                                                                                                                                                      
 * Kendo UI commercial licenses may be obtained at                                                                                                                                                      
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete                                                                                                                                  
 * If you do not own a commercial license, this file shall be governed by the trial license terms.                                                                                                      
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       
                                                                                                                                                                                                       

*/
!function(define){define("util/undoredostack.min",["../kendo.core.min"],function(){var t=kendo,e=t.Observable.extend({init:function(e){t.Observable.fn.init.call(this,e);this.clear()},events:["undo","redo"],push:function(e){this.stack=this.stack.slice(0,this.currentCommandIndex+1);this.currentCommandIndex=this.stack.push(e)-1},undo:function(){if(this.canUndo()){var e=this.stack[this.currentCommandIndex--];e.undo();this.trigger("undo",{command:e})}},redo:function(){if(this.canRedo()){var e=this.stack[++this.currentCommandIndex];e.redo();this.trigger("redo",{command:e})}},clear:function(){this.stack=[];this.currentCommandIndex=-1},canUndo:function(){return this.currentCommandIndex>=0},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1}});t.deepExtend(t,{util:{UndoRedoStack:e}})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("util/text-metrics.min",["../kendo.core.min"],function(){var t=window.kendo.jQuery,r=(window.kendo.util=window.kendo.util||{},kendo.Class.extend({init:function(e){this._size=e;this._length=0;this._map={}},put:function(e,t){var r=this._map;var n={key:e,value:t};r[e]=n;if(!this._head)this._head=this._tail=n;else{this._tail.newer=n;n.older=this._tail;this._tail=n}if(this._length>=this._size){r[this._head.key]=null;this._head=this._head.newer;this._head.older=null}else this._length++},get:function(e){var t=this._map[e];if(t){if(t===this._head&&t!==this._tail){this._head=t.newer;this._head.older=null}if(t!==this._tail){if(t.older){t.older.newer=t.newer;t.newer.older=t.older}t.older=this._tail;t.newer=null;this._tail.newer=t;this._tail=t}return t.value}}})),n=/\r?\n|\r|\t/g,i=" ";function f(e){return String(e).replace(n,i)}function d(e){var t=[];for(var r in e)t.push(r+e[r]);return t.sort().join("")}function p(e){var t=2166136261;for(var r=0;r<e.length;++r){t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);t^=e.charCodeAt(r)}return t>>>0}function m(){return{width:0,height:0,baseline:0}}var s={baselineMarkerSize:1},g;if(typeof document!=="undefined"){g=document.createElement("div");g.style.cssText="position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;"+"padding: 0 !important; margin: 0 !important; border: 0 !important;"+"line-height: normal !important; visibility: hidden !important; white-space: pre!important;"}var a=kendo.Class.extend({init:function(e){this._cache=new r(1e3);this.options=t.extend({},s,e)},measure:function(e,t,r){if(r===void 0)r={};if(typeof e==="undefined"||e===null)return m();var c=d(t);var n=p(e+c);var i=this._cache.get(n);if(i)return i;var a=m();var s=r.box||g;var o=this._baselineMarker().cloneNode(false);for(var l in t){var u=t[l];if(typeof u!=="undefined")s.style[l]=u}var h=r.normalizeText!==false?f(e):String(e);s.textContent=h;s.appendChild(o);document.body.appendChild(s);if(h.length){a.width=s.offsetWidth-this.options.baselineMarkerSize;a.height=s.offsetHeight;a.baseline=o.offsetTop+this.options.baselineMarkerSize}if(a.width>0&&a.height>0)this._cache.put(n,a);s.parentNode.removeChild(s);return a},_baselineMarker:function(){var e=document.createElement("div");e.style.cssText="display: inline-block; vertical-align: baseline;width: "+this.options.baselineMarkerSize+"px; height: "+this.options.baselineMarkerSize+"px;overflow: hidden;";return e}});function e(e,t,r){return a.current.measure(e,t,r)}a.current=new a,kendo.deepExtend(kendo.util,{LRUCache:r,TextMetrics:a,measureText:e,objectKey:d,hashKey:p,normalizeText:f})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("util/main.min",["../kendo.core.min"],function(){var i=window.kendo,c;function e(e){return e*e}var t=Date.now;if(!t)t=function(){return(new Date).getTime()};function r(e){if(typeof e!=="string")e+="px";return e}function n(e){var t=[];if(e){var r=i.toHyphens(e).split("-");for(var n=0;n<r.length;n++)t.push("k-pos-"+r[n])}return t.join(" ")}function a(e){var t={1:"i",10:"x",100:"c",2:"ii",20:"xx",200:"cc",3:"iii",30:"xxx",300:"ccc",4:"iv",40:"xl",400:"cd",5:"v",50:"l",500:"d",6:"vi",60:"lx",600:"dc",7:"vii",70:"lxx",700:"dcc",8:"viii",80:"lxxx",800:"dccc",9:"ix",90:"xc",900:"cm",1e3:"m"};var r=[1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1];var n="";while(e>0)if(e<r[0])r.shift();else{n+=t[r[0]];e-=r[0]}return n}function s(e){e=e.toLowerCase();var t={i:1,v:5,x:10,l:50,c:100,d:500,m:1e3};var r=0,n=0;for(var i=0;i<e.length;++i){var a=t[e.charAt(i)];if(!a)return null;r+=a;if(a>n)r-=2*n;n=a}return r}function o(r){var n=Object.create(null);return function(){var e="";for(var t=arguments.length;--t>=0;)e+=":"+arguments[t];return e in n?n[e]:n[e]=r.apply(this,arguments)}}function l(e){return h.test(e)}function u(e,t){try{return e.call(t,function(e){throw new r(e)})}catch(e){if(e instanceof r)return e.value;throw e}function r(e){this.value=e}}(0,i.deepExtend)(i,{util:{now:t,renderPos:n,renderSize:r,sqr:e,romanToArabic:s,arabicToRoman:a,memoize:o,isUnicodeLetter:l,withExit:u}});var h=new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");return window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("util/parse-xml.min",["../kendo.core.min","./main.min"],function(){"use strict";var S=String.fromCharCode,A={amp:38,lt:60,gt:62,quot:34,apos:39,nbsp:160};function e(e){var t=[];for(var r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}function D(e,t){if(t>65535){t-=65536;e.push(t>>>10&1023|55296,56320|t&1023)}else e.push(t)}var E=e("<![CDATA["),B=e("]]>"),N=e("--\x3e"),z=e("!--"),P=e("/>"),H=e("</"),O=e("?>"),V=e("?"),M=e("<"),T=e(">"),$=e(";"),U=e("="),I=e("&"),W=e('"'),j=e("'"),q=e("#"),K=e("x"),J=e("X"),L={};function t(n,f){var i=0;var a=[];var d={is:function(e){var t=a.length,r=e.length;while(--t>=0&&--r>=0)if(a[t].$tag!=e[r]&&e[r]!="*")return false;return r<0?a[a.length-1]:null},exit:function(){throw L},stack:a};function r(e){var t=n[i++];if(!(t&240^240))D(e,(t&3)<<18|(n[i++]&63)<<12|(n[i++]&63)<<6|n[i++]&63);else if(!(t&224^224))D(e,(t&15)<<12|(n[i++]&63)<<6|n[i++]&63);else if(!(t&192^192))D(e,(t&31)<<6|n[i++]&63);else e.push(t)}function s(e){throw new Error(e+", at "+i)}function t(e){var t=[];while(i<n.length&&e(n[i]))t.push(n[i++]);return t}function p(e){return S.apply(0,t(e))}function o(){t(e)}function l(e){var t=i;for(var r=0;r<e.length;++r)if(n[i++]!=e[r]){i=t;return false}return e}function u(e){if(!l(e))s("Expecting "+e.join(", "))}function e(e){return e==9||e==10||e==13||e==32}function m(e){return e>=48&&e<=57}function g(e){return e>=48&&e<=57||(e|=32)>=97&&e<=102}function v(e){return e==58||e==95||(e|=32)>=97&&e<=122}function b(e){return e==45||m(e)||v(e)}function w(){var e=[];while(i<n.length){if(l(N))return h("comment",S.apply(0,e));r(e)}}function y(){var e,t;if(l(V))C();else if(l(z))w();else{e=c();t=F(e);a.push(t);if(l(P))h("enter",e,t,true);else{u(T);h("enter",e,t);_(e);if(e!=c())s("Bad closing tag");h("leave",e,t);o();u(T)}a.pop()}}function _(e){var t=[];while(i<n.length)if(l(H))return t.length&&h("text",S.apply(0,t));else if(l(E))while(i<n.length&&!l(B))r(t);else if(l(M)){if(t.length)h("text",S.apply(0,t));y();t=[]}else if(l(I))x(t);else r(t);s("Unclosed tag "+e)}function c(){if(!v(n[i]))s("Expecting XML name");return p(b)}function k(){var e=l(W)||l(j);if(!e)s("Expecting string");var t=[];while(i<n.length)if(l(e))return S.apply(0,t);else if(l(I))x(t);else r(t);s("Unfinished string")}function x(e){var t;if(l(q)){if(l(K)||l(J))t=parseInt(p(g),16);else t=parseInt(p(m),10);if(isNaN(t))s("Bad numeric entity")}else{var r=c();t=A[r];if(t===undefined)s("Unknown entity "+r)}D(e,t);u($)}function C(){h("decl",c(),F());u(O)}function F(e){var t={$tag:e};while(i<n.length){o();var r=n[i];if(r==63||r==62||r==47)break;t[c()]=(u(U),k())}return t}function h(e,t,r,n){var i=f&&f[e];if(i)i.call(d,t,r,n)}var R=[];r(R);if(R[0]!=65279)i=0;while(i<n.length){o();u(M);y();o()}}kendo.util.parseXML=function e(){try{return t.apply(this,arguments)}catch(e){if(e!==L)throw e}}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/commands.min",["../kendo.core.min","../kendo.binder.min","../kendo.window.min","../kendo.list.min","../kendo.tabstrip.min"],function(){var v=kendo,t=v.jQuery,s={AUTO_FILL:"autoFill",CLEAR:"clear",CUT:"cut",EDIT:"edit",PASTE:"paste",VALIDATION:"validation"},r=v.spreadsheet.Command=v.Class.extend({init:function(e){this.options=e;this._workbook=e.workbook;this._property=e&&e.property;this._state={}},range:function(e){if(e!==undefined)this._setRange(e);return this._range},_setRange:function(e){this._range=e},redo:function(){this.range().select();this.exec()},undo:function(){this.setState(this._state)},getState:function(){this._state=this.range().getState(this._property)},setState:function(e){this.range().setState(e)},rejectState:function(e){this.undo();return{title:e.title,body:e.message,reason:"error",type:"validationError"}},_forEachCell:function(t){var r=this.range();var e=r._ref;e.forEach(function(e){r.sheet().forEach(e.toRangeRef(),t.bind(this))}.bind(this))},usesImage:function(){return false}}),n=(v.spreadsheet.DrawingUpdateCommand=r.extend({init:function(e){this._sheet=e.sheet;this._drawing=e.drawing;this._orig=this._drawing.clone();this._previous=e.previous},exec:function(){},undo:function(){this._drawing.reset(this._previous);this._sheet._activeDrawing=this._drawing;this._sheet.triggerChange({layout:true})},redo:function(){this._drawing.reset(this._orig);this._sheet._activeDrawing=this._drawing;this._sheet.triggerChange({layout:true})},usesImage:function(e){return this._drawing.image===e||this._orig.image===e||this._previous.image===e}}),r.extend({init:function(e){r.fn.init.call(this,e);this._drawing=e.drawing},usesImage:function(e){return this._drawing.image===e}})),e=(v.spreadsheet.InsertImageCommand=n.extend({init:function(e){n.fn.init.call(this,e);this._blob=e.blob;this._width=e.width;this._height=e.height},exec:function(){var e=this.range();var t=e.sheet();var r=this._width;var n=this._height;var i=r/n;if(r>n){r=Math.min(r,300);n=r/i}else{n=Math.min(n,300);r=n*i}this._drawing=t.addDrawing({topLeftCell:e.topLeft(),offsetX:5,offsetY:5,width:r,height:n,opacity:1,image:this._workbook.addImage(this._blob)},true);this._blob=null},undo:function(){var e=this.range().sheet();e._activeDrawing=null;e.removeDrawing(this._drawing)},redo:function(){var e=this.range().sheet();e._activeDrawing=this._drawing;e.addDrawing(this._drawing)}}),v.spreadsheet.DeleteDrawingCommand=n.extend({exec:function(){var e=this.range().sheet();e._activeDrawing=null;e.removeDrawing(this._drawing)},undo:function(){var e=this.range().sheet();e._activeDrawing=this._drawing;e.addDrawing(this._drawing)},redo:function(){this.exec()}}),n.extend({exec:function(){var e=this.range().sheet();this._origIndex=e._drawings.indexOf(this._drawing);e._drawings.splice(this._origIndex,1);this._newIndex=this._reorder();e._drawings.splice(this._newIndex,0,this._drawing);e.triggerChange({drawings:true})},undo:function(){var e=this.range().sheet();e._drawings.splice(this._newIndex,1);e._drawings.splice(this._origIndex,0,this._drawing);e.triggerChange({drawings:true})}})),i=(v.spreadsheet.BringToFrontCommand=e.extend({_reorder:function(){return this.range().sheet()._drawings.length}}),v.spreadsheet.SendToBackCommand=e.extend({_reorder:function(){return 0}}),r.extend({init:function(e){r.fn.init.call(this,e);this._target=e.target;this._value=e.value},exec:function(){this.getState();this.setState(this._value)}})),a=(v.spreadsheet.ColumnWidthCommand=i.extend({getState:function(){this._state=this.range().sheet().columnWidth(this._target)},setState:function(e){this.range().sheet().columnWidth(this._target,e)}}),v.spreadsheet.RowHeightCommand=i.extend({getState:function(){this._state=this.range().sheet().rowHeight(this._target)},setState:function(e){this.range().sheet().rowHeight(this._target,e)}}),v.spreadsheet.HyperlinkCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._link=e.link},exec:function(){var e=this.range();this._prevLink=e.link();this._prevUnderline=e.underline();e.link(this._link);e.underline(true);if(e.value()==null){this._hasSetValue=true;e.value(this._link)}},undo:function(){var e=this.range();e.link(this._prevLink);e.underline(this._prevUnderline);if(this._hasSetValue)e.value(null)}}),v.spreadsheet.GridLinesChangeCommand=i.extend({getState:function(){this._state=this._range.sheet().showGridLines()},setState:function(e){this._range.sheet().showGridLines(e)}}),v.spreadsheet.PropertyChangeCommand=r.extend({_setRange:function(e){r.prototype._setRange.call(this,e.skipHiddenCells())},init:function(e){r.fn.init.call(this,e);this._value=e.value},exec:function(){var e=this.range();if(e.enable()){this.getState();if(this.options.property==="format")this._workbook.trigger("changeFormat",{range:e});e[this._property](this._value)}}})),u=(v.spreadsheet.ClearContentCommand=r.extend({exec:function(){var t=[],r,n,i,e,a;if(!this.range().enable())return{reason:"error",type:"cannotModifyDisabled"};if(!this.range().canEditArrayFormula())return{reason:"error",type:"intersectsArray"};this.getState();r=this.range().skipHiddenCells();if(r._ref.refs&&r._ref.refs.length>1)r._ref.refs.forEach(function(e){a=r.sheet().range(e);t=t.concat(a.values())});else t=r.values();i=[];t.forEach(function(e){n=[];e.forEach(function(){n.push(null)});i.push(n)});if(r.sheet().trigger("changing",{data:i,range:r,changeType:s.CLEAR}))return;r.clearContent();e=r._getValidationState();if(e)return this.rejectState(e)},undo:function(){var e=this.range().skipHiddenCells();var t=e.sheet();var r=this._state.data;var n=[];var i;r.forEach(function(e){i=[];e.forEach(function(e){i.push(e.value)});n.push(i)});if(t.trigger("changing",{data:n,range:e,changeType:s.CLEAR}))return;this.setState(this._state)}}),v.spreadsheet.EditCommand=a.extend({init:function(e){e.property=e.property||"input";a.fn.init.call(this,e)},_setRange:function(e){a.prototype._setRange.apply(this,arguments);this._editRange=this.options.arrayFormula?e:e.sheet().activeCellSelection()},getState:function(){this._state=this.range().getState()},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this))},undo:function(){var e=this._editRange;var t=this._state;if(e.sheet().trigger("changing",{data:t.data[0][0].value,range:e,changeType:s.EDIT}))return;this.setState(this._state)},_exec:function(){var e=this.options.arrayFormula;var t=this._editRange;if(!t.enable())return{reason:"error",type:"rangeDisabled"};if(!t.canEditArrayFormula())return{reason:"error",type:"intersectsArray"};var r=this._value;this.getState();if(this.range().sheet().trigger("changing",{data:r,range:this._editRange,changeType:s.EDIT}))return;if(this._property=="value"){t.value(r);return}try{t.link(null);if(r==="")t.value(null);else{t.input(r,{arrayFormula:e});if(/\n/.test(t.value()))t.wrap(true)}t._adjustRowHeight();var n=t._getValidationState();if(n)return this.rejectState(n)}catch(e){if(e instanceof v.spreadsheet.calc.ParseError)return{title:"Error in formula",body:e+"",reason:"error"};else throw e}}}),v.spreadsheet.InsertCommentCommand=a.extend({init:function(e){e.property="comment";a.fn.init.call(this,e)}}),v.spreadsheet.TextWrapCommand=a.extend({init:function(e){e.property="wrap";a.fn.init.call(this,e);this._value=e.value},getState:function(){var r={};this.range().forEachRow(function(e){var t=e.topLeft().row;r[t]=e.sheet().rowHeight(t)});this._state=this.range().getState(this._property);this._rowHeight=r},undo:function(){var e=this.range().sheet();var t=this._rowHeight;this.range().setState(this._state);for(var r in t)e.rowHeight(r,t[r])}}),v.spreadsheet.AdjustDecimalsCommand=r.extend({init:function(e){this._delta=e.value;e.property="format";r.fn.init.call(this,e)},exec:function(){var a=this.range().sheet();var s=this._delta;var o=v.spreadsheet.formatting;this.getState();a.batch(function(){this.range().forEachCell(function(e,t,r){var n=r.format;if(!n){var i=r.value;if(typeof i=="number"&&/\./.test(i))n="0."+String(i).split(".")[1].replace(/\d/g,"0")}if(n||s>0){n=o.adjustDecimals(n||"0",s);a.range(e,t).format(n)}})}.bind(this))}}),v.spreadsheet.BorderChangeCommand=r.extend({init:function(e){e.property="border";r.fn.init.call(this,e);this._type=e.border;this._style=e.style},_batch:function(e){return this.range().sheet().batch(e,{})},exec:function(){var e=this;e.getState();e._batch(function(){e[e._type](e._style)})},noBorders:function(){this.range().insideBorders(null);this.outsideBorders(null)},allBorders:function(e){this.range().insideBorders(e);this.outsideBorders(e)},leftBorder:function(e){this.range().leftColumn().borderLeft(e)},rightBorder:function(e){this.range().rightColumn().borderRight(e)},topBorder:function(e){this.range().topRow().borderTop(e)},bottomBorder:function(e){this.range().bottomRow().borderBottom(e)},outsideBorders:function(e){var t=this.range();t.leftColumn().borderLeft(e);t.topRow().borderTop(e);t.rightColumn().borderRight(e);t.bottomRow().borderBottom(e)},insideBorders:function(e){this.range().insideBorders(e);this.outsideBorders(null)},insideHorizontalBorders:function(e){this.range().insideHorizontalBorders(e)},insideVerticalBorders:function(e){this.range().insideVerticalBorders(e)}}),v.spreadsheet.MergeCellCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._type=e.value},exec:function(){this.getState();this[this._type]()},activate:function(e){this.range().sheet().activeCell(e)},getState:function(){this._state=this.range().getState()},undo:function(){if(this._type!=="unmerge"){this.range().unmerge();this.activate(this.range().topLeft())}this.range().setState(this._state)},cells:function(){var e=this.range();var t=e._ref;e.merge();this.activate(t)},horizontally:function(){var e=this.range().topRow()._ref;this.range().forEachRow(function(e){e.merge()});this.activate(e)},vertically:function(){var e=this.range().leftColumn()._ref;this.range().forEachColumn(function(e){e.merge()});this.activate(e)},unmerge:function(){var e=this.range();var t=e._ref.topLeft;e.unmerge();this.activate(t)}}),v.spreadsheet.FreezePanesCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._type=e.value},exec:function(){this.getState();this._topLeft=this.range().topLeft();this[this._type]()},getState:function(){this._state=this.range().sheet().getState()},undo:function(){this.range().sheet().setState(this._state)},panes:function(){var e=this._topLeft;var t=this.range().sheet();t.frozenColumns(e.col).frozenRows(e.row)},rows:function(){var e=this._topLeft;var t=this.range().sheet();t.frozenRows(e.row)},columns:function(){var e=this._topLeft;var t=this.range().sheet();t.frozenColumns(e.col)},unfreeze:function(){var e=this.range().sheet();e.frozenRows(0).frozenColumns(0)}}),v.spreadsheet.PasteCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._clipboard=e.workbook.clipboard();this._clipboard.parse();this._event=e.event;this._clipboardContent=this._clipboard._content;this._sheet=this._workbook.activeSheet();this._range=this._sheet.selection?this._sheet.selection():this._sheet.range(this._clipboard.pasteRef());this._state=this._range.getState();this._targetRangeRefs=this._range._ref instanceof v.spreadsheet.UnionRef?this._range._ref.refs:[this._range._ref]},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this))},undo:function(){var e=this._sheet;var t=this._range;if(e.trigger("changing",{data:this._state.data,range:t,changeType:s.PASTE}))return;this.setState(this._state)},_exec:function(){var e=this._clipboard.canPaste();if(!e.canPaste){if(e.menuInvoked)return{reason:"error",type:"useKeyboard"};if(e.pasteOnMerged)return{reason:"error",type:"modifyMerged"};if(e.overflow)return{reason:"error",type:"overflow"};if(e.pasteOnDisabled){this._event.preventDefault();return{reason:"error",type:"cannotModifyDisabled"}}return{reason:"error"}}var t=this._sheet;var r=this._range;if(this._workbook.trigger("paste",{range:r,clipboardContent:this._clipboardContent})||t.trigger("changing",{data:this._clipboardContent.data,range:r,changeType:s.PASTE})){this._event.preventDefault();return}else this._processPaste()},_adjustPasteTarget:function(c,h,f){var e=this;var t=e._targetRangeRefs;var r=e._sheet;var d=v.spreadsheet.RangeRef;var p=v.spreadsheet.UnionRef;var n=[];var m=function(e,t){var r=0;var n=e.topLeft;var i=t.topLeft;if(n.row>i.row)r=1;else if(n.row<i.row)r=-1;else if(n.col>i.col)r=1;else if(n.col<i.col)r=-1;return r};var i,a,s,o,l,u,g;for(u=0;u<t.length;u+=1){s=t[u];l=c[u];o=s.topLeft;g={row:l.rows*h+o.row-1,col:l.cols*f+o.col-1};i=new d(o,g);n.push(i)}if(n.length===1)a=r.range(i);else{n.sort(m);a=r.range(new p(n))}a.select();e._range=a;e._state=e._range.getState()},_processPaste:function(){var e=this;var t=e._sheet;var r=e._clipboardContent;var n=e._range;var i=r.data;var a=i.length;var s=i[0].length;var o=e._targetRangeRefs;var l=e._targetRanges(a,s);var u;e._adjustPasteTarget(l,a,s);t.batch(function(){for(u=0;u<o.length;u++)e._populateTargetRange(o[u],a,s,l[u])},{recalc:true,ref:e._range._ref});n._adjustRowHeight()},_populateTargetRange:function(e,t,r,n){var i=e.topLeft;var a,s,o;for(s=0;s<n.rows;s++)for(o=0;o<n.cols;o++){a=this._sheet.range(i.row+t*s,i.col+r*o);a.setState(this._clipboardContent,this._clipboard)}},_targetRangeDimensions:function(e,t,r){var n=e.topLeft;var i=e.bottomRight;var a=i.row-n.row+1;var s=i.col-n.col+1;var o=1;var l=1;if(a%t===0&&s%r===0){o=a/t;l=s/r}return{rows:o,cols:l}},_targetRanges:function(e,t){var r=this._targetRangeRefs;var n=[];var i;for(i=0;i<r.length;i++)n.push(this._targetRangeDimensions(r[i],e,t));return n}}),v.spreadsheet.AdjustRowHeightCommand=r.extend({exec:function(){var e=this.options;var t=this._workbook.activeSheet();var r=e.range||t.range(e.rowIndex);r._adjustRowHeight()}}),v.spreadsheet.ToolbarPasteCommand=r.extend({exec:function(){if(v.support.clipboard.paste){this._workbook._view.clipboard.focus().select();document.execCommand("paste")}else return{reason:"error",type:"useKeyboard"}}}),v.spreadsheet.CutCommand=r.extend({_eventType:"cut",init:function(e){r.fn.init.call(this,e);this._clipboard=e.workbook.clipboard();this._event=e.event},exec:function(){var e=this._clipboard.canCopy();var t=[],r,n;if(!e.canCopy){if(e.menuInvoked)return{reason:"error",type:"useKeyboard"};else if(e.multiSelection)return{reason:"error",type:"unsupportedSelection"};return}var i=this._workbook.activeSheet().selection();if(this._eventType=="cut"){if(!i.enable()){this._event.preventDefault();return{reason:"error",type:"cannotModifyDisabled"}}this.getState()}if(this._workbook.trigger(this._eventType,{range:i}))this._event.preventDefault();else if(this._eventType=="cut"){r=i.values();r.forEach(function(e){n=[];e.forEach(function(){n.push({})});t.push(n)});if(i.sheet().trigger("changing",{data:t,range:i,changeType:s.CUT}))return;this._clipboard.cut()}else this._clipboard.copy()},undo:function(){var e=this.range();if(e.sheet().trigger("changing",{data:this._state.data,range:e,changeType:s.CUT}))return;this.setState(this._state)}}),v.spreadsheet.CopyCommand=v.spreadsheet.CutCommand.extend({_eventType:"copy",undo:t.noop}),v.spreadsheet.ToolbarCopyCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._clipboard=e.workbook.clipboard()},undo:t.noop,exec:function(){if(v.support.clipboard.copy)document.execCommand("copy");else return{reason:"error",type:"useKeyboard"}}}),v.spreadsheet.AutoFillCommand=r.extend({init:function(e){r.fn.init.call(this,e)},origin:function(e){this._origin=e},exec:function(){var e=this.range(),t;if(!e.enable())return{reason:"error",type:"rangeDisabled"};if(e.intersectingArrayFormula())return{reason:"error",type:"intersectsArray"};this.getState();try{t=e._previewFillFrom(this._origin);if(e.sheet().trigger("changing",{data:t.props,range:t.dest,changeType:s.AUTO_FILL}))return;t.dest._properties(t.props,true)}catch(e){if(e instanceof v.spreadsheet.Range.FillError)return{reason:"error",type:e.code};throw e}},undo:function(){var e=this.range();var t=this._state;if(e.sheet().trigger("changing",{data:t.data,range:e,changeType:s.AUTO_FILL}))return;this.setState(this._state)}}),v.spreadsheet.ToolbarCutCommand=r.extend({cannotUndo:true,init:function(e){r.fn.init.call(this,e);this._clipboard=e.workbook.clipboard()},exec:function(){if(v.support.clipboard.copy)document.execCommand("cut");else return{reason:"error",type:"useKeyboard"}}}),v.spreadsheet.FilterCommand=r.extend({undo:function(){this.range().filter(this._state)},exec:function(){var e=this.range();this._state=e.hasFilter();e.filter(!this._state)}}),v.spreadsheet.SortCommand=r.extend({undo:function(){var e=this.range().sheet();e.setState(this._state)},exec:function(){var e=this.range();var t=e.sheet();var r=t.activeCell();var n=this.options.sheet?r.topLeft.col:this.options.column||0;var i=this.options.value==="asc"?true:false;this._state=t.getState();if(this.options.sheet)e=this.expandRange();var a=e.cantSort();if(a)return{reason:"error",type:a.code};e.sort({column:n,ascending:i})},expandRange:function(){var e=this.range().sheet();return new v.spreadsheet.Range(e._sheetRef,e)}}),v.spreadsheet.ApplyFilterCommand=r.extend({column:function(){return this.options.column||0},undo:function(){var e=this.range().sheet();e.clearFilter(this.column());if(this._state.length)this.range().filter(this._state)},getState:function(){var e=this.range().sheet();var t=e.filter();if(t)this._state=t.columns.filter(function(e){return e.index==this.column()}.bind(this))},exec:function(){var e=this.range();var t=this.column();var r=e.sheet().filter();var n;var i;var a=false;if(this.options.valueFilter)i={column:t,filter:new v.spreadsheet.ValueFilter(this.options.valueFilter)};else if(this.options.customFilter)i={column:t,filter:new v.spreadsheet.CustomFilter(this.options.customFilter)};this.getState();if(r&&r.ref.eq(e._ref)&&r.columns.length){r.columns.forEach(function(e){if(e.index===t)a=true});n=r.columns.map(function(e){return e.index===t?i:{column:e.index,filter:e.filter}});if(!a)n.push(i)}else n=i;e.filter(n)}})),o=(v.spreadsheet.ClearFilterCommand=u.extend({exec:function(){var e=this.range();var t=this.column();this.getState();e.clearFilter(t)}}),v.spreadsheet.HideLineCommand=r.extend({init:function(e){r.fn.init.call(this,e);this.axis=e.axis},undo:function(){var e=this.range().sheet();e.setAxisState(this._state)},exec:function(){var e=this.range().sheet();this._state=e.getAxisState();if(this.axis=="row")e.axisManager().hideSelectedRows();else e.axisManager().hideSelectedColumns()}}),v.spreadsheet.UnHideLineCommand=v.spreadsheet.HideLineCommand.extend({exec:function(){var e=this.range().sheet();this._state=e.getAxisState();if(this.axis=="row")e.axisManager().unhideSelectedRows();else e.axisManager().unhideSelectedColumns()}}),r.extend({exec:function(){this._expandedRange=this._expand(this.range());this._state=this._expandedRange.getState();this._indexes=this._exec(this._expandedRange.sheet())},undo:function(){var t=this;var e=t._expandedRange;var r=e.sheet();r.batch(function(){t._indexes.forEach(function(e){t._undoOne(r,e);r._restoreModifiedFormulas(e.formulas)});e.setState(t._state)},{layout:true,recalc:true,ref:e._ref})}})),l=(v.spreadsheet.DeleteRowCommand=o.extend({_expand:function(e){return e.resize({left:-Infinity,right:+Infinity})},_exec:function(e){return e.axisManager().deleteSelectedRows()},_undoOne:function(e,t){e.insertRow(t.index);e.rowHeight(t.index,t.height)}}),v.spreadsheet.DeleteColumnCommand=o.extend({_expand:function(e){return e.resize({top:-Infinity,bottom:+Infinity})},_exec:function(e){return e.axisManager().deleteSelectedColumns()},_undoOne:function(e,t){e.insertColumn(t.index);e.columnWidth(t.index,t.width)}}),r.extend({init:function(e){r.fn.init.call(this,e);this._value=e.value},undo:function(){var t=this;var r=t.range().sheet();r.batch(function(){for(var e=t._pos.count;--e>=0;)t._undoOne(r,t._pos.base)},{layout:true,recalc:true})}})),c=(v.spreadsheet.AddColumnCommand=l.extend({exec:function(){var e=this._value;var t=this.range().sheet();var r=t.axisManager().preventAddColumn();if(!r&&e==="right")r=t.axisManager().preventAddColumnAfterLast();if(r)return r;if(e==="left")this._pos=t.axisManager().addColumnLeft();else this._pos=t.axisManager().addColumnRight()},_undoOne:function(e,t){e.deleteColumn(t)}}),v.spreadsheet.AddRowCommand=l.extend({exec:function(){var e=this._value;var t=this.range().sheet();var r=t.axisManager().preventAddRow();if(!r&&e==="below")r=t.axisManager().preventAddRowAfterLast();if(r)return r;if(e==="above")this._pos=t.axisManager().addRowAbove();else this._pos=t.axisManager().addRowBelow()},_undoOne:function(e,t){e.deleteRow(t)}}),v.spreadsheet.EditValidationCommand=r.extend({init:function(e){r.fn.init.call(this,e);this._value=e.value},exec:function(){var e=this,t=e.range().sheet();this.getState();if(t.trigger("changing",{data:e._value,range:e.range(),changeType:s.VALIDATION}))return;try{t.withCultureDecimals(function(){e.range().validation(e._value)})}catch(e){if(e instanceof v.spreadsheet.calc.ParseError)return{title:"Error in formula",body:e+"",reason:"error"};else throw e}},undo:function(){var e=this.range();var t=this._state;if(e.sheet().trigger("changing",{data:t.data[0][0].validation,range:e,changeType:s.VALIDATION}))return;this.setState(this._state)}}),v.spreadsheet.OpenCommand=r.extend({cannotUndo:true,exec:function(){var e=this.options.file;if(e.name.match(/.xlsx$/i)===null)return{reason:"error",type:"openUnsupported"};var t=this.options.workbook;t.fromFile(this.options.file).then(function(){var e=t.excelImportErrors;if(e&&e.length)t._view.openDialog("importError",{errors:e})})}}),v.spreadsheet.SaveAsCommand=r.extend({cannotUndo:true,exec:function(){var e=this.options.name+this.options.extension;if(this.options.extension===".xlsx")this.options.workbook.saveAsExcel({fileName:e});else if(this.options.extension===".pdf")this.options.workbook.saveAsPDF(t.extend(this.options.pdf,{workbook:this.options.workbook,fileName:e}))}}),r.extend({init:function(e){r.fn.init.call(this,e);this._name=e.name;this._value=e.value},getState:function(){this._state=this._workbook.nameDefinition(this._name)},setState:function(){this._workbook.nameDefinition(this._name,this._state);this._workbook.trigger("change",{recalc:true})}}));v.spreadsheet.DefineNameCommand=c.extend({exec:function(){this.getState();try{this._workbook.defineName(this._name,this._value);this._workbook.trigger("change",{recalc:true})}catch(e){return{title:"Error",body:e+"",reason:"error"}}}}),v.spreadsheet.DeleteNameCommand=c.extend({exec:function(){this.getState();this._workbook.undefineName(this._name);this._workbook.trigger("change",{recalc:true})}})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/formulabar.min",["../kendo.core.min"],function(){var n=window.kendo,i=n.jQuery,e={wrapper:"k-spreadsheet-formula-bar"},a=n.ui.Widget.extend({init:function(e,t){n.ui.Widget.call(this,e,t);e=this.element.addClass(a.classNames.wrapper);i("<span class='k-icon k-i-formula-fx' />").prependTo(e);var r=e.width();this.formulaInput=new n.spreadsheet.FormulaInput(i("<div/>").appendTo(e),{formulaBarWidth:r})},destroy:function(){if(this.formulaInput)this.formulaInput.destroy();this.formulaInput=null}});i.extend(true,n.spreadsheet.FormulaBar=a,{classNames:e})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/formulainput.min",["../kendo.core.min"],function(){var u=kendo,l=window,t=u.jQuery,r=u.ui.Widget,a=".kendoFormulaInput",n=u.keys,e={wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"},s=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"],o={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"},f=/(^_|[^a-z0-9]$)/i,i=r.extend({init:function(e,t){r.call(this,e,t);e=this.element;e.addClass(i.classNames.wrapper).attr("contenteditable",true).attr("spellcheck",false).css("white-space","pre");if(t&&t.formulaBarWidth)e.css("max-width",t.formulaBarWidth-16+"px");if(this.options.autoScale)e.on("input",this.scale.bind(this));this._highlightedRefs=[];this._formulaSource();this._formulaList();this._popup();this._tooltip();e.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this)).on("paste",this._paste.bind(this))},options:{name:"FormulaInput",autoScale:false,filterOperator:"startswith",scalePadding:30,minLength:1,formulaBarWidth:null},events:["keyup","focus"],enable:function(e){if(e===undefined)return this.element.attr("contenteditable")==="true";if(e)this.element.attr("contenteditable",e);else this.element.removeAttr("contenteditable");this.element.toggleClass("k-state-disabled",!e)},getPos:function(){var e=this.element[0];var t=l.getSelection();var r=a(t.focusNode,t.focusOffset);var n=a(t.anchorNode,t.anchorOffset);if(r!=null&&n!=null){if(r>n){var i=r;r=n;n=i}return{begin:r,end:n,collapsed:r==n}}function a(n,i){try{(function e(t){if(t===n)throw i;else if(t.nodeType==1)for(var r=t.firstChild;r;r=r.nextSibling)e(r);else if(t.nodeType==3)i+=t.nodeValue.length})(e)}catch(e){return e}}},setPos:function(e,t){var r=this.element[0];e=o(r,e);if(t!=null)t=o(r,t);else t=e;if(e&&t){var n=document.createRange();n.setStart(e.node,e.pos);n.setEnd(t.node,t.pos);var i=l.getSelection();var a=i.getRangeAt(0);if(s(n,a)){i.removeAllRanges();i.addRange(n)}}function s(e,t){return e.startOffset!=t.startOffset||e.endOffset!=t.endOffset||e.startContainer!=t.endContainer||e.endContainer!=t.endContainer}function o(e,i){try{(function e(t){if(t.nodeType==3){var r=t.nodeValue.length;if(r>=i)throw t;i-=r}else if(t.nodeType==1)for(var n=t.firstChild;n;n=n.nextSibling)e(n)})(e)}catch(e){return{node:e,pos:i}}}},end:function(){this.setPos(this.length())},home:function(){this.setPos(0)},select:function(){this.setPos(0,this.length())},length:function(){return this.value().length},_formulaSource:function(){var e=[];var t;for(var r in u.spreadsheet.calc.runtime.FUNCS)if(!f.test(r)){t=r.toUpperCase();e.push({value:t,text:t})}this.formulaSource=new u.data.DataSource({data:e})},_formulaList:function(){this.list=new u.ui.StaticList(t("<ul />").addClass(i.classNames.listWrapper).insertAfter(this.element),{autoBind:false,selectable:true,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"});this.list.element.on("mousedown",function(e){e.preventDefault()})},_formulaListChange:function(){var e=this._tokenContext();if(!e||this._mute)return;var t=e.token;var r=this.list.value()[0];var n={replace:true,token:t,end:t.end};if(!e.nextToken||e.nextToken.value!="(")r+="(";this._replaceAt(n,r);this.popup.close()},_popup:function(){this.popup=new u.ui.Popup(this.list.element,{anchor:this.element})},_blur:function(){this.popup.close();clearTimeout(this._focusId);this.trigger("blur")},_isFormula:function(){return/^=/.test(this.value())},_keydown:function(e){var t=e.keyCode;var r=this;if(o[t]){r.popup.close();r._navigated=true}else if(r._move(t)){r._navigated=true;e.preventDefault()}r._keyDownTimeout=setTimeout(r._syntaxHighlight.bind(r))},_keyup:function(){var e=this.popup;var t;if(this._isFormula()&&!this._navigated){t=((this._tokenContext()||{}).token||{}).value;this.filter(t);if(!t||!this.formulaSource.view().length)e.close();else{e[e.visible()?"position":"open"]();this.list.focusFirst()}}this._navigated=false;this._syntaxHighlight();this.trigger("keyup")},_input:function(){this._syntaxHighlight()},_focus:function(){setTimeout(this._sync.bind(this));this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this));this.trigger("focus")},_paste:function(e){e.preventDefault();var t=this.getPos();var r;if(u.support.browser.msie)r=l.clipboardData.getData("Text");else r=e.originalEvent.clipboardData.getData("text/plain");var n=this.value();n=n.substr(0,t.begin)+r+n.substr(t.end);this.value(n);this.setPos(t.begin+r.length);this.scale()},_move:function(e){var t=this.list;var r=this.popup;if(r.visible()){if(e===n.DOWN){t.focusNext();if(!t.focus())t.focusFirst();return true}if(e===n.UP){t.focusPrev();if(!t.focus())t.focusLast();return true}if(e===n.ENTER){t.select(t.focus());r.close();return true}if(e===n.TAB){t.select(t.focus());r.close();return true}if(e===n.PAGEUP){t.focusFirst();return true}if(e===n.PAGEDOWN){t.focusLast();return true}}return e===n.ENTER||e===n.TAB},_tokenContext:function(){var e=this.getPos();var t=this.value();if(!t||!e||!e.collapsed)return null;var r=u.spreadsheet.calc.tokenize(t,this.row(),this.col());var n;for(var i=0;i<r.length;++i){n=r[i];if(h(n,e)&&/^(?:str|sym|func)$/.test(n.type))return{token:n,nextToken:r[i+1]}}return null},_sync:function(){if(this._editorToSync&&this.isActive())this._editorToSync.value(this.value())},_textContainer:function(){var e=u.getComputedStyles(this.element[0],s);e.position="absolute";e.visibility="hidden";e.whiteSpace="pre";e.top=-3333;e.left=-3333;this._span=t("<span style='white-space: pre'/>").css(e).insertAfter(this.element)},_tooltip:function(){this._cellTooltip=t('<div class="k-widget k-tooltip" style="position:absolute; display:none">A1</div>').insertAfter(this.element)},tooltip:function(e){this._cellTooltip.text(e)},toggleTooltip:function(e){this._cellTooltip.toggle(e)},isActive:function(){return this.element[0]===u._activeElement()},filter:function(e){if(!e||e.length<this.options.minLength)return;this._mute=true;this.list.select(-1);this._mute=false;this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:e})},hide:function(){this.enable(false);this.element.hide();this._cellTooltip.hide()},show:function(){this.enable(true);this.element.show()},row:function(){if(this.activeCell)return this.activeCell.row},col:function(){if(this.activeCell)return this.activeCell.col},position:function(e){if(!e)return;this.show();this.element.css({top:e.top+1+"px",left:e.left+1+"px"});this._cellTooltip.css({top:e.top-this._cellTooltip.height()-10+"px",left:e.left})},resize:function(e){if(!e)return;this.element.css({width:e.width-1,height:e.height-1})},canInsertRef:function(e){return this._canInsertRef(e)},_canInsertRef:function(e){if(this.popup.visible())return null;var r=e;var n=this.getPos();var t,i;if(n&&this._isFormula()){if(n.begin===0)return null;t=u.spreadsheet.calc.tokenize(this.value(),this.row(),this.col());for(var a=0;a<t.length;++a){i=t[a];if(h(i,n))return o(i);if(s(i))return l(t[a-1],i)}return l(i,null)}return null;function s(e){return e.begin>n.begin}function o(e){if(e){if(/^(?:num|str|bool|sym|ref)$/.test(e.type))return{replace:true,token:e,end:e.end};if(/^(?:op|punc|startexp)$/.test(e.type)){if(e.end==n.end)return l(e,t[a+1]);return l(t[a-1],e)}}}function l(e,t){if(e==null)return null;if(t==null){if(/^(?:op|startexp)$/.test(e.type)||c(e.value))return{token:e,end:n.end};return null}if(r){if(e.type=="op"&&/^(?:punc|op)$/.test(t.type))return{token:e,end:n.end}}else{if(e.type=="startexp")return{token:e,end:n.end};if(/^(?:op|punc)$/.test(e.type)&&/^[,;({]$/.test(e.value))return{token:e,end:n.end};if(/^(?:ref|sym)/.test(e.type))return{token:e,replace:true,end:e.end};if(/^(?:ref|sym)/.test(t.type))return{token:t,replace:true,end:t.end}}return false}},refAtPoint:function(e){var t=this._canInsertRef();if(t){var r=e.selection()._ref.simplify().clone().relative(0,0,3);if(e.isMerged(r))r=r.topLeft;if(e!==this.activeSheet)r=r.setSheet(e.name(),true);this._replaceAt(t,r.print(0,0))}},_replaceAt:function(e,t){var r=this.value();var n=e.token;var i=r.substr(e.end);r=r.substr(0,e.replace?n.begin:e.end)+t;var a=r.length;r+=i;this._value(r);this.setPos(a);this.scale();this._syntaxHighlight()},syncWith:function(e){var t=this;var r="input"+a;var n=t._sync.bind(t),i;if(u.support.browser.msie){r="keydown"+a;i=function(){setTimeout(n)}}t._editorToSync=e;t.element.off(r).on(r,i||n)},scale:function(){var e=this.element;var t,r;if(!this._span)this._textContainer();this._span.html(e.html());t=this._span.width()+this.options.scalePadding;r=this._span.height();if(t>e.width())e.width(t);if(r>e.height())e.height(r);this._sync()},_value:function(e){this.element.text(e)},value:function(e){if(e===undefined){var t=this.element[0].innerText;return t.replace(/\n$/,"")}this._value(e);this._syntaxHighlight()},highlightedRefs:function(){return this._highlightedRefs.slice()},_syntaxHighlight:function(){var r=this.getPos();var i=this.value();var n=u.spreadsheet.Pane.classNames.series;var a=[];var s=0;var o=[];var e=[];var l;if(r&&!r.collapsed)return;if(!/^=/.test(i)){if(this._highlightedRefs.length){this._highlightedRefs=[];this.element.text(i)}if(this.popup)this.popup.close();return}else{e=u.spreadsheet.calc.tokenize(i,this.row(),this.col());e.forEach(function(e){e.active=false;e.cls=["k-syntax-"+e.type];if(e.type=="ref"){e.colorClass=n[s++%n.length];e.cls.push(e.colorClass);a.push(e)}if(r&&e.type=="punc")if(c(e.value))o.unshift(e);else if(d(e.value)){var t=o.shift();if(t)if(p(e.value,t.value)){if(h(e,r)||h(t,r)){e.cls.push("k-syntax-paren-match");t.cls.push("k-syntax-paren-match")}}else{e.cls.push("k-syntax-error");t.cls.push("k-syntax-error")}else e.cls.push("k-syntax-error")}if(r&&h(e,r)){e.cls.push("k-syntax-at-point");e.active=true;l=e}if(e.type=="func"&&!m(e.value)&&(!r||!h(e,r)))e.cls.push("k-syntax-error")});e.reverse().forEach(function(e){var t=e.begin,r=e.end;var n=u.htmlEncode(i.substring(t,r));i=i.substr(0,t)+"<span class='"+e.cls.join(" ")+"'>"+n+"</span>"+i.substr(r)});this.element.html(i)}if(r)this.setPos(r.begin,r.end);this._highlightedRefs=a},destroy:function(){this._editorToSync=null;this.element.off(a);clearTimeout(this._focusTimeout);clearTimeout(this._keyDownTimeout);this._cellTooltip=null;this._span=null;this.popup.destroy();this.popup=null;r.fn.destroy.call(this)},insertNewline:function(){var e=this.value();var t=this.getPos();var r=t.end==e.length;e=e.substr(0,t.begin)+(r?"\n\n":"\n"+e.substr(t.end));this.value(e);this.setPos(t.begin+1)}});function c(e){return e=="("||e=="["||e=="{"}function d(e){return e==")"||e=="]"||e=="}"}function p(e,t){return t=="("?e==")":t=="["?e=="]":t=="{"?e=="}":false}function h(e,t){return e.begin<=t.begin&&e.end>=t.end}function m(e){return u.spreadsheet.calc.runtime.FUNCS[e.toLowerCase()]}u.spreadsheet.FormulaInput=i,t.extend(true,i,{classNames:e})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/eventlistener.min",["../kendo.core.min"],function(){var e=window.kendo,i=e.jQuery,n={8:"backspace",9:"tab",13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",35:"end",36:"home",32:"spacebar",33:"pageup",34:"pagedown",46:"delete",113:":edit"},a=navigator.platform.toUpperCase().indexOf("MAC")>=0,s=function(e){if(e>47&&e<58||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223||e===229)return true;return false},t=function(e){var t=e.keyCode;var r=n[t];if(!r&&s(t))r=":alphanum";if(!r&&e.key&&e.key.length==1)r=":alphanum";return r},r=e.Class.extend({init:function(e,t,r){this._handlers={};this.target=e;this._observer=t||window;this.keyDownProxy=this.keyDown.bind(this);this.mouseProxy=this.mouse.bind(this);this.touchProxy=this.touch.bind(this);this.threshold=5;this._pressLocation=null;e.on("keydown",this.keyDownProxy);e.on("contextmenu mousedown cut copy paste scroll wheel click dblclick focus",this.mouseProxy);e.on("touchmove touchend",this.touchProxy);i(document.documentElement).on("mousemove mouseup",this.mouseProxy);i(document.documentElement).on("touchmove touchend",this.touchProxy);if(r)for(var n in r)this.on(n,r[n])},keyDown:function(e){this.handleEvent(e,t(e.originalEvent))},touch:function(e){this.handleEvent(e,e.type)},mouse:function(e){var t;if(e.which)t=e.which==3;else if(e.button)t=e.button==2;var r=e.type;if(r==="mousedown")if(t)r="rightmousedown";else this._pressLocation={x:e.pageX,y:e.pageY};if(r==="mouseup")if(!t)this._pressLocation=null;if(r==="mousemove"&&this._pressLocation){var n=this._pressLocation.x-e.pageX;var i=this._pressLocation.y-e.pageY;var a=Math.sqrt(n*n+i*i);if(a>this.threshold)r="mousedrag"}this.handleEvent(e,r)},handleEvent:function(e,t){var r="";e.mod=a?e.metaKey:e.ctrlKey&&!e.altKey;if(e.altKey)r+="alt+";if(e.shiftKey)r+="shift+";if(e.ctrlKey)r+="ctrl+";r+=t;var n=this._handlers["*+"+t];if(n)n.call(this._observer,e,r);var i=this._handlers[r];if(i)i.call(this._observer,e,r)},on:function(e,t){var r=this._handlers;if(typeof t==="string")t=this._observer[t];if(typeof e==="string")e=e.split(",");e.forEach(function(e){r[e]=t})},destroy:function(){this.target.off("keydown",this.keyDownProxy);this.target.off("keydown",this.mouseProxy);i(document.documentElement).off("mousemove mouseup",this.mouseProxy)}});e.spreadsheet.EventListener=r})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/rangelist.min",["../kendo.core.min"],function(){var e=kendo,h=e.Class.extend({init:function e(t,r,n,i){this.level=t;this.value=r;this.left=n;this.right=i}}),i=new function e(){this.left=this;this.right=this;this.level=0};function a(e){if(e.left.level===e.level){var t=e;e=e.left;t.left=e.right;e.right=t}return e}function s(e){if(e.right.right.level===e.level){var t=e;e=e.right;t.right=e.left;e.left=t;e.level+=1}return e}function r(e,t){if(e===i)return new h(1,t,i,i);else if(e.value.start>t.start)e.left=r(e.left,t);else e.right=r(e.right,t);return s(a(e))}function o(e,t){if(e===i)return e;var r=e.value.start-t.start;if(r===0)if(e.left!==i&&e.right!==i){var n=e.left;while(n.right!==i)n=n.right;e.value=n.value;e.left=o(e.left,e.value)}else if(e.left===i)e=e.right;else e=e.left;else if(r>0)e.left=o(e.left,t);else e.right=o(e.right,t);if(e.left.level<e.level-1||e.right.level<e.level-1){e.level-=1;if(e.right.level>e.level)e.right.level=e.level;e=a(e);e.right=a(e.right);e.right.right=a(e.right.right);e=s(e);e.right=s(e.right)}return e}var l=e.Class.extend({init:function e(t,r,n){this.start=t;this.end=r;this.value=n},intersects:function(e){return e.start<=this.end&&e.end>=this.start},clone:function(){return new l(this.start,this.end,this.value)}}),n=e.Class.extend({init:function(){this.root=i},insert:function(e){this.root=r(this.root,e)},remove:function(e){this.root=o(this.root,e)},findrange:function(e){var t=this.root;while(t!=i)if(e<t.value.start)t=t.left;else if(e>t.value.end)t=t.right;else return t.value;return null},values:function(){var e=[];u(this.root,e);return e},intersecting:function(e,t){var r=[];c(this.root,new l(e,t),r);return r},map:function(e){var t=new n;f(t,this.root,e);return t},clone:function(){return this.map(function(e){return e.clone()})},first:function(){var e=this.root;while(e.left!=i)e=e.left;return e},last:function(){var e=this.root;while(e.right!=i)e=e.right;return e}});function u(e,t){if(e===i)return;u(e.left,t);t.push(e.value);u(e.right,t)}function c(e,t,r){if(e===i)return;var n=e.value;if(t.start<n.start)c(e.left,t,r);if(n.intersects(t))r.push(n);if(t.end>n.end)c(e.right,t,r)}function f(e,t,r){if(t===i)return;f(e,t.left,r);e.insert(r(t.value));f(e,t.right,r)}var t=e.Class.extend({init:function(e,t,r){if(t===undefined)this.tree=e;else{this.tree=new n;this.tree.insert(new l(e,t,r))}},values:function(){return this.tree.values()},map:function(e){return new t(this.tree.map(e))},intersecting:function(e,t){return this.tree.intersecting(e,t)},first:function(){return this.tree.first().value},last:function(){return this.tree.last().value},insert:function(e,t,r){return this.tree.insert(new l(e,t,r))},value:function(e,t,r){if(r===undefined){if(t===undefined)t=e;return this.intersecting(e,t)[0].value}var n=this.tree.intersecting(e-1,t+1);if(n.length){var i=n[0],a=n[n.length-1];if(i.end<e)if(i.value===r)e=i.start;else n.shift();if(a.start>t)if(a.value===r)t=a.end;else n.pop();for(var s=0,c=n.length;s<c;s++){var o=n[s];var l=o.value;var u=o.start;var h=o.end;this.tree.remove(o);if(u<e)if(l!==r)this.insert(u,e-1,l);else e=u;if(h>t)if(l!==r)this.insert(t+1,h,l);else t=h}}this.insert(e,t,r)},expandedValues:function(e,t){var r=this.intersecting(e,t);var n=[];var i=0;for(var a=e;a<=t;a++){if(r[i].end<a)i++;n.push({index:a-e,value:r[i].value})}return n},sortedIndices:function(e,t,i,a){var r=this.expandedValues(e,t);var n=function(e,t){if(e.value===t.value)return e.index-t.index;return i(e.value,t.value)};if(a)n=function(e,t){var r=a[e.index];var n=a[t.index];if(r.value===n.value)return i(e.value,t.value);return e.index-t.index};r.sort(n);return r},sort:function(e,t,r){if(this.intersecting(e,t).length===1)return;var n=this.expandedValues(e,t);for(var i=0,a=r.length;i<a;i++)this.value(i+e,i+e,n[r[i].index].value)},copy:function(e,t,r){var n=this.intersecting(e,t);var i=r;var a;for(var s=0,o=n.length;s<o;s++){var l=n[s].start;if(l<e)l=e;var u=n[s].end;if(u>t)u=t;a=i+(u-l);this.value(i,a,n[s].value);i=++a}},iterator:function(e,t){return new d(e,t,this.intersecting(e,t))},getState:function(){return this.tree.clone()},setState:function(e){this.tree=e.clone()},toJSON:function(){return this.values()},fromJSON:function(e){e.forEach(function(e){this.value(e.start,e.end,e.value)},this)}}),d=e.Class.extend({init:function(e,t,r){this.start=e;this.end=t;this.index=0;this.ranges=r},unique:function(){return this.ranges.map(function(e){return e.value})},at:function(e){while(this.ranges[this.index]&&this.ranges[this.index].end<e)this.index++;return this.ranges[this.index]&&this.ranges[this.index].value},forEach:function(e){for(var t=this.start;t<=this.end;t++)e(this.at(t),t);this.index=0}}),p=t.extend({init:function(e,t,r){this.tree=new n;this.range=new l(e,t,r)},intersecting:function(e,t){var r=this.tree.intersecting(e,t);var n=[];var i;if(!r.length)return[this.range];for(var a=0,s=r.length;a<s;a++){i=r[a];if(i.start>e)n.push(new l(e,i.start-1,this.range.value));n.push(i);e=i.end+1}if(i.end<t)n.push(new l(i.end+1,t,this.range.value));return n},insert:function(e,t,r){if(r!==this.range.value)this.tree.insert(new l(e,t,r))},lastRangeStart:function(){var e=this.tree.root;if(e===i)return this.range.start;while(e.right!==i)e=e.right;return e.value.end+1}});e.spreadsheet.RangeTree=n,e.spreadsheet.RangeList=t,e.spreadsheet.SparseRangeList=p,e.spreadsheet.ValueRange=l})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/propertybag.min",["../kendo.core.min"],function(){var s=window.kendo,r=s.Class.extend({init:function(e){this.list=e},get:function(e){return this.parse(this.list.value(e,e))},set:function(e,t,r){if(r===undefined){r=t;t=e}this.list.value(e,t,r)},parse:function(e){return e},copy:function(e,t,r){this.list.copy(e,t,r)},iterator:function(e,t){return this.list.iterator(e,t)}}),e=r.extend({set:function(e,t,r){this.list.value(e,t,JSON.stringify(r))},parse:function(e){return JSON.parse(e)}}),t=r.extend({init:function(e,t){r.prototype.init.call(this,e);this.formats=t},set:function(e,t,r){if(r instanceof Date){r=s.spreadsheet.dateToNumber(r);if(!this.formats.value(e,t))this.formats.value(e,t,n(s.culture().calendar.patterns.d))}else if(typeof r=="number")r=s.spreadsheet.calc.runtime.limitPrecision(r);this.list.value(e,t,r)}});function n(e){return e.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm")}function i(e){e=e.clone();e.value=e.value.deepClone();return e}function o(){var e=this.map(i);e.clone=o;return e}s.spreadsheet.PropertyBag=s.Class.extend({specs:[{property:r,name:"format",value:null,sortable:true,serializable:true},{property:t,name:"value",value:null,sortable:true,serializable:true,depends:"format"},{property:r,name:"formula",value:null,sortable:true,serializable:true},{property:r,name:"background",value:null,sortable:true,serializable:true},{property:e,name:"vBorders",value:null,sortable:false,serializable:false},{property:e,name:"hBorders",value:null,sortable:false,serializable:false},{property:r,name:"color",value:null,sortable:true,serializable:true},{property:r,name:"fontFamily",value:null,sortable:true,serializable:true},{property:r,name:"underline",value:null,sortable:true,serializable:true},{property:r,name:"fontSize",value:null,sortable:true,serializable:true},{property:r,name:"italic",value:null,sortable:true,serializable:true},{property:r,name:"bold",value:null,sortable:true,serializable:true},{property:r,name:"textAlign",value:null,sortable:true,serializable:true},{property:r,name:"indent",value:null,sortable:true,serializable:true},{property:r,name:"verticalAlign",value:null,sortable:true,serializable:true},{property:r,name:"wrap",value:null,sortable:true,serializable:true},{property:r,name:"validation",value:null,sortable:false,serializable:true},{property:r,name:"enable",value:null,sortable:false,serializable:true},{property:r,name:"link",value:null,sortable:true,serializable:true},{property:r,name:"editor",value:null,sortable:true,serializable:true},{property:r,name:"comment",value:null,sortable:true,serializable:true},{property:r,name:"html",value:null,sortable:true,serializable:true}],init:function(e,t,i){i=i||{};var a=e*t-1;this.rowCount=e;this.columnCount=t;this.cellCount=a;this.properties={};this.lists={};this.specs.forEach(function(e){var t=e.name;var r=i[t];if(r===undefined)r=e.value;this.lists[t]=new s.spreadsheet.SparseRangeList(0,a,r);var n=this.properties[t]=new e.property(this.lists[t],this.lists[e.depends]);n.spec=e},this);this.lists.formula.tree.clone=o;this.lists.validation.tree.clone=o},getState:function(){var t={};this.specs.forEach(function(e){t[e.name]=this.lists[e.name].getState()},this);return t},setState:function(t){this.specs.forEach(function(e){this.lists[e.name].setState(t[e.name])},this)},get:function(e,t){if(t===undefined)return this.lists[e];switch(e){case"borderRight":t+=this.rowCount;case"borderLeft":e="vBorders";break;case"borderBottom":t++;case"borderTop":e="hBorders";break}return t>this.cellCount?null:this.properties[e].get(t)},set:function(e,t,r,n){switch(e){case"borderRight":t+=this.rowCount;r+=this.rowCount;case"borderLeft":e="vBorders";break;case"borderBottom":t++;r++;case"borderTop":e="hBorders";break}if(t<=r&&r<=this.cellCount)this.properties[e].set(t,r,n)},fromJSON:function(t,r){for(var e=0;e<this.specs.length;e++){var n=this.specs[e];if(n.serializable)if(r[n.name]!==undefined)this.set(n.name,t,t,r[n.name],false)}["borderLeft","borderRight","borderTop","borderBottom"].forEach(function(e){if(r[e]!==undefined)this.set(e,t,t,r[e])},this)},copy:function(t,r,n){this.specs.forEach(function(e){this.properties[e.name].copy(t,r,n)},this)},iterator:function(e,t,r){var n=this.properties[e];var i=n.iterator(t,r),a=i.at;var s=this.cellCount;i.at=function(e){return e>s?null:n.parse(a.call(i,e))};i.name=e;i.value=n.spec.value;return i},sortable:function(){return this.specs.filter(function(e){return e.sortable}).map(function(e){return this.lists[e.name]},this)},iterators:function(r,n){return this.specs.reduce(function(e,t){if(t.serializable)e.push(this.iterator(t.name,r,n));return e}.bind(this),[])},forEach:function(e,t,c){var r=this.iterators(e,t);var n=this.iterator("hBorders",e,t+1);var h=this.iterator("vBorders",e,t);var f=this.iterator("vBorders",e+this.rowCount,t+this.rowCount);var i,a;function s(e,t,r){var n=t.at(r);if(n!==t.value)i[e]=n}for(a=e;a<=t;a++){i={};for(var o=0;o<r.length;o++){var l=r[o];var u=l.at(a);if(u!==l.value)i[l.name]=u}s("borderLeft",h,a);s("borderRight",f,a+this.rowCount);s("borderTop",n,a);if((a+1)%this.rowCount)s("borderBottom",n,a+1);c(i)}},forEachProperty:function(e){for(var t in this.properties)e(this.properties[t])}}),s.spreadsheet.ALL_PROPERTIES=s.spreadsheet.PropertyBag.prototype.specs.reduce(function(e,t){if(t.serializable)e.push(t.name);return e},["borderTop","borderRight","borderBottom","borderLeft"])})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/references.min",["../kendo.core.min"],function(){"use strict";var e=kendo.spreadsheet,n;function a(e){var t=Math.floor(e/26)-1;return(t>=0?a(t):"")+String.fromCharCode(65+e%26)}function l(e){if(/^[a-z_][a-z0-9_]*$/i.test(e))return e;return"'"+e.replace(/\x27/g,"\\'")+"'"}function u(e,t,r,n){var i="";++t;if(!isFinite(t))t="";else if(n!=null&&!(n&2))t="$"+t;if(!isFinite(r))r="";else{i=a(r);if(n!=null&&!(n&1))i="$"+i}if(e)return l(e)+"!"+i+t;else return i+t}var t=kendo.Class.extend({type:"ref",sheet:"",clone:function(){return this},hasSheet:function(){return this._hasSheet},simplify:function(){return this},setSheet:function(e,t){this.sheet=e;if(t!=null)this._hasSheet=t;return this},absolute:function(){return this},relative:function(){return this},adjust:function(){return this},toString:function(){return this.relative(0,0,3,3).print(0,0)},forEach:function(e,t){e.call(t,this)},map:function(e,t){return e.call(t,this)},intersects:function(e){return this.intersect(e)!==c},isCell:function(){return false},toRow:function(){return this},toColumn:function(){return this},first:function(){return this},lastRange:function(){return this},size:function(){return 1},rangeAt:function(){return this},nextRangeIndex:function(){return 0},previousRangeIndex:function(){return 0},eq:function(e){var t=this;var r=e;if(t===c||r===c)return t===r;if(r instanceof f||r instanceof h&&!(t instanceof f)){t=e;r=this}if(t instanceof f){r=r.simplify();return r instanceof f&&t.row==r.row&&t.col==r.col&&t.sheet==r.sheet}else if(t instanceof h){if(r instanceof h)return r.topLeft.eq(t.topLeft)&&r.bottomRight.eq(t.bottomRight);if(r instanceof o)return r.single()&&t.eq(r.refs[0])}else if(t instanceof o&&r instanceof o){var n=t.refs;var i=r.refs;if(n.length!=i.length)return false;for(var a=0,s=n.length;a<s;a++)if(!n[a].eq(i[a]))return false;return true}return t===r},concat:function(e){return new o([this,e])},replaceAt:function(e,t){return t},forEachColumnIndex:function(e){this.forEachAxisIndex("col",e)},forEachRowIndex:function(e){this.forEachAxisIndex("row",e)},forEachAxisIndex:function(r,e){var n=[];var t=r==="row"?"forEachRow":"forEachColumn";this[t](function(e){var t=e.first()[r];if(n.indexOf(t)===-1)n.push(t)});n.sort(function(e,t){return e>t?1:e<t?-1:0}).forEach(e)},valid:function(){return false},renameSheet:function(e,t){if(this.sheet&&this.sheet.toLowerCase()==e.toLowerCase()){this.sheet=t;return true}}}),c=(t.display=u,new(t.extend({init:function e(){},print:function(){return"#NULL!"},eq:function(e){return e===this},forEach:function(){}}))),r=t.extend({ref:"name",init:function e(t){this.name=t},clone:function(){return new r(this.name).setSheet(this.sheet,this.hasSheet())},print:function(){var e=l(this.name);if(this.hasSheet())e=l(this.sheet)+"!"+e;return e}}),f=t.extend({ref:"cell",init:function e(t,r,n){this.row=t;this.col=r;this.rel=n||0},clone:function(){return new f(this.row,this.col,this.rel).setSheet(this.sheet,this.hasSheet())},intersect:function(e){if(e instanceof f)if(this.eq(e))return this;else return c;return e.intersect(this)},print:function(e,t,r){var n=this.col,i=this.row,a=this.rel,s;if(e==null&&a){var o=this.hasSheet()?l(this.sheet)+"!":"";if(isFinite(n))n=a&1?"C["+n+"]":"C"+(n+1);else n="";if(isFinite(i))i=a&2?"R["+i+"]":"R"+(i+1);else i="";return o+i+n}else{s=this.absolute(e,t);if(r){i=s.row%1048576;n=s.col%16384;if(i<0)i+=1048576;if(n<0)n+=16384;return u(this._hasSheet&&this.sheet,i,n,a)}return s.valid()?u(this._hasSheet&&this.sheet,s.row,s.col,a):"#REF!"}},absolute:function(e,t){var r=this.clone();if(r.rel&3===0)return r;if(r.rel&1)r.col=(r.col+t)%16384;if(r.rel&2)r.row=(r.row+e)%1048576;r.rel=0;return r},toRangeRef:function(){return new h(this,this)},relative:function(e,t,r){if(r==null)r=this.rel;var n=r&2?this.row-e:this.row;var i=r&1?this.col-t:this.col;return new f(n,i,r).setSheet(this.sheet,this.hasSheet())},height:function(){return 1},width:function(){return 1},toString:function(){return u(null,this.row,this.col,3)},isCell:function(){return true},leftColumn:function(){return this},rightColumn:function(){return this},topRow:function(){return this},bottomRow:function(){return this},forEachRow:function(e){e(this.toRangeRef())},forEachColumn:function(e){e(this.toRangeRef())},adjust:function(e,t,r,n,i,a,s){var o=this.absolute(e,t);if(i){if(o.row>=a){if(s<0&&o.row<a-s)return c;o.row+=s}}else if(o.col>=a){if(s<0&&o.col<a-s)return c;o.col+=s}if(r!=null&&n!=null)o=o.relative(r,n,this.rel);return o},valid:function(){if(this.rel)throw new Error("valid() called on relative reference");var e=this.col,t=this.row;return!(isFinite(e)&&e<0||isFinite(t)&&t<0)}}),h=t.extend({ref:"range",init:function e(t,r){if(t._hasSheet&&r._hasSheet&&t.sheet.toLowerCase()!=r.sheet.toLowerCase())this.endSheet=r.sheet;this.topLeft=new f(t.row,t.col,t.rel);this.bottomRight=new f(r.row,r.col,r.rel);this.normalize()},clone:function(){return new h(this.topLeft.clone(),this.bottomRight.clone()).setSheet(this.sheet,this.hasSheet())},_containsRange:function(e){return this._containsCell(e.topLeft)&&this._containsCell(e.bottomRight)},_containsCell:function(e){return e.sheet==this.sheet&&e.row>=this.topLeft.row&&e.col>=this.topLeft.col&&e.row<=this.bottomRight.row&&e.col<=this.bottomRight.col},contains:function(e){if(e instanceof Array){var t=this;return e.some(function(e){return t.contains(e)})}if(e instanceof f)return this._containsCell(e);if(e instanceof h)return this._containsRange(e);return false},_intersectRange:function(e){if(this.sheet!=e.sheet)return c;var t=this.topLeft.col;var r=this.topLeft.row;var n=this.bottomRight.col;var i=this.bottomRight.row;var a=e.topLeft.col;var s=e.topLeft.row;var o=e.bottomRight.col;var l=e.bottomRight.row;if(t<=o&&a<=n&&r<=l&&s<=i)return new h(new f(Math.max(r,s),Math.max(t,a)),new f(Math.min(i,l),Math.min(n,o))).setSheet(this.sheet,this.hasSheet());else return c},intersect:function(e){if(e instanceof f)return this._containsCell(e)?e:c;if(e instanceof h)return this._intersectRange(e).simplify();if(e instanceof o)return e.intersect(this);return c},simplify:function(){if(this.isCell())return new f(this.topLeft.row,this.topLeft.col,this.topLeft.rel).setSheet(this.sheet,this.hasSheet());return this},normalize:function(){var e=this.topLeft,t=this.bottomRight;var r=e.row,n=e.col,i=t.row,a=t.col;var s=e.rel&2,o=e.rel&1;var l=t.rel&2,c=t.rel&1;var u,h=false;if(s===l&&o===c){if(r>i){h=true;u=r;r=i;i=u;u=s;s=l;l=u}if(n>a){h=true;u=n;n=a;a=u;u=o;o=c;c=u}if(h){this.topLeft=new f(r,n,o|s);this.bottomRight=new f(i,a,c|l)}}return this},print:function(e,t,r){if(r||this.absolute(e,t).valid()){var n=this.topLeft.print(e,t,r)+":"+this.bottomRight.print(e,t,r);if(this.hasSheet())n=l(this.sheet)+(this.endSheet?":"+l(this.endSheet):"")+"!"+n;return n}return"#REF!"},absolute:function(e,t){return new h(this.topLeft.absolute(e,t),this.bottomRight.absolute(e,t)).setSheet(this.sheet,this.hasSheet())},relative:function(e,t,r,n){if(n==null)n=r;return new h(this.topLeft.relative(e,t,r),this.bottomRight.relative(e,t,n)).setSheet(this.sheet,this.hasSheet())},height:function(){if(this.topLeft.rel!=this.bottomRight.rel)throw new Error("Mixed relative/absolute references");return this.bottomRight.row-this.topLeft.row+1},width:function(){if(this.topLeft.rel!=this.bottomRight.rel)throw new Error("Mixed relative/absolute references");return this.bottomRight.col-this.topLeft.col+1},collapse:function(){return this.topLeft.toRangeRef()},leftColumn:function(){return new h(this.topLeft,new f(this.bottomRight.row,this.topLeft.col))},rightColumn:function(){return new h(new f(this.topLeft.row,this.bottomRight.col),this.bottomRight)},topRow:function(){return new h(this.topLeft,new f(this.topLeft.row,this.bottomRight.col))},bottomRow:function(){return new h(new f(this.bottomRight.row,this.topLeft.col),this.bottomRight)},toRangeRef:function(){return this},toRow:function(e){e+=Math.max(0,this.topLeft.row);return new h(new f(e,this.topLeft.col),new f(e,this.bottomRight.col)).setSheet(this.sheet,this.hasSheet())},toColumn:function(e){e+=Math.max(0,this.topLeft.col);return new h(new f(this.topLeft.row,e),new f(this.bottomRight.row,e)).setSheet(this.sheet,this.hasSheet())},toCell:function(e,t){e+=Math.max(0,this.topLeft.row);t+=Math.max(0,this.topLeft.col);return new f(e,t,0).setSheet(this.sheet,this.hasSheet())},forEachRow:function(e){var t=this.topLeft.row;var r=this.bottomRight.row;var n=this.topLeft.col;var i=this.bottomRight.col;for(var a=t;a<=r;a++)e(new h(new f(a,n),new f(a,i)))},forEachColumn:function(e){var t=this.topLeft.row;var r=this.bottomRight.row;var n=this.topLeft.col;var i=this.bottomRight.col;for(var a=n;a<=i;a++)e(new h(new f(t,a),new f(r,a)))},intersecting:function(e){return e.filter(function(e){return e.toRangeRef().intersects(this)},this)},union:function(e,t){var r=this.intersecting(e);var n=this.topLeft.row;var i=this.topLeft.col;var a=this.bottomRight.row;var s=this.bottomRight.col;var o=false;r.forEach(function(e){e=e.toRangeRef();if(e.topLeft.row<n){o=true;n=e.topLeft.row}if(e.topLeft.col<i){o=true;i=e.topLeft.col}if(e.bottomRight.row>a){o=true;a=e.bottomRight.row}if(e.bottomRight.col>s){o=true;s=e.bottomRight.col}if(t)t(e)});var l=new h(new f(n,i),new f(a,s));if(o)return l.union(e,t);else return l},resize:function(e){var t=Math.max.bind(Math,0);function r(e){return e||0}var n=this.topLeft.row+r(e.top);var i=this.topLeft.col+r(e.left);var a=this.bottomRight.row+r(e.bottom);var s=this.bottomRight.col+r(e.right);if(i<0&&s<0||n<0&&a<0)return c;else if(n<=a&&i<=s)return new h(new f(t(n),t(i)),new f(t(a),t(s)));else return c},move:function(e,t){return new h(new f(this.topLeft.row+e,this.topLeft.col+t),new f(this.bottomRight.row+e,this.bottomRight.col+t))},first:function(){return this.topLeft.clone().setSheet(this.sheet,this.hasSheet())},isCell:function(){return!this.endSheet&&this.topLeft.eq(this.bottomRight)},toString:function(){return this.topLeft+":"+this.bottomRight},adjust:function(e,t,r,n,i,a,s){var o=this.topLeft.adjust(e,t,r,n,i,a,s);var l=this.bottomRight.adjust(e,t,r,n,i,a,s);if(o===c&&l===c)return c;if(o===c){o=this.topLeft.absolute(e,t);if(i)o.row=a;else o.col=a;if(r!=null&&n!=null)o=o.relative(r,n,this.topLeft.rel)}else if(l===c){l=this.bottomRight.absolute(e,t);if(i)l.row=a-1;else l.col=a-1;if(r!=null&&n!=null)l=l.relative(r,n,this.bottomRight.rel)}return new h(o,l).setSheet(this.sheet,this.hasSheet()).simplify()},valid:function(){return this.topLeft.valid()&&this.bottomRight.valid()}}),o=t.extend({init:function e(t){this.refs=t;this.length=t.length},clone:function(){return new o(this.refs.slice())},intersect:function(e){var t=[];for(var r=0;r<this.length;++r){var n=e.intersect(this.refs[r]);if(n!==c)t.push(n)}if(t.length>0)return new o(t).simplify();return c},simplify:function(){var e=new o(this.refs.reduce(function(e,t){t=t.simplify();if(t!==c)e.push(t);return e},[]));if(e.empty())return c;if(e.single())return e.refs[0];return e},absolute:function(t,r){return new o(this.refs.map(function(e){return e.absolute(t,r)}))},forEach:function(t,r){this.refs.forEach(function(e){if(e instanceof o)e.forEach(t,r);else t.call(r,e)},r)},toRangeRef:function(){return this.refs[0].toRangeRef()},contains:function(t){return this.refs.some(function(e){return e.contains(t)})},map:function(t,r){var n=[];this.forEach(function(e){n.push(t.call(r,e))});return new o(n)},first:function(){return this.refs[0].first()},lastRange:function(){return this.refs[this.length-1]},size:function(){return this.length},single:function(){return this.length==1},empty:function(){return this.length===0},isCell:function(){return this.single()&&this.refs[0].isCell()},rangeAt:function(e){return this.refs[e]},nextRangeIndex:function(e){if(e===this.length-1)return 0;else return e+1},previousRangeIndex:function(e){if(e===0)return this.length-1;else return e-1},concat:function(e){return new o(this.refs.concat([e]))},print:function(t,r,n){return this.refs.map(function(e){return e.print(t,r,n)}).join(",")},replaceAt:function(e,t){var r=this.refs.slice();r.splice(e,1,t);return new o(r)},leftColumn:function(){return this.map(function(e){return e.leftColumn()})},rightColumn:function(){return this.map(function(e){return e.rightColumn()})},topRow:function(){return this.map(function(e){return e.topRow()})},bottomRow:function(){return this.map(function(e){return e.bottomRow()})},forEachRow:function(t){this.forEach(function(e){e.forEachRow(t)})},forEachColumn:function(t){this.forEach(function(e){e.forEachColumn(t)})},adjust:function(t,r,n,i,a,s,o){return this.map(function(e){return e.adjust(t,r,n,i,a,s,o)}).simplify()},toString:function(){return this.refs.map(function(e){return e.toString()}).join(", ")},valid:function(){for(var e=this.refs.length;--e>=0;)if(this.refs[e].valid())return false;return true},renameSheet:function(t,r){this.refs.forEach(function(e){e.renameSheet(t,r)})}});e.NULLREF=c,e.SHEETREF=new h(new f(0,0),new f(Infinity,Infinity)),e.FIRSTREF=new f(0,0),e.Ref=t,e.NameRef=r,e.CellRef=f,e.RangeRef=h,e.UnionRef=o,e.SHEETREF.print=function(){return"#SHEET"}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/autofillcalculator.min",["../kendo.core.min"],function(){var e=kendo,d=e.spreadsheet.RangeRef,p=e.spreadsheet.CellRef,t=e.Class.extend({init:function(e){this._grid=e},rectIsVertical:function(e,t,r,n){var i=this._grid.rectangle(e.toRangeRef());var a=this._grid.rectangle(t.toRangeRef());return Math.abs(a[n]-i[n])>Math.abs(i[r]-a[r])},autoFillDest:function(e,t){var r=e.topLeft;var n=e.bottomRight;var i;var c=t.row>=r.row;var a=t.col>=r.col;if(c)i=a?4:3;else i=a?2:1;var s,o,l,u;if(i===4){s=r;o=n;u=t.row>o.row||t.col>o.col;if(u)t=new p(Math.max(t.row,o.row),Math.max(t.col,o.col));if(this.rectIsVertical(o,t,"right","bottom"))l=new p(t.row,o.col);else l=new p(o.row,t.col)}else if(i===3){var h=new p(r.col,n.row);if(t.row>n.row&&this.rectIsVertical(h,t,"left","bottom")){s=r;l=new p(t.row,n.col)}else{s=n;l=new p(r.row,t.col)}}else if(i===2){var f=new p(r.row,n.col);if(t.col>n.col&&!this.rectIsVertical(f,t,"right","top")){s=r;l=new p(n.row,t.col)}else{s=n;l=new p(t.row,r.col)}}else{s=n;if(this.rectIsVertical(r,t,"left","top"))l=new p(t.row,r.col);else l=new p(r.row,t.col)}return this._grid.normalize(new d(s,l))}});e.spreadsheet.AutoFillCalculator=t})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/navigator.min",["../kendo.core.min","./autofillcalculator.min"],function(){var _=kendo,p=_.spreadsheet.RangeRef,k=_.spreadsheet.CellRef,t=_.Class.extend({init:function(n,i,e,a){this.rangeGetter=e;this.prevLeft=function(e){var t=a(this.range(e));var r=this.range(i.prevVisible(t.topLeft[n]));return a(r).topLeft[n]};this.nextRight=function(e){var t=a(this.range(e));var r=this.range(i.nextVisible(t.bottomRight[n]));return a(r).bottomRight[n]};this.nextLeft=function(e){var t=a(this.range(e));return i.nextVisible(t.bottomRight[n])};this.prevRight=function(e){var t=a(this.range(e));return i.prevVisible(t.topLeft[n])}},boundary:function(e,t){this.top=e;this.bottom=t},range:function(e){return this.rangeGetter(e,this.top,this.bottom)}}),e=_.Class.extend({init:function(e){this._sheet=e;this.autoFillCalculator=new _.spreadsheet.AutoFillCalculator(e._grid);this.colEdge=new t("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));this.rowEdge=new t("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this))},height:function(e){this._viewPortHeight=e},union:function(e){return this._sheet.unionWithMerged(e)},columnRange:function(e,t,r){return this._sheet._ref(t,e,r-t,1)},rowRange:function(e,t,r){return this._sheet._ref(e,t,1,r-t)},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells)},setSelectionValue:function(e){var t=this._sheet.selection();setTimeout(function(){t.value(e())})},selectAll:function(){this._sheet.select(this._sheet._sheetRef)},select:function(e,t,r){e=this.refForMode(e,t);if(r)e=this._sheet.select().concat(e);this._sheet.select(e)},refForMode:function(e,t){var r=this._sheet._grid;switch(t){case"range":e=r.normalize(e);break;case"row":e=r.rowRef(e.row);break;case"column":e=r.colRef(e.col);break;case"sheet":e=this._sheet._sheetRef;break}return e},startSelection:function(e,t,r,n,i){if(t=="autofill")this._sheet.startAutoFill();else if(n&&t=="range"){var a=new p(this._sheet.activeCell().first(),e);this._sheet.select(a,false,false);this._sheet.startSelection(i)}else{this._sheet.startSelection(i);this.select(e,t,r)}},completeSelection:function(){this._sheet.completeSelection()},selectForContextMenu:function(e,t){var r=this._sheet;r._activeDrawing=null;if(!r.select().contains(this.refForMode(e,t)))this.select(e,t)},selectDrawingForContextMenu:function(e){var t=this._sheet;t._activeDrawing=e;t.triggerChange({selection:true})},modifySelection:function(c){var h=this.determineDirection(c);var e=this._sheet;var t=this._viewPortHeight;var r=e._grid._rows;var n=e._grid._columns;var f=e.currentOriginalSelectionRange();var i=e.select().toRangeRef();var a=e.activeCell();var s=f.topLeft.clone();var o=f.bottomRight.clone();var l=new k(o.row,s.col);var u;this.colEdge.boundary(i.topLeft.row,i.bottomRight.row);this.rowEdge.boundary(i.topLeft.col,i.bottomRight.col);switch(h){case"expand-left":s.col=this.colEdge.prevLeft(s.col);u=s;break;case"shrink-right":s.col=this.colEdge.nextLeft(s.col);u=s;break;case"expand-right":o.col=this.colEdge.nextRight(o.col);u=o;break;case"shrink-left":o.col=this.colEdge.prevRight(o.col);u=o;break;case"expand-up":s.row=this.rowEdge.prevLeft(s.row);u=s;break;case"shrink-down":s.row=this.rowEdge.nextLeft(s.row);u=s;break;case"expand-down":o.row=this.rowEdge.nextRight(o.row);u=o;break;case"shrink-up":o.row=this.rowEdge.prevRight(o.row);u=o;break;case"expand-page-up":s.row=r.prevPage(s.row,t);break;case"shrink-page-up":o.row=r.prevPage(o.row,t);break;case"expand-page-down":o.row=r.nextPage(o.row,t);break;case"shrink-page-down":s.row=r.nextPage(s.row,t);break;case"first-col":s.col=n.firstVisible();o.col=a.bottomRight.col;u=s;break;case"last-col":o.col=n.lastVisible();s.col=a.topLeft.col;u=o;break;case"first-row":s.row=r.firstVisible();o.row=a.bottomRight.row;u=s;break;case"last-row":o.row=r.lastVisible();s.row=a.topLeft.row;u=o;break;case"last":o.row=r.lastVisible();o.col=n.lastVisible();s=a.topLeft;u=o;break;case"first":s.row=r.firstVisible();s.col=n.firstVisible();o=a.bottomRight;u=s;break;case"expand-word-right":o.col=n.nextUntil(o.col,m(e,o,true));u=o;break;case"shrink-word-right":s.col=n.nextUntil(l.col,m(e,l,true));u=s;break;case"expand-word-left":s.col=n.prevUntil(l.col,m(e,l,true));u=s;break;case"shrink-word-left":o.col=n.prevUntil(o.col,m(e,o,true));u=o;break;case"expand-word-up":s.row=r.prevUntil(s.row,m(e,s,false));u=s;break;case"shrink-word-up":o.row=r.prevUntil(o.row,m(e,o,false));u=o;break;case"expand-word-down":o.row=r.nextUntil(o.row,m(e,o,false));u=o;break;case"shrink-word-down":s.row=r.nextUntil(s.row,m(e,s,false));u=s;break}var d=new p(s,o);if(!this.union(d).intersects(a)){this.modifySelection(h.replace("shrink","expand"));return}if(u)e.focus(u);this.updateCurrentSelectionRange(d)},moveActiveCell:function(e){var t=this._sheet;var r=t.activeCell();var n=r.topLeft;var i=r.bottomRight;var a=t.originalActiveCell();var s=t._grid._rows;var o=t._grid._columns;var l=a.row;var u=a.col;switch(e){case"left":u=o.prevVisible(n.col);break;case"up":l=s.prevVisible(n.row);break;case"right":u=o.nextVisible(i.col);break;case"down":l=s.nextVisible(i.row);break;case"first-col":u=o.firstVisible();break;case"last-col":u=o.lastVisible();break;case"first-row":l=s.firstVisible();break;case"last-row":l=s.lastVisible();break;case"last":l=s.lastVisible();u=o.lastVisible();break;case"first":l=s.firstVisible();u=o.firstVisible();break;case"next-page":l=s.nextPage(i.row,this._viewPortHeight);break;case"prev-page":l=s.prevPage(i.row,this._viewPortHeight);break;case"word-right":u=o.nextUntil(u,m(t,i,true));break;case"word-left":u=o.prevUntil(u,m(t,i,true));break;case"word-up":l=s.prevUntil(l,m(t,i,false));break;case"word-down":l=s.nextUntil(l,m(t,i,false));break}t.select(new k(l,u))},navigateInSelection:function(c){var e=this._sheet;var h=e.activeCell();var f=h.topLeft;var d=e.originalActiveCell();var t=e._grid._rows;var r=e._grid._columns;var n=d.row;var i=d.col;var p=false;var m=false;var a,s;var o=f.col;var g=f.row;var l;function v(e){a=e.topLeft;s=e.bottomRight}v(e.currentNavigationRange());var b=false;var w=false;while(!b&&!w){var u=new k(n,i);var y=e.singleCellSelection();if(y){p=a.eq(u)&&e._sheetRef.topLeft.eq(u);m=s.eq(u)&&e._sheetRef.bottomRight.eq(u);if(!p)p=r.firstVisible()===i&&t.firstVisible()===n;if(!m)m=r.lastVisible()===i&&t.lastVisible()===n}switch(c){case"next":if(m){w=true;_.focusNextElement()}else if(s.eq(u)){v(e.nextNavigationRange());n=a.row;i=a.col}else{i=r.nextVisible(o);if(i==o||i>s.col){i=a.col;l=t.nextVisible(n);if(l==n||l>s.row)n=a.row;else n=l}}break;case"previous":if(p){w=true;this._sheet._workbook._view.element.find(".k-spreadsheet-name-editor .k-input").trigger("focus")}else if(a.eq(u)){v(e.previousNavigationRange());n=s.row;i=s.col}else{i=r.prevVisible(o);if(i==o||i<a.col){i=s.col;l=t.prevVisible(n);if(l==n||l<a.row)n=s.row;else n=l}}break;case"lower":if(s.eq(u)){v(e.nextNavigationRange());n=a.row;i=a.col}else{n=t.nextVisible(g);if(n==g||n>s.row){n=a.row;l=r.nextVisible(i);if(l==i||l>s.col)i=a.col;else i=l}}break;case"upper":if(a.eq(u)){v(e.previousNavigationRange());n=s.row;i=s.col}else{n=t.prevVisible(g);if(n==g||n<a.row){n=s.row;l=r.prevVisible(i);if(l==i||l<a.col)i=s.col;else i=l}}break;default:throw new Error("Unknown entry navigation: "+c)}b=!this.shouldSkip(n,i);o=i;g=n}if(b)if(e.singleCellSelection())e.select(new k(n,i));else e.activeCell(new k(n,i))},extendSelection:function(e,t){var r=this._sheet;var n=r._grid;if(t==="autofill"){this.resizeAutoFill(e);return}if(t==="range")e=n.normalize(e);else if(t==="row")e=n.rowRef(e.row).bottomRight;else if(t==="column")e=n.colRef(e.col).bottomRight;var i=r.originalActiveCell().toRangeRef();this.updateCurrentSelectionRange(new p(i.topLeft,e))},shouldSkip:function(e,t){if(this._sheet.isHiddenRow(e)||this._sheet.isHiddenColumn(t))return true;var r=new k(e,t);var n=false;this._sheet.forEachMergedCell(function(e){if(e.intersects(r)&&!e.collapse().eq(r))n=true});return n},resizeAutoFill:function(e){var t=this._sheet;var r=t.select();var n=t._autoFillOrigin;var i=this.autoFillCalculator.autoFillDest(r,e);var a=this.punch(r,i);var s,o;if(!a){var l=t.range(i)._previewFillFrom(t.range(n));if(l){o=l.direction;s=l.hint}}t.updateAutoFill(i,a,s,o)},determineDirection:function(e){var t=this._sheet.currentSelectionRange();var r=this._sheet.activeCell();var n=r.topLeft.col==t.topLeft.col;var i=r.bottomRight.col==t.bottomRight.col;var a=r.topLeft.row==t.topLeft.row;var s=r.bottomRight.row==t.bottomRight.row;switch(e){case"left":e=i?"expand-left":"shrink-left";break;case"right":e=n?"expand-right":"shrink-right";break;case"up":e=s?"expand-up":"shrink-up";break;case"down":e=a?"expand-down":"shrink-down";break;case"prev-page":e=s?"expand-page-up":"shrink-page-up";break;case"next-page":e=a?"expand-page-down":"shrink-page-down";break;case"word-left":e=i?"expand-word-left":"shrink-word-left";break;case"word-right":e=n?"expand-word-right":"shrink-word-right";break;case"word-up":e=s?"expand-word-up":"shrink-word-up";break;case"word-down":e=a?"expand-word-down":"shrink-word-down";break}return e},updateCurrentSelectionRange:function(e){var t=this._sheet;t.select(t.originalSelect().replaceAt(t.selectionRangeIndex(),e),false)},punch:function(e,t){var r;if(t.topLeft.eq(e.topLeft))if(t.bottomRight.row<e.bottomRight.row){var n=this.rowEdge.nextRight(t.bottomRight.row);r=new p(new k(n,e.topLeft.col),e.bottomRight)}else if(t.bottomRight.col<e.bottomRight.col){var i=this.colEdge.nextRight(t.bottomRight.col);r=new p(new k(e.topLeft.row,i),e.bottomRight)}return r}});function m(i,a,s){var o=i.range(a).value();return function(e,t,r){if(r)return true;var n=(s?i.range(a.row,e):i.range(e,a.col)).value();if(o===null)return n===null?false:e;else if(!t&&n===null){o=null;return false}else return n===null}}_.spreadsheet.SheetNavigator=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/axismanager.min",["../kendo.core.min"],function(){var o=kendo,e=o.Class.extend({init:function(e){this._sheet=e},forEachSelectedColumn:function(r){var n=this._sheet;n.batch(function(){n.select().forEachColumnIndex(function(e,t){r(n,e,t)})},{layout:true,recalc:true})},forEachSelectedRow:function(r){var n=this._sheet;n.batch(function(){n.select().forEachRowIndex(function(e,t){r(n,e,t)})},{layout:true,recalc:true})},includesHiddenColumns:function(e){return this._sheet._grid._columns.includesHidden(e.topLeft.col,e.bottomRight.col)},includesHiddenRows:function(e){return this._sheet._grid._rows.includesHidden(e.topLeft.row,e.bottomRight.row)},selectionIncludesHiddenColumns:function(){return this.includesHiddenColumns(this._sheet.select())},selectionIncludesHiddenRows:function(){return this.includesHiddenRows(this._sheet.select())},deleteSelectedColumns:function(){var n=[],i=0;this.forEachSelectedColumn(function(e,t){t-=i;if(e.isHiddenColumn(t))return;i++;var r=[];n.unshift({index:t,formulas:r,width:e.columnWidth(t)});e._saveModifiedFormulas(r,function(){e.deleteColumn(t)})});return n},deleteSelectedRows:function(){var n=[],i=0;this.forEachSelectedRow(function(e,t){t-=i;if(e.isHiddenRow(t))return;i++;var r=[];n.unshift({index:t,formulas:r,height:e.rowHeight(t)});e._saveModifiedFormulas(r,function(){e.deleteRow(t)})});return n},hideSelectedColumns:function(){this.forEachSelectedColumn(function(e,t){e.hideColumn(t)});var e=this._sheet;var t=e.select().toRangeRef();var r=t.topLeft.col;var n=t.bottomRight.col;var i=null;while(true){var a=n<e._columns._count;var s=r>=0;if(!s&&!a)break;if(a&&!e.isHiddenColumn(n)){i=n;break}if(s&&!e.isHiddenColumn(r)){i=r;break}r--;n++}if(i!==null){t=new o.spreadsheet.RangeRef(new o.spreadsheet.CellRef(0,i),new o.spreadsheet.CellRef(e._rows._count-1,i));e.range(t).select()}},hideSelectedRows:function(){this.forEachSelectedRow(function(e,t){e.hideRow(t)});var e=this._sheet;var t=e.select().toRangeRef();var r=t.topLeft.row;var n=t.bottomRight.row;var i=null;while(true){var a=n<e._rows._count;var s=r>=0;if(!s&&!a)break;if(a&&!e.isHiddenRow(n)){i=n;break}if(s&&!e.isHiddenRow(r)){i=r;break}r--;n++}if(i!==null){t=new o.spreadsheet.RangeRef(new o.spreadsheet.CellRef(i,0),new o.spreadsheet.CellRef(i,e._columns._count-1));e.range(t).select()}},unhideSelectedColumns:function(){this.forEachSelectedColumn(function(e,t){e.unhideColumn(t)})},unhideSelectedRows:function(){this.forEachSelectedRow(function(e,t){e.unhideRow(t)})},preventAddRow:function(){var e=this._sheet.select().toRangeRef();var t=e.height();return this._sheet.preventInsertRow(0,t)},preventAddRowAfterLast:function(){var e=this._sheet.select().toRangeRef();var t=e.height();return this._sheet.preventInsertBelowLastRow(e.bottomRight.row,t)},preventAddColumn:function(){var e=this._sheet.select().toRangeRef();var t=e.width();return this._sheet.preventInsertColumn(0,t)},preventAddColumnAfterLast:function(){var e=this._sheet.select().toRangeRef();var t=e.width();return this._sheet.preventInsertAfterLastColumn(e.bottomRight.col,t)},addColumnLeft:function(){var t=this._sheet;var r,n=0;t.batch(function(){t.select().forEachColumnIndex(function(e){if(!r)r=e;t.insertColumn(r);++n})},{recalc:true,layout:true});return{base:r,count:n}},addColumnRight:function(){var t=this._sheet;var r,n=0;t.batch(function(){t.select().forEachColumnIndex(function(e){r=e+1;++n});for(var e=0;e<n;++e)t.insertColumn(r)},{recalc:true,layout:true});return{base:r,count:n}},addRowAbove:function(){var t=this._sheet;var r,n=0;var i=t._grid.rowCount;var a=t.select();var s=a.bottomRight.row-a.topLeft.row+1;t.batch(function(){a.forEachRowIndex(function(e){if(!r)r=e;if(a.bottomRight.row+s<i)t.insertRow(r);++n})},{recalc:true,layout:true});return{base:r,count:n}},addRowBelow:function(){var t=this._sheet;var r,n=0;var i=t._grid.rowCount;t.batch(function(){t.select().forEachRowIndex(function(e){r=e+1;++n});if(r+n<i)for(var e=0;e<n;++e)t.insertRow(r)},{recalc:true,layout:true});return{base:r,count:n}}});o.spreadsheet.AxisManager=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/clipboard.min",["../kendo.core.min"],function(){var b=kendo,r=b.jQuery,w=b.spreadsheet.CellRef,e=b.Class.extend({init:function(e){this._content={};this._externalContent={};this._internalContent={};this.workbook=e;this.origin=b.spreadsheet.NULLREF;this.iframe=document.createElement("iframe");this.iframe.className="k-spreadsheet-clipboard-paste";this.iframe.setAttribute("title","Spreadsheet clipboard iframe");this.menuInvoked=false;this._uid=b.guid();document.body.appendChild(this.iframe)},destroy:function(){document.body.removeChild(this.iframe)},canCopy:function(){var e={canCopy:true};var t=this.workbook.activeSheet().select();if(t===b.spreadsheet.NULLREF)e.canCopy=false;if(t instanceof b.spreadsheet.UnionRef){e.canCopy=false;e.multiSelection=true}if(this.menuInvoked){e.canCopy=false;e.menuInvoked=true}return e},canPaste:function(){var e=this.workbook.activeSheet();var t=this.pasteRef();var r=e.range(t);var n={canPaste:true,pasteOnMerged:false,pasteOnDisabled:false};if(!r.enable()){n.canPaste=false;n.pasteOnDisabled=true}if(!t.eq(e.unionWithMerged(t))){n.canPaste=false;n.pasteOnMerged=true}if(this.menuInvoked){n.canPaste=false;n.menuInvoked=true}if(t.bottomRight.row>=e._rows._count||t.bottomRight.col>=e._columns._count){n.canPaste=false;n.overflow=true}return n},intersectsMerged:function(){var e=this.workbook.activeSheet();this.parse();this.origin=this._content.origRef;var t=this.pasteRef();return!t.eq(e.unionWithMerged(t))},copy:function(){var e=this.workbook.activeSheet();this.origin=e.select();this._internalContent=e.selection().getState();delete this._externalContent.html;delete this._externalContent.plain},cut:function(){var e=this.workbook.activeSheet();this.copy();e.range(e.select()).clear()},pasteRef:function(){var e=this.workbook.activeSheet();if(this.origin===b.spreadsheet.NULLREF)return e.select();var t=e.activeCell().first();var r=this.origin.first();var n=r.row-t.row;var i=r.col-t.col;return this.origin.relative(n,i,3)},paste:function(){var e=this.workbook.activeSheet();var t=this.pasteRef();e.range(t).setState(this._content,this);e.triggerChange({recalc:true,ref:t})},external:function(e){if(e&&(e.html||e.plain))this._externalContent=e;else return this._externalContent},isExternal:function(){return!this._isInternal()},parse:function(){var e=y();if(this._isInternal())e=this._internalContent;else{var t=this._externalContent;if(t.html){var r=this.iframe.contentWindow.document;r.open();r.write(t.html);r.close();var n=r.querySelector("table");if(n)e=a(n);else e=i(t.plain)}else e=i(t.plain);this.origin=e.origRef}this._content=e},_isInternal:function(){if(this._externalContent.html===undefined)return true;var e=r("<div/>").html(this._externalContent.html).find("table.kendo-clipboard-"+this._uid).length?true:false;var t=r("<div/>").html(this._externalContent.plain).find("table.kendo-clipboard-"+this._uid).length?true:false;return e||t}});function y(){var e=new w(0,0,0);return{ref:e,mergedCells:[],data:[],foreign:true,origRef:e.toRangeRef()}}function _(e,t,r,n){var i=e.data||(e.data=[]);if(!i[t])i[t]=[];i[t][r]=n;var a=e.origRef.bottomRight;a.row=Math.max(a.row,t);a.col=Math.max(a.col,r)}function u(e){return e.replace(/^-(?:ms|moz|webkit)-/,"")}function c(t){var r={};["borderBottom","borderRight","borderLeft","borderTop"].forEach(function(e){r[e]=t[e+"Style"]=="none"?null:{size:1,color:t[e+"Color"]}});return r}function k(e,t,r,n,i){var a=window.getComputedStyle(r);var s=r.innerText.replace(/\t$/,"");var o=c(a);var l={value:s===""?null:s,borderTop:o.borderTop||n.get(e,t)||null,borderBottom:o.borderBottom||n.get(e+1,t)||null,borderLeft:o.borderLeft||i.get(e,t)||null,borderRight:o.borderRight||i.get(e,t+1)||null,fontSize:parseInt(a["font-size"],10)};n.set(e,t,l.borderTop);n.set(e+1,t,l.borderBottom);i.set(e,t,l.borderLeft);i.set(e,t+1,l.borderRight);if(a["background-color"]!=="rgb(0, 0, 0)"&&a["background-color"]!=="rgba(0, 0, 0, 0)")l.background=a["background-color"];if(a.color!=="rgb(0, 0, 0)"&&a.color!=="rgba(0, 0, 0, 0)")l.color=a.color;if(a["text-decoration"]=="underline")l.underline=true;if(a["font-style"]=="italic")l.italic=true;if(a["font-weight"]=="bold")l.bold=true;if(u(a["text-align"])!=="right")l.textAlign=u(a["text-align"]);if(a["vertical-align"]!=="middle")l.verticalAlign=a["vertical-align"];if(a["word-wrap"]!=="normal")l.wrap=true;return l}function a(e){var t=y();var r=[],n=0,i=0;for(var c=0;c<e.rows.length;++c)r.push([]);var h=new b.spreadsheet.calc.runtime.Matrix;var f=new b.spreadsheet.calc.runtime.Matrix;for(var a=0;a<e.rows.length;++a,++n){var d=e.rows[a];i=0;for(var s=0;s<d.cells.length;++s){var o=d.cells[s];var p=o.rowSpan;var m=o.colSpan;while(r[n][i])i++;var g=o.getAttribute("style");var v=/mso-ignore:colspan/.test(g);_(t,n,i,k(n,i,o,h,f));if(p>1||m>1&&!v)t.mergedCells.push(new b.spreadsheet.RangeRef(new w(n,i),new w(n+p-1,i+m-1)).toString());for(var l=n+p;--l>=n;)for(var u=i+m;--u>=i;)if(l<r.length){r[l][u]=true;if(!(l==n&&u==i))_(t,l,u,{})}}}return t}function i(e){var t=y();if(e.indexOf("\t")===-1&&e.indexOf("\n")==-1)_(t,0,0,{value:e});else{var r=e.split("\n");for(var n=0;n<r.length;n++){var i=r[n].split("\t");for(var a=0;a<i.length;a++)_(t,n,a,{value:i[a]})}}return t}b.spreadsheet.Clipboard=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/range.min",["../kendo.core.min","../util/text-metrics.min","../util/main.min"],function(){var d=window.kendo,u=d.jQuery,p=d.spreadsheet.UnionRef,f=d.spreadsheet.CellRef,h=d.spreadsheet.RangeRef,i=["color","fontFamily","underline","italic","bold","textAlign","indent","verticalAlign","background","format","link","editor","borderTop","borderRight","borderBottom","borderLeft","comment","html"],r=d.Class.extend({init:function(e,t){this._sheet=t;this._ref=e},clone:function(){return new r(this._ref.clone(),this._sheet)},skipHiddenCells:function(){var o=[];var l=this,e=l._sheet;var u=e.isHiddenRow.bind(e);var c=e.isHiddenColumn.bind(e);l._ref.forEach(function(e){e=l._normalize(e.toRangeRef());var t=e.topLeft,r=e.bottomRight;var n=m(t.row,r.row,u);var i=m(t.col,r.col,c);for(var a=0;a<n.length;++a)for(var s=0;s<i.length;++s)o.push(new h(new f(n[a].begin,i[s].begin),new f(n[a].end,i[s].end)))});return e.range(o.length>1?new p(o):o[0])},_normalize:function(e){return this._sheet._grid.normalize(e)},_set:function(i,a,e){var t=this;var s=t._sheet;t._ref.forEach(function(e){var t=e;var r=i==="value"||i==="formula"||i==="link";if(r&&e.topLeft){var n=new f(e.topLeft.row,e.topLeft.col);s.forEachMergedCell(function(e){if(e.intersects(n))t=n})}s._set(t.toRangeRef(),i,a)});if(!e)s.triggerChange({recalc:i=="formula"||i=="value"||i=="validation",value:a,range:t,ref:t._ref});return t},_get:function(e){return this._sheet._get(this._ref.toRangeRef(),e)},_property:function(e,t){if(t===undefined)return this._get(e);else return this._set(e,t)},value:function(e){if(e!==undefined)this._set("formula",null,true);return this._property("value",e)},html:function(e){return this._property("html",e)},resize:function(e){var t=this._resizedRef(e);return new r(t,this._sheet)},_resizedRef:function(t){return this._ref.map(function(e){return e.toRangeRef().resize(t)})},input:function(r,n){n=u.extend({arrayFormula:false},n);var i=this._get("format"),a;if(r!==undefined){var e=this._ref.toRangeRef().topLeft;a=d.spreadsheet.calc.parse(this._sheet.name(),e.row,e.col,r,i);this._sheet.batch(function(){var e=null;if(a.type=="exp")e=d.spreadsheet.calc.compile(a);else if(i!="@"){var t=i&&d.spreadsheet.formatting.type(a.value,i);if(a.type=="date"&&t!="date")this.format(a.format||c(d.culture().calendar.patterns.d));else if(a.type=="percent"&&t!="percent")this.format(a.value*100==(a.value*100|0)?"0%":"0.00%");else if(a.format)if(!i||a.currency||t=="number"&&a.type=="number"&&a.format.length>i.length)this.format(a.format)}else if(a.type!="string")a.value=r;this.formula(e,n.arrayFormula);if(!e)this.value(a.value)}.bind(this),{recalc:true,value:r,ref:this._ref,editorChange:this._sheet.isInEditMode()});return this}else{r=this._get("value");var t=this._get("formula");var s=i&&!t&&d.spreadsheet.formatting.type(r,i);if(t)r="="+t;else e:{if(i&&s=="date"){var o=d.spreadsheet.formatting.text(r,i);a=d.spreadsheet.calc.parse(null,null,null,o,i);var l=d.spreadsheet.formatting.text(a.value,i);if(o==l){r=o;break e}}if(s==="date")r=d.toString(d.spreadsheet.numberToDate(r),d.culture().calendar.patterns.d);else if(s==="percent")r=d.spreadsheet.calc.runtime.limitPrecision(r*100)+"%";else if(typeof r=="string"&&(/^[=']/.test(r)||/^(?:true|false)$/i.test(r)||g(r)))r="'"+r;else if(this._sheet._useCultureDecimals()&&typeof r=="number"&&r!=Math.floor(r))r=String(r).replace(".",d.culture().numberFormat["."])}return r}},enable:function(e){if(e===undefined)return!d.util.withExit(function(n){this._sheet.forEach(this._ref,function(e,t,r){if(r.enable===false)n(true)})},this);return this._property("enable",e)},formula:function(e,t){var r=this;if(e===undefined){var n=r._get("formula");return n?""+n:null}if(t){var i=this._ref.toRangeRef();e=r._sheet.range(i.topLeft)._set("formula",e)._get("formula");if(e)e.setArrayFormulaRange(i)}else r._set("formula",e);return r},intersectingArrayFormula:function(){var n=this._ref.clone().simplify().setSheet(this._sheet.name());return d.util.withExit(function(r){this._sheet._forFormulas(function(e){var t=e.arrayFormulaRange;if(t&&(t=n.intersect(t))!==d.spreadsheet.NULLREF)r({formula:e,intersection:t})})},this)},canEditArrayFormula:function(){var e=this.intersectingArrayFormula();if(e)return e.formula.arrayFormulaRange.eq(e.intersection);return true},validation:function(e){if(e===undefined){var t=this._get("validation");return t?t.toJSON():null}return this._property("validation",e)},_getValidationState:function(){var e=this._ref.toRangeRef();var t=e.topLeft.row;var r=e.topLeft.col;var n=e.bottomRight.row;var i=e.bottomRight.col;var a,s;for(a=r;a<=i;a++)for(s=t;s<=n;s++){var o=this._sheet._validation(s,a);if(o&&o.type==="reject"&&o.value===false)return o}return false},merge:function(){this._ref=this._sheet._merge(this._ref);return this},unmerge:function(){var t=this._sheet._mergedCells;this._ref.forEach(function(e){e.toRangeRef().intersecting(t).forEach(function(e){t.splice(t.indexOf(e),1)})});this._sheet.triggerChange({});return this},select:function(){this._sheet.select(this._ref);return this},values:function(e){if(this._ref instanceof p)throw new Error("Unsupported for multiple ranges.");if(this._ref===d.spreadsheet.NULLREF)if(e!==undefined)throw new Error("Unsupported for NULLREF.");else return[];var t=this._ref.toRangeRef();var r=t.topLeft.row;var n=t.topLeft.col;var i=t.bottomRight.row;var a=t.bottomRight.col;var s,o;if(e===undefined){e=new Array(t.height());for(var l=0;l<e.length;l++)e[l]=new Array(t.width());for(s=n;s<=a;s++)for(o=r;o<=i;o++)e[o-r][s-n]=this._sheet._value(o,s);return e}else{this._sheet._set(t,"formula",null);for(s=n;s<=a;s++)for(o=r;o<=i;o++){var u=e[o-r];if(u){var c=u[s-n];if(c!==undefined)this._sheet._value(o,s,c)}}this._sheet.triggerChange({recalc:true,ref:t});return this}},_properties:function(i,e){if(this._ref instanceof p)throw new Error("Unsupported for multiple ranges.");if(this._ref===d.spreadsheet.NULLREF)if(i!==undefined)throw new Error("Unsupported for NULLREF.");else return[];var r=this._ref.toRangeRef();var a=r.topLeft.row;var s=r.topLeft.col;var c=r.bottomRight.row;var h=r.bottomRight.col;var n,o;var l=this._sheet;if(i===undefined){i=new Array(r.height());l.forEach(r,function(e,t,r){e-=a;t-=s;var n=i[e]||(i[e]=[]);n[t]=r});return i}else{var u;r=r.clone();var f=function(e){var t=u[e];r.topLeft.row=r.bottomRight.row=o;r.topLeft.col=r.bottomRight.col=n;if(e=="value")l._set(r,"formula",null);l._set(r,e,t)};for(n=s;n<=h;n++){if(!e&&l.isHiddenColumn(n))continue;for(o=a;o<=c;o++){if(!e&&l.isHiddenRow(o))continue;if(e&&l.isFilteredRow(o))continue;var t=i[o-a];if(t){u=t[n-s];if(u)Object.keys(u).forEach(f)}}}l.triggerChange({recalc:true,ref:this._ref});return this}},clear:function(t){t=t||{};var e=t.clearAll||!Object.keys(t).length;var r=this._sheet;var n={recalc:e||t.contentsOnly,ref:this._ref};r.batch(function(){if(n.recalc)this.formula(null);if(e)this.validation(null);if(e||t.formatOnly){i.forEach(function(e){if(!(t.keepBorders&&/^border/i.test(e)))this[e](null)}.bind(this));this.fontSize(null);this.wrap(null);this.unmerge()}}.bind(this),n);return this},clearContent:function(){return this.clear({contentsOnly:true})},clearFormat:function(){return this.clear({formatOnly:true})},isSortable:function(){return!this.cantSort()},cantSort:function(){if(this._ref instanceof p)return{code:"cantSortMultipleSelection",message:"Unsupported for multiple ranges."};if(this._ref===d.spreadsheet.NULLREF)return{code:"cantSortNullRef",message:"Unsupported for NULLREF."};var i=this._sheet._getMergedCells(this._ref.toRangeRef());var a=i.primary;var s=i.secondary;var o=null,l=null;var u={};try{this._sheet.forEach(this,function(e,t){var r=new f(e,t).print();var n=a[r];if(n){if(o===null){o=n.width();l=n.height()}else if(!(o==n.width()&&l==n.height()))throw u}else if(!s[r]&&i.hasMerged)throw u})}catch(e){if(e!==u)throw e;return{code:"cantSortMixedCells",message:"Unsupported for range containing cells of different shapes."}}return false},sort:function(e){var t=this.cantSort();if(t)throw new Error(t.message);if(e===undefined)e={column:0};e=e instanceof Array?e:[e];this._sheet._sortBy(this._ref.toRangeRef(),e.map(function(e,t){if(typeof e==="number")e={column:e};return{index:e.column===undefined?t:e.column,ascending:e.ascending===undefined?true:e.ascending}}));return this},isFilterable:function(){return!(this._ref instanceof p)},filter:function(e){if(this._ref instanceof p)throw new Error("Unsupported for multiple ranges.");if(e===false)this.clearFilters();else{e=e===true?[]:e instanceof Array?e:[e];this._sheet._filterBy(this._ref.toRangeRef(),e.map(function(e,t){return{index:e.column===undefined?t:e.column,filter:e.filter}}))}return this},clearFilter:function(e){this._sheet.clearFilter(e)},clearFilters:function(){var e=this._sheet.filter();var t=[];if(e){for(var r=0;r<e.columns.length;r++)t.push(e.columns[r].index);this._sheet.batch(function(){this.clearFilter(t);this._filter=null},{layout:true,filter:true})}},hasFilter:function(){var e=this._sheet.filter();return!!e},leftColumn:function(){return new r(this._ref.leftColumn(),this._sheet)},rightColumn:function(){return new r(this._ref.rightColumn(),this._sheet)},topRow:function(){return new r(this._ref.topRow(),this._sheet)},bottomRow:function(){return new r(this._ref.bottomRow(),this._sheet)},column:function(e){return new r(this._ref.toColumn(e),this._sheet)},row:function(e){return new r(this._ref.toRow(e),this._sheet)},forEachRow:function(t){this._ref.forEachRow(function(e){t(new r(e,this._sheet))}.bind(this))},forEachColumn:function(t){this._ref.forEachColumn(function(e){t(new r(e,this._sheet))}.bind(this))},sheet:function(){return this._sheet},topLeft:function(){return this._ref.toRangeRef().topLeft},intersectingMerged:function(){var e=this._sheet;var t=[];e._mergedCells.forEach(function(e){if(e.intersects(this._ref))t.push(e.toString())}.bind(this));return t},getState:function(e){var s=this._ref.first();var t={ref:s,data:[],origRef:this._ref,rows:this._sheet._rows.getState()};var o;if(!e){o=d.spreadsheet.ALL_PROPERTIES;t.mergedCells=this.intersectingMerged()}else if(e==="input")o=["value","formula"];else if(e==="border")o=["borderLeft","borderTop","borderRight","borderBottom"];else o=[e];var l=t.data;this.forEachCell(function(e,t,r){var n={};var i=e-s.row;var a=t-s.col;if(!l[i])l[i]=[];l[i][a]=n;o.forEach(function(e){var t=typeof r[e]=="undefined"?null:r[e];if(t instanceof d.spreadsheet.calc.runtime.Formula||t instanceof d.spreadsheet.validation.Validation)t=t.deepClone();n[e]=t})});return t},setState:function(l,u){var c=this._sheet;var h=this._ref.first();var t=l.ref.row-h.row;var r=l.ref.col-h.col;var f=u&&!u.isExternal();var d=u&&!f;c.batch(function(){if(l.mergedCells)this.unmerge();if(!u)this._sheet._rows.setState(l.rows);var s=h.row;var o=this.hasFilter();l.data.forEach(function(e,i){if(o&&f&&c.isHiddenRow(l.ref.row+i))return;var a=h.col;e.forEach(function(t,e){if(o&&f&&c.isHiddenColumn(l.ref.col+e))return;var r=u?c.range(s,a):c.range(h.row+i,h.col+e);if(r.enable()){for(var n in t)if(n!="value")if(!(u&&n=="enable"))r._set(n,t[n]);if(!t.formula)if(d)try{if(t.value==null)r._set("value",null);else r.input(t.value)}catch(e){r._set("value",t.value)}else r._set("value",t.value)}a++});s++});if(l.mergedCells)l.mergedCells.forEach(function(e){e=c._ref(e).relative(t,r,3);c.range(e).merge()},this)}.bind(this),{recalc:true,ref:this._ref})},_adjustRowHeight:function(){var e=this;var u=e._sheet;var t=u._getMergedCells(e._ref.toRangeRef());var c=t.primary;var h=t.secondary;u.batch(function(){e.forEachRow(function(e){var t=e._ref.topLeft.row;var l=u.rowHeight(t);if(!l)return;e.forEachCell(function(e,t,r){var n=new f(e,t).print();if(h[n])return;var i=c[n];var a;if(i)a=u._columns.sum(i.topLeft.col,i.bottomRight.col);else a=u.columnWidth(t);var s=r.value;if(r.format&&s!=null)s=d.spreadsheet.formatting.format(s,r.format);var o=d.spreadsheet.util.getTextHeight(s,a,r.fontFamily,r.fontSize,r.wrap);l=Math.max(l,o)});u.rowHeight(t,l)})},{layout:true})},forEachCell:function(t){this._ref.forEach(function(e){this._sheet.forEach(e.toRangeRef(),t.bind(this))}.bind(this))},hasValue:function(){var s=this._sheet._defaultCellStyle;return d.util.withExit(function(a){this.forEachCell(function(e,t,r){for(var n in r){var i=r[n];if(i!==undefined&&i!==null&&i!==s[n])a(true)}})},this)},wrap:function(e){if(e===undefined)return!!this._property("wrap");this._property("wrap",e);if(e!==null)this._adjustRowHeight();return this},fontSize:function(e){if(e===undefined)return this._property("fontSize");this._property("fontSize",e);if(e!==null)this._adjustRowHeight();return this},draw:function(e,t){this._sheet.draw(this,e,t)},insideBorders:function(e){return this.insideVerticalBorders(e).insideHorizontalBorders(e)},insideVerticalBorders:function(t){this._ref.forEach(function(e){if(e instanceof h&&e.width()>1){e=e.clone();e.topLeft.col++;this._sheet.range(e)._set("vBorders",t)}},this);return this},insideHorizontalBorders:function(t){this._ref.forEach(function(e){if(e instanceof h&&e.height()>1){e=e.clone();e.topLeft.row++;this._sheet.range(e)._set("hBorders",t)}},this);return this}});function m(e,t,r){while(e<=t&&r(e))e++;if(e>t)return[];for(var n=e+1;n<=t;++n)if(r(n))return[{begin:e,end:n-1}].concat(m(n+1,t,r));return[{begin:e,end:t}]}function c(e){return e.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm")}function g(e){return!/^=/.test(e)&&/number|percent/.test(d.spreadsheet.calc.parse(null,0,0,e).type)}u.each(i,function(e,t){r.prototype[t]=function(e){return this._property(t,e)}});var s=u('<div style="position: absolute !important; top: -4000px !important; height: auto !important;'+"padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;"+"line-height: normal !important; visibility: hidden !important;"+'white-space: pre-wrap;"></div>')[0];function e(e,t,r,n,i){var a={baselineMarkerSize:0,width:i===true?t+"px":"auto","font-size":(n||12)+"px","font-family":r||"Arial","white-space":i===true?"pre-wrap":"pre","overflow-wrap":i===true?"break-word":"normal","word-wrap":i===true?"break-word":"normal"};return d.util.measureText(e,a,{box:s,normalizeText:false}).height}d.spreadsheet.util={getTextHeight:e},d.spreadsheet.Range=r})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/runtime.min",["./references.min"],function(){"use strict";var i={},a=kendo.spreadsheet,e=(a.calc=i).runtime={},o=kendo.Class,l=a.Ref,c=a.CellRef,u=a.RangeRef,h=a.UnionRef,p=a.NULLREF;function g(e){if(e instanceof g)return e;this.code=e}g.prototype.toString=function(){return"#"+this.code+(this.code=="NAME"?"?":"!")};var f=o.extend({init:function e(t,r,n,i){this.callback=t;this.formula=r;this.ss=n;this.parent=i},resolve:function(e){var t=this;if(e instanceof l)t.resolveCells([e],function(){t._resolve(e)});else t._resolve(e)},error:function(e){return new g(e)},_resolve:function(e){if(e===undefined)e=null;else if(Array.isArray(e))e=this.asMatrix(e);else e=_(e);var t=this.formula;if(t.arrayFormulaRange)e=this.asMatrix(e)||this.asMatrix([[e]]);else if(e instanceof u)e=this._arrayArg(e);t.value=e;if(this.ss.onFormula(t)&&this.callback)this.callback.call(t,e)},resolveCells:function(e,t){var i=this,n=[];(function e(t){for(var r=0;r<t.length;++r){var n=t[r];if(n instanceof l)o(i.getRefCells(n));if(Array.isArray(n))e(n)}})(e);if(!n.length)return t.call(i);for(var r=n.length,a=0;a<n.length;++a)s(n[a]);function s(e){e.exec(i.ss,function(){if(!--r)t.call(i)},i)}function o(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.formula)n.push(r.formula)}return true}},cellValues:function(e,t){var r=[];for(var n=0;n<e.length;++n){var i=e[n];if(i instanceof l){i=this.getRefData(i,t);r=r.concat(i)}else if(Array.isArray(i))r=r.concat(this.cellValues(i,t));else if(i instanceof d)r=r.concat(this.cellValues(i.data,t));else r.push(i)}return r},fetchName:function(e,t){var r=this.formula;var n=this.ss.nameValue(e,r.sheet,r.row,r.col);if(n instanceof v){n=n.clone(r.sheet,r.row,r.col,true);var i=new a.ValidationFormulaContext(this.ss.workbook);n.exec(i,t,this)}else{if(n instanceof l){n=n.absolute(r.row,r.col);if(n instanceof u&&this.ss.isMerged(n))n=n.topLeft;if(!n.sheet)n.sheet=r.sheet}t(n==null?new g("NAME"):n)}},force:function(e){if(e instanceof l)return this.getRefData(e);return e},func:function(e,t,r){e=e.toLowerCase();var n=s[e];if(n)return n.call(this,t,r);t(new g("NAME"))},bool:function(e){if(e instanceof l)e=this.getRefData(e);if(typeof e=="string")return e.toLowerCase()=="true";if(typeof e=="number")return e!==0;if(typeof e=="boolean")return e;return e!=null},_arrayArg:function(e){var t=this.formula;if(!t.arrayFormulaRange&&e instanceof u){if(e.height()==1&&t.col>=e.topLeft.col&&t.col<=e.bottomRight.col)return this.getRefData(new c(e.topLeft.row,t.col).setSheet(e.sheet));if(e.width()==1&&t.row>=e.topLeft.row&&t.row<=e.bottomRight.row)return this.getRefData(new c(t.row,e.topLeft.col).setSheet(e.sheet));return new g("VALUE")}else return this.asMatrix(e)},asMatrix:function(e){if(e instanceof d)return e;var i=this;if(e instanceof u){var t=e.topLeft;var r=t.row,n=t.col;var a=i.getRefCells(e);var s=new d(i);if(isFinite(e.width()))s.width=e.width();if(isFinite(e.height()))s.height=e.height();if(!isFinite(r))r=0;if(!isFinite(n))n=0;a.forEach(function(e){s.set(e.row-r,e.col-n,e.value)});return s}if(Array.isArray(e)&&e.length>0){var s=new d(i),o=0;e.forEach(function(e){var n=0;var r=1;e.forEach(function(e){var t=e instanceof u;if(e instanceof l&&!t)e=i.getRefData(e);if(t||Array.isArray(e))e=i.asMatrix(e);if(e instanceof d){e.each(function(e,t,r){s.set(o+t,n+r,e)});r=Math.max(r,e.height);n+=e.width}else{if(typeof e==="string"&&e.length&&!isNaN(e))e=Number(e);s.set(o,n++,e)}});o+=r});return s}},getRefCells:function(e,t,r){var n=this.formula;return this.ss.getRefCells(e,t,n.sheet,n.row,n.col,r)},getRefData:function(e,t){var r=this.formula;return this.ss.getData(e,r.sheet,r.row,r.col,t)},workbook:function(){return this.ss.workbook}}),d=o.extend({init:function e(t){this.context=t;this.height=0;this.width=0;this.data=[]},clone:function(){var e=new d(this.context);e.height=this.height;e.width=this.width;e.data=this.data.map(function(e){return e.slice()});return e},get:function(e,t){var r=this.data[e];var n=r?r[t]:null;return n instanceof l?this.context.getRefData(n):n},getNA:function(e,t){if(e<this.height&&t<this.width)return this.get(e,t);return new g("N/A")},set:function(e,t,r){var n=this.data[e];if(n==null)n=this.data[e]=[];n[t]=r;if(e>=this.height)this.height=e+1;if(t>=this.width)this.width=t+1},each:function(e,t){for(var r=0;r<this.height;++r)for(var n=0;n<this.width;++n){var i=this.get(r,n);if(t||i!=null){i=e.call(this.context,i,r,n);if(i!==undefined)return i}}},map:function(n,e){var i=new d(this.context);this.each(function(e,t,r){i.set(t,r,n.call(this,e,t,r))},e);return i},eachRow:function(e){for(var t=0;t<this.height;++t){var r=e.call(this.context,t);if(r!==undefined)return r}},eachCol:function(e){for(var t=0;t<this.width;++t){var r=e.call(this.context,t);if(r!==undefined)return r}},mapRow:function(t){var r=new d(this.context);this.eachRow(function(e){r.set(e,0,t.call(this.context,e))});return r},mapCol:function(t){var r=new d(this.context);this.eachCol(function(e){r.set(0,e,t.call(this.context,e))});return r},toString:function(){return JSON.stringify(this.data)},transpose:function(){var n=new d(this.context);this.each(function(e,t,r){n.set(r,t,e)});return n},unit:function(e){this.width=this.height=e;var t=this.data=new Array(e);for(var r=e;--r>=0;){var n=t[r]=new Array(e);for(var i=e;--i>=0;)n[i]=r==i?1:0}return this},multiply:function(e){var t=this,r=new d(t.context);for(var n=0;n<t.height;++n)for(var i=0;i<e.width;++i){var a=0;for(var s=0;s<t.width;++s){var o=t.get(n,s);var l=e.get(s,i);if(typeof o!="number"||typeof l!="number")throw new g("VALUE");a+=o*l}r.set(n,i,a)}return r},adds:function(e,t){var r=this,n=new d(r.context);var i=t?-1:1;for(var a=0;a<r.height;++a)for(var s=0;s<r.width;++s){var o=r.get(a,s),l=e.get(a,s);n.set(a,s,o+i*l)}return n},determinant:function(){var e=this.clone().data;var t=e.length;var r=1,n,i,a,s;for(n=0;n<t;n++){for(i=n;i<t&&!e[i][n];i++);if(i==t)return 0;if(i!=n){r=-r;for(s=n;s<t;s++){var o=e[n][s];e[n][s]=e[i][s];e[i][s]=o}}for(a=n+1;a<t;a++)for(s=n+1;s<t;s++)e[a][s]-=e[n][s]*e[a][n]/e[n][n];r*=e[n][n]}return r},inverse:function(){var e=this.width;var t=this.augment(new d(this.context).unit(e));var r=t.data;var n;for(var i=0;i<e;++i){var a=m(i,e,function(e){return r[e][i]});if(!r[a][i])return null;if(i!=a){n=r[i];r[i]=r[a];r[a]=n}for(var s=i+1;s<e;++s){for(var o=i+1;o<2*e;++o)r[s][o]-=r[i][o]*r[s][i]/r[i][i];r[s][i]=0}}for(var s=0;s<e;++s)for(var l=r[s][s],o=0;o<2*e;++o)r[s][o]/=l;for(var i=e;--i>=0;)for(var s=i;--s>=0;)if(r[s][i])for(var o=2*e;--o>=e;)r[s][o]-=r[i][o]*r[s][i];return t.slice(0,e,e,e)},augment:function(e){var n=this.clone(),i=n.width;e.each(function(e,t,r){n.set(t,r+i,e)});return n},slice:function(e,t,r,n){var i=new d(this.context);for(var a=0;a<r;++a)for(var s=0;s<n;++s)i.set(a,s,this.get(e+a,t+s));return i}});function m(e,t,r){var n=r(e),i=e;while(++e<t){var a=r(e);if(a>n){n=a;i=e}}return i}var v=o.extend({init:function e(t,r,n,i,a,s,o){this.refs=t;this.handler=r;this.print=n;this.absrefs=null;this.sheet=i;this.row=a;this.col=s;this.onReady=[];this.pending=false;this.arrayFormulaRange=o},setArrayFormulaRange:function(e){this.arrayFormulaRange=e.clone().setSheet(this.sheet)},clone:function(t,e,r,n){var i=t.toLowerCase();var a=this.refs;var s=this.arrayFormulaRange;if(n||i!=this.sheet.toLowerCase()){a=a.map(function(e){if(!e.hasSheet()&&(!e.sheet||e.sheet.toLowerCase()!=i))e=e.clone().setSheet(t);return e});if(s)s=s.clone().setSheet(t)}return new v(a,this.handler,this.print,t,e,r,s)},deepClone:function(){var e=this.refs.map(function(e){return e.clone()});return new v(e,this.handler,this.print,this.sheet,this.row,this.col,this.arrayFormulaRange)},resolve:function(t){this.pending=false;this.onReady.forEach(function(e){e(t)})},exec:function(e,t,r){if("value"in this){if(t)t(this.value)}else{if(t)this.onReady.push(t);var n=new f(this.resolve,this,e,r);var i=0;while(r){if(r.formula===this){this.pending=false;n.resolve(new g("CIRCULAR"));return}r=r.parent;++i}if(this.pending)return;this.pending=true;var a=function(){if(!this.absrefs)this.absrefs=this.refs.map(function(e){return e.absolute(this.row,this.col)},this);this.handler.call(n)}.bind(this);if(i<20)a();else setTimeout(a,0)}},reset:function(){this.onReady=[];this.pending=false;delete this.value},renameSheet:function(t,r){t=t.toLowerCase();this.absrefs=null;if(this.sheet.toLowerCase()==t)this.sheet=r;this.refs.forEach(function(e){e.renameSheet(t,r)})},adjust:function(t,r,n,i){t=t.toLowerCase();var a=this.row;var s=this.col;var c=this.sheet.toLowerCase();var o=false;if(c==t){if(r=="row"&&a>=n){this.row+=i;o=true}if(r=="col"&&s>=n){this.col+=i;o=true}}var h=this.row;var f=this.col;this.absrefs=null;var e=this.refs;var l=o;this.refs=e.map(function(e){var t=d(e);if(!l&&!b(t,e))l=true;return t});var u=this.arrayFormulaRange;if(u){this.arrayFormulaRange=d(u);if(!l&&!b(u,this.arrayFormulaRange))l=true}if(l)return new v(e,this.handler,this.print,this.sheet,a,s,u);function d(e){if(e===p)return e;if(e.sheet.toLowerCase()!=t){if(o){if(r=="row"&&a>=n)e=e.relative(i,0);if(r=="col"&&s>=n)e=e.relative(0,i)}return e}return e.adjust(a,s,h,f,r=="row",n,i)}},toString:function(){return this.print(this.row,this.col)}});function b(e,t){if(e.constructor!==t.constructor)return false;if(e instanceof c)return e.sheet==t.sheet&&e.row==t.row&&e.col==t.col&&e.rel==t.rel;if(e instanceof u)return b(e.topLeft,t.topLeft)&&b(e.bottomRight,t.bottomRight)&&e.endSheet==t.endSheet;if(e instanceof h){var r=e.refs.length;if(r!=t.refs.length)return false;while(--r>=0)if(!b(e.refs[r],t.refs[r]))return false}return true}var s=Object.create(null);function w(i,a){var s="function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ";var o="function resolve(args, callback) { var toResolve = [], i = 0; ";var l,n,e="'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; ",f=false;var d=false,p=false;e+=a.map(u).join("");e+="if (i < args.length) return new CalcError('N/A'); ";e+="return xargs; } ";s+="return { args: xargs, width: width, height: height, arrays: arrays }; } ";var t;if(f){o+="this.resolveCells(toResolve, callback); } ";t=new Function("CalcError","round",e+o+s+" return { resolve: resolve, check: check, arrayArgs: arrayArgs };")}else t=new Function("CalcError","round",e+" return { check: check };");t=t(g,y);if(!p)delete t.arrayArgs;return t;function u(e){l=e[0];var t="{ ";if(Array.isArray(l)){s+="while (i < args.length) { ";o+="while (i < args.length) { ";t+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";t+="while (i < args.length) { ";t+=e.map(u).join("");t+="} ";t+="xargs = stack.pop(); ";o+="} ";s+="} "}else if(l=="+"){s+="while (i < args.length) { ";o+="while (i < args.length) { ";t+="if (i >= args.length) return new CalcError('N/A'); ";t+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";t+="do { ";t+=e.slice(1).map(u).join("");t+="} while (i < args.length); ";t+="xargs = stack.pop(); ";o+="} ";s+="} "}else if(l=="?")t+="if (!("+h(e[1])+")) return new CalcError(err); ";else{var r=e[1];if(Array.isArray(r)&&/^#?collect/.test(r[0])){var n=/!$/.test(r[0]);var i=r[2];c();t+="try {"+"var $"+l+" = this.cellValues(args.slice(i";if(i)t+=", i + "+i;t+=")"+(n?",true":"")+").reduce(function(ret, $"+l+"){ ";if(r[0].charAt(0)!="#")t+="if ($"+l+" instanceof CalcError) throw $"+l+"; ";t+="if ("+h(r[1])+") ret.push($"+l+"); ";t+="return ret; ";t+="}.bind(this), []); ";if(i)t+="i += "+i+"; ";else t+="i = args.length; ";t+="xargs.push($"+l+")"+"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ";o+="toResolve.push(args.slice(i)); "}else if(r=="rest")t+="xargs.push(args.slice(i)); i = args.length; ";else{if(d=/^\*/.test(l)){p=true;l=l.substr(1)}t+="var $"+l+" = args[i++]; ";var a=false;if(/!$/.test(r)){r=r.substr(0,r.length-1);a=true}else t+="if ($"+l+" instanceof CalcError) return $"+l+"; ";t+=m(r,a)+"xargs.push($"+l+"); "}}t+="} ";return t}function c(){if(n)return"$"+l+"";f=true;n=true;o+="toResolve.push(args[i++]); ";return"($"+l+" = this.force($"+l+"))"}function r(e){return"("+(e?"(typeof "+c()+" == 'number' ? ($"+l+" = round($"+l+"), true) : false) || ":"(typeof "+c()+" == 'number') || ")+"(typeof $"+l+" == 'boolean' ? ($"+l+" = +$"+l+", true) : false) || "+"(typeof $"+l+" == 'string' && !/^(?:=|true|false)/i.test($"+l+") ? ("+"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $"+l+"), "+"/^date|number|percent$/.test(tmp.type) ? ($"+l+" = +tmp.value, true) : false"+") : false)"+")"}function m(e,t){n=false;var r="if (!("+h(e)+")) { ";if(n&&!t)r+=" if ($"+l+" instanceof CalcError) return $"+l+"; ";r+="return new CalcError(err); } ";if(!n)o+="i++; ";if(d)s+="var $"+l+" = this._arrayArg(args[i]); "+"if ($"+l+") { "+"xargs.push($"+l+"); "+"width = Math.max(width, $"+l+".width); "+"height = Math.max(height, $"+l+".height); "+"arrays.push(true) } else { "+"xargs.push(args[i]); "+"arrays.push(false); } i++; ";else s+="xargs.push(args[i++]); arrays.push(false); ";return r}function h(e){if(Array.isArray(e)){if(e[0]=="or")return"("+e.slice(1).map(h).join(") || (")+")";if(e[0]=="and")return"("+e.slice(1).map(h).join(") && (")+")";if(e[0]=="values")return"("+e.slice(1).map(function(e){return c()+" === "+e}).join(") || (")+")";if(e[0]=="null")return"("+h("null")+" ? (($"+l+" = "+e[1]+"), true) : false)";if(e[0]=="between"||e[0]=="[between]")return"("+c()+" >= "+e[1]+" && "+"$"+l+" <= "+e[2]+" ? true : ((err = 'NUM'), false))";if(e[0]=="(between)")return"("+c()+" > "+e[1]+" && "+"$"+l+" < "+e[2]+" ? true : ((err = 'NUM'), false))";if(e[0]=="(between]")return"("+c()+" > "+e[1]+" && "+"$"+l+" <= "+e[2]+" ? true : ((err = 'NUM'), false))";if(e[0]=="[between)")return"("+c()+" >= "+e[1]+" && "+"$"+l+" < "+e[2]+" ? true : ((err = 'NUM'), false))";if(e[0]=="assert"){var t=e[2]||"N/A";return"(("+e[1]+") ? true : (err = "+JSON.stringify(t)+", false))"}if(e[0]=="not")return"!("+h(e[1])+")";throw new Error("Unknown array type condition: "+e[0])}if(e=="number"||e=="datetime")return r(true);if(e=="number!")return"(typeof "+c()+" == 'number' ? ($"+l+" = round($"+l+"), true) : false)";if(e=="integer"||e=="date")return"("+r()+" && (($"+l+" |= 0), true))";if(e=="divisor")return"("+r(true)+" && ($"+l+" == 0 ? ((err = 'DIV/0'), false) : true))";if(e=="number+")return"("+r(true)+" && ($"+l+" >= 0 ? true : ((err = 'NUM'), false)))";if(e=="integer+")return"("+r()+" && (($"+l+" |= 0) >= 0 ? true : ((err = 'NUM'), false)))";if(e=="number++")return"("+r(true)+" && ($"+l+" > 0 ? true : ((err = 'NUM'), false)))";if(e=="integer++")return"("+r()+" && (($"+l+" |= 0) > 0 ? true : ((err = 'NUM'), false)))";if(e=="string")return"((typeof "+c()+" == 'string' || typeof $"+l+" == 'boolean' || typeof $"+l+" == 'number') ? ($"+l+" += '', true) : ($"+l+" === undefined ? (($"+l+" = ''), true) : false))";if(e=="boolean")return"(typeof "+c()+" == 'boolean')";if(e=="logical")return"(typeof "+c()+" == 'boolean' || (typeof $"+l+" == 'number' ? ($"+l+" = !!$"+l+", true) : false))";if(e=="matrix"){c();return"((m = this.asMatrix($"+l+")) ? ($"+l+" = m) : false)"}if(e=="#matrix")return"((m = this.asMatrix($"+l+")) ? ($"+l+" = m) : false)";if(e=="ref")return"($"+l+" instanceof kendo.spreadsheet.Ref)";if(e=="area")return"($"+l+" instanceof kendo.spreadsheet.CellRef || $"+l+" instanceof kendo.spreadsheet.RangeRef)";if(e=="cell")return"($"+l+" instanceof kendo.spreadsheet.CellRef)";if(e=="null")return"("+c()+" == null)";if(e=="anyvalue")return"("+c()+" != null && i <= args.length)";if(e=="forced")return"("+c()+", i <= args.length)";if(e=="anything")return"(i <= args.length)";if(e=="blank")return"("+c()+" == null || $"+l+" === '')";throw new Error("Can't check for type: "+e)}}function y(e){return e===parseInt(e,10)?e:+e.toPrecision(14)}function _(e){if(typeof e=="number")return y(e);else return e}function k(e,t,r){if(r instanceof g)return r;try{return t.apply(e,r)}catch(e){if(e instanceof g)return e;else throw e}}function x(l,t,u,c){return function(s,o){function e(){if(c){var e=c.call(this,o);o=e.args;if(e.width>0&&e.height>0){var t=new d(this);for(var r=0;r<e.height;++r)for(var n=0;n<e.width;++n){var i=[];for(var a=0;a<o.length;++a)if(e.arrays[a])i[a]=o[a].getNA(r,n);else i[a]=o[a];i=u.call(this,i);t.set(r,n,k(this,l,i))}return s(t)}}var i=u.call(this,o);s(k(this,l,i))}if(t)t.call(this,o,e);else e.call(this)}}function C(c,t,h,f){return function(l,u){function e(){if(f){var e=f.call(this,u);u=e.args;if(e.width>0&&e.height>0){var n=new d(this);var i=e.width*e.height;var t=function(t,r){return function(e){n.set(t,r,e);--i;if(i===0)return l(n)}};for(var r=0;r<e.height&&i>0;++r)for(var a=0;a<e.width&&i>0;++a){var s=[];for(var o=0;o<u.length;++o)if(e.arrays[o])s[o]=u[o].getNA(r,a);else s[o]=u[o];s=h.call(this,s);if(s instanceof g){n.set(r,a,s);--i;if(i===0)return l(n)}else{s.unshift(t(r,a));c.apply(this,s)}}return}}var e=h.call(this,u);if(e instanceof g)l(e);else{e.unshift(l);c.apply(this,e)}}if(t)t.call(this,u,e);else e.call(this)}}function t(i,a){i=i.toLowerCase();s[i]=a;return{args:function(e,t){var r=w(i,e);if(t){if(r.arrayArgs)console.log(r.arrayArgs.toString());if(r.resolve)console.log(r.resolve.toString());if(r.check)console.log(r.check.toString())}var n=s[i]=x(a,r.resolve,r.check,r.arrayArgs);n.kendoSpreadsheetArgs=e;return this},argsAsync:function(e,t){var r=w(i,e);if(t){if(r.arrayArgs)console.log(r.arrayArgs.toString());if(r.resolve)console.log(r.resolve.toString());if(r.check)console.log(r.check.toString())}var n=s[i]=C(a,r.resolve,r.check,r.arrayArgs);n.kendoSpreadsheetArgs=e;return this}}}function F(e,t,r){t++;return(1461*(e+4800+((t-14)/12|0))/4|0)+(367*(t-2-12*((t-14)/12|0))/12|0)-(3*((e+4900+((t-14)/12|0))/100|0)/4|0)+r-32075}function R(e){var t,r,n,i,a,s,o;t=e+68569;r=4*t/146097|0;t=t-((146097*r+3)/4|0);i=4e3*(t+1)/1461001|0;t=t-(1461*i/4|0)+31;n=80*t/2447|0;s=t-(2447*n/80|0);t=n/11|0;a=n+2-12*t;o=100*(r-49)+i+t;a--;return{year:o,month:a,date:s,day:(e+1)%7,ord:D[E(o)][a]+s}}s["if"]=function(t,e){var o=this;var r=e[0],n=e[1],i=e[2];this.resolveCells([r],function(){var e=o.asMatrix(r);if(e)n(function(s){i(function(n){var i=o.asMatrix(s);var a=o.asMatrix(n);t(e.map(function(e,t,r){if(e instanceof g)return e;else if(o.bool(e))return i?i.get(t,r):s;else return a?a.get(t,r):n}))})});else{r=this.force(r);if(r instanceof g)t(r);else if(o.bool(r))n(t);else i(t)}})},s["φ"]=function(e){e((1+Math.sqrt(5))/2)};var S=F(1900,0,-1),A=[31,28,31,30,31,30,31,31,30,31,30,31],D=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];function E(e){if(e%4)return 0;if(e%100)return 1;if(e%400)return 0;return 1}function B(e){return E(e)?366:365}function M(e,t){return E(e)&&t==1?29:A[t]}function T(e,t,r){return t>=1&&t<=12&&r>=1&&r<=M(e,t-1)}function I(e){return R((e|0)+S)}function L(e,t,r){return F(e,t,r)-S}var N=60*1e3,z=60*N,P=24*z;function H(e){var t=e-(e|0);if(t<0)t++;var r=Math.round(P*t);var n=Math.floor(r/z);r-=n*z;var i=Math.floor(r/N);r-=i*N;var a=Math.floor(r/1e3);r-=a*1e3;return{hours:n,minutes:i,seconds:a,milliseconds:r}}function O(e){var t=I(e),r=H(e);return new Date(t.year,t.month,t.date,r.hours,r.minutes,r.seconds,r.milliseconds)}function V(e,t,r,n){return(e+(t+(r+n/1e3)/60)/60)/24}function $(e){var t=V(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());e=L(e.getFullYear(),e.getMonth(),e.getDate());if(e<0)return e-1+t;else return e+t}function U(e,t){if(t)t=kendo.spreadsheet.formatting.makeDateFormat(t);return kendo.parseExactDate(e,t)||kendo.parseExactDate(e)||kendo.parseExactDate(e,["MMMM dd yyyy","MMMM dd yy","MMM dd yyyy","MMM dd yy","dd MMMM yyyy","dd MMMM yy","dd MMM yyyy","dd MMM yy","MMMM dd, yyyy","MMMM dd, yy","MMM dd, yyyy","MMM dd, yy","MMMM dd","MMM dd","MMMM yyyy","MMM yyyy","dd MMMM","dd MMM"])}e.CalcError=g,e.Formula=v,e.Matrix=d,e.packDate=L,e.unpackDate=I,e.packTime=V,e.unpackTime=H,e.serialToDate=O,e.dateToSerial=$,e.daysInMonth=M,e.validDate=T,e.isLeapYear=E,e.daysInYear=B,e.parseDate=U,e.limitPrecision=y,a.dateToNumber=$,a.numberToDate=O,a.defineFunction=t,a.CalcError=g,e.defineFunction=t,e.defineAlias=function(e,t){var r=s[t];if(!r)throw new Error("Function "+t+" is not yet defined");if(!r.kendoSpreadsheetAliases)r.kendoSpreadsheetAliases=[t];r.kendoSpreadsheetAliases.push(e);s[e]=r},e.FUNCS=s;var r=["or","number",["null",0]],W=[["*a",r],["*b",r]],n=[["*a","forced"],["*b","forced"]];function j(e,t){e=typeof e==="string"?e.toLowerCase():e;t=typeof t==="string"?t.toLowerCase():t;if(e===false&&t==null)return true;if(t===false&&e==null)return true;if(e===0&&t==null)return true;if(t===0&&e==null)return true;if(e===""&&t==null)return true;if(t===""&&e==null)return true;return e===t}function q(r){return function(e,t){if(typeof e=="string"&&typeof t!="string")t=t==null?"":t+"";if(typeof e!="string"&&typeof t=="string")e=e==null?"":e+"";if(typeof e=="number"&&t==null)t=0;if(typeof t=="number"&&e==null)e=0;if(typeof e=="string"&&typeof t=="string"){e=e.toLowerCase();t=t.toLowerCase()}if(typeof t==typeof e)return r(e,t);else return new g("VALUE")}}t("binary+",function(e,t){return e+t}).args(W),t("binary-",function(e,t){return e-t}).args(W),t("binary*",function(e,t){return e*t}).args(W),t("binary/",function(e,t){return e/t}).args([["*a",r],["*b","divisor"]]),t("binary^",function(e,t){return Math.pow(e,t)}).args(W),t("binary&",function(e,t){if(e==null)e="";if(t==null)t="";return""+e+t}).args([["*a",["or","number","string","boolean","null"]],["*b",["or","number","string","boolean","null"]]]),t("binary=",j).args(n),t("binary<>",function(e,t){return!j(e,t)}).args(n),t("binary<",q(function(e,t){return e<t})).args(n),t("binary<=",q(function(e,t){return e<=t})).args(n),t("binary>",q(function(e,t){return e>t})).args(n),t("binary>=",q(function(e,t){return e>=t})).args(n),t("unary+",function(e){return e}).args([["*a",r]]),t("unary-",function(e){return-e}).args([["*a",r]]),t("unary%",function(e){return e/100}).args([["*a",r]]),t("binary:",function(e,t){return new u(e,t).setSheet(e.sheet||this.formula.sheet,e.hasSheet())}).args([["a","cell"],["b","cell"]]),t("binary,",function(e,t){return new h([e,t])}).args([["a","ref"],["b","ref"]]),t("binary ",function(e,t){return e.intersect(t)}).args([["a","ref"],["b","ref"]]),t("not",function(e){return!this.bool(e)}).args([["*a",["or","anyvalue",["null",0]]]]),t("isblank",function(e){if(e instanceof c){e=this.getRefData(e);return e==null}return false}).args([["*value","anything!"]]),t("iserror",function(e){return e instanceof g}).args([["*value","forced!"]]),t("iserr",function(e){return e instanceof g&&e.code!="N/A"}).args([["*value","forced!"]]),t("isna",function(e){return e instanceof g&&e.code=="N/A"}).args([["*value","forced!"]]),t("islogical",function(e){return typeof e=="boolean"}).args([["*value","forced!"]]),t("isnontext",function(e){return typeof e!="string"}).args([["*value","forced!"]]),t("istext",function(e){return typeof e=="string"}).args([["*value","forced!"]]),t("isnumber",function(e){return typeof e=="number"}).args([["*value","forced!"]]),t("isref",function(e){return e instanceof c||e instanceof u}).args([["*value","anything!"]]),s[",getname"]=function(e,t){this.fetchName(t[0],e)}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/validation.min",["./runtime.min"],function(){"use strict";var l=kendo.jQuery,e=kendo.spreadsheet,u={},c=(e.validation=u,e.calc),t=kendo.Class,h="_matrix({0})",f='DATEVALUE("{0}")';function r(e,t,r,n){var i;var a;var s;var o;if(typeof n==="string")n=JSON.parse(n);if(n.from){if(n.dataType==="list"&&!n.fromIsListValue){if(n.from.indexOf("{")>-1)n.from=n.from.replace(/\"/g,"").replace("{",'"').replace("}",'"');n.from=kendo.format(h,n.from);n.fromIsListValue=true}if(n.dataType==="date"){s=c.runtime.parseDate(n.from);if(s){n.from=kendo.format(f,n.from);n.fromIsDateValue=true}}n.from=c.compile(c.parseFormula(e,t,r,n.from))}if(n.to){if(n.dataType==="date"){o=c.runtime.parseDate(n.to);if(o){n.to=kendo.format(f,n.to);n.toIsDateValue=true}}n.to=c.compile(c.parseFormula(e,t,r,n.to))}if(n.dataType=="custom")a=u.validationComparers.custom;else if(n.dataType=="list")a=u.validationComparers.list;else a=u.validationComparers[n.comparerType];if(!a)throw kendo.format("'{0}' comparer is not implemented.",n.comparerType);i=function(e){var t=this.to&&(this.to_value||this.to_value===0)?this.to_value:undefined;if(e===null||e==="")if(this.allowNulls)this.value=true;else this.value=false;else if(this.dataType=="custom")this.value=a(e,this.from_value,t);else if(this.dataType=="list"){var r=this._getListData();this.value=a(e,r,t)}else this.value=a(e,this.from_value,t);return this.value};return new kendo.spreadsheet.validation.Validation(l.extend(n,{handler:i,sheet:e,row:t,col:r}))}c.runtime.defineFunction("_matrix",function(e){if(typeof e=="string")e=this.asMatrix([e.split(/\s*,\s*/)]);return e}).args([["m",["or","matrix","string"]]]);var d=t.extend({init:function e(t){this.handler=t.handler;this.from=t.from;this.to=t.to;this.dataType=t.dataType;this.comparerType=t.comparerType;this.type=t.type?t.type:"warning";this.allowNulls=t.allowNulls?true:false;this.fromIsDateValue=t.fromIsDateValue?true:false;this.toIsDateValue=t.toIsDateValue?true:false;this.showButton=t.showButton;this.fromIsListValue=t.fromIsListValue?true:false;this.sheet=t.sheet;this.row=t.row;this.col=t.col;if(t.tooltipMessageTemplate)this.tooltipMessageTemplate=t.tooltipMessageTemplate;if(t.tooltipTitleTemplate)this.tooltipTitleTemplate=t.tooltipTitleTemplate;if(t.messageTemplate)this.messageTemplate=t.messageTemplate;if(t.titleTemplate)this.titleTemplate=t.titleTemplate},_formatMessages:function(e){var t=this.from?this.from_value:"";var r=this.to?this.to_value:"";var n=this.from?this.from.toString():"";var i=this.to?this.to.toString():"";var a=this.dataType;var s=this.type;var o=this.comparerType;return kendo.format(e,t,r,n,i,a,s,o)},_setMessages:function(){this.title="";this.message="";if(this.tooltipTitleTemplate)this.tooltipTitle=this._formatMessages(this.tooltipTitleTemplate);if(this.tooltipMessageTemplate)this.tooltipMessage=this._formatMessages(this.tooltipMessageTemplate);if(this.titleTemplate)this.title=this._formatMessages(this.titleTemplate);if(this.messageTemplate)this.message=this._formatMessages(this.messageTemplate)},_getListData:function(){if(!this.from_value||!this.from_value.data)return[];var e=this.from_value.data;var t;var r;var n=[];for(t=0;t<e.length;t++){var i=e[t];if(i)for(r=0;r<i.length;r++)n.push(i[r])}return n},clone:function(e,t,r){var n=this._getOptions();if(n.from)n.from=n.from.clone(e,t,r);if(n.to)n.to=n.to.clone(e,t,r);return new d(l.extend(n,{handler:this.handler},{sheet:e,row:t,col:r}))},deepClone:function(){var e=new d(this);e.from=e.from.deepClone();if(e.to)e.to=e.to.deepClone();return e},exec:function(t,r,n,i){var a=this;function s(e){if(e instanceof kendo.spreadsheet.Ref){e=t.getData(e);if(Array.isArray(e))e=e[0]}return e}var o=function(e){a.from_value=s(e);a.value=a.handler.call(a,r,n);a._setMessages();if(i)i(a.value)};if(a.to)a.to.exec(t,function(e){a.to_value=s(e);a.from.exec(t,o)});else a.from.exec(t,o)},reset:function(){if(this.from)this.from.reset();if(this.to)this.to.reset();delete this.value},adjust:function(e,t,r,n){var i,a,s;var o=this.row;var l=this.col;if(this.from)i=this.from.adjust(e,t,r,n);if(this.to)a=this.to.adjust(e,t,r,n);if(this.sheet.toLowerCase()==e.toLowerCase())switch(t){case"row":if(o>=r){s=true;this.row+=n}break;case"col":if(l>=r){s=true;this.col+=n}break}if(s||i||a){var u=new d(this);u.from=i;u.to=a;u.row=o;u.col=l;return u}},toJSON:function(){var e=this._getOptions();if(e.from){e.from=e.from.toString();if(e.dataType==="list"){e.from=e.from.replace(/^_matrix\((.*)\)$/i,"$1");delete e.fromIsListValue}if(e.dataType==="date")if(this.fromIsDateValue){e.from=e.from.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");delete e.fromIsDateValue}}if(e.to){e.to=e.to.toString();if(e.dataType==="date")if(this.toIsDateValue){e.to=e.to.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");delete e.toIsDateValue}}return e},_getOptions:function(){return{from:this.from,to:this.to,dataType:this.dataType,type:this.type,comparerType:this.comparerType,row:this.row,col:this.col,sheet:this.sheet,allowNulls:this.allowNulls,fromIsListValue:this.fromIsListValue,fromIsDateValue:this.fromIsDateValue,toIsDateValue:this.toIsDateValue,tooltipMessageTemplate:this.tooltipMessageTemplate,tooltipTitleTemplate:this.tooltipTitleTemplate,messageTemplate:this.messageTemplate,titleTemplate:this.titleTemplate,showButton:this.showButton}}});u.compile=r,u.validationComparers={greaterThan:function(e,t){return e>t},lessThan:function(e,t){return e<t},between:function(e,t,r){return e>=t&&e<=r},equalTo:function(e,t){return e==t},notEqualTo:function(e,t){return e!=t},greaterThanOrEqualTo:function(e,t){return e>=t},lessThanOrEqualTo:function(e,t){return e<=t},notBetween:function(e,t,r){return e<t||e>r},custom:function(e,t){return t},list:function(e,t){return t.indexOf(e)>-1}},u.Validation=d})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/sheet.min",["../kendo.core.min","../kendo.color.min","./runtime.min","./validation.min","./references.min"],function(){var d=kendo,h=d.spreadsheet.RangeRef,r=d.spreadsheet.UnionRef,f=d.spreadsheet.CellRef,p=d.spreadsheet.Range,o,l=d.Class.extend({init:function(e){this._sheet=e;this.selection=d.spreadsheet.FIRSTREF.toRangeRef();this.originalSelection=d.spreadsheet.FIRSTREF.toRangeRef();this._activeCell=d.spreadsheet.FIRSTREF.toRangeRef();this.originalActiveCell=d.spreadsheet.FIRSTREF},currentSelectionRange:function(){return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef()},currentOriginalNavigationRange:function(){return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef()},currentNavigationRange:function(){if(this.singleCellSelection())return this._sheet._sheetRef;else return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef()},nextNavigationRange:function(){if(!this.singleCellSelection())this.selectionRangeIndex=this.selection.nextRangeIndex(this.selectionRangeIndex);return this.currentNavigationRange()},previousNavigationRange:function(){if(!this.singleCellSelection())this.selectionRangeIndex=this.selection.previousRangeIndex(this.selectionRangeIndex);return this.currentNavigationRange()},activeCell:function(e){if(e){this.originalActiveCell=e.first();this._activeCell=this._sheet.unionWithMerged(e.toRangeRef());this._sheet.focus(e);this._sheet.triggerChange({activeCell:true,selection:true})}return this._activeCell},select:function(t,e,c,r){if(t){if(t.eq(this.originalSelection))return;this._sheet.triggerSelect(new p(t,this._sheet));this.originalSelection=t;this.selection=e;if(c!==false){if(t.isCell()){this._sheet.forEachMergedCell(t,function(e){t=e.topLeft});this.activeCell(t)}else{t=this.selection.lastRange();if(r&&r._sheet===this._sheet&&r.panes[0]){var n=r.panes;var i,a,s,o,l,u;for(i=0;i<n.length;i++){a=n[i];s=a._currentView.rows.values;o=a._currentView.columns.values;l=new h(new f(s.start,o.start),new f(s.end,o.end));u=t.intersect(l);if(u!==d.spreadsheet.NULLREF)break}if(u&&u!==d.spreadsheet.NULLREF)t=u}this.activeCell(t.first())}this.selectionRangeIndex=this.selection.size()-1}else this._sheet.triggerChange({selection:true})}return this.selection},singleCellSelection:function(){return this._activeCell.eq(this.selection)}}),e=d.Observable.extend({init:function(){d.Observable.prototype.init.call(this);this._reinit.apply(this,arguments)},events:["changing","commandRequest","afterInsertRow","afterDeleteRow","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","dataBinding","dataBound","progress"],_reinit:function(e,t,r,n,i,a,s){s=s||{};this._defaultCellStyle={background:s.background,color:s.color,fontFamily:s.fontFamily,fontSize:s.fontSize,italic:s.italic,bold:s.bold,underline:s.underline,wrap:s.wrap,verticalAlign:s.verticalAlign,textAlign:s.textAlign};this._rows=new d.spreadsheet.Axis(e,r);this._columns=new d.spreadsheet.Axis(t,n);this._filteredRows=new d.spreadsheet.RangeList(0,e-1,false);this._mergedCells=[];this._frozenRows=0;this._frozenColumns=0;this._suspendChanges=false;this._filter=null;this._showGridLines=true;this._gridLinesColor=null;this._grid=new d.spreadsheet.Grid(this._rows,this._columns,e,t,i,a);this._sheetRef=this._grid.normalize(d.spreadsheet.SHEETREF);this._properties=new d.spreadsheet.PropertyBag(e,t,this._defaultCellStyle);this._sorter=new d.spreadsheet.Sorter(this._grid,this._properties.sortable());this._viewSelection=new l(this);this._editSelection=new l(this);this._formulaSelections=[];this._drawings=[]},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection},navigator:function(){if(!this._navigator)this._navigator=new d.spreadsheet.SheetNavigator(this);return this._navigator},axisManager:function(){if(!this._axisManager)this._axisManager=new d.spreadsheet.AxisManager(this);return this._axisManager},_name:function(e){if(!e)return this._sheetName;this._sheetName=e;return this},name:function(){return this._name()},_property:function(e,t,r){if(t===undefined)return e();else{e(t);return this.triggerChange(r)}},_field:function(e,t,r){if(t===undefined)return this[e];else{this[e]=t;return this.triggerChange(r)}},suspendChanges:function(e){if(e===undefined)return this._suspendChanges;this._suspendChanges=e;return this},triggerChange:function(e){if(!this._suspendChanges)this.trigger("change",e);return this},triggerSelect:function(e){this.trigger("select",{range:e})},setDataSource:function(e,t){if(this.dataSourceBinder)this.dataSourceBinder.destroy();this.dataSourceBinder=new d.spreadsheet.SheetDataSourceBinder({dataSource:e,sheet:this,columns:t});this.dataSource=this.dataSourceBinder.dataSource},hideColumn:function(e){if(this.trigger("hideColumn",{index:e}))return;return this._property(this._columns.hide.bind(this._columns),e,{layout:true})},unhideColumn:function(e){if(this.trigger("unhideColumn",{index:e}))return;return this._property(this._columns.unhide.bind(this._columns),e,{layout:true})},isHiddenColumn:function(e){return this._grid._columns.hidden(e)},_copyRange:function(e,t){var r=this._grid;var n=r.rowCount;var i=r.normalize(e.topLeft);var a=r.normalize(e.bottomRight);var s=i.col*n+i.row;var o=a.col*n+a.row;var l=t.col*n+t.row;this._properties.copy(s,o,l)},_saveModifiedFormulas:function(e,t){var r=o;o=e;var n=t();o=r;return n},_restoreModifiedFormulas:function(e){var n=this._workbook;e.forEach(function(e){var t=n.sheetByName(e.sheet),r;if(e instanceof d.spreadsheet.calc.runtime.Formula){r=t._grid.cellRefIndex(e);t._properties.set("formula",r,r,e)}if(e instanceof d.spreadsheet.validation.Validation){r=t._grid.cellRefIndex(e);t._properties.set("validation",r,r,e)}})},_adjustReferences:function(r,n,i,e){this._mergedCells=e.reduce(function(e,t){t=t.adjust(null,null,null,null,r=="row",n,i);if(t instanceof h)e.push(t);return e},[]);if(this._workbook){var a=this._name();this._workbook._sheets.forEach(function(e){e._forFormulas(function(e){var t=e.adjust(a,r,n,i);if(t&&o)o.push(t)});e._forValidations(function(e){var t=e.adjust(a,r,n,i);if(t&&o)o.push(t)})});this._workbook.adjustNames(a,r=="row",n,i)}var t=this.select();t=t.adjust(null,null,null,null,r=="row",n,i);if(t!==d.spreadsheet.NULLREF)this.select(t);var s=r=="col"?this._columns:this._rows;s.adjust(n,i);if(r=="row")if(i<0)this._filteredRows.copy(n-i,this._rows._count-1,n);else{this._filteredRows.copy(n,this._rows._count,n+i);this._filteredRows.value(n,n+i-1,false)}this._drawings.forEach(function(e){if(e.topLeftCell)e.topLeftCell=e.topLeftCell.adjust(null,null,null,null,r=="row",n,i)})},_forFormulas:function(r){var e=this._properties;var t=e.get("formula").values();var n=t.length;t.forEach(function(e,t){r.call(this,e.value,t,n)},this)},_forValidations:function(t){var e=this._properties;e.get("validation").values().forEach(function(e){t.call(this,e.value)},this)},preventInsertRow:function(e,t){if(this.selectedHeaders().allRows)return{reason:"error",type:"insertRowWhenColumnIsSelected"};t=t||1;var r=this._grid;var n=this.range(r.rowCount-t,0,t,r.columnCount);if(n.hasValue())return{reason:"error",type:"shiftingNonblankCells"};return false},preventInsertBelowLastRow:function(e,t){t=t||1;if(e+t===this._rows._count)return{reason:"error",type:"insertRowBelowLastRow"};return false},preventInsertColumn:function(e,t){if(this.selectedHeaders().allCols)return{reason:"error",type:"insertColumnWhenRowIsSelected"};t=t||1;var r=this._grid;var n=this.range(0,r.columnCount-t,r.rowCount,t);if(n.hasValue())return{reason:"error",type:"shiftingNonblankCells"};return false},preventInsertAfterLastColumn:function(e,t){t=t||1;if(e+t===this._columns._count)return{reason:"error",type:"insertColAfterLastCol"};return false},insertRow:function(c,e){var t=this.preventInsertRow(c);if(t)throw new Error("Shifting nonblank cells off the worksheet is not supported!");if(this.trigger("insertRow",{index:c}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var r=e.rowCount;var n=this.frozenRows();if(c<n)this.frozenRows(n+1);var i=this._mergedCells.slice();for(var a=0;a<t;a++){var s=new h(new f(c,a),new f(c,a));var o=e.normalize(s.topLeft);var l=e.normalize(s.bottomRight);var u=new h(new f(o.row,o.col),new f(r-2,l.col));this._copyRange(u,new f(o.row+1,o.col));new p(s,this).clear({clearAll:true,keepBorders:true})}this._adjustReferences("row",c,1,i)},{recalc:true,layout:true,insertRow:{index:c},ref:new h(new f(c,0),new f(Infinity,Infinity))});if(!e)this.trigger("afterInsertRow",{index:c});return this},isEnabledRow:function(e){var t=new h(new f(e,0),new f(e,this._grid.columnCount));return new p(t,this).enable()},deleteRow:function(c,e){if(!this.isEnabledRow(c))return this;if(this.trigger("deleteRow",{index:c}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var r=this.frozenRows();if(c<r)this.frozenRows(r-1);var n=this._mergedCells.slice();for(var i=0;i<t;i++){var a=new h(new f(c,i),new f(c,i));new p(a,this).clear({clearAll:true,keepBorders:true});var s=e.normalize(a.topLeft);var o=e.normalize(a.bottomRight);var l=new h(new f(s.row+1,s.col),new f(Infinity,o.col));this._copyRange(l,s);var u=e.normalize(l.bottomRight);new p(new h(u,u),this).clear()}this._adjustReferences("row",c,-1,n)},{recalc:true,layout:true,deleteRow:{index:c},ref:new h(new f(c,0),new f(Infinity,Infinity))});if(!e)this.trigger("afterDeleteRow",{index:c});return this},insertColumn:function(u){if(this.trigger("insertColumn",{index:u}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var r=this.frozenColumns();if(u<r)this.frozenColumns(r+1);var n=this._mergedCells.slice();for(var i=t;i>=u;i--){var a=new h(new f(0,i),new f(Infinity,i));new p(a,this).clear({clearAll:true,keepBorders:true});if(i==u)break;var s=e.normalize(a.topLeft);var o=e.normalize(a.bottomRight);var l=new h(new f(s.row,s.col-1),new f(o.row,o.col-1));this._copyRange(l,s)}this._adjustReferences("col",u,1,n)},{recalc:true,layout:true,insertColumn:{index:u},ref:new h(new f(0,u),new f(Infinity,Infinity))});return this},isEnabledColumn:function(e){var t=new h(new f(0,e),new f(Infinity,e));return new p(t,this).enable()},deleteColumn:function(u){if(!this.isEnabledColumn(u))return this;if(this.trigger("deleteColumn",{index:u}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var r=this.frozenColumns();if(u<r)this.frozenColumns(r-1);var n=this._mergedCells.slice();for(var i=u;i<t;i++){var a=new h(new f(0,i),new f(Infinity,i));new p(a,this).clear({clearAll:true,keepBorders:true});if(i==t-1)break;var s=e.normalize(a.topLeft);var o=e.normalize(a.bottomRight);var l=new h(new f(s.row,s.col+1),new f(o.row,o.col+1));this._copyRange(l,s)}this._adjustReferences("col",u,-1,n)},{recalc:true,layout:true,deleteColumn:{index:u},ref:new h(new f(0,u),new f(Infinity,Infinity))});return this},_filterRow:function(e){this._rows.hide(e);this._filteredRows.value(e,e,true);this.triggerChange({layout:true})},hideRow:function(e){if(this.trigger("hideRow",{index:e}))return;return this._property(this._rows.hide.bind(this._rows),e,{layout:true})},unhideRow:function(e){if(this.trigger("unhideRow",{index:e}))return;return this._property(this._rows.unhide.bind(this._rows),e,{layout:true})},isHiddenRow:function(e){return this._grid._rows.hidden(e)},isFilteredRow:function(e){return this._filteredRows.value(e)},columnWidth:function(e,t){return this._property(this._columns.value.bind(this._columns,e,e),t,{layout:true})},rowHeight:function(e,t){return this._property(this._rows.value.bind(this._rows,e,e),t,{layout:true})},frozenRows:function(e){return this._field("_frozenRows",e,{layout:true})},frozenColumns:function(e){return this._field("_frozenColumns",e,{layout:true})},showGridLines:function(e){return this._field("_showGridLines",e,{layout:true})},gridLinesColor:function(e){return this._field("_gridLinesColor",e,{layout:true})},_ref:function(e,t,r,n){var i=null;if(e instanceof d.spreadsheet.Ref)return e;if(e instanceof d.spreadsheet.Range)return e._ref.toRangeRef();if(typeof e==="string")i=d.spreadsheet.calc.parseReference(e);else{if(!r)r=1;if(!n)n=1;i=new h(new f(e,t),new f(e+r-1,t+n-1))}return i},range:function(e,t,r,n){return new p(this._ref(e,t,r,n),this)},_getMergedCells:function(n){var e=this._grid;var i={};var a={};var s=false;this.forEachMergedCell(n,function(t){var r=t.topLeft;e.forEach(t,function(e){if(r.eq(e)){i[e.print()]=t;s=true}else if(n.contains(e)){a[e.print()]=r;s=true}})});return{primary:i,secondary:a,hasMerged:s}},forEachMergedCell:function(t,r){var n=false;if(typeof r==="undefined"){r=t;n=true}this._mergedCells.forEach(function(e){if(n||e.intersects(t))r(e)})},forEachFilterHeader:function(t,e){var r=false;if(typeof e==="undefined"){e=t;r=true}if(this._filter){var n=[];this._filter.ref.forEachColumn(function(e){if(r||e.intersects(t))n.push(e.topLeft)});this._mergedCells.forEach(function(t){n=n.map(function(e){if(t.intersects(e))return t;return e})});n.reduce(function e(t,r){if(t.indexOf(r)<0)t.push(r);return t},[]).forEach(e)}},forEach:function(e,l){var u=this;function t(e){if(!(e instanceof h))e=e.toRangeRef();var t=u._grid.normalize(e.topLeft);var r=u._grid.normalize(e.bottomRight);var n,i;function a(e){l(i++,n,e)}for(n=t.col;n<=r.col;n++){i=t.row;var s=u._grid.index(i,n);var o=u._grid.index(r.row,n);u._properties.forEach(s,o,a)}}if(!(e instanceof h))e=u._ref(e);if(e instanceof r)e.forEach(t);else t(e)},startResizing:function(e){this._initialPosition=e;this._resizeInProgress=true},startAutoFill:function(){this._autoFillInProgress=true;var e=this.select();this._autoFillOrigin=e;this._autoFillDest=e;this.triggerChange({selection:true})},updateAutoFill:function(e,t,r,n){this._autoFillDest=e;this._autoFillPunch=t;this._autoFillHint=r;this._autoFillDirection=n;this.triggerChange({selection:true})},autoFillRef:function(){return this._autoFillDest},autoFillPunch:function(){return this._autoFillPunch},autoFillInProgress:function(){return this._autoFillInProgress},resizingInProgress:function(){return this._resizeInProgress},draggingInProgress:function(){return this._draggingInProgress},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;var e=this.resizeHintPosition();if(this._initialPosition&&e){var t=this.resizeHandlePosition();if(t.col!==-Infinity)this.trigger("commandRequest",{command:"ColumnWidthCommand",options:{target:t.col,value:this.columnWidth(t.col)-(this._initialPosition.x-e.x)}});else this.trigger("commandRequest",{command:"RowHeightCommand",options:{target:t.row,value:this.rowHeight(t.row)-(this._initialPosition.y-e.y)}})}else this.trigger("change",{resize:true})}},_renderComment:function(e){var t=e?this.range(e).comment():null;if(t){if(!this._commentRef||!e.eq(this._commentRef)){this._commentRef=e;this.trigger("change",{comment:true})}}else if(this._commentRef){this._commentRef=null;this.trigger("change",{comment:true})}},resizeHandlePosition:function(){return this._resizeHandlePosition},resizeHintPosition:function(e){if(e!==undefined){this._resizeHintPosition=e;this.trigger("change",{resize:true})}return this._resizeHintPosition},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=undefined;this._resizeHandlePosition=undefined;this._initialPosition=undefined;this.trigger("change",{resize:true})}},positionResizeHandle:function(e){this._resizeHandlePosition=e;this.trigger("change",{resize:true})},startDragging:function(e){this._draggingInProgress=e},completeDragging:function(){var e=this._draggingInProgress;if(e){this._draggingInProgress=null;var t=e.drawing;if(t.eq(e.copy))return;if(t.topLeftCell){var r=this.drawingBoundingBox(t);var n=this._rows.indexVisible(r.top);var i=this._columns.indexVisible(r.left);var a=new f(n,i);var s=this.refBoundingBox(a);t.offsetX=r.left-s.left;t.offsetY=r.top-s.top;t.topLeftCell=a;this.triggerChange({dragging:true})}this.trigger("commandRequest",{command:"DrawingUpdateCommand",options:{sheet:this,drawing:t,previous:e.copy}})}},startSelection:function(e){if(this.frozenRows()||this.frozenColumns())this._currentView=null;else if(e&&e._sheet===this)this._currentView=e;this._selectionInProgress=true},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;this._resizeHintPosition=undefined;this.trigger("change",{selection:true})}if(this._autoFillInProgress){this._autoFillInProgress=false;var e=this._autoFillDest;var t=this._autoFillOrigin;if(this._autoFillPunch)this.trigger("commandRequest",{command:"ClearContentCommand",options:{operatingRange:this.range(this._autoFillPunch)}});else if(!e.eq(t))this.trigger("commandRequest",{command:"AutoFillCommand",options:{operatingRange:this.range(e),origin:this.range(t)}});else this.triggerChange({selection:true});this._autoFillDest=null;this._autoFillPunch=null;this._autoFillOrigin=null;this.select(e)}},selectionInProgress:function(){return this._selectionInProgress},select:function(e,t){var r=this._selectionState();var n;if(e){e=this._ref(e);e=this._grid.normalize(e);n=this._grid.isAxis(e)?e:this.unionWithMerged(e)}return r.select(e,n,t,this._currentView)},originalSelect:function(){return this._selectionState().originalSelection},currentSelectionRange:function(){return this._selectionState().currentSelectionRange()},currentOriginalSelectionRange:function(){return this._selectionState().currentOriginalNavigationRange()},currentNavigationRange:function(){return this._selectionState().currentNavigationRange()},nextNavigationRange:function(){return this._selectionState().nextNavigationRange()},previousNavigationRange:function(){return this._selectionState().previousNavigationRange()},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex},activeCell:function(e){return this._selectionState().activeCell(e)},originalActiveCell:function(){return this._selectionState().originalActiveCell},singleCellSelection:function(){return this._selectionState().singleCellSelection()},unionWithMerged:function(e){var t=this._mergedCells;return e.map(function(e){return e.toRangeRef().union(t)})},trim:function(t){var r=[];var n=this._grid;this._properties.forEachProperty(function(e){r.push(n.trim(t,e.list))});return this.unionWithMerged(t.topLeft.toRangeRef().union(r))},focus:function(e){if(e)this._focus=e.toRangeRef();else{var t=this._focus;this._focus=null;return t}},activeCellSelection:function(){return new p(this._grid.normalize(this.activeCell()),this)},selection:function(){return new p(this._grid.normalize(this._selectionState().selection),this)},selectedHeaders:function(){var e=this.select();var l={};var u={};var c=false;var h=false;var f=this._grid.rowCount-1;var d=this._grid.columnCount-1;e.forEach(function(e){var t;var r="partial";var n="partial";e=e.toRangeRef();var i=e.bottomRight;var a=e.topLeft;var s=a.col<=0&&i.col>=d;var o=a.row<=0&&i.row>=f;if(o){h=true;n="full"}if(s){c=true;r="full"}if(!o)for(t=a.row;t<=i.row;t++)if(l[t]!=="full")l[t]=r;if(!s)for(t=a.col;t<=i.col;t++)if(u[t]!=="full")u[t]=n});return{rows:l,cols:u,allRows:h,allCols:c,all:h&&c}},isInEditMode:function(e){if(e===undefined)return this._inEdit;this._inEdit=e;if(e){this._editSelection.selection=this._viewSelection.selection.clone();this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();this._editSelection._activeCell=this._viewSelection._activeCell.clone();this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone()}},_setFormulaSelections:function(e){this._formulaSelections=(e||[]).slice();this.triggerChange({selection:true})},_viewActiveCell:function(){return this._viewSelection._activeCell.toRangeRef()},toJSON:function(){var i={};var a=this._rows.toJSON("height",i);var e=this._columns.toJSON("width",{});var t=this._viewSelection;var s=[];var r=this._defaultCellStyle||{};function o(t){Object.keys(r).forEach(function(e){if(t[e]===r[e])delete t[e]})}this.forEach(d.spreadsheet.SHEETREF,function(e,t,r){o(r);if(Object.keys(r).length===0)return;if(r.link)s.push({ref:d.spreadsheet.Ref.display(null,e,t),target:r.link});var n=i[e];if(n===undefined){n=a.length;a.push({index:e});i[e]=n}e=a[n];r.index=t;if(e.cells===undefined)e.cells=[];if(r.formula)if(r.formula.arrayFormulaRange)r.formula={src:r.formula.toString(),ref:r.formula.arrayFormulaRange.toString()};else r.formula=r.formula.toString();if(r.validation)r.validation=r.validation.toJSON();if(r.color)r.color=d.parseColor(r.color).toCss();if(r.background)r.background=d.parseColor(r.background).toCss();if(r.borderTop&&r.borderTop.color)r.borderTop.color=d.parseColor(r.borderTop.color).toCss();if(r.borderBottom&&r.borderBottom.color)r.borderBottom.color=d.parseColor(r.borderBottom.color).toCss();if(r.borderRight&&r.borderRight.color)r.borderRight.color=d.parseColor(r.borderRight.color).toCss();if(r.borderLeft&&r.borderLeft.color)r.borderLeft.color=d.parseColor(r.borderLeft.color).toCss();e.cells.push(r)});var n={name:this._name(),rows:a,columns:e,selection:t.selection.toString(),activeCell:t.activeCell().toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),showGridLines:this.showGridLines(),gridLinesColor:this.gridLinesColor(),mergedCells:this._mergedCells.map(function(e){return e.toString()}),hyperlinks:s,defaultCellStyle:r,drawings:this._drawings.map(function(e){return e.toJSON()})};if(this._sort)n.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(e){return{index:e.index,ascending:e.ascending}})};if(this._filter)n.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(e){var t=e.filter.toJSON();t.index=e.index;return t})};return n},fromJSON:function(f){this.batch(function(){if(f.name!==undefined)this._name(f.name);if(f.frozenColumns!==undefined)this.frozenColumns(f.frozenColumns);if(f.frozenRows!==undefined)this.frozenRows(f.frozenRows);if(f.columns!==undefined)this._columns.fromJSON("width",f.columns);if(f.rows!==undefined){this._rows.fromJSON("height",f.rows);for(var e=0;e<f.rows.length;e++){var t=f.rows[e];var r=t.index;if(r===undefined)r=e;if(t.cells)for(var n=0;n<t.cells.length;n++){var i=t.cells[n];var a=i.index;if(a===undefined)a=n;if(i.formula){var s=typeof i.formula!="string";var c=s?i.formula.src:i.formula;var o=this._compileFormula(r,a,c);if(s)o.setArrayFormulaRange(d.spreadsheet.calc.parseReference(i.formula.ref));i.formula=o}if(i.validation)i.validation=this._compileValidation(r,a,i.validation);this._properties.fromJSON(this._grid.index(r,a),i)}}}if(f.drawings)this._drawings=f.drawings.map(m.fromJSON);if(f.selection)this._viewSelection.selection=this._viewSelection.originalSelection=this._ref(f.selection);if(f.activeCell){var l=this._ref(f.activeCell);this._viewSelection._activeCell=l.toRangeRef();this._viewSelection.originalActiveCell=l.first()}if(f.mergedCells)f.mergedCells.forEach(function(e){this.range(e).merge()},this);if(f.sort)this._sort={ref:this._ref(f.sort.ref),columns:f.sort.columns.slice(0)};if(f.filter){var u=f.filter.ref;var h=f.filter.columns===undefined?[]:f.filter.columns;if(!u)d.logToConsole("Dropping filter for sheet '"+f.name+"' due to missing ref");else{this._filter={ref:this._ref(u),columns:h.map(function(e){return{index:e.index,filter:d.spreadsheet.Filter.create(e)}})};this._refreshFilter()}}if(f.showGridLines!==undefined)this._showGridLines=f.showGridLines;this._gridLinesColor=f.gridLinesColor});this._rows._refresh();this._columns._refresh()},formula:function(e){return this._properties.get("formula",this._grid.cellRefIndex(e))},validation:function(e){return this._properties.get("validation",this._grid.cellRefIndex(e))},resetFormulas:function(){this._forFormulas(function(e){e.reset()})},resetValidations:function(){this._forValidations(function(e){e.reset()})},recalc:function(e,t){var r=this._properties.get("formula").values();var n=r.length,i=0,a=0;if(!n&&t)return t();function s(){i--;if(a==n&&!i)t()}while(a<n){i++;r[a++].value.exec(e,t?s:null)}},revalidate:function(n){var i=this;this._forValidations(function(e){var t=new f(e.row,e.col);var r=new h(t,t);e.exec(n,i._get(r,"value"),i._get(r,"format"))})},_value:function(e,t,r){var n=this._grid.index(e,t);if(r!==undefined)this._properties.set("value",n,n,r);else return this._properties.get("value",n)},_validation:function(e,t){var r=this._grid.index(e,t);return this._properties.get("validation",r)},_compileValidation:function(e,t,r){if(r instanceof d.spreadsheet.validation.Validation)return r.clone(this._name(),e,t);if(r.from!=null)r.from=(r.from+"").replace(/^=/,"");if(r.to!=null)r.to=(r.to+"").replace(/^=/,"");return d.spreadsheet.validation.compile(this._name(),e,t,r)},_compileFormula:function(e,t,r){r=r.replace(/^=/,"");r=d.spreadsheet.calc.parseFormula(this._name(),e,t,r);return d.spreadsheet.calc.compile(r)},_copyValuesInRange:function(e,t,r,n){var i,a,s;for(i=e.col;i<=t.col;i++){a=this._grid.index(e.row,i);s=this._grid.index(t.row,i);for(var o=a,l=e.row;o<=s;++o,++l){r=r.clone(this._name(),l,i);this._properties.set(n,o,o,r)}}return r},_set:function(e,t,r){var n=this._grid.normalize(e.topLeft);var i=this._grid.normalize(e.bottomRight);var a,s,o;if(typeof r=="number")r=d.spreadsheet.calc.runtime.limitPrecision(r);if(r&&t=="formula"){if(typeof r=="string")r=this._compileFormula(n.row,n.col,r);r=this._copyValuesInRange(n,i,r,"formula")}else if(r&&t=="validation"){r=this._compileValidation(n.row,n.col,r);r=this._copyValuesInRange(n,i,r,"validation")}else for(a=n.col;a<=i.col;a++){s=this._grid.index(n.row,a);o=this._grid.index(i.row,a);this._properties.set(t,s,o,r);if(t=="formula")this._properties.set("value",s,o,null)}},_get:function(e,t){var r=this._grid.normalize(e.topLeft);var n=this._grid.index(r.row,r.col);return this._properties.get(t,n)},batch:function(e,t){var r=this.suspendChanges();this.suspendChanges(true);e.call(this);return this.suspendChanges(r).triggerChange(t||{recalc:true})},_sortBy:function(t,e){var r=null;e.forEach(function(e){r=this._sorter.sortBy(t,e.index,this._properties.get("value"),e.ascending,r)},this);this._sort={ref:t,columns:e};this._refreshFilter();this.forEach(t,function(e,t,r){var n=r.formula;if(n){var i=e-n.row;if(i!==0){var a=i>0?n.row:n.row+i;n.adjust(this.name(),"row",a,i)}}}.bind(this));this.triggerChange({recalc:true})},_refreshFilter:function(){if(this._filter)this._filterBy(this._filter.ref,this._filter.columns)},_filterBy:function(s,t){this.batch(function(){for(var e=s.topLeft.row;e<=s.bottomRight.row;e++)if(this.isFilteredRow(e)){this._filteredRows.value(e,e,false);this._rows.unhide(e)}t.forEach(function(e){var t=s.resize({top:1}).toColumn(e.index);var n=[];if(t===d.spreadsheet.NULLREF)return;this.forEach(t,function(e,t,r){r.row=e;n.push(r)});e.filter.prepare(n);for(var r=0;r<n.length;r++){var i=n[r];var a=e.filter.value(i);if(e.filter.matches(a)===false)this._filterRow(i.row)}},this);this._filter={ref:s,columns:t}},{recalc:true,layout:true,filter:true})},filterColumn:function(e){var t=this.filter().ref;return e.toRangeRef().topLeft.col-t.topLeft.col},filter:function(){return this._filter},clearFilter:function(e){this._clearFilter(e instanceof Array?e:[e])},_clearFilter:function(t){if(this._filter)this.batch(function(){this._filter.columns=this._filter.columns.filter(function(e){return t.indexOf(e.index)<0});this._refreshFilter()},{recalc:true,layout:true,filter:true})},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()}},setAxisState:function(e){this._rows.setState(e.rows);this._columns.setState(e.columns);this.triggerChange({layout:true})},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(e){return e.clone()}),properties:this._properties.getState()}},setState:function(e){this._rows.setState(e.rows);this._columns.setState(e.columns);this._mergedCells=e.mergedCells;this._properties.setState(e.properties);this.triggerChange(d.spreadsheet.ALL_REASONS)},_merge:function(t){var l=this._mergedCells;var u=this;var r;this.batch(function(){r=t.map(function(e){if(e instanceof d.spreadsheet.CellRef)return e;var t=e.toRangeRef().union(l,function(e){l.splice(l.indexOf(e),1)});var r=new p(t,u);var n=r._get("formula");var i=r.value();var a=r.format();var s=r.background();r.value(null);r.format(null);r.background(null);var o=new p(t.collapse(),u);if(n)o._set("formula",n);else o.value(i);o.format(a);o.background(s);l.push(t);return t});var e=u._viewSelection;e.selection=u.unionWithMerged(e.originalSelection);e._activeCell=u.unionWithMerged(e.originalActiveCell)},{activeCell:true,selection:true});return r},_useCultureDecimals:function(){return this._workbook&&this._workbook.options.useCultureDecimals},withCultureDecimals:function(e){var t=".";if(this._useCultureDecimals())t=d.culture().numberFormat["."];return d.spreadsheet.calc.withDecimalSeparator(t,e)},drawingBoundingBox:function(e){var t=e.offsetX;var r=e.offsetY;if(e.topLeftCell){t+=this._columns.sum(0,e.topLeftCell.col-1);r+=this._rows.sum(0,e.topLeftCell.row-1)}return new d.spreadsheet.Rectangle(t,r,e.width,e.height)},refBoundingBox:function(e){return this._grid.rectangle(e.toRangeRef())},addDrawing:function(e,t){if(!(e instanceof m))e=new m(e);this._drawings.push(e);if(t)this._activeDrawing=e;this.triggerChange({layout:true});return e},removeDrawing:function(e){var t=this._drawings.indexOf(e);if(t>=0){this._drawings.splice(t,1);this.triggerChange({layout:true})}},usesImage:function(e){for(var t=this._drawings.length;--t>=0;)if(this._drawings[t].image===e)return true;return false},isMerged:function(e){var t=this._mergedCells;for(var r=t.length;--r>=0;)if(t[r].eq(e))return true;return false}}),m=d.Class.extend({init:function e(t){this.reset(t)},toJSON:function(){return{topLeftCell:this.topLeftCell.toString(),offsetX:this.offsetX,offsetY:this.offsetY,width:this.width,height:this.height,image:this.image,opacity:this.opacity}},clone:function(){return new m(this)},reset:function(e){var t=e.topLeftCell;if(typeof t=="string")t=d.spreadsheet.calc.parseReference(t);this.topLeftCell=t;this.offsetX=e.offsetX||0;this.offsetY=e.offsetY||0;this.width=e.width;this.height=e.height;this.image=e.image;this.opacity=e.opacity!=null?e.opacity:1},eq:function(e){return(!this.topLeftCell&&!e.topLeftCell||this.topLeftCell&&e.topLeftCell&&this.topLeftCell.eq(e.topLeftCell))&&this.offsetX===e.offsetX&&this.offsetY===e.offsetY&&this.width===e.width&&this.height===e.height&&this.image===e.image&&this.opacity===e.opacity}});m.fromJSON=function(e){return new m(e)},d.spreadsheet.Sheet=e,d.spreadsheet.Drawing=m})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/sheetsbar.min",["../kendo.core.min","../kendo.sortable.min"],function(){var p=window.kendo,n=p.jQuery,l=p._outerWidth,o=".",m=" ",e={sheetsBarWrapper:"k-widget k-header",sheetsBarSheetsWrapper:"k-tabstrip k-floatwrap k-tabstrip-bottom",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",sheetsBarAdd:"k-spreadsheet-sheets-bar-add",sheetsBarRemove:"k-spreadsheet-sheets-remove",sheetsBarItems:"k-spreadsheet-sheets-items",sheetsBarEditor:"k-spreadsheet-sheets-editor",sheetsBarScrollable:"k-tabstrip-scrollable",sheetsBarNext:"k-tabstrip-next",sheetsBarPrev:"k-tabstrip-prev",sheetsBarKItem:"k-item k-tabstrip-item",sheetsBarKActive:"k-state-active k-state-tab-on-top",sheetsBarKTextbox:"k-textbox",sheetsBarKLink:"k-link",sheetsBarKIcon:"k-icon",sheetsBarKFontIcon:"k-icon",sheetsBarKButton:"k-button k-icon-button",sheetsBarKButtonDefaults:"k-button-md k-rounded-md k-button-solid k-button-solid-base",sheetsBarKButtonBare:"k-button-md k-rounded-md k-button-flat k-button-flat-base",sheetsBarKArrowW:"k-i-arrow-60-left",sheetsBarKArrowE:"k-i-arrow-60-right",sheetsBarKReset:"k-reset k-tabstrip-items",sheetsBarKIconX:"k-i-close",sheetsBarKSprite:"k-sprite",sheetsBarKIconPlus:"k-i-plus",sheetsBarHintWrapper:"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint",sheetsBarKResetItems:"k-reset k-tabstrip-items"},g=p.ui.Widget.extend({init:function(e,t){var r=g.classNames;p.ui.Widget.call(this,e,t);e=this.element;e.addClass(r.sheetsBarWrapper);this._openDialog=t.openDialog;this._tree=new p.dom.Tree(e[0]);this._tree.render([this._addButton(),this._createSheetsWrapper([])]);this._toggleScrollEvents(true);this._createSortable();this._sortable.bind("start",this._onSheetReorderStart.bind(this));this._sortable.bind("end",this._onSheetReorderEnd.bind(this));e.on("click",o+r.sheetsBarRemove,this._onSheetRemove.bind(this));e.on("click","li",this._onSheetSelect.bind(this));e.on("dblclick","li"+o+r.sheetsBarActive,this._createEditor.bind(this));e.on("click",o+r.sheetsBarAdd,this._onAddSelect.bind(this))},options:{name:"SheetsBar",scrollable:{distance:200}},events:["select","reorder","rename"],_createEditor:function(){if(this._editor)return;this._renderSheets(this._sheets,this._selectedIndex,true);this._editor=this.element.find(p.format("input{0}{1}",o,g.classNames.sheetsBarEditor)).trigger("focus").on("keydown",this._onEditorKeydown.bind(this)).on("blur",this._onEditorBlur.bind(this))},_destroyEditor:function(e){var t=e?null:this._editor.val();this._editor.off();this._editor=null;this._renderSheets(this._sheets,this._selectedIndex,false);this._onSheetRename(t)},renderSheets:function(e,t){if(!e||t<0)return;this._renderSheets(e,t,false)},_renderSheets:function(e,t,r){var n=this;var i=g.classNames;n._isRtl=p.support.isRtl(n.element);n._sheets=e;n._selectedIndex=t;n._renderHtml(r,true);if(!n._scrollableAllowed())return;var a=n._sheetsWrapper();a.addClass(i.sheetsBarScrollable+m+i.sheetsBarSheetsWrapper);n._toggleScrollButtons()},_toggleScrollButtons:function(e){var t=this;var r=t._sheetsGroup();var n=t._sheetsWrapper();var i=p.scrollLeft(r);var a=n.find(o+g.classNames.sheetsBarPrev);var s=n.find(o+g.classNames.sheetsBarNext);if(e===false){a.addClass("k-disabled");s.addClass("k-disabled")}else{a.toggleClass("k-disabled",!(t._isRtl?i<r[0].scrollWidth-r[0].offsetWidth-1:i!==0));s.toggleClass("k-disabled",!(t._isRtl?i!==0:i<r[0].scrollWidth-r[0].offsetWidth-1))}},_toggleScrollEvents:function(e){var t=this;var r=g.classNames;var n=t.options;var i;var a;var s=t._sheetsWrapper();i=s.find(o+r.sheetsBarPrev);a=s.find(o+r.sheetsBarNext);if(e){i.on("mousedown",function(){t._nowScrollingSheets=true;t._scrollSheetsByDelta(n.scrollable.distance*(t._isRtl?1:-1))});a.on("mousedown",function(){t._nowScrollingSheets=true;t._scrollSheetsByDelta(n.scrollable.distance*(t._isRtl?-1:1))});i.add(a).on("mouseup",function(){t._nowScrollingSheets=false})}else{i.off();a.off()}},_renderHtml:function(c,h){var e;var t=[];var r=p.dom;var n=r.element;var i=this._sheets;var f=this._selectedIndex;var a=g.classNames;for(e=0;e<i.length;e++){var s=i[e];var o=e===f;var l={className:a.sheetsBarKItem+m};var u=[];if(o)l.className+=a.sheetsBarKActive+m+a.sheetsBarActive;else l.className+=a.sheetsBarInactive;if(o&&c)u.push(n("input",{type:"text",value:s.name(),className:a.sheetsBarKTextbox+m+a.sheetsBarEditor,maxlength:50},[]));else{u.push(n("span",{className:a.sheetsBarKLink,title:s.name()},[r.text(s.name())]));if(i.length>1){var d=n("span",{className:a.sheetsBarKIcon+m+a.sheetsBarKFontIcon+m+a.sheetsBarKIconX},[]);u.push(n("span",{className:a.sheetsBarKLink+m+a.sheetsBarRemove,"data-type":"remove"},[d]))}}t.push(n("li",l,u))}this._tree.render([this._addButton(),this._createSheetsWrapper(t,h)])},_createSheetsWrapper:function(e,t){var r=p.dom.element;var n=g.classNames;var i=r("div",{className:"k-tabstrip-items-wrapper k-hstack"});var a=[null,r("ul",{className:n.sheetsBarKReset},e),null];t=true;if(t){var s=n.sheetsBarKButton+m+n.sheetsBarKButtonBare+m;a[0]=r("span",{className:s+n.sheetsBarPrev},[r("span",{className:"k-button-icon"+m+n.sheetsBarKIcon+m+n.sheetsBarKArrowW},[])]);a[2]=r("span",{className:s+n.sheetsBarNext},[r("span",{className:"k-button-icon"+m+n.sheetsBarKIcon+m+n.sheetsBarKArrowE},[])])}i.children=a;return r("div",{className:n.sheetsBarItems},[i])},_createSortable:function(){var r=g.classNames;this._sortable=new p.ui.Sortable(this.element,{filter:p.format("ul li.{0},ul li.{1}",r.sheetsBarActive,r.sheetsBarInactive),container:o+r.sheetsBarItems,axis:"x",animation:false,ignore:"input",end:function(){if(this.draggable.hint)this.draggable.hint.remove()},hint:function(e){var t=n(e).clone();return t.wrap("<div class='"+r.sheetsBarHintWrapper+"'><ul class='"+r.sheetsBarKResetItems+"'></ul></div>").closest("div")}})},_onEditorKeydown:function(e){if(this._editor){if(e.which===13)this._destroyEditor();if(e.which===27)this._destroyEditor(true)}},_onEditorBlur:function(){if(this._editor)this._destroyEditor()},_onSheetReorderEnd:function(e){e.preventDefault();this.trigger("reorder",{oldIndex:e.oldIndex,newIndex:e.newIndex})},_onSheetReorderStart:function(e){if(this._editor)e.preventDefault()},_onSheetRemove:function(e){var r=n(e.target).closest("li").text();if(this._editor)this._destroyEditor();var t=function(e){var t=e.sender;if(t.isConfirmed())this.trigger("remove",{name:r,confirmation:true})}.bind(this);this._openDialog("confirmation",{close:t})},_onSheetSelect:function(e){var t=n(e.target).text();if(n(e.target).is(o+g.classNames.sheetsBarEditor)||!t){e.preventDefault();return}if(this._editor)this._destroyEditor();this._scrollSheetsToItem(n(e.target).closest("li"));this.trigger("select",{name:t,isAddButton:false})},_onSheetRename:function(e){if(this._sheets[this._selectedIndex].name()===e||e===null)return;this.trigger("rename",{name:e,sheetIndex:this._selectedIndex})},_onAddSelect:function(){this.trigger("select",{isAddButton:true})},_addButton:function(){var e=p.dom.element;var t=g.classNames;return e("a",{className:t.sheetsBarAdd+m+t.sheetsBarKButton+m+t.sheetsBarKButtonDefaults},[e("span",{className:"k-button-icon"+m+t.sheetsBarKIcon+m+t.sheetsBarKFontIcon+m+t.sheetsBarKIconPlus},[])])},destroy:function(){this._sortable.destroy()},_scrollableAllowed:function(){var e=this.options;return e.scrollable&&!isNaN(e.scrollable.distance)},_scrollSheetsToItem:function(e){var t=this;var r=t._sheetsGroup();var n=p.scrollLeft(r);var i=l(e);var a=t._isRtl?e.position().left:e.position().left-r.children().first().position().left;var s=r[0].offsetWidth;var o;if(t._isRtl){if(a<0)o=n+a-(s-n);else if(a+i>s)o=n+a-i}else if(n+s<a+i)o=a+i-s;else if(n>a)o=a;r.finish().animate({scrollLeft:o},"fast","linear",function(){t._toggleScrollButtons()})},_sheetsGroup:function(){return this._sheetsWrapper().find("ul")},_sheetsWrapper:function(){return this.element.find(o+g.classNames.sheetsBarItems)},_scrollSheetsByDelta:function(e){var t=this;var r=t._sheetsGroup();var n=p.scrollLeft(r);r.finish().animate({scrollLeft:n+e},"fast","linear",function(){if(t._nowScrollingSheets)t._scrollSheetsByDelta(e);else t._toggleScrollButtons()})}});n.extend(true,p.spreadsheet.SheetsBar=g,{classNames:e})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/calc.min",["./runtime.min"],function(){"use strict";var R=kendo.util,l=kendo.spreadsheet,i=l.Ref,w=l.RangeRef,y=l.CellRef,_=l.NameRef,e=l.calc,p=e.runtime,r=Object.create(null),n=Object.create(null),a=[[":"],[" "],[","],["%"],["^"],["*","/"],["+","-"],["&"],["=","<",">","<=",">=","<>"]],C=(a.forEach(function(e,t){e.forEach(function(e){r[e]=a.length-t;n[e==","?";":e]=a.length-t})}),r),F={DEC:".",ARG:",",COL:","};function s(e){F.DEC=e;F.ARG=e==","?";":",";F.COL=e==","?"\\":",";C=e==","?n:r}e.withDecimalSeparator=function(e,t){if(F.DEC==e)return t();var r=F.DEC;s(e);try{return t()}finally{s(r)}},e._separators=F;var m=kendo.Class.extend({init:function e(t,r){this.message=t;this.pos=r},toString:function(){return this.message}}),v={type:"bool",value:true},b={type:"bool",value:false};function k(e){e=e.toUpperCase();for(var t=0,r=0;r<e.length;++r)t=t*26+e.charCodeAt(r)-64;return t-1}function x(e){return parseInt(e,10)-1}function t(e,t){if(e.toLowerCase()=="#sheet")return l.SHEETREF;e:{var r;if(r=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(e)){var n=x(r[4]),i=k(r[2]);if(n<1048576&&i<16384)return new y(x(r[4]),k(r[2]));break e}var a=A(e,{});var s=[];while(true){var o=a.next();if(o instanceof y)o.rel=0;else if(o instanceof w){o.topLeft.rel=0;o.bottomRight.rel=0}else break e;s.push(o);if(a.eof())break;if(!a.is("op",F.ARG))break e;a.next()}return s.length==1?s[0]:new l.UnionRef(s)}if(!t)throw new Error("Cannot parse reference: "+e)}function c(t,e,r,s){var n=[];s=A(s,{row:e,col:r});var o=s.is;return{type:"exp",ast:a(true),refs:n,sheet:t,row:e,col:r};function c(e){e.index=n.length;n.push(e);return e}function i(e,t,r){if(o(e,t))return s.next();else{var n=s.peek();if(n)s.croak("Expected "+e+" «"+t+"» but found "+n.type+" «"+n.value+"»");else if(!r)s.croak("Expected "+e+" «"+t+"»")}}function a(e){return u(m(l()),0,e)}function h(e){if(e.upper=="TRUE"||e.upper=="FALSE")return e.upper=="TRUE"?v:b;return c(new _(e.value))}function f(){var e=s.next();e=e.value;i("punc","(");var t=[];while(1){if(o("punc",")"))break;if(o("op",F.ARG)){t.push({type:"null"});s.next();continue}t.push(a(false));if(s.eof()||o("punc",")"))break;i("op",F.ARG)}i("punc",")",true);return{type:"func",func:e,args:t}}function d(e){if(!e.hasSheet())e.setSheet(t);return c(e)}function l(){var e;if(o("ref"))e=d(s.next());else if(o("func"))e=f();else if(o("punc","(")){s.next();e=a(true);i("punc",")",true)}else if(o("punc","{")){s.next();e=p();i("punc","}",true)}else if(o("num")||o("str")||o("error"))e=s.next();else if(o("sym"))e=h(s.next());else if(o("op","+")||o("op","-"))e={type:"prefix",op:s.next().value,exp:l()};else if(!s.peek())s.croak("Incomplete expression");else if(o("punc","["))s.croak("External reference not supported");else s.croak("Parse error");return g(e)}function p(){var e=[],t=[e],r=true;while(!s.eof()&&!o("punc","}")){if(r)r=false;else if(o(null,";")){t.push(e=[]);s.next()}else i(null,F.COL);e.push(a(false))}return{type:"matrix",value:t}}function m(e){if(o("punc","(")||o("ref")||o("num")||o("func"))return{type:"binary",op:" ",left:e,right:a(false)};else return e}function g(e){if(o("op","%")){s.next();return g({type:"postfix",op:"%",exp:e})}else return e}function u(e,t,r){var n=o("op");if(n&&(r||n.value!=F.ARG)){var i=C[n.value];if(i>t){s.next();var a=u(l(),i,r);return u({type:"binary",op:n.value==";"?",":n.value,left:e,right:a},t,r)}}return e}}function o(e,t){var r=c(null,0,0,e);if(!(r.ast instanceof _))throw new m("Invalid name: "+e);r=r.ast;if(!(t instanceof i)){var n=c(r.sheet,0,0,t);if(n.ast instanceof i)t=n.ast;else if(/^(?:str|num|bool|error)$/.test(n.ast.type))t=n.ast.value;else t=g(n)}return{name:r,value:t}}var u=function(r){return function(e){var t=r[e];if(!t)t=r[e]=new Function("'use strict';return("+e+")")();return t}}(Object.create(null));function h(e){return u("function(row, col, mod){return("+r(e.ast,e,0)+")}");function r(n,i,a){switch(n.type){case"num":return"(kendo.spreadsheet.calc._separators.DEC == '.' ? "+JSON.stringify(JSON.stringify(n.value))+" : "+JSON.stringify(JSON.stringify(n.value))+".replace('.' , kendo.spreadsheet.calc._separators.DEC))";case"bool":return JSON.stringify(n.value);case"error":return JSON.stringify("#"+n.value);case"str":return JSON.stringify(JSON.stringify(n.value));case"ref":return"this.refs["+n.index+"].print(row, col, mod)";case"prefix":return e(function(){return JSON.stringify(n.op)+" + "+r(n.exp,n,C[n.op])});case"postfix":return e(function(){return r(n.exp,n,C[n.op])+" + "+JSON.stringify(n.op)});case"binary":return e(function(){var e=s(r(n.left,n,C[n.op]),n.left instanceof _&&n.op==":");var t=s(r(n.right,n,C[n.op]),n.right instanceof _&&n.op==":");if(/^[,;]/.test(n.op))return e+" + kendo.spreadsheet.calc._separators.ARG + "+t;else return e+" + "+JSON.stringify(n.op)+" + "+t});case"func":return JSON.stringify(n.func+"(")+" + "+(n.args.length>0?n.args.map(function(e){return r(e,n,0)}).join(" + kendo.spreadsheet.calc._separators.ARG + ' ' + "):"''")+" + ')'";case"matrix":return"'{ ' + "+n.value.map(function(e){return e.map(function(e){return r(e,n,0)}).join(" + kendo.spreadsheet.calc._separators.COL + ' ' + ")}).join(" + '; ' + ")+"+ ' }'";case"null":return"''"}throw new Error("Cannot make printer for node "+n.type);function e(e){var t=n.op;var r=C[t]<a||!a&&t==","||i.type=="prefix"&&a==C[t]&&i.op=="-"||i.type=="binary"&&a==C[t]&&n===i.right;return s(e(),r)}}function s(e,t){return t?"'(' + "+e+" + ')'":e}}function f(e,t){var r=0;return o(e,t);function o(e,t){switch(e.type){case"ref":return n(e,t);case"num":case"str":case"null":case"error":case"bool":return i(e,t);case"prefix":case"postfix":return c(e,t);case"binary":return h(e,t);case"func":return m(e,t);case"lambda":return g(e,t);case"matrix":return s(e.value,t,true)}throw new Error("Cannot CPS "+e.type)}function n(e,t){return e.ref=="name"?a(e,t):i(e,t)}function i(e,t){return t(e)}function a(e,t){return{type:"func",func:",getname",args:[l(t),e]}}function c(e,t){return o({type:"func",func:"unary"+e.op,args:[e.exp]},t)}function h(e,t){return o({type:"func",func:"binary"+e.op,args:[e.left,e.right]},t)}function f(e,i,a,s){return o(e,function(e){var t=l(s);var r=u("T");var n=u("E");return{type:"func",func:"if",args:[t,e,{type:"lambda",vars:[r],body:o(i||v,function(e){return{type:"call",func:{type:"var",name:r},args:[e]}})},{type:"lambda",vars:[n],body:o(a||b,function(e){return{type:"call",func:{type:"var",name:n},args:[e]}})}]}})}function d(e,t){if(e.length===0)return i(v,t);return o({type:"func",func:"IF",args:[e[0],{type:"func",func:"AND",args:e.slice(1)},b]},t)}function p(e,t){if(e.length===0)return i(b,t);return o({type:"func",func:"IF",args:[e[0],v,{type:"func",func:"OR",args:e.slice(1)}]},t)}function m(e,t){switch(e.func.toLowerCase()){case"if":return f(e.args[0],e.args[1],e.args[2],t);case"and":return d(e.args,t);case"or":return p(e.args,t);case"true":return t(v);case"false":return t(b)}return function t(r,n){if(n==e.args.length)return{type:"func",func:e.func,args:r};else return o(e.args[n],function(e){return t(r.concat([e]),n+1)})}([l(t)],0)}function g(e,t){var r=u("K");var n=o(e.body,function(e){return{type:"call",func:{type:"var",value:r},args:[e]}});return t({type:"lambda",vars:[r].concat(e.vars),body:n})}function s(e,n,i){var a=[];return function t(r){if(r==e.length)return n({type:"matrix",value:a});else return(i?s:o)(e[r],function(e){a[r]=e;return t(r+1)})}(0)}function l(e){var t=u("R");return{type:"lambda",vars:[t],body:e({type:"var",name:t})}}function u(e){if(!e)e="";e="_"+e;return e+ ++r}}var d=Object.create(null);function g(e){var t=h(e);var r=t.call(e);var n=d[r];if(n)return n.clone(e.sheet,e.row,e.col);var i=a(f(e.ast,function(e){return{type:"return",value:e}}));i=["function(){","var context = this, refs = context.formula.absrefs",i,"}"].join(";\n");n=new p.Formula(e.refs,u(i),t,e.sheet,e.row,e.col);d[r]=n.clone(e.sheet,e.row,e.col);return n;function a(e){var t=e.type;if(t=="num")return e.value+"";else if(t=="str")return JSON.stringify(e.value);else if(t=="error")return"context.error("+JSON.stringify(e.value)+")";else if(t=="return")return"context.resolve("+a(e.value)+")";else if(t=="func")return"context.func("+JSON.stringify(e.func)+", "+a(e.args[0])+", "+s(e.args.slice(1))+")";else if(t=="call")return a(e.func)+"("+e.args.map(a).join(", ")+")";else if(t=="ref")return"refs["+e.index+"]";else if(t=="bool")return""+e.value;else if(t=="if")return"(context.bool("+a(e.co)+") ? "+a(e.th)+" : "+a(e.el)+")";else if(t=="lambda")return"(function("+e.vars.join(", ")+"){ return("+a(e.body)+") })";else if(t=="var")return e.name;else if(t=="matrix")return s(e.value);else if(t=="null")return"null";else throw new Error("Cannot compile expression "+t)}function s(e){return"[ "+e.map(a).join(", ")+" ]"}}function S(e){return e}function A(o,l){o=B(M(o),l);var r=o.ahead;var c=o.skip;var t=null;var u=l.row!=null&&l.col!=null?function(e){if(e.rel&1)e.col-=l.col;if(e.rel&2)e.row-=l.row;return e}:S;var h=l.forEditor?function(e,t,r){e.begin=t.begin;e.end=r.end;return e}:S;return{peek:n,next:a,croak:o.croak,eof:o.eof,is:e};function e(e,t){var r=n();return r!=null&&(e==null||r.type===e)&&(t==null||r.value===t)?r:null}function n(){if(t==null)t=i();return t}function a(){if(t!=null){var e=t;t=null;return e}return i()}function i(){var e;var t=o.peek();if(t){if(t.type=="sym"||t.type=="rc"||t.type=="num")e=r(8,s)||r(6,d)||r(6,p)||r(4,m)||r(4,g)||r(2,v)||r(2,b);if(!e)e=o.next()}return e}function f(e,t){if(e.type=="rc"){if(e.rel&&!l.forEditor&&(l.row==null||l.col==null))o.croak("Cannot read relative cell in RC notation");return new y(e.row,e.col,e.rel)}if(e.type=="num")if(e.value<=1048577)return u(new y(x(e.value),t?-Infinity:+Infinity,2));else return null;var r=e.value;var n=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(r);if(n){var i=x(n[4]),a=k(n[2]);if(i<=1048576&&a<=16383)return u(new y(x(n[4]),k(n[2]),(n[1]?0:1)|(n[3]?0:2)));else return null}var s=r.charAt(0)=="$";if(s)r=r.substr(1);if(/^\d+$/.test(r)){var i=x(r);if(i<=1048576)return u(new y(x(r),t?-Infinity:+Infinity,s?0:2))}else{var a=k(r);if(a<=16383)return u(new y(t?-Infinity:+Infinity,k(r),s?0:1))}}function s(e,t,r,n,i,a,s,o){if(e.type=="sym"&&t.type=="op"&&t.value==":"&&r.type=="sym"&&n.type=="punc"&&n.value=="!"&&(i.type=="sym"||i.type=="rc"||i.type=="num"&&i.value==i.value|0)&&a.type=="op"&&a.value==":"&&(s.type=="sym"||s.type=="rc"||s.type=="num"&&s.value==s.value|0)&&s.type==i.type&&!(o.type=="punc"&&o.value=="("&&!s.space)){var l=f(i,true),u=f(s,false);if(l&&u){c(7);return h(new w(l.setSheet(e.value,true),u.setSheet(r.value,true)).setSheet(e.value,true),e,s)}}}function d(e,t,r,n,i,a){if(e.type=="sym"&&t.type=="op"&&t.value==":"&&r.type=="sym"&&n.type=="punc"&&n.value=="!"&&(i.type=="sym"||i.type=="rc"||i.type=="num"&&i.value==i.value|0)&&!(a.type=="punc"&&a.value=="("&&!i.space)){var s=f(i);if(s){c(5);var o=s.clone();return h(new w(s.setSheet(e.value,true),o.setSheet(r.value,true)).setSheet(e.value,true),e,i)}}}function p(e,t,r,n,i,a){if(e.type=="sym"&&t.type=="punc"&&t.value=="!"&&(r.type=="sym"||r.type=="rc"||r.type=="num"&&r.value==r.value|0)&&n.type=="op"&&n.value==":"&&(i.type=="sym"||i.type=="rc"||i.type=="num"&&i.value==i.value|0)&&!(a.type=="punc"&&a.value=="("&&!i.space)){var s=f(r,true),o=f(i,false);if(s&&o){c(5);return h(new w(s,o).setSheet(e.value,true),e,i)}}}function m(e,t,r,n){if(e.type=="sym"&&t.type=="punc"&&t.value=="!"&&(r.type=="sym"||r.type=="rc"||r.type=="num"&&r.value==r.value|0)&&!(n.type=="punc"&&n.value=="("&&!r.space)){c(3);var i=f(r);if(!i||!isFinite(i.row))i=new _(r.value);return h(i.setSheet(e.value,true),e,r)}}function g(e,t,r,n){if((e.type=="sym"||e.type=="rc"||e.type=="num"&&e.value==e.value|0)&&(t.type=="op"&&t.value==":")&&(r.type=="sym"||r.type=="rc"||r.type=="num"&&r.value==r.value|0)&&!(n.type=="punc"&&n.value=="("&&!r.space)){var i=f(e,true),a=f(r,false);if(i&&a){c(3);return h(new w(i,a),e,r)}}}function v(e,t){if((e.type=="sym"||e.type=="rc")&&!(t.type=="punc"&&t.value=="("&&!e.space)){var r=f(e);if(r&&isFinite(r.row)&&isFinite(r.col)){c(1);return h(r,e,e)}}}function b(e,t){if(e.type=="sym"&&t.type=="punc"&&t.value=="("&&!e.space){e.type="func";c(1);return e}}}function D(e){return" \t\r\n ​".indexOf(e)>=0}var E={type:"eof"};function B(n,r){var i=[],a=0;var s=n.readWhile;return{next:_,peek:t,eof:x,croak:n.croak,ahead:e,skip:k};function o(e){return/[0-9]/i.test(e)}function l(e){return/[a-z$_]/i.test(e)||R.isUnicodeLetter(e)}function h(e){return l(e)||o(e)||e=="."}function f(e){return e in C}function d(e){return"\\!;(){}[]".indexOf(e)>=0}function p(){var t=false;var e=s(function(e){if(e==F.DEC){if(t)return false;t=true;return true}return o(e)});if(e==F.DEC)return{type:"punc",value:F.DEC};else return{type:"num",value:parseFloat(e.replace(F.DEC,"."))}}function u(e,t){return{type:"sym",value:e,upper:e.toUpperCase(),space:D(n.peek()),quote:t}}function c(e,t,r){if(!e&&!t&&!r)return null;if(!e&&!r||e&&r){var n=t?parseInt(t,10):0;return e?n:n-1}}function m(){var e=n.lookingAt(/^R(\[)?(-?[0-9]+)?(\])?C(\[)?(-?[0-9]+)?(\])?/i);if(e){var t=c(e[1],e[2],e[3]);var r=c(e[4],e[5],e[6]);if(t!=null&&r!=null){n.skip(e);return{type:"rc",row:t,col:r,rel:(e[4]||!(e[4]||e[5]||e[6])?1:0)|(e[1]||!(e[1]||e[2]||e[3])?2:0)}}}return u(s(h))}function g(){n.next();return{type:"str",value:n.readEscaped('"')}}function v(){n.next();return u(n.readEscaped("'"),true)}function b(){return{type:"op",value:s(function(e,t){return t+e in C})}}function w(){return{type:"punc",value:n.next()}}function y(){if(n.eof())return null;var e=n.peek(),t;if(e=='"')return g();if(e=="'")return v();if(o(e)||e==F.DEC)return p();if(l(e))return m();if(f(e))return b();if(d(e))return w();if(t=n.lookingAt(/^#([a-z\/]+)[?!]?/i)){n.skip(t);return{type:"error",value:t[1]}}if(!r.forEditor)n.croak("Can't handle character with code: "+e.charCodeAt(0));return{type:"error",value:n.next()}}function t(){while(i.length<=a){s(D);var e=n.pos();var t=y();if(r.forEditor&&t){t.begin=e;t.end=n.pos()}i.push(t)}return i[a]}function _(){var e=t();if(e)a++;return e}function e(e,t){var r=a,n=[];while(e-- >0)n.push(_()||E);a=r;return t.apply(n,n)}function k(e){a+=e}function x(){return t()==null}}function M(r){var n=0,t=1,i=0;return{next:a,peek:s,eof:o,croak:l,readWhile:f,readEscaped:h,lookingAt:d,skip:c,forward:u,pos:e};function e(){return n}function a(){var e=r.charAt(n++);if(e=="\n"){t++;i=0}else i++;return e}function s(){return r.charAt(n)}function o(){return s()===""}function l(e){throw new m(e+" (input: "+r+")",n)}function c(e){if(typeof e=="string"){if(r.substr(n,e.length)!=e)l("Expected "+e);u(e.length)}else if(e instanceof RegExp){var t=e.exec(r.substr(n));if(t){u(t[0].length);return t}}else u(e[0].length)}function u(e){while(e-- >0)a()}function h(e){var t=false,r="";while(!o()){var n=a();if(t){r+=n;t=false}else if(n=="\\")t=true;else if(n==e)break;else r+=n}return r}function f(e){var t="";while(!o()&&e(s(),t))t+=a();return t}function d(e){return e.exec(r.substr(n))}}var T=[],I=e.registerFormatParser=function(e){T.push(e)};function L(t,r,n){var e=[];t=A(t,{forEditor:true,row:r,col:n});while(!t.eof())e.push(a());var i=e[0];if(i.type=="op"&&i.value=="=")i.type="startexp";return e;function a(){var e=t.next();if(e.type=="sym"){if(e.upper=="TRUE"){e.type="bool";e.value=true}else if(e.upper=="FALSE"){e.type="bool";e.value=false}}else if(e.type=="ref")e={type:"ref",ref:r!=null&&n!=null?e.absolute(r,n):e,begin:e.begin,end:e.end};return e}}function N(e,t,r){t=t||0;r=r||0;e=A(e,{row:t,col:r});var n=[];while(!e.eof()){var i=e.next();if(i.type!="ref")throw new m("Expecting a reference but got: "+JSON.stringify(i));n.push(i.absolute(t,r))}return n}e.parse=function(e,t,r,n,i){if(n instanceof Date)return{type:"date",value:p.dateToSerial(n)};if(typeof n=="number")return{type:"number",value:n};if(typeof n=="boolean")return{type:"boolean",value:n};n+="";if(/^'/.test(n))return{type:"string",value:n.substr(1)};if(/^-?[0-9]+%$/.test(n)){var a=n.substr(0,n.length-1);var s=parseFloat(a);if(!isNaN(s)&&s==a)return{type:"percent",value:s/100}}if(/^=/.test(n)){n=n.substr(1);if(/\S/.test(n))return c(e,t,r,n);else return{type:"string",value:"="+n}}for(var o=0;o<T.length;++o){var l=T[o](n);if(l)return l}if(n.toLowerCase()=="true")return{type:"boolean",value:true};if(n.toLowerCase()=="false")return{type:"boolean",value:false};var u=p.parseDate(n,i);if(u)return{type:"date",value:p.dateToSerial(u)};var s=parseFloat(n);if(!isNaN(s)&&n.length>0&&s==n){i=null;if(s!=Math.floor(s))i="0."+String(s).split(".")[1].replace(/\d/g,"0");return{type:"number",value:s,format:i}}return{type:"string",value:n}},e.parseNameDefinition=o,e.parseFormula=c,e.parseReference=t,e.compile=g,e.parseSqref=N,e.InputStream=M,e.ParseError=m,e.tokenize=L,I(function(e){var t,r=0,n="";if(t=/^(\d+)([-/.])(\d+)\2(\d{2}(?:\d{2})?)(\s*)/.exec(e)){var i=parseInt(t[1],10);var c=t[2];var a=parseInt(t[3],10);var s=parseInt(t[4],10);if(s<30)s+=2e3;else if(s<100)s+=1900;var h=true;if(i>12){var f=i;i=a;a=f;h=false}if(!p.validDate(s,i,a))return null;r=p.packDate(s,i-1,a);if(r<0)r--;if(h)n=["mm","dd","yyyy"].join(c);else n=["dd","mm","yyyy"].join(c);n+=t[5];e=e.substr(t[0].length)}if(t=/^(\d+):(\d+)$/.exec(e)){var o=parseInt(t[1],10);var l=parseInt(t[2],10);return{type:"date",format:n+"hh:mm",value:r+p.packTime(o,l,0,0)}}if(t=/^(\d+):(\d+)(\.\d+)$/.exec(e)){var l=parseInt(t[1],10);var u=parseInt(t[2],10);var d=parseFloat(t[3])*1e3;return{type:"date",format:n+"mm:ss.00",value:r+p.packTime(0,l,u,d)}}if(t=/^(\d+):(\d+):(\d+)$/.exec(e)){var o=parseInt(t[1],10);var l=parseInt(t[2],10);var u=parseInt(t[3],10);return{type:"date",format:n+"hh:mm:ss",value:r+p.packTime(o,l,u,0)}}if(t=/^(\d+):(\d+):(\d+)(\.\d+)$/.exec(e)){var o=parseInt(t[1],10);var l=parseInt(t[2],10);var u=parseInt(t[3],10);var d=parseFloat(t[4])*1e3;return{type:"date",format:n+"hh:mm:ss.00",value:r+p.packTime(o,l,u,d)}}}),I(function(e){var t,r;var n=kendo.culture();var i=n.numberFormat[","];var c=n.numberFormat["."];var h=n.numberFormat.currency.symbol;var f=P(i,c);var d=new RegExp("^\\s*\\"+h+"\\s*");var a=1;var s="";var o="";var l=false;var p=false;e=M(e.replace(/^\s+|\s+$/g,""));if(e.skip(/^-\s*/))a=-1;if(t=e.skip(d)){l=true;s+='"'+t[0]+'"'}if(e.skip(/^-\s*/)){if(a<0)return null;a=-1}if(!(r=e.skip(f)))return null;s+="0";if(t=e.skip(d)){if(l)return null;l=true;o='"'+t[0]+'"'}if(!l&&(t=e.skip(/^\s*%\s*/))){p=true;o=t[0]}if(!e.eof())return null;if(r[2]||l){s=s.replace("0","#");s+=",0"}if(r[3])s+="."+H("0",r[3].length-1);var u=r[0].replace(new RegExp("\\"+i,"g"),"").replace(new RegExp("\\"+c,"g"),".");u=parseFloat(u);if(p)u/=100;s+=o;if(l)s+=";-"+s;return{type:"number",currency:l,format:s,value:a*u}}),I(function(e){var t;if(t=/^([0-9]*)\.([0-9]+)(\s*%)$/.exec(e))return{type:"number",value:parseFloat(e)/100,format:"0."+H("0",t[2].length)+t[3]}});var z={};function P(e,t){var r=e+t;var n=z[r];if(!n){n="^(\\d+(COM\\d{3})*(DOT\\d+)?)";n=n.replace(/DOT/g,"\\"+t).replace(/COM/g,"\\"+e);n=new RegExp(n);z[r]=n}return n}function H(e,t){var r="";while(t-- >0)r+=e;return r}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/excel-reader.min",["../kendo.core.min","../kendo.color.min","../util/parse-xml.min","./calc.min"],function(){"use strict";var n=kendo.jQuery,i=kendo.util.parseXML,T=kendo.spreadsheet.calc.parseReference,c={greaterThanOrEqual:"greaterThanOrEqualTo",lessThanOrEqual:"lessThanOrEqualTo"},d=null;function e(e,r,n){var t=new FileReader;t.onload=function(e){var t=new JSZip(e.target.result);y(t,r,n)};t.readAsArrayBuffer(e)}var z=["sheetData","row","c"],P=["cols","col"],a=["definedNames","definedName"],H=["sheetData","row","c","f"],O=["mergeCells","mergeCell"],V=["sheetViews","sheetView","pane"],$=["sheetData","row"],U=["sheetViews","sheetView","selection"],m=["sheets","sheet"],h=["sheetData","row","c","is"],s=["t"],o=["si"],W=["sheetData","row","c","v"],g=["bookViews","workbookView"],j=["sheetViews","sheetView"],q=["hyperlinks","hyperlink"],K=["dataValidations","dataValidation"],J=["dataValidations","dataValidation","formula1"],G=["dataValidations","dataValidation","formula2"],Y=["x14:dataValidations","x14:dataValidation"],X=["x14:dataValidations","x14:dataValidation","xm:sqref"],Q=["x14:dataValidations","x14:dataValidation","x14:formula1","xm:f"],Z=["x14:dataValidations","x14:dataValidation","x14:formula2","xm:f"],l=["commentList","comment"],v=["authors","author"],b=["t"];function u(e){if(!/^\//.test(e)){if(!/^xl\//.test(e))e="xl/"+e}else e=e.substr(1);return e}function y(s,o,t){d=o.excelImportErrors=[];var l=E(s);var u=ue(s,"_rels/workbook.xml");var e=ve(s,u.byType.theme[0]);var c=pe(s,e);var h=[];var f=0;I(s,"xl/workbook.xml",{enter:function(e,t){if(this.is(m)){var r=t["r:id"];var n=u.byId[r];var i=t.name;var a=C(s,n);o.options.columnWidth=a.columnWidth||o.options.columnWidth;o.options.rowHeight=a.rowHeight||o.options.rowHeight;h.push({workbook:o,zip:s,strings:l,styles:c,file:n,options:{name:i,rows:Math.max(o.options.rows||0,a.rows),columns:Math.max(o.options.columns||0,a.cols),columnWidth:a.columnWidth,rowHeight:a.rowHeight}})}else if(this.is(g))if(t.activeTab)f=L(t.activeTab)},text:function(e){var t=this.is(a);if(t&&!(N(t["function"])||N(t.vbProcedure))){var r=t.localSheetId;var n=null;if(r!=null)n=h[r].options.name;var i=t.name;if(i!="_xlnm._FilterDatabase"){if(n)i="'"+n.replace(/\'/g,"\\'")+"'!"+i;oe(n,null,function(){o.defineName(i,e,N(t.hidden))},"reading user-defined name: "+i)}}}});var r=new n.Deferred;r.progress(function(e){if(t)t.notify(e)}).then(function(){var e=o.sheets();x(e);o.activeSheet(e[f]);if(t)t.resolve()});_(h,o,r)}function _(a,s,o){var e=(new n.Deferred).resolve();for(var t=0;t<a.length;t++)(function(n,i){e=e.then(function(){var e=s.insertSheet(n.options);e.suspendChanges(true);var t=k(e,n);var r={sheet:e,progress:i/(a.length-1)};t.then(function(){o.notify(r)});return t})})(a[t],t);e.then(function(){o.resolve()})}function k(e,t){var r=new n.Deferred;setTimeout(function(){F(t.zip,t.file,e,t.strings,t.styles);r.resolve()},0);return r}function x(e){for(var t=0;t<e.length;t++)e[t].suspendChanges(false).triggerChange({recalc:true})}function C(e,t){var n={rows:0,cols:0};I(e,u(t),{enter:function(e,t){if(e=="dimension"){var r=T(t.ref);if(r.bottomRight){n.cols=r.bottomRight.col+1;n.rows=r.bottomRight.row+1}}else if(e==="sheetFormatPr"){if(t.defaultColWidth)n.columnWidth=ee(parseFloat(t.defaultColWidth));if(t.defaultRowHeight)n.rowHeight=te(parseFloat(t.defaultRowHeight))}else if(this.is($))this.exit()}});return n}function ee(e){var t=7;var r=(256*e+Math.floor(128/t))/256;return r*t}function te(e){return e*(4/3)}function F(t,e,p,i,x){var C={};var m,g,v,b,w,a;var F=p._columns._count;var R=null;var r=e.replace(/worksheets\//,"worksheets/_rels/");var y=ue(t,r);var s,o;var _;var k;var S;var A;var D;var E;var B=[];d=p._workbook.excelImportErrors;e=u(e);I(t,e,{enter:function(c,e,t){var r;if(this.is(H)){if(t)if(e.t=="shared"&&e.si!=null)b=p.range(C[e.si])._get("formula")}else if(this.is(z)){v=null;b=null;m=e.r;w=null;if(m==null){m=T(R);m.col++;m=m.toString()}R=m;g=e.t;var n=e.s;if(n!=null)le(p,m,x,n)}else if(this.is(O))p.range(e.ref).merge();else if(this.is(P)){var i=L(e.min)-1;var a=Math.min(F,L(e.max))-1;var s;if(e.width){s=ee(parseFloat(e.width));if(s!==0)p._columns.values.value(i,a,s)}if(e.hidden==="1"||s===0)for(var o=i;o<=a;o++)p.hideColumn(o);if(e.style!=null)le(p,new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity,i),new kendo.spreadsheet.CellRef(+Infinity,a)),x,e.style)}else if(this.is($)){var l=L(e.r)-1;var u;if(e.ht){u=te(parseFloat(e.ht));if(u!==0)p._rows.values.value(l,l,u)}if(e.hidden==="1"||u===0)p.hideRow(l)}else if(this.is(U)){if(e.activeCell){var h=T(e.activeCell);p.select(h,true)}}else if(this.is(V)){if(e.state&&e.state.indexOf("frozen")>-1){if(e.xSplit)p.frozenColumns(L(e.xSplit));if(e.ySplit)p.frozenRows(L(e.ySplit))}}else if(this.is(j))p.showGridLines(N(e.showGridLines,true));else if(this.is(q)){var f=e["r:id"];var d=y.byId[f];if(d)p.range(e.ref).link(d)}else if(this.is(["autoFilter"])){_=e.ref;if(t)M()}else if(_)if(this.is(["filterColumn"]))k=parseInt(e.colId,10);else if(this.is(["customFilters"])){S=N(e.and)?"and":"or";A=[]}else if(this.is(["customFilter"])){r=ie(e.operator,e.val);if(r)A.push({operator:r.operator,value:r.value})}else if(this.is(["dynamicFilter"]))B.push({column:k,filter:new kendo.spreadsheet.DynamicFilter({type:ae(e.type)})});else if(this.is(["top10"]))B.push({column:k,filter:new kendo.spreadsheet.TopFilter({value:se(e.val),type:function(e,t){return e&&t?"topPercent":t?"topNumber":e?"bottomPercent":"bottomNumber"}(N(e.percent),N(e.top))})});else if(this.is(["filters"])){D=N(e.blank);E=[]}else if(this.is(["filter"]))E.push(se(e.val))},leave:function(e,n){if(this.is(H)){if(!b&&n.t=="shared"&&n.si!=null)b=p.range(C[n.si])._get("formula")}else if(this.is(z)){if(b!=null){var t=oe(p,w||m,function(){p.range(w||m).formula(b,a)},"parsing formula");if(t)p.range(w||m).value(b).background("#ffaaaa")}else if(v!=null){var r=p.range(m);if(!r._get("formula")){if(!g||g=="n")v=parseFloat(v);else if(g=="s")v=i[L(v)];else if(g=="b")v=v==="1";else if(g=="d")v=kendo.parseDate(v);if(v!=null)r.value(v)}}}else if(this.is(K)||this.is(Y))(function(){var e=kendo.spreadsheet.calc.parseSqref(n.sqref);var t=n.type.toLowerCase();var r=n.operator;if(/^(?:whole|decimal)$/.test(t))t="number";else if(t=="list")r="list";if(!r&&/^(?:number|date)$/.test(t))r="between";e.forEach(function(e){oe(p,e,function(){p.range(e).validation({type:N(n.showErrorMessage,true)?"reject":"warning",from:s,to:o,dataType:t,comparerType:c[r]||r,allowNulls:N(n.allowBlank),showButton:N(n.showDropDown)||t=="date"||t=="list",messageTemplate:n.error,titleTemplate:n.errorTitle})},"parsing validation")})})();else if(e=="cols")p._columns._refresh();else if(e=="sheetData")p._rows._refresh();else if(e=="autoFilter")M();else if(_)if(e=="customFilters")B.push({column:k,filter:new kendo.spreadsheet.CustomFilter({logic:S,criteria:A})});else if(e=="filters")B.push({column:k,filter:new kendo.spreadsheet.ValueFilter({values:E,blanks:D})})},text:function(e){var t;if(this.is(W)||this.is(h))v=e;else if(t=this.is(H)){b=e;a=t.t=="array";if(a)w=t.ref;else if(t.t=="shared")C[t.si]=m}else if(this.is(J)||this.is(Q))s=e;else if(this.is(G)||this.is(Z))o=e;else if(this.is(X))this.stack[this.stack.length-2].sqref=e}});if(y.byType.comments){var n=be(e,y.byType.comments[0]);ne(t,n,p)}if(y.byType.drawing){var l=be(e,y.byType.drawing[0]);re(t,l,p)}function M(){p.range(_).filter(B);_=null}}function R(e){var t=/\.([^.]+)$/.exec(e);if(t&&t[1])return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif"}[t[1].toLowerCase()]}function S(e){var t=/[^/]+$/.exec(e);return t&&t[0]}function re(s,o,l){var i=["xdr:twoCellAnchor"];var n=["xdr:ext"];var a=["xdr:oneCellAnchor"];var p=["xdr:from"];var m=["xdr:to"];var t=["xdr:row"];var r=["xdr:col"];var g=["xdr:rowOff"];var v=["xdr:colOff"];var b=["xdr:blipFill","a:blip"];var e=o.replace(/drawings\//,"drawings/_rels/");var u=ue(s,e);if(u.byType.image)Object.keys(u.byId).forEach(function(e){var t=be(o,u.byId[e]);var r=R(t);if(r){var n=s.files[t].asArrayBuffer();var i=S(t);var a=i&&!(kendo.support.browser.msie||kendo.support.browser.edge)?new window.File([n],i,{type:r}):new window.Blob([n],{type:r});u.byId[e]=l._workbook.addImage(a)}});var c,h,f,d;I(s,o,{enter:function(e,t){if(this.is(i)||this.is(a))c={};else if(this.is(p)||this.is(m))h={};else if(this.is(b)){var r=t["r:embed"];c.image=u.byId[r]}else if(this.is(n)){f=w(parseFloat(t.cx));d=w(parseFloat(t.cy))}},leave:function(){if(this.is(p)){c.topLeftCell=new kendo.spreadsheet.CellRef(h.row,h.col);c.offsetX=w(h.colOffset);c.offsetY=w(h.rowOffset)}else if(this.is(m)){c.brCell=new kendo.spreadsheet.CellRef(h.row,h.col);c.brX=w(h.colOffset);c.brY=w(h.rowOffset)}else if(this.is(i)&&c.image){var e=l._columns.sum(0,c.topLeftCell.col-1)+c.offsetX;var t=l._rows.sum(0,c.topLeftCell.row-1)+c.offsetY;var r=l._columns.sum(0,c.brCell.col-1)+c.brX;var n=l._rows.sum(0,c.brCell.row-1)+c.brY;l.addDrawing({topLeftCell:c.topLeftCell,offsetX:c.offsetX,offsetY:c.offsetY,width:f!=null?f:r-e,height:d!=null?d:n-t,image:c.image,opacity:1})}else if(this.is(a)&&c.image)l.addDrawing({topLeftCell:c.topLeftCell,offsetX:c.offsetX,offsetY:c.offsetY,width:f,height:d,image:c.image,opacity:1})},text:function(e){if(this.is(t))h.row=parseFloat(e);else if(this.is(r))h.col=parseFloat(e);else if(this.is(g))h.rowOffset=parseFloat(e);else if(this.is(v))h.colOffset=parseFloat(e)}})}function ne(e,t,r){var n=[];var i;var a;I(e,t,{enter:function(e,t){if(this.is(l))a={author:n[t.authorId],ref:t.ref,text:""};else if(this.is(v))i=""},leave:function(){if(this.is(l))r.range(a.ref).comment(a.text);else if(this.is(v))n.push(i)},text:function(e){if(this.is(b))a.text+=e;else if(this.is(v))i+=e}})}function ie(e,t){var r={equal:"eq",notEqual:"ne",greaterThan:"gt",greaterThanOrEqual:"gte",lessThan:"lt",lessThanOrEqual:"lte"}[e];t=se(t);if(r&&typeof t=="number")return{operator:r,value:t};if((e=="notEqual"||!e)&&typeof t=="string")return{operator:e?"doesnotmatch":"matches",value:t}}function ae(e){return{Q1:"quarter1",Q2:"quarter2",Q3:"quarter3",Q4:"quarter4",M1:"january",M2:"february",M3:"march",M4:"april",M5:"may",M6:"june",M7:"july",M8:"august",M9:"september",M10:"october",M11:"november",M12:"december"}[e.toUpperCase()]||e}function se(e){var t=parseFloat(e);if(!isNaN(t)&&t==e)return t;return e}function oe(t,r,e,n){try{e();return false}catch(e){var i={context:n,error:String(e)};if(t&&t.name)i.sheet=t.name();else if(t)i.sheet=t;if(r)i.location=String(r);d.push(i);return true}}var A={none:0,thin:1,medium:2,dashed:1,dotted:1,thick:3,double:3,hair:1,mediumDashed:2,dashDot:1,mediumDashDot:2,dashDotDot:1,mediumDashDotDot:2,slantDashDot:1},D={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};function le(e,t,r,n){var s=e.range(t);var i=r.inlineStyles[n],a,o;if(i.xfId)a=r.namedStyles[i.xfId];if(u("applyBorder","borderId"))f(r.borders[o]);if(u("applyFont","fontId"))h(r.fonts[o]);if(u("applyAlignment","textAlign"))s.textAlign(o);if(u("applyAlignment","verticalAlign"))s.verticalAlign(o);if(u("applyAlignment","indent"))s.indent(o);if(u("applyAlignment","wrapText"))s._property("wrap",o);if(u("applyFill","fillId"))c(r.fills[o]);if(u("applyNumberFormat","numFmtId"))l(r.numFmts[o]||D[o]);function l(e){var t=typeof e=="string"?e:e.formatCode;if(t!=null&&!/^general$/i.test(t)){t=t.replace(/^\[\$-[0-9]+\]/,"");s.format(t)}}function c(e){if(e.type=="solid")s.background(e.color)}function h(e){s.fontFamily(e.name);if(e.size)s._property("fontSize",e.size*4/3);if(e.bold)s.bold(true);if(e.italic)s.italic(true);if(e.underline)s.underline(true);if(e.color)s.color(e.color)}function f(a){function e(e,t){var r=a[e];if(!r)return;var n=A[r.style];if(n===0)return;var i=r.color;if(i==null)i="#000";s._property(t,{size:n,color:i})}e("left","borderLeft");e("top","borderTop");e("right","borderRight");e("bottom","borderBottom")}function u(e,t){var r=i[e];if(r!=null&&!r)return false;o=i[t];if(a&&o==null){r=a[e];if(r!=null&&!r)return false;o=a[t]}return o!=null}}function I(e,t,r){var n=e.files[t];if(n)i(n.asUint8Array(),r)}function E(e){var t=[];var r=null;I(e,"xl/sharedStrings.xml",{leave:function(){if(this.is(o)){t.push(r);r=null}},text:function(e){if(this.is(s)){if(r==null)r="";r+=e}}});return t}function ue(e,t){var i={byId:{},byType:{theme:[]}};I(e,u(t)+".rels",{enter:function(e,t){if(e=="Relationship"){i.byId[t.Id]=t.Target;var r=t.Type.match(/\w+$/)[0];var n=i.byType[r]||[];n.push(t.Target);i.byType[r]=n}}});return i}var B=["borders","border"],M=["fills","fill"],ce=["fonts","font"],he=["cellXfs","xf"],fe=["cellStyleXfs","xf"],de=["numFmts","numFmt"],f=[p("FF000000"),p("FFFFFFFF"),p("FFFF0000"),p("FF00FF00"),p("FF0000FF"),p("FFFFFF00"),p("FFFF00FF"),p("FF00FFFF"),p("FF000000"),p("FFFFFFFF"),p("FFFF0000"),p("FF00FF00"),p("FF0000FF"),p("FFFFFF00"),p("FFFF00FF"),p("FF00FFFF"),p("FF800000"),p("FF008000"),p("FF000080"),p("FF808000"),p("FF800080"),p("FF008080"),p("FFC0C0C0"),p("FF808080"),p("FF9999FF"),p("FF993366"),p("FFFFFFCC"),p("FFCCFFFF"),p("FF660066"),p("FFFF8080"),p("FF0066CC"),p("FFCCCCFF"),p("FF000080"),p("FFFF00FF"),p("FFFFFF00"),p("FF00FFFF"),p("FF800080"),p("FF800000"),p("FF008080"),p("FF0000FF"),p("FF00CCFF"),p("FFCCFFFF"),p("FFCCFFCC"),p("FFFFFF99"),p("FF99CCFF"),p("FFFF99CC"),p("FFCC99FF"),p("FFFFCC99"),p("FF3366FF"),p("FF33CCCC"),p("FF99CC00"),p("FFFFCC00"),p("FFFF9900"),p("FFFF6600"),p("FF666699"),p("FF969696"),p("FF003366"),p("FF339966"),p("FF003300"),p("FF333300"),p("FF993300"),p("FF993366"),p("FF333399"),p("FF333333"),p("FF000000"),p("FFFFFFFF")];function pe(e,a){var i={fonts:[],numFmts:{},fills:[],borders:[],namedStyles:[],inlineStyles:[]};var s=null;var o=null;var l=null;var u=null;I(e,"xl/styles.xml",{enter:function(e,t,r){if(this.is(de))i.numFmts[t.numFmtId]=t;else if(this.is(ce)){i.fonts.push(s={});if(r)s=null}else if(s){if(e=="sz")s.size=parseFloat(t.val);else if(e=="name")s.name=t.val;else if(e=="b")s.bold=N(t.val,true);else if(e=="i")s.italic=N(t.val,true);else if(e=="u")s.underline=t.val==null||t.val=="single";else if(e=="color")s.color=h(t,null)}else if(this.is(M)){i.fills.push(o={});if(r)o=null}else if(o){if(e=="patternFill")o.type=t.patternType;else if(e=="fgColor"&&o.type==="solid")o.color=h(t,f[0]);else if(e=="bgColor"&&o.type!=="solid")o.color=h(t,f[0])}else if(this.is(B)){i.borders.push(l={});if(r)l=null}else if(l){if(/^(?:left|top|right|bottom)$/.test(e))l[e]={style:t.style||"none"};if(e=="color"){var n=this.stack[this.stack.length-2].$tag;l[n].color=h(t,f[0])}}else if(this.is(fe)){u=c(t);i.namedStyles.push(u);if(r)u=null}else if(this.is(he)){u=c(t);i.inlineStyles.push(u);if(r)u=null}else if(u)if(e=="alignment"){if(/^(?:left|center|right|justify)$/.test(t.horizontal))u.textAlign=t.horizontal;if(/^(?:top|center|bottom)$/.test(t.vertical))u.verticalAlign=t.vertical;if(t.wrapText!=null)u.wrapText=N(t.wrapText);if(t.indent!=null)u.indent=L(t.indent)}},leave:function(e){if(this.is(ce))s=null;else if(this.is(M))o=null;else if(this.is(B))l=null;else if(e=="xf")u=null}});function c(t){var r={borderId:L(t.borderId),fillId:L(t.fillId),fontId:L(t.fontId),numFmtId:L(t.numFmtId),pivotButton:N(t.pivotButton),quotePrefix:N(t.quotePrefix),xfId:L(t.xfId)};e("applyAlignment");e("applyBorder");e("applyFill");e("applyFont");e("applyNumberFormat");e("applyProtection");function e(e){if(t[e]!=null)r[e]=N(t[e])}return r}function h(e,t){if(e.rgb)return p(e.rgb);else if(e.indexed)return f[L(e.indexed)];else if(e.theme){var r=a.colorScheme[L(e.theme)];if(!r)return t;var n=kendo.parseColor(r);if(e.tint){n=n.toHSL();var i=parseFloat(e.tint);if(i<0)n.l=n.l*(1+i);else n.l=n.l*(1-i)+(100-100*(1-i))}return n.toCssRgba()}}return i}var me=["a:clrScheme","*","a:srgbClr"],ge=["a:clrScheme","*","a:sysClr"];function ve(e,t){var r=[];var n={colorScheme:r};var i=u(t);if(e.files[i]){I(e,i,{enter:function(e,t){if(this.is(ge))r.push(p(t.val=="window"?"FFFFFFFF":"FF000000"));else if(this.is(me))r.push(p("FF"+t.val))}});if(r.length>3){a(r,0,1);a(r,2,3)}}function a(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}return n}function L(e){return e==null?null:parseInt(e,10)}function N(e,t){if(e==null)return t;return e=="true"||e===true||e==1}function p(e){var t=/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);return"rgba("+parseInt(t[2],16)+", "+parseInt(t[3],16)+", "+parseInt(t[4],16)+", "+parseInt(t[1],16)/255+")"}function be(e,t){e=e.split(/\/+/);t=t.split(/\/+/);e.pop();while(t.length){var r=t.shift();if(r==="")e=[];else if(r===".")continue;else if(r==="..")e.pop();else e.push(r)}return e.join("/")}function w(e){return e/9525}kendo.spreadsheet.readExcel=e,kendo.spreadsheet._readSheet=F,kendo.spreadsheet._readStrings=E,kendo.spreadsheet._readStyles=pe,kendo.spreadsheet._readTheme=ve,kendo.spreadsheet._readWorkbook=y})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/workbook.min",["../kendo.core.min","./runtime.min","./references.min","./excel-reader.min"],function(){var o=kendo,l=o.jQuery,u=o.spreadsheet.calc.runtime.Formula,c=o.spreadsheet.Ref,n=o.spreadsheet.CalcError;function h(e,t){var r=new XMLHttpRequest;r.onload=function(){t(r.response,r.getResponseHeader("Content-Type"))};r.onerror=function(){t(null)};r.open("GET",e);r.responseType="arraybuffer";r.send()}o.spreadsheet.messages.workbook={defaultSheetName:"Sheet"};var e=o.Observable.extend({options:{},init:function(e,t){o.Observable.fn.init.call(this);this.options=e;this._view=t;this._sheets=[];this._images={};this._imgID=0;this._sheetsSearchCache={};this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource});this.undoRedoStack=new o.util.UndoRedoStack;this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this));this._context=new o.spreadsheet.FormulaContext(this);this._validationContext=new o.spreadsheet.ValidationFormulaContext(this);this._names=Object.create(null);this.fromJSON(this.options)},clipboard:function(){if(!this._clipboard)this._clipboard=new o.spreadsheet.Clipboard(this);return this._clipboard},destroy:function(){this.unbind();if(this._clipboard)this._clipboard.destroy()},events:["cut","copy","paste","changing","change","excelImport","excelExport","insertSheet","removeSheet","selectSheet","renameSheet","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","changeFormat","dataBinding","dataBound","progress"],_sheetChanging:function(e){if(this.trigger("changing",e))e.preventDefault()},_sheetChange:function(e){this.trigger("change",e)},_sheetInsertRow:function(e){if(this.trigger("insertRow",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetInsertColumn:function(e){if(this.trigger("insertColumn",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetDeleteRow:function(e){if(this.trigger("deleteRow",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetDeleteColumn:function(e){if(this.trigger("deleteColumn",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetHideRow:function(e){if(this.trigger("hideRow",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetHideColumn:function(e){if(this.trigger("hideColumn",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetUnhideRow:function(e){if(this.trigger("unhideRow",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetUnhideColumn:function(e){if(this.trigger("unhideColumn",{sheet:e.sender,index:e.index}))e.preventDefault()},_sheetSelect:function(e){this.trigger("select",e)},_sheetDataBinding:function(e){if(this.trigger("dataBinding",{sheet:e.sender}))e.preventDefault()},_sheetDataBound:function(e){this.trigger("dataBound",{sheet:e.sender})},_sheetProgress:function(e){var t=this;setTimeout(function(){t.trigger("progress",{toggle:e.toggle})})},_sheetCommandRequest:function(e){this.trigger("commandRequest",e)},_inputForRef:function(e){var t=this;return t._sheet.withCultureDecimals(function(){return new o.spreadsheet.Range(e,t._sheet).input()})},_onUndoRedo:function(e){e.command.range().select()},execute:function(e){var t=l.extend({workbook:this},e.options);var r=new o.spreadsheet[e.command](t);var n=this.activeSheet();if(t.origin)r.origin(t.origin);if(t.operatingRange)r.range(t.operatingRange);else r.range(n.selection());if(t.editRange)r._editRange=t.editRange;var i=r.exec();if(!i||i.reason!=="error")if(!r.cannotUndo)this.undoRedoStack.push(r);this.cleanupImages();return i},resetFormulas:function(){this._sheets.forEach(function(e){e.resetFormulas()})},resetValidations:function(){this._sheets.forEach(function(e){e.resetValidations()})},refresh:function(e){if(e.recalc){this.resetFormulas();this.resetValidations();this._sheet.recalc(this._context);this._sheet.revalidate(this._validationContext)}},activeSheet:function(e){if(e===undefined)return this._sheet;if(!this.sheetByName(e.name()))return;this._sheet=e;e.triggerChange(o.spreadsheet.ALL_REASONS)},moveSheetToIndex:function(e,t){var r=this.sheetIndex(e);var n=this._sheets;if(r===-1)return;this._sheetsSearchCache={};n.splice(t,0,n.splice(r,1)[0]);this.trigger("change",{sheetSelection:true})},insertSheet:function(e){e=e||{};var r=this;var t=typeof e.index==="number"?e.index:r._sheets.length;var n;var i=r._sheets;var a=function(e){e=e?e:1;var t=o.spreadsheet.messages.workbook.defaultSheetName+e;if(!r.sheetByName(t))return t;return a(e+1)};if(e.name&&r.sheetByName(e.name))return;this._sheetsSearchCache={};n=e.name||a();var s=new o.spreadsheet.Sheet(e.rows||this.options.rows,e.columns||this.options.columns,e.rowHeight||this.options.rowHeight,e.columnWidth||this.options.columnWidth,e.headerHeight||this.options.headerHeight,e.headerWidth||this.options.headerWidth,e.defaultCellStyle||this.options.defaultCellStyle);s._workbook=this;s._name(n);this._bindSheetEvents(s);i.splice(t,0,s);if(e.data)s.fromJSON(e.data);if(e.dataSource)s.setDataSource(e.dataSource);this.trigger("change",{sheetSelection:true});return s},_bindSheetEvents:function(e){e.bind("changing",this._sheetChanging.bind(this));e.bind("change",this._sheetChange.bind(this));e.bind("insertRow",this._sheetInsertRow.bind(this));e.bind("insertColumn",this._sheetInsertColumn.bind(this));e.bind("deleteRow",this._sheetDeleteRow.bind(this));e.bind("deleteColumn",this._sheetDeleteColumn.bind(this));e.bind("hideRow",this._sheetHideRow.bind(this));e.bind("hideColumn",this._sheetHideColumn.bind(this));e.bind("unhideRow",this._sheetUnhideRow.bind(this));e.bind("unhideColumn",this._sheetUnhideColumn.bind(this));e.bind("select",this._sheetSelect.bind(this));e.bind("commandRequest",this._sheetCommandRequest.bind(this));e.bind("dataBinding",this._sheetDataBinding.bind(this));e.bind("dataBound",this._sheetDataBound.bind(this));e.bind("progress",this._sheetProgress.bind(this))},sheets:function(){return this._sheets.slice()},sheetByName:function(e){return this._sheets[this.sheetIndex(e)]},sheetByIndex:function(e){return this._sheets[e]},sheetIndex:function(e){var t=this._sheets;var r=(typeof e=="string"?e:e.name()).toLowerCase();var n=this._sheetsSearchCache[r];if(n>=0)return n;for(n=0;n<t.length;n++){var i=t[n].name().toLowerCase();this._sheetsSearchCache[i]=n;if(i===r)return n}return-1},renameSheet:function(e,r){var n=e.name().toLowerCase();if(!r||n===r.toLowerCase()||this.sheetByName(r))return;e=this.sheetByName(n);if(!e)return;this._sheetsSearchCache={};if(this.trigger("renameSheet",{sheet:e,newSheetName:r}))return;this._sheets.forEach(function(e){e._forFormulas(function(e){e.renameSheet(n,r)})});this.forEachName(function(e,t){if(e.nameref.renameSheet(n,r)){this.undefineName(t);e.name=e.nameref.print();this.nameDefinition(e.name,e)}if(e.value instanceof c||e.value instanceof u)e.value.renameSheet(n,r)}.bind(this));e._name(r);this.trigger("change",{sheetSelection:true});return e},removeSheet:function(e){var t=this;var r=t._sheets;var n=e.name();var i=t.sheetIndex(e);if(r.length===1)return;if(this.trigger("removeSheet",{sheet:e}))return;this._sheetsSearchCache={};if(i>-1){e.unbind();r.splice(i,1);if(t.activeSheet().name()===n){var a=r[i===r.length?i-1:i];t.activeSheet(a)}else this.trigger("change",{recalc:true,sheetSelection:true})}},_clearSheets:function(){for(var e=0;e<this._sheets.length;e++){this._sheets[e]._activeDrawing=[];this._sheets[e]._drawings=[];this._sheets[e].unbind()}this._sheets=[];this._sheetsSearchCache={};this._names={};this._images={};this._imgID=0},fromJSON:function(r){if(r.sheets){this._clearSheets();if(r.images){this._imgID=0;this._images={};Object.keys(r.images).forEach(function(e){if(!isNaN(e)){var t=parseFloat(e);if(isFinite(t))this._imgID=Math.max(this._imgID,t)}this._images[e]={url:r.images[e]}},this)}for(var e=0;e<r.sheets.length;e++){var t=r.sheets[e];var n=a(t,this.options);var i=this.insertSheet({rows:n.rowCount,columns:n.columnCount,rowHeight:n.rowHeight,columnWidth:n.columnWidth,headerHeight:n.headerHeight,headerWidth:n.headerWidth,data:t});if(t.dataSource)i.setDataSource(t.dataSource)}}if(r.activeSheet)this.activeSheet(this.sheetByName(r.activeSheet));else this.activeSheet(this._sheets[0]);if(r.names)r.names.forEach(function(e){this.defineName(e.name,e.value,e.hidden)},this)},toJSON:function(){this.resetFormulas();this.resetValidations();var e=Object.keys(this._names).map(function(e){var t=this._names[e];var r=t.value;if(r instanceof c||r instanceof u)r=r.print(0,0,true);else if(r instanceof n)r=r+"";else r=JSON.stringify(r);return{value:r,hidden:t.hidden,name:t.name,sheet:t.nameref.sheet,localName:t.nameref.name}},this);return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(e){e.recalc(this._context);e.revalidate(this._validationContext);return e.toJSON()},this),names:e,columnWidth:this.options.columnWidth,rowHeight:this.options.rowHeight}},saveJSON:function(){var n=this;var e=new l.Deferred;var i=n.toJSON();var t=Object.keys(n._images).filter(function(e){return n.usesImage(e)===1});var r=t.length;i.images={};if(r)t.forEach(function(e){var t=n._images[e];if(t.blob){var r=new FileReader;r.onload=function(){i.images[e]=r.result;a()};r.readAsDataURL(t.blob)}else{i.images[e]=t.url;a()}});else a();return e.promise();function a(){if(--r<=0)e.resolve(i)}},fromFile:function(e){var t=new l.Deferred;var r=t.promise();var n={file:e,promise:r};if(e&&!this.trigger("excelImport",n)){this._clearSheets();o.spreadsheet.readExcel(e,this,t)}else t.reject();return r},saveAsExcel:function(t){var n=this;t=l.extend({},n.options.excel,t);var r=n.toJSON();if(n.trigger("excelExport",{workbook:r}))return;var e=Object.keys(n._images).filter(function(e){return n.usesImage(e)===1});var i=e.length;var a=i?{}:null;if(i)e.forEach(function(r){var e=n._images[r];if(e.blob){var t=new FileReader;t.onload=function(){a[r]={type:e.blob.type,name:e.blob.name,data:t.result};s()};t.readAsArrayBuffer(e.blob)}else h(e.url,function(e,t){a[r]={type:t,data:e};s()})});else s();function s(){if(--i<=0){r.images=a;var e=new o.ooxml.Workbook(r);o.saveAs({dataURI:t.forceProxy?e.toDataURL():e.toBlob(),fileName:r.fileName||t.fileName,proxyURL:t.proxyURL,forceProxy:t.forceProxy})}}},draw:function(n,i){if(typeof n=="function"&&!i){i=n;n={}}var a=[],s=this._sheets;(function t(r){if(r<s.length)s[r].draw(o.spreadsheet.SHEETREF,n,function(e){a.push(e);t(r+1)});else{var e=a[0];for(r=1;r<a.length;++r)e.children=e.children.concat(a[r].children);i(e)}})(0)},nameForRef:function(e,t){if(t===undefined)t=e.sheet;t=t.toLowerCase();var r=e+"";for(var n in this._names){var i=this._names[n];var a=i.value;if(a instanceof c)if(!a.sheet||a.sheet&&t==a.sheet.toLowerCase())if(a+""==r)return i}return{name:r}},defineName:function(e,t,r){var n=o.spreadsheet.calc.parseNameDefinition(e,t);e=n.name.print();this._names[e.toLowerCase()]={value:n.value,hidden:r,name:e,nameref:n.name}},undefineName:function(e){delete this._names[e.toLowerCase()]},nameValue:function(e){e=e.toLowerCase();if(e in this._names)return this._names[e].value;return null},nameDefinition:function(e,t){e=e.toLowerCase();if(arguments.length>1)if(t===undefined)delete this._names[e];else this._names[e]=t;return this._names[e]},forEachName:function(t){Object.keys(this._names).forEach(function(e){t(this._names[e],e)},this)},adjustNames:function(n,i,a,s){n=n.toLowerCase();Object.keys(this._names).forEach(function(e){var t=this._names[e];var r=t.value;if(r instanceof c&&r.sheet.toLowerCase()==n)t.value=r.adjust(null,null,null,null,i,a,s);else if(r instanceof u)r.adjust(n,i?"row":"col",a,s)},this)},addImage:function(e){var t=String(++this._imgID);if(typeof e=="string")this._images[t]={url:e};else this._images[t]={blob:e};return t},imageUrl:function(e){var t=this._images[e];var r=t.url;if(!r)r=t.url=window.URL.createObjectURL(t.blob);return r},cleanupImages:function(){Object.keys(this._images).forEach(function(e){if(!this.usesImage(e)){var t=this._images[e].url;if(t)window.URL.revokeObjectURL(t);delete this._images[e]}},this)},usesImage:function(e){var t;var r=this._sheets;for(t=r.length;--t>=0;)if(r[t].usesImage(e))return 1;var n=this.undoRedoStack.stack;for(t=n.length;--t>=0;)if(n[t].usesImage(e))return 2;return false}});function a(e,t){function r(e,t,r){return e!==undefined?e:t!==undefined?t:r}var n=r(e.rowCount,t.rows,200),i=r(e.columnCount,t.columns,50),c=r(e.rowHeight,t.rowHeight,20),h=r(e.columnWidth,t.columnWidth,64),f=r(e.headerHeight,t.headerHeight,20),d=r(e.headerWidth,t.headerWidth,32);if(e.rows!==undefined)for(var a=0;a<e.rows.length;++a){var s=e.rows[a];var o=r(s.index,a);if(o>=n)n=o+1;if(s.cells)for(var l=0;l<s.cells.length;++l){var p=s.cells[l];var u=r(p.index,l);if(u>=i)i=u+1}}return{rowCount:n,columnCount:i,rowHeight:c,columnWidth:h,headerHeight:f,headerWidth:d}}if(o.spreadsheet.Workbook=e,o.PDFMixin){o.PDFMixin.extend(e.prototype);e.prototype.saveAsPDF=function(t){var r=new l.Deferred;var e=r.promise();var n={promise:e};if(this.trigger("pdfExport",n))return;this._drawPDF(t,r).then(function(e){return t.forceProxy?o.pdf.exportPDF(e):o.pdf.exportPDFToBlob(e)}).done(function(e){o.saveAs({dataURI:e,fileName:t.fileName,proxyURL:t.proxyURL,forceProxy:t.forceProxy,proxyTarget:t.proxyTarget});r.resolve()}).fail(function(e){r.reject(e)});return e};e.prototype._drawPDF=function(e){var t=new l.Deferred;var r=function(e){t.resolve(e)};switch(e.area){case"workbook":e.workbook.draw(e,r);break;case"sheet":e.workbook.activeSheet().draw(e,r);break;case"selection":e.workbook.activeSheet().selection().draw(e,r);break}return t.promise()}}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/formulacontext.min",["../kendo.core.min"],function(){var e=kendo.spreadsheet,x=e.CellRef,C=e.RangeRef,F=e.UnionRef,R=e.NameRef,S=e.Ref,t=kendo.Class.extend({init:function(e){this.workbook=e},getRefCells:function(e,t,c,h,f,d){var r,n,i,a;if(e instanceof x){r=this.workbook.sheetByName(e.sheet);if(!r||!e.valid())return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];n=r.formula(e);i=r.range(e.row,e.col).value();if(d||n!=null||i!=null)return[{formula:n,value:i,row:e.row,col:e.col,sheet:e.sheet,hidden:t?r.columnWidth(e.col)===0||r.rowHeight(e.row)===0:false}];else return[]}if(e instanceof C){a=this.workbook.sheetIndex(e.sheet);var p=[],s=a;if(e.endSheet){s=this.workbook.sheetIndex(e.endSheet);if(a>s){var m=a;a=s;s=m}}if(a<0||s<0||!e.valid())return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];while(a<=s){r=this.workbook.sheetByIndex(a++);var g=r._grid.normalize(e.topLeft);var v=r._grid.normalize(e.bottomRight);var b=r._grid.cellRefIndex(g);var w=r._grid.cellRefIndex(v);var y=r._properties.iterator("value",b,w);for(var o=g.col;o<=v.col;++o)for(var l=g.row;l<=v.row;++l){var _=r._grid.index(l,o);n=r._properties.get("formula",_);i=y.at(_);if(d||n!=null||i!=null)p.push({formula:n,value:i,row:l,col:o,sheet:r.name(),hidden:t?r.columnWidth(o)===0||r.rowHeight(l)===0:false})}}return p}if(e instanceof F){var k=[];for(a=0;a<e.refs.length;++a)k=k.concat(this.getRefCells(e.refs[a],t,c,h,f));return k}if(e instanceof R){var u=this.nameValue(e,c,h,f);if(u instanceof S)return this.getRefCells(u,t,c,h,f);return[{value:u==null?new kendo.spreadsheet.calc.runtime.CalcError("NAME"):u}]}return[]},isMerged:function(e){var t=this.workbook.sheetByName(e.sheet);return t.isMerged(e)},nameValue:function(e,t,r,n){var i;if(e.hasSheet())i=this.workbook.nameValue(e.print());else{e=e.clone().setSheet(t,true);i=this.workbook.nameValue(e.print());if(i==null)i=this.workbook.nameValue(e.name)}if(i instanceof S)i=i.absolute(r,n);return i},getData:function(e,t,r,n,i){var a=e instanceof x;if(e instanceof R)a=this.workbook.nameValue(e.name)instanceof x;var s=this.getRefCells(e,false,t,r,n,i).map(function(e){var t=e.value;if(t instanceof kendo.spreadsheet.calc.runtime.Formula)t=t.value;return t});return a?s[0]:s},onFormula:function(e){var a=this.workbook.sheetByName(e.sheet);var t=e.row,r=e.col,s=e.value;var n=a.formula({row:t,col:r});if(n!==e)return false;var i=e.arrayFormulaRange;if(i){var o,l;var u=s.width;var c=s.height;a.forEach(i,function(e,t){if(o===undefined){o=e;l=t}var r=e-o;var n=t-l;var i;if(r<c&&n<u)i=s.get(r,n);else i=new kendo.spreadsheet.calc.runtime.CalcError("N/A");a._value(e,t,i)})}else{if(s instanceof S){s=this.getData(s,e.sheet,t,r);if(Array.isArray(s))s=s[0];if(s===undefined)s=null}if(s instanceof kendo.spreadsheet.calc.runtime.Matrix)s=s.get(0,0);a._value(t,r,s)}clearTimeout(a._formulaContextRefresh);a._formulaContextRefresh=setTimeout(function(){a.batch(function(){},{layout:true})},50);return true}}),r=t.extend({onFormula:function(){return true}});e.FormulaContext=t,e.ValidationFormulaContext=r})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/controller.min",["../kendo.core.min"],function(){(function(c){"use strict";var s=c.jQuery;var u=/:alphanum$/;var i={up:"up",down:"down",left:"left",right:"right",home:"first-col",end:"last-col","ctrl+left":"word-left","ctrl+right":"word-right","ctrl+up":"word-up","ctrl+down":"word-down","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"};var o={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper",delete:"clearContents",backspace:"clearContents","shift+:alphanum":"edit","alt+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl","alt+ctrl+:alphanum":"edit",":edit":"edit"};var h={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove"};var t={pageup:"onPageUp",pagedown:"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"};var e={esc:"onEditorEsc",enter:"onEditorBlur","alt+enter":"insertNewline","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"onEditorBlur","shift+ctrl+enter":"onEditorArrayFormula"};var f=s.extend({focus:"onEditorBarFocus"},e);var r=s.extend({focus:"onEditorCellFocus"},e);var d={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet",autofill:"autofill"};function p(e){return e.map(function(e){return'[data-action="'+e+'"]'}).join(",")}var m=p(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]);var g=p(["unhide-row","unhide-column"]);var n=[];var a=[];var v=[];for(var l in i){n.push(l);a.push("shift+"+l)}for(l in o)v.push(l);t[n]="onAction";t[a]="onShiftAction";t[v]="onEntryAction";r[n]="onEditorAction";r[a]="onEditorShiftAction";var b=c.Class.extend({init:function(e,t){this.view=e;this.workbook(t);this.container=s(e.container);this.clipboardElement=s(e.clipboard);this.cellContextMenu=e.cellContextMenu;this.rowHeaderContextMenu=e.rowHeaderContextMenu;this.colHeaderContextMenu=e.colHeaderContextMenu;this.drawingContextMenu=e.drawingContextMenu;this.scroller=e.scroller;this.tabstrip=e.tabstrip;this.sheetsbar=e.sheetsbar;e.nameEditor.bind("enter",this.onNameEditorEnter.bind(this));e.nameEditor.bind("cancel",this.onNameEditorCancel.bind(this));e.nameEditor.bind("select",this.onNameEditorSelect.bind(this));e.nameEditor.bind("delete",this.onNameEditorDelete.bind(this));this.editor=e.editor;this.editor.bind("change",this.onEditorChange.bind(this));this.editor.bind("activate",this.onEditorActivate.bind(this));this.editor.bind("deactivate",this.onEditorDeactivate.bind(this));this.editor.bind("update",this.onEditorUpdate.bind(this));s(e.scroller).on("scroll",this.onScroll.bind(this));this.listener=new c.spreadsheet.EventListener(this.container,this,h);s(e.scroller).on("mousedown",this.onMouseDown.bind(this));this._enableEditorEvents();if(this.sheetsbar){this.sheetsbar.bind("select",this.onSheetBarSelect.bind(this));this.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this));this.sheetsbar.bind("rename",this.onSheetBarRename.bind(this));this.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this))}this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this));this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));this.drawingContextMenu.bind("select",this.onContextMenuSelect.bind(this));this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).add(this.drawingContextMenu.element).on("contextmenu",false);if(this.tabstrip){this.tabstrip.bind("action",this.onCommandRequest.bind(this));this.tabstrip.bind("dialog",this.onDialogRequest.bind(this))}},_enableEditorEvents:function(e){if(e===undefined||e){this.keyListener=new c.spreadsheet.EventListener(this.clipboardElement,this,t);this.barKeyListener=new c.spreadsheet.EventListener(this.editor.barElement(),this,f);this.inputKeyListener=new c.spreadsheet.EventListener(this.editor.cellElement(),this,r)}else{this.keyListener.destroy();this.barKeyListener.destroy();this.inputKeyListener.destroy()}},_execute:function(e){var t=this._workbook.execute(e);if(e.command==="EditCommand"&&!t)this._workbook.trigger("change",{editorClose:true});if(t){this._preventNavigation=true;if(t.reason==="error"){this.editor.deactivate(true);this.view.showError(t,function(){this.activateEditor(false);this.editor.value(this._lastEditorValue);this.editor._value=this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());this.editor.select()}.bind(this))}else this.view.openDialog(t.reason)}return t},_activeTooltip:function(){return this._workbook.activeSheet().activeCell().simplify().toString()},onContextMenuSelect:function(e){var t=s(e.item).data("action");var r;switch(t){case"cut":r={command:"ToolbarCutCommand",options:{workbook:this._workbook}};break;case"copy":r={command:"ToolbarCopyCommand",options:{workbook:this._workbook}};break;case"paste":r={command:"ToolbarPasteCommand",options:{workbook:this._workbook}};break;case"delete-drawing":r={command:"DeleteDrawingCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"bring-to-front":r={command:"BringToFrontCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"send-to-back":r={command:"SendToBackCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"unmerge":r={command:"MergeCellCommand",options:{value:"unmerge"}};break;case"merge":this.view.openDialog("merge");break;case"hide-row":r={command:"HideLineCommand",options:{axis:"row"}};break;case"hide-column":r={command:"HideLineCommand",options:{axis:"column"}};break;case"unhide-row":r={command:"UnHideLineCommand",options:{axis:"row"}};break;case"unhide-column":r={command:"UnHideLineCommand",options:{axis:"column"}};break;case"delete-row":r={command:"DeleteRowCommand"};break;case"delete-column":r={command:"DeleteColumnCommand"};break}if(r)this._execute(r)},onSheetBarRemove:function(e){var t=this._workbook.sheetByName(e.name);if(!t)return;this._workbook.removeSheet(t)},destroy:function(){this.listener.destroy();this._enableEditorEvents(false);this.keyListener.destroy();this.inputKeyListener.destroy()},onSheetBarSelect:function(e){var t;var r=this._workbook;if(e.isAddButton){if(this._workbook.trigger("insertSheet"))return;t=r.insertSheet()}else t=r.sheetByName(e.name);if(r.activeSheet().name()!==t.name()){if(this._workbook.trigger("selectSheet",{sheet:t}))return;if(!this.editor.canInsertRef(false))this.editor.deactivate();r.activeSheet(t)}},onSheetBarReorder:function(e){var t=this._workbook;var r=t.sheetByIndex(e.oldIndex);var n=t.activeSheet();var i=n.name();t.moveSheetToIndex(r,e.newIndex);if(i!==r.name()){if(t.trigger("selectSheet",{sheet:r})){t.activeSheet(n);return}if(!this.editor.canInsertRef(false))this.editor.deactivate();t.activeSheet(r)}},onSheetBarRename:function(e){var t=this._workbook.sheetByIndex(e.sheetIndex);if(this._workbook.sheetByName(e.name)){this.view.showError({reason:"error",type:"duplicateSheetName"});return}this._workbook.renameSheet(t,e.name);this.clipboardElement.focus()},sheet:function(e){this.navigator=e.navigator();this.axisManager=e.axisManager()},workbook:function(e){this._workbook=e;this.clipboard=e.clipboard();e.bind("commandRequest",this.onCommandRequest.bind(this))},refresh:function(){var e=this.editor;var t=this._workbook;var r=t.activeSheet();this._viewPortHeight=this.view.scroller.clientHeight;this.navigator.height(this._viewPortHeight);if(!e.isActive()&&!this.isEditorDisabled){e.enable(r.selection().enable()!==false);this.resetEditorValue()}var n=r.selection()._ref.simplify();var i=this._workbook.nameForRef(n,r.name());this.view.nameEditor.value(i.name)},onScroll:function(){this.view.render({scroll:true})},onWheel:function(e){var t=e.originalEvent.deltaX;var r=e.originalEvent.deltaY;if(e.originalEvent.deltaMode===1){t*=10;r*=10}this.scrollWith(t,r);e.preventDefault()},onAction:function(e,t){var r=this._workbook.activeSheet();r._activeDrawing=null;this.navigator.moveActiveCell(i[t]);e.preventDefault()},onPageUp:function(){this.scrollDown(-this._viewPortHeight)},onPageDown:function(){this.scrollDown(this._viewPortHeight)},onEntryAction:function(e,t){var r=this._workbook.activeSheet();if(e.mod){var n=String.fromCharCode(e.keyCode);var i=true;switch(n){case"A":r._activeDrawing=null;this.navigator.selectAll();break;case"Y":this._workbook.undoRedoStack.redo();break;case"Z":this._workbook.undoRedoStack.undo();break;default:i=false;break}if(i)e.preventDefault()}else{var a=r.selection().enable()===false;var s=t!==":edit";if(t=="delete"||t=="backspace"){if(r._activeDrawing)this._execute({command:"DeleteDrawingCommand",options:{drawing:r._activeDrawing}});else if(!a)this._execute({command:"ClearContentCommand"});e.preventDefault()}else if(u.test(t)||!s){r._activeDrawing=null;if(a){e.preventDefault();return}if(s)this.editor.value("");this.activateEditor(s)}else{this.navigator.navigateInSelection(o[t]);e.preventDefault()}}},onShiftAction:function(e,t){this.navigator.modifySelection(i[t.replace("shift+","")],this.appendSelection);e.preventDefault()},onMouseMove:function(e){var t=this._workbook.activeSheet();if(t.resizingInProgress()||t.selectionInProgress())return;var r=this.objectAt(e);if(r.type==="columnresizehandle"||r.type==="rowresizehandle")t.positionResizeHandle(r.ref);else t.removeResizeHandle();t._renderComment(r.type=="cell"?r.ref:null)},onMouseDown:function(e){var t=this.objectAt(e);if(t.pane)this.originFrame=t.pane;if(this._startResizingDrawing(e,t)){e.stopPropagation();return}var r=this._workbook.activeSheet();var n=this.container.closest("["+c.attr("role")+'="window"]');if(n.length){n=c.widgetInstance(n);if(n&&n.options.modal)e.stopPropagation()}r._activeDrawing=null;if(t.type==="drawing"){r._activeDrawing=t.drawing;t.copy=t.drawing.clone();t.startBox=r.drawingBoundingBox(t.copy);r.startDragging(t);r.triggerChange({dragging:true});e.preventDefault();return}if(t.type==="editor"){this.onEditorEsc();this.openCustomEditor();e.preventDefault();return}if(this.editor.canInsertRef(false)&&t.ref){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());this.navigator.startSelection(t.ref,this._selectionMode,this.appendSelection,e.shiftKey,this.view);e.preventDefault();return}else{this._preventNavigation=false;this.editor.deactivate();if(this._preventNavigation)return}if(t.type==="columnresizehandle"||t.type==="rowresizehandle"){r.startResizing({x:t.x,y:t.y});e.preventDefault();return}if(t.type==="filtericon"){this.openFilterMenu(e);e.preventDefault();return}this._selectionMode=d[t.type];this.appendSelection=e.mod;this.navigator.startSelection(t.ref,this._selectionMode,this.appendSelection,e.shiftKey,this.view)},_startResizingDrawing:function(e){var t=s(e.target).closest(".k-spreadsheet-drawing-handle");if(t.length){var r=this.translateCoords(e);var n=t.data("direction");var i=this._workbook.activeSheet();var a=i._activeDrawing;i.startDragging({pane:this.originFrame,drawing:a,copy:a.clone(),startBox:i.drawingBoundingBox(a),resize:n,startX:r.x,startY:r.y});return true}},onContextMenu:function(e){var t=this._workbook.activeSheet();e.preventDefault();if(t.resizingInProgress()||t.draggingInProgress())return;this.cellContextMenu.close();this.colHeaderContextMenu.close();this.rowHeaderContextMenu.close();this.drawingContextMenu.close();var r;var n=this.objectAt(e);if(n.type==="columnresizehandle"||n.type==="rowresizehandle")return;if(n.ref)this.navigator.selectForContextMenu(n.ref,d[n.type]);else if(n.type=="drawing")this.navigator.selectDrawingForContextMenu(n.drawing);var i=this.navigator._sheet.select()instanceof c.spreadsheet.UnionRef;var a=false;var s=false;if(n.type=="columnheader"){r=this.colHeaderContextMenu;a=!i&&this.axisManager.selectionIncludesHiddenColumns()}else if(n.type=="rowheader"){r=this.rowHeaderContextMenu;a=!i&&this.axisManager.selectionIncludesHiddenRows()}else if(n.type=="drawing")r=this.drawingContextMenu;else{r=this.cellContextMenu;s=this.navigator.selectionIncludesMergedCells()}r.element.find(m).toggle(!i);r.element.find(g).toggle(a);r.element.find("[data-action=unmerge]").toggle(s);setTimeout(function(){r.open(e.pageX,e.pageY)})},prevent:function(e){e.preventDefault()},constrainResize:function(e,t){var r=this._workbook.activeSheet();var n=r.resizeHandlePosition();return!n||e==="outside"||e==="topcorner"||t.col<n.col||t.row<n.row},_dragDrawing:function(e){var t=this._workbook.activeSheet();var r=t.draggingInProgress();if(!r)return false;var n=this.translateCoords(e);var i=r.drawing;var a=n.x-r.startX;var s=n.y-r.startY;if(r.resize=="SE")if(r.aspect)if(Math.abs(a)>Math.abs(s)){i.width=Math.max(r.copy.width+a,20);i.height=i.width/r.aspect}else{i.height=Math.max(r.copy.height+s,20);i.width=i.height*r.aspect}else{i.width=Math.max(r.copy.width+a,20);i.height=Math.max(r.copy.height+s,20)}else if(r.resize=="E")i.width=Math.max(r.copy.width+a,20);else if(r.resize=="S")i.height=Math.max(r.copy.height+s,20);else if(r.resize=="N"){if(r.copy.height-s>20){i.height=r.copy.height-s;i.offsetY=r.copy.offsetY+s}}else if(r.resize=="W"){if(r.copy.width-a>20){i.width=r.copy.width-a;i.offsetX=r.copy.offsetX+a}}else if(r.resize=="NE"){i.width=Math.max(r.copy.width+a,20);if(r.copy.height-s>20){i.height=r.copy.height-s;i.offsetY=r.copy.offsetY+s}}else if(r.resize=="SW"){i.height=Math.max(r.copy.height+s,20);if(r.copy.width-a>20){i.width=r.copy.width-a;i.offsetX=r.copy.offsetX+a}}else if(r.resize=="NW"){if(r.copy.height-s>20){i.height=r.copy.height-s;i.offsetY=r.copy.offsetY+s}if(r.copy.width-a>20){i.width=r.copy.width-a;i.offsetX=r.copy.offsetX+a}}else{i.offsetX=r.copy.offsetX+a;i.offsetY=r.copy.offsetY+s}t.triggerChange({dragging:true});return true},onMouseDrag:function(e){if(this._selectionMode==="sheet")return;var t={clientX:e.clientX,clientY:e.clientY};var r=this._workbook.activeSheet();if(this._dragDrawing(e))return;var n=this.objectAt(t);if(r.resizingInProgress()){if(!this.constrainResize(n.type,n.ref))r.resizeHintPosition({x:n.x,y:n.y});return}if(n.type==="outside"){this.startAutoScroll(n);return}if(this.originFrame===n.pane)this.selectToLocation(t);else{var i=this.originFrame._grid;if(n.x>i.right)c.scrollLeft(this);if(n.y>i.bottom)this.scrollTop();if(n.y<i.top||n.x<i.left)this.startAutoScroll(n,t);else this.selectToLocation(t)}e.preventDefault()},onMouseUp:function(e){var t=this._workbook.activeSheet();t.completeResizing();t.completeDragging();this.navigator.completeSelection();this.stopAutoScroll();var r=this.editor.activeEditor();if(!r)return;var n=e.target;while(n){if(n===r.element[0])return;n=n.parentNode}var i=this.objectAt(e);if(i&&i.ref&&r.canInsertRef(false)){r.refAtPoint(t);t._setFormulaSelections(r.highlightedRefs())}},onDblClick:function(e){var t=this.objectAt(e);var r=this._workbook.activeSheet().selection().enable()===false;if(t.type!=="cell"||r)return;var n=this._workbook.activeSheet().selection();this.activateEditor(!n.value()&&!n.formula());this.onEditorUpdate()},onCut:function(e){var t=this;setTimeout(function(){t.clipboard.menuInvoked=e===undefined;t._execute({command:"CutCommand",options:{workbook:t.view._workbook,event:e.originalEvent||e}})})},clipBoardValue:function(){return this.clipboardElement.html()},_pasteImage:function(e){var t=this;var r=new window.Image;r.src=window.URL.createObjectURL(e);r.onload=function(){t._execute({command:"InsertImageCommand",options:{blob:e,width:r.width,height:r.height}})};setTimeout(function(){window.URL.revokeObjectURL(r.src)},10)},onPaste:function(e){var t=this;var r="";var n="";t.clipboard.menuInvoked=e===undefined;if(e){var i=e.originalEvent.clipboardData;if(i&&i.getData){e.preventDefault();var a=false;var s=false;if(window.DOMStringList&&i.types instanceof window.DOMStringList){a=i.types.contains("text/html");s=i.types.contains("text/plain")}else if(Array.isArray(i.types)){a=i.types.indexOf("text/html")>=0;s=i.types.indexOf("text/plain")>=0}else{a=/text\/html/.test(i.types);s=/text\/plain/.test(i.types)}if(a)r=i.getData("text/html").trim();if(s)n=i.getData("text/plain").trim();if(!r&&!n&&i.items&&i.items.length)for(var o=0;o<i.items.length;++o){var l=i.items[o];if(l.kind=="file"&&/^image\/(?:png|jpe?g|gif)$/i.test(l.type))return t._pasteImage(l.getAsFile())}}else{if(window.clipboardData.files&&window.clipboardData.files.length){var u=window.clipboardData.files[0];if(/^image\/(?:png|jpe?g|gif)$/i.test(u.type))return t._pasteImage(u)}n=window.clipboardData.getData("Text");if(n)n=n.trim();t.clipboardElement.empty();setTimeout(function(){r=t.clipboardElement.html();if(r||n){t.clipboard.external({html:r,plain:n});t._execute({command:"PasteCommand",options:{workbook:t.view._workbook,event:e.originalEvent||e}})}});return}}else if(c.support.browser.msie){t.clipboardElement.trigger("focus").select();document.execCommand("paste");return}else t.clipboard.menuInvoked=true;if(!r&&!n)return;t.clipboard.external({html:r,plain:n});t._execute({command:"PasteCommand",options:{workbook:t.view._workbook,event:e.originalEvent||e}})},onCopy:function(e){this.clipboard.menuInvoked=e===undefined;this._execute({command:"CopyCommand",options:{workbook:this.view._workbook,event:e.originalEvent||e}})},scrollTop:function(){this.scroller.scrollTop=0},scrollLeft:function(){this.scroller.scrollLeft=0},scrollDown:function(e){this.scroller.scrollTop+=e},scrollRight:function(e){this.scroller.scrollLeft+=e},scrollWith:function(e,t){this.scroller.scrollTop+=t;this.scroller.scrollLeft+=e},translateCoords:function(e){var t=this.container[0].getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},objectAt:function(e,t){if(!e)return;e=this.translateCoords(e);return this.view.objectAt(e.x,e.y,t)},selectToLocation:function(e){var t=this.objectAt(e,true);if(t.pane&&t.ref){this.extendSelection(t);this.lastKnownCellLocation=e;this.originFrame=t.pane}this.stopAutoScroll()},extendSelection:function(e){this.navigator.extendSelection(e.ref,this._selectionMode)},autoScroll:function(){var e=this._autoScrollTarget.x;var t=this._autoScrollTarget.y;var r=this.originFrame._grid;var n=this.view.scroller;var i=8;var a=n.scrollLeft;var s=n.scrollTop;if(e<r.left)this.scrollRight(-i);if(e>r.right)this.scrollRight(i);if(t<r.top)this.scrollDown(-i);if(t>r.bottom)this.scrollDown(i);if(s===n.scrollTop&&a===n.scrollLeft)this.selectToLocation(this.finalLocation);else this.extendSelection(this.objectAt(this.lastKnownCellLocation))},startAutoScroll:function(e,t){if(!this._scrollInterval)this._scrollInterval=setInterval(this.autoScroll.bind(this),50);this.finalLocation=t||this.lastKnownCellLocation;this._autoScrollTarget=e},stopAutoScroll:function(){clearInterval(this._scrollInterval);this._scrollInterval=null},openCustomEditor:function(){this.view.openCustomEditor()},openFilterMenu:function(e){var t=this.objectAt(e);var r=this._workbook.activeSheet();var n=r.filterColumn(t.ref);var i=this.view.createFilterMenu(n);i.bind("action",this.onCommandRequest.bind(this));i.bind("action",i.close.bind(i));i.openFor(e.target)},_saveEditorValue:function(e){var t=this.editor._range.sheet();var r=this.editor.value();if(this._workbook.activeSheet()!==t){this._workbook.activeSheet()._setFormulaSelections();this._workbook.activeSheet(t)}t.isInEditMode(false);this._lastEditorValue=r;this._execute({command:"EditCommand",options:{value:r,arrayFormula:e}})},onEditorChange:function(){this._saveEditorValue(false)},onEditorArrayFormula:function(){this._saveEditorValue(true);this.editor.deactivate(true)},onEditorActivate:function(){var e=this._workbook;var t=e.activeSheet();t._setFormulaSelections(this.editor.highlightedRefs());t.isInEditMode(true)},onEditorDeactivate:function(){var e=this._workbook.activeSheet();e.isInEditMode(false);e._setFormulaSelections([])},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs())},onEditorBarFocus:function(){var e=this._workbook.activeSheet().selection().enable()===false;if(e)return;this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()})},onEditorCellFocus:function(){this.editor.scale()},onEditorEsc:function(){this.resetEditorValue();this.editor.deactivate();this.clipboardElement.trigger("focus")},insertNewline:function(e){e.preventDefault();this.editor.insertNewline()},onEditorBlur:function(e,t){if(this.editor.isFiltered())return;this._preventNavigation=false;this.editor.deactivate();if(!this._preventNavigation){this.clipboardElement.trigger("focus");this.navigator.navigateInSelection(o[t])}},onEditorAction:function(e,t){var r=this.editor;var n=this._workbook.activeSheet();if(this._casualEditing&&/^(?:up|right|down|left)$/.test(t)){this.deactivateEditor();this.navigator.moveActiveCell(i[t]);e.preventDefault()}else if(r.canInsertRef(true)){this.navigator.moveActiveCell(i[t]);r.activeEditor().refAtPoint(n);n._setFormulaSelections(r.highlightedRefs());e.preventDefault()}},onEditorShiftAction:function(e,t){var r=this.editor;var n=this._workbook.activeSheet();if(r.canInsertRef(true)){this.navigator.modifySelection(i[t.replace("shift+","")],this.appendSelection);r.activeEditor().refAtPoint(n);n._setFormulaSelections(r.highlightedRefs());e.preventDefault()}},resetEditorValue:function(){var e=this._workbook.activeSheet();var t=e.activeCell();var r=this._workbook._inputForRef(t);var n=e.range(t).intersectingArrayFormula();if(n)r="="+n.formula;this.editor.value(r,!!n)},activateEditor:function(e){this._casualEditing=e;this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus()},deactivateEditor:function(){this.view.editor.deactivate()},onCommandRequest:function(e){if(e.command)this._execute(e);else this._workbook.undoRedoStack[e.action]()},onDialogRequest:function(e){var t={pdfExport:this._workbook.options.pdf,excelExport:this._workbook.options.excel};if(e.options)s.extend(true,e.options,t);else e.options=t;this.view.openDialog(e.name,e.options)},onNameEditorEnter:function(){var e;var t=this._workbook;var r=t.activeSheet();var n=this.view.nameEditor.value();e=c.spreadsheet.calc.parseReference(n,true)||t.nameValue(n);if(e instanceof c.spreadsheet.Ref){if(e.sheet&&e.sheet.toLowerCase()!=r.name().toLowerCase()){var i=t.sheetByName(e.sheet);if(i){t.activeSheet(i);r=i}}r.range(e).select();return}e=r.selection()._ref.clone().simplify().setSheet(r.name(),true);this._execute({command:"DefineNameCommand",options:{name:n,value:e}});this.clipboardElement.trigger("focus")},onNameEditorCancel:function(){this.clipboardElement.trigger("focus")},onNameEditorSelect:function(e){var t=e.name;var r=this._workbook;var n=r.activeSheet();var i=r.nameValue(t);if(i instanceof c.spreadsheet.Ref){if(i.sheet&&i.sheet.toLowerCase()!=n.name().toLowerCase()){var a=r.sheetByName(i.sheet);if(a){r.activeSheet(a);n=a}}n.range(i).select();return}this.clipboardElement.trigger("focus")},onNameEditorDelete:function(e){this._execute({command:"DeleteNameCommand",options:{name:e.name}});this.clipboardElement.trigger("focus")}});c.spreadsheet.Controller=b})(window.kendo)})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/view.min",["../kendo.core.min","../kendo.menu.min","./sheetsbar.min","../util/main.min"],function(){var b=window.kendo,h=b.jQuery,f=b.spreadsheet.CellRef,i=".",s=7,u=20,l="Error",d={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonSelected:"k-selected",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon",iconFilterDefault:"k-i-arrow-60-down",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu",drawingContextMenu:"k-spreadsheet-drawing-context-menu"};function e(e){var t=window.getSelection();t.removeAllRanges();var r=document.createRange();r.selectNodeContents(e);t.addRange(r)}function m(e,t){var r=e.trs[t].children;return r[r.length-2]}function g(e,t){var r=e.trs[t-1];var n=e.trs[t].children.length-1;if(r&&n>=0)return r.children[n]}function w(e){return(e.size||1)+"px solid "+(e.color||"#000")}function k(e){if(!/:\/\//.test(e))e="http://"+e;return e}function x(c,n,e,h){function f(e){var t=n.link;if(!t)if(typeof n.value=="object")t=n.value.link;if(t){var r={textDecoration:"none"};if(n.color)r.color=n.color;if(n.underline)r.textDecoration="underline";return b.dom.element("a",{href:k(t),style:r,target:"_blank"},e?[e]:[])}return e}var d=n.value!=null||n.validation!=null&&!n.validation.value||n.background||n.merged||n.comment;if(!e&&!d)return;var t={};var r=n.background;if(r){var i=r;if(h){i=b.parseColor(i).toHSV();i.v*=.9;i=i.toCssRgba()}i=w({color:i});t.outline=i}if(r)t.backgroundColor=r;if(n.color)t.color=n.color;if(n.fontFamily)t.fontFamily=n.fontFamily;if(n.underline)t.textDecoration="underline";if(n.italic)t.fontStyle="italic";if(n.textAlign)t.textAlign=n.textAlign;if(n.bold)t.fontWeight="bold";if(n.fontSize)t.fontSize=n.fontSize+"px";if(n.wrap===true){t.whiteSpace="pre-wrap";t.overflowWrap="break-word";t.wordWrap="break-word"}else{t.whiteSpace="pre";t.overflowWrap="normal";t.wordWrap="normal"}t.left=n.left+1+"px";t.top=n.top+1+"px";t.width=n.width-1+"px";t.height=n.height-1+"px";var a=n.value,s=typeof a,o=n.format;if(!o&&s=="number"&&a!=Math.floor(a))o="0.##############";if(o&&a!=null){a=b.spreadsheet.formatting.format(a,o);if(a.__dataType)s=a.__dataType}else if(a!==null&&a!==undefined)if(n.html)a=b.dom.html(a);else a=b.dom.text(a);if(!t.textAlign)switch(s){case"number":case"date":case"percent":case"currency":t.textAlign="right";break;case"boolean":t.textAlign="center";break}b.spreadsheet.draw.applyIndent(n,t);var l=[y.cell];if(e)l.push(e);if(n.enable===false)l.push("k-state-disabled");if(n.merged)l.push("k-spreadsheet-merged-cell");if(n.comment)l.push("k-spreadsheet-has-comment");var p=n.verticalAlign||"bottom";if(p&&a)a=b.dom.element("div",{className:"k-vertical-align-"+p},[f(a)]);else a=f(a);var m=a?[a]:[];var u={style:t};var g=n.validation;if(g&&!g.value){m.push(b.dom.element("span",{className:"k-dirty"}));l.push("k-dirty-cell");u.title=g.message}u.className=l.join(" ");var v=b.dom.element("div",u,m);c.push(v);return v}function c(e,t,r){var n={};if(r.background)n.backgroundColor=r.background;if(r.color)n.color=r.color;if(r.fontFamily)n.fontFamily=r.fontFamily;if(r.underline)n.textDecoration="underline";if(r.italic)n.fontStyle="italic";if(r.textAlign)n.textAlign=r.textAlign;if(r.verticalAlign)n.verticalAlign=r.verticalAlign==="center"?"middle":r.verticalAlign;if(r.bold)n.fontWeight="bold";if(r.fontSize)n.fontSize=r.fontSize+"px";if(r.wrap===true)n.whiteSpace="pre-wrap";if(r.borderRight)n.borderRight=w(r.borderRight);else if(r.background)n.borderRightColor=r.background;if(r.borderBottom)n.borderBottom=w(r.borderBottom);else if(r.background)n.borderBottomColor=r.background;var i=r.value,a=typeof i,s=r.format;if(!s&&a=="number"&&i!=Math.floor(i))s="0.##############";if(s&&i!=null){i=b.spreadsheet.formatting.format(i,s);if(i.__dataType)a=i.__dataType}if(!n.textAlign)switch(a){case"number":case"date":case"percent":case"currency":n.textAlign="right";break;case"boolean":n.textAlign="center";break}var o=null;if(r.enable===false)o="k-state-disabled";var c=e.addCell(t,i,n,o,r.validation);var l,u;if(r.borderLeft){u=m(e,t);l=w(r.borderLeft);if(u&&l)u.attr.style.borderRight=l}else if(r.background)n.borderLeftColor=r.background;if(r.borderTop){u=g(e,t);l=w(r.borderTop);if(u&&l)u.attr.style.borderBottom=l}else if(r.background)n.borderTopColor=r.background;return c}b.spreadsheet.messages.view={nameBox:"Name Box",errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",insertColumnWhenRowIsSelected:"Cannot insert column when all columns are selected.",insertRowWhenColumnIsSelected:"Cannot insert row when all rows are selected.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",cantSortMultipleSelection:"Cannot sort multiple selection",cantSortNullRef:"Cannot sort empty selection",cantSortMixedCells:"Cannot sort range containing cells of mixed shapes",validationError:"The value that you entered violates the validation rules set on the cell.",cannotModifyDisabled:"Cannot modify disabled cells.",insertRowBelowLastRow:"Cannot insert row below the last row.",insertColAfterLastCol:"Cannot insert column to the right of the last column."},tabs:{home:"Home",insert:"Insert",data:"Data"}},b.spreadsheet.messages.menus={cut:"Cut",copy:"Copy",paste:"Paste",merge:"Merge",unmerge:"Unmerge",delete:"Delete",hide:"Hide",unhide:"Unhide",bringToFront:"Bring to front",sendToBack:"Send to back"};var a=b.Class.extend({init:function(){this.cols=[];this.trs=[];this._height=0;this._width=0},addColumn:function(e){this._width+=e;var t=b.dom.element("col",{style:{width:e+"px"}});t.visible=e>0;this.cols.push(t)},addRow:function(e){var t=null;t={style:{height:e+"px"}};this._height+=e;var r=b.dom.element("tr",t);r.visible=e>0;this.trs.push(r)},addCell:function(e,t,r,n,i){if(t===null||t===undefined)t="";if(!(t instanceof b.dom.Node))t=b.dom.text(t);var a=[t];var s={style:r};if(i&&!i.value){a.push(b.dom.element("span",{className:"k-dirty"}));n=(n||"")+(n?" ":"")+"k-dirty-cell";s.title=i.message}if(n)s.className=n;var o=b.dom.element("td",s,a);this.trs[e].children.push(o);return o},toDomTree:function(e,t,r){this.trs=this.trs.filter(function(e){return e.visible});var n=0;this.cols=this.cols.filter(function(e,t){if(!e.visible){this.trs.forEach(function(e){e.children.splice(t-n,1)});n++}return e.visible},this);return b.dom.element("table",{style:{left:e+"px",top:t+"px",height:this._height+"px",width:this._width+"px"},className:r,role:"presentation"},[b.dom.element("colgroup",null,this.cols),b.dom.element("tbody",null,this.trs)])}}),t='<ul class="#=classNames.cellContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+"<li data-action=merge>#: messages.merge #</li>"+"<li data-action=unmerge>#: messages.unmerge #</li>"+"</ul>",r='<ul class="#=classNames.rowHeaderContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+'<li data-action="delete-row">#: messages.delete #</li>'+'<li data-action="hide-row">#: messages.hide #</li>'+'<li data-action="unhide-row">#: messages.unhide #</li>'+"</ul>",n='<ul class="#=classNames.colHeaderContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+'<li data-action="delete-column">#: messages.delete #</li>'+'<li data-action="hide-column">#: messages.hide #</li>'+'<li data-action="unhide-column">#: messages.unhide #</li>'+"</ul>",o='<ul class="#=classNames.drawingContextMenu#">'+'<li data-action="bring-to-front">#: messages.bringToFront #</li>'+'<li data-action="send-to-back">#: messages.sendToBack #</li>'+'<li class="k-separator"></li>'+'<li data-action="delete-drawing">#: messages.delete #</li>'+"</ul>",v=(b.spreadsheet.ContextMenu=b.ui.ContextMenu,b.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div>'+'<div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+t+r+n+o));function C(e,t,r){return e>=t&&e<=r}var p=b.Class.extend({init:function(e,t){var r=p.classNames;this.element=e;this.options=h.extend(true,{messages:b.spreadsheet.messages.view},this.options,t);this._chrome();this._dialogs=[];e.append(v({classNames:r,messages:b.spreadsheet.messages.menus}));this._formulaInput();this.wrapper=e.find(i+r.view);this.container=e.find(i+r.fixedContainer)[0];this.scroller=e.find(i+r.scroller)[0];this.clipboard=e.find(i+r.clipboard);this.viewSize=h(this.scroller.firstChild);this.tree=new b.dom.Tree(this.container);this.clipboardContents=new b.dom.Tree(this.clipboard[0]);this.editor=new b.spreadsheet.SheetEditor(this);this._sheetsbar();var n={target:e,animation:false,showOn:"never"};this.cellContextMenu=new b.spreadsheet.ContextMenu(e.find(i+r.cellContextMenu),n);this.colHeaderContextMenu=new b.spreadsheet.ContextMenu(e.find(i+r.colHeaderContextMenu),n);this.rowHeaderContextMenu=new b.spreadsheet.ContextMenu(e.find(i+r.rowHeaderContextMenu),n);this.drawingContextMenu=new b.spreadsheet.ContextMenu(e.find(i+r.drawingContextMenu),n)},enableClipboard:function(e){this.isClipboardDeactivated=!e;if(e)this.clipboard.attr("contenteditable",e);else this.clipboard.removeAttr("contenteditable")},_resize:function(){var e=h(this.formulaBar.element).parents(".k-spreadsheet-action-bar");var t=b._outerHeight;var r=this.tabstrip?t(this.tabstrip.element):0;var n=e?t(e):0;var i=this.sheetsbar?t(this.sheetsbar.element):0;this.wrapper.height(this.element.height()-(r+n+i));if(this.tabstrip)this.tabstrip.quickAccessAdjust()},_chrome:function(){var e=h("<div class='k-spreadsheet-action-bar' />").prependTo(this.element);var t=h("<div class='k-spreadsheet-name-editor' />").appendTo(e);this.nameEditor=new b.spreadsheet.NameEditor(t,this.options);var r=h("<div />").appendTo(e);this.formulaBar=new b.spreadsheet.FormulaBar(r);if(this.options.toolbar)this._tabstrip()},_formulaInput:function(){var e=this.element.find(i+p.classNames.cellEditor);this.formulaInput=new b.spreadsheet.FormulaInput(e,{autoScale:true})},_sheetsbar:function(){if(this.options.sheetsbar){var e=h.extend(true,{openDialog:this.openDialog.bind(this)},this.options.sheetsbar);this.sheetsbar=new b.spreadsheet.SheetsBar(this.element.find(i+p.classNames.sheetsBar),e)}},_tabstrip:function(){var e=this.options.messages.tabs;var t=h.extend(true,{home:true,insert:true,data:true},this.options.toolbar);var r=[];if(this.tabstrip){this.tabstrip.destroy();this.element.children(".k-tabstrip").remove()}for(var n in t)if(t[n]===true||t[n]instanceof Array)r.push({id:n,text:e[n],content:""});this.tabstrip=new b.spreadsheet.TabStrip(h("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:r,toolbarOptions:t,view:this});this.tabstrip.select(0)},_executeCommand:function(e){this._sheet.trigger("commandRequest",e)},workbook:function(e){this._workbook=e;e._view=this;this.nameEditor._workbook=e},sheet:function(e){this._sheet=e},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell())},_rectangle:function(e,t){return e._grid.boundingRectangle(t.toRangeRef())},isColumnResizer:function(t,e,r){t-=this._sheet._grid._headerWidth;if(!e._grid.columns.frozen)t+=this.scroller.scrollLeft;r=this._sheet._grid._columns.locate(0,r,function(e){return Math.abs(t-e)<=s/2});return r!==null&&!this._sheet.isHiddenColumn(r)?r:null},isRowResizer:function(t,e,r){t-=this._sheet._grid._headerHeight;if(!e._grid.rows.frozen)t+=this.scroller.scrollTop;r=this._sheet._grid._rows.locate(0,r,function(e){return Math.abs(t-e)<=s/2});return r!==null&&!this._sheet.isHiddenRow(r)?r:null},isFilterIcon:function(n,i,a,e){var s=this;var t=a._grid;var r=t.rows.frozen?0:s.scroller.scrollTop;var o=t.columns.frozen?0:s.scroller.scrollLeft;n-=s._sheet._grid._headerWidth-o;i-=s._sheet._grid._headerHeight-r;return b.util.withExit(function(r){s._sheet.forEachFilterHeader(e,function(e){var t=s._rectangle(a,e);if(a.filterIconRect(t).intersects(n,i))r(true)})})},isAutoFill:function(e,t,r){var n=this._sheet.select();if(n.size>1)return false;e-=this._sheet._grid._headerWidth;t-=this._sheet._grid._headerHeight;if(!r._grid.columns.frozen)e+=this.scroller.scrollLeft;if(!r._grid.rows.frozen)t+=this.scroller.scrollTop;var i=this._rectangle(r,n);return Math.abs(i.right-e)<8&&Math.abs(i.bottom-t)<8},isEditButton:function(e,t,r){var n=this._sheet.activeCellCustomEditor();if(n){var i=this.activeCellRectangle();if(t>=i.top&&t<=i.bottom)return r._editorInLastColumn?e<i.left&&e>=i.left-u:e>i.right&&e<=i.right+u}},drawingAt:function(e,t,r){e-=this._sheet._grid._headerWidth;t-=this._sheet._grid._headerHeight;if(!r._grid.columns.frozen)e+=this.scroller.scrollLeft;if(!r._grid.rows.frozen)t+=this.scroller.scrollTop;var n=this._sheet;var i=this._sheet._drawings;for(var a=i.length;--a>=0;){var s=i[a];var o=n.drawingBoundingBox(s);if(o.intersects(e,t))return{drawing:s,drx:o.left-e,dry:o.top-t}}},objectAt:function(e,t,c){var r=this._sheet._grid;var n,i;if(e<0||t<0||e>this.scroller.clientWidth||t>this.scroller.clientHeight)n={type:"outside"};else if(e<r._headerWidth&&t<r._headerHeight)n={type:"topcorner"};else{i=this.paneAt(e,t);if(!i)n={type:"outside"};else{if(!c){var a=this.drawingAt(e,t,i);if(a)return{type:"drawing",drawing:a.drawing,drx:a.drx,dry:a.dry,pane:i,startX:e,startY:t}}var s=i._grid.rows.indexVisible(t,this.scroller.scrollTop);var o=i._grid.columns.indexVisible(e,this.scroller.scrollLeft);var l="cell";var u=new f(s,o);var h=this._sheet.selectionInProgress();if(this.isAutoFill(e,t,i))l="autofill";else if(this.isFilterIcon(e,t,i,u))l="filtericon";else if(!h&&e<r._headerWidth){l="rowheader";if((s=this.isRowResizer(t,i,s))!==null){u=new f(s,-Infinity);l="rowresizehandle"}}else if(!h&&t<r._headerHeight){l="columnheader";if((o=this.isColumnResizer(e,i,o))!==null){u=new f(-Infinity,o);l="columnresizehandle"}}else if(this.isEditButton(e,t,i))l="editor";n={type:l,ref:u}}}n.pane=i;n.x=e;n.y=t;return n},paneAt:function(n,i){return this.panes.filter(function e(t){var r=t._grid;return C(i,r.top,r.bottom)&&C(n,r.left,r.right)})[0]},containingPane:function(t){return this.panes.filter(function(e){if(e._grid.contains(t))return true;return false})[0]},cellRectangle:function(e){var t=this.containingPane(e)._grid;var r=this._sheet._grid.rectangle(e);return r.offset(t.headerWidth-(t.columns.frozen?0:this.scroller.scrollLeft),t.headerHeight-(t.rows.frozen?0:this.scroller.scrollTop))},refresh:function(e){var t=this._sheet;if(this.tabstrip)this.tabstrip.refreshTools(t.range(t.activeCell()));if(e.sheetSelection&&this.sheetsbar)this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));this._resize();this.viewSize[0].style.height=t._grid.totalHeight()+"px";this.viewSize[0].style.width=t._grid.totalWidth()+"px";if(e.layout){var r=t.frozenColumns();var n=t.frozenRows();this.panes=[this._pane(n,r)];if(r>0)this.panes.push(this._pane(n,0,null,r));if(n>0)this.panes.push(this._pane(0,r,n,null));if(n>0&&r>0)this.panes.push(this._pane(0,0,n,r))}if(e.filter)this._destroyFilterMenu();if(e.activeCell)this._focus=t.activeCell().toRangeRef()},createFilterMenu:function(e){this._destroyFilterMenu();var t=this._sheet;var r=t.filter().ref;var n=new b.spreadsheet.Range(r,t);var i=h("<div />").appendTo(this.element);var a={column:e,range:n};var s=new b.spreadsheet.FilterMenu(i,a);this._filterMenu=s;return s},selectClipboardContents:function(){if(!this.isClipboardDeactivated){this.clipboard.focus();e(this.clipboard[0])}},scrollIntoView:function(e){var t=false;var r=this.containingPane(e)._grid;var n=r.scrollBoundaries(e);var i=this.scroller;var a=r.rows.frozen?0:i.scrollTop;var s=r.columns.frozen?0:i.scrollLeft;if(n.top<a){t=true;i.scrollTop=n.scrollTop}if(n.bottom>a){t=true;i.scrollTop=n.scrollBottom}if(n.left<s){t=true;i.scrollLeft=n.scrollLeft}if(n.right>s){t=true;i.scrollLeft=n.scrollRight}return t},_destroyDialog:function(){this._dialogs.pop()},openCustomEditor:function(){var r=this;var e=r._sheet.activeCell().first();var t=r._sheet.activeCellCustomEditor();var n=r._sheet.range(e);t.edit({range:n,rect:r.activeCellRectangle(),view:this,validation:this._sheet.validation(e),callback:function(e,t){r._executeCommand({command:"EditCommand",options:{operatingRange:n,editRange:n,property:t?"input":"value",value:e}})}})},openDialog:function(n,i){var a=this._sheet;return a.withCultureDecimals(function(){var e=b.spreadsheet.dialogs.create(n,i);if(e){e.bind("action",this._executeCommand.bind(this));e.bind("deactivate",this._destroyDialog.bind(this));this._dialogs.push(e);var t=a.activeCell();var r=new b.spreadsheet.Range(t,a);e.open(r);return e}}.bind(this))},showError:function(e,r){var t=this._dialogs;var n=this.options.messages.errors;var i=false;if(t.length>0)t.forEach(function(e){if(e.options&&e.options.title===l)i=true});if(i)return;var a=function(t){var e=t.sender.dialog().element;e.find(".k-button").first().trigger("focus");e.find(".k-button, input").on("keydown",function(e){if(e.keyCode==b.keys.ESC)t.sender.close()})};var s=function(e){var t=e.sender;this.selectClipboardContents();if(t._retry&&r)r()}.bind(this);if(b.spreadsheet.dialogs.registered(e.type)){var o={close:s};if(e.type==="validationError")o=h.extend(o,{title:e.title||"Error",text:e.body?e.body:n[e.type],activate:a});this.openDialog(e.type,o)}else this.openDialog("message",{title:e.title||"Error",text:e.body?e.body:n[e.type],activate:a,close:s})},destroy:function(){this._dialogs.forEach(function(e){e.destroy()});this.cellContextMenu.destroy();this.rowHeaderContextMenu.destroy();this.colHeaderContextMenu.destroy();this.drawingContextMenu.destroy();this.cellContextMenu=this.rowHeaderContextMenu=this.colHeaderContextMenu=this.drawingContextMenu=null;if(this.tabstrip){this.tabstrip.destroy();this.tabstrip=null}this._destroyFilterMenu()},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();this._filterMenu=undefined;this._filterMenuColumn=undefined}},render:function(e){if(!this.element.is(":visible"))return;var t=this._sheet;var r=t.focus();var n=b.support.scrollbar();var i=this.wrapper[0].clientWidth-n;var a=this.wrapper[0].clientHeight-n;if(r&&this.scrollIntoView(r))return;var s=!t.resizingInProgress()?"none":t.resizeHandlePosition().col===-Infinity?"column":"row";this.wrapper.toggleClass(d.editContainer,this.editor.isActive()).toggleClass(d.horizontalResize,s=="row").toggleClass(d.verticalResize,s=="column");var o=t._grid;var l=[];var u={scroller:this.scroller,toplevelElements:l,contentWidth:i,contentHeight:a};this.panes.forEach(function(e){l.push(e.render(u))});var c=b.dom.element("div",{style:{width:o._headerWidth+"px",height:o._headerHeight+"px"},className:p.classNames.topCorner});l.push(c);if(t.resizeHandlePosition()&&t.resizeHintPosition())l.push(this.renderResizeHint());this.tree.render(l);h(this.container).css({width:i,height:a});if(this.editor.isActive())this.editor.toggleTooltip(this.activeCellRectangle());else if(!(e.resize||e.comment||t.selectionInProgress()||t.resizingInProgress()||t.draggingInProgress()||t.isInEditMode()))this.renderClipboardContents()},renderResizeHint:function(){var e=this._sheet;var t=e.resizeHandlePosition();var r=t.col!==-Infinity;var n;if(r)n={height:this.scroller.clientHeight+"px",width:s+"px",left:e.resizeHintPosition().x+"px",top:"0px"};else n={height:s+"px",width:this.scroller.clientWidth+"px",top:e.resizeHintPosition().y+"px",left:"0px"};var i=_.classNames;return b.dom.element("div",{className:i.resizeHint+(!r?" "+i.resizeHintVertical:""),style:n},[b.dom.element("div",{className:i.resizeHintHandle}),b.dom.element("div",{className:i.resizeHintMarker})])},renderClipboardContents:function(){var e=this._sheet;var t=e._grid;var s=t.normalize(e.select().toRangeRef());var r=this._workbook.clipboard().canCopy();if(r.canCopy===false&&r.multiSelection){this.clipboardContents.render([]);this.selectClipboardContents();return}s=e.trim(s);var o=new a;var n=t.rangeDimensions(s);n.rows.forEach(function(e){o.addRow(e)});n.columns.forEach(function(e){o.addColumn(e)});var i=e._getMergedCells(s);var l=i.primary;var u=i.secondary;e.forEach(s,function(e,t,r){var n=new f(e,t).print();if(!u[n]){var i=c(o,e-s.topLeft.row,r);var a=l[n];if(a){i.attr.colspan=a.width();i.attr.rowspan=a.height()}}});if(b.support.browser.msie)this.clipboard.empty();this.clipboardContents.render([o.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);this.selectClipboardContents()},_pane:function(e,t,r,n){var i=new _(this._sheet,this._sheet._grid.pane({row:e,column:t,rowCount:r,columnCount:n}));i.refresh(this.scroller.clientWidth,this.scroller.clientHeight);return i}}),y={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",vborder:"k-spreadsheet-vborder",hborder:"k-spreadsheet-hborder",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]},_=b.Class.extend({init:function(e,t){this._sheet=e;this._grid=t},refresh:function(e,t){this._grid.refresh(e,t)},isVisible:function(e,t,r){return this._grid.view(e,t).ref.intersects(r)},render:function(e){var t=e.scroller;var r=t.scrollLeft;var n=t.scrollTop;if(n<0)n=0;if(r<0)r=0;var i=_.classNames;var a=this._sheet;var s=this._grid;var o=s.view(r,n);this._currentView=o;this._currentRect=this._rectangle(o.ref);this._selectedHeaders=a.selectedHeaders();var l=[];l.push(this.renderData(e));if(!a._activeDrawing)l.push(this.renderSelection(t));l.push(this.renderAutoFill());l.push(this.renderEditorSelection());l.push(this.renderFilterHeaders());if(s.hasRowHeader){var c=b.dom.element("div",{className:i.rowHeader,style:{width:s.headerWidth+"px",top:o.rowOffset+"px"}});l.push(c);a.forEach(o.ref.leftColumn(),function(e){if(!a.isHiddenRow(e)){var t=e+1,r=a.rowHeight(e);c.children.push(b.dom.element("div",{className:this.headerClassName(e,"row"),style:{width:s.headerWidth+"px",height:r+"px"}},[b.dom.element("div",{className:"k-vertical-align-center"},[b.dom.text(t+"")])]))}}.bind(this))}if(s.hasColumnHeader){var h=b.dom.element("div",{className:i.columnHeader,style:{top:"0px",left:o.columnOffset+"px",width:this._currentRect.width+"px",height:s.headerHeight+"px"}});l.push(h);var f=0;a.forEach(o.ref.topRow(),function(e,t){if(!a.isHiddenColumn(t)){var r=b.spreadsheet.Ref.display(null,Infinity,t),n=a.columnWidth(t);h.children.push(b.dom.element("div",{className:this.headerClassName(t,"col"),style:{position:"absolute",left:f+"px",width:n+"px",height:s.headerHeight+"px"}},[b.dom.element("div",{className:"k-vertical-align-center"},[b.dom.text(r+"")])]));f+=n}}.bind(this))}if(a.resizeHandlePosition()&&(s.hasColumnHeader||s.hasRowHeader))if(!a.resizeHintPosition())this.renderResizeHandle(l);var u=[i.pane];if(s.hasColumnHeader)u.push(i.top);if(s.hasRowHeader)u.push(i.left);return b.dom.element("div",{style:s.style,className:u.join(" ")},l)},headerClassName:function(e,t){var r=this._selectedHeaders;var n;var i;if(t==="row"){n=r.rows[e];i=r.allRows}else{n=r.cols[e];i=r.allCols}var a=n||(r.all?"full":i?"partial":"none");if(a)a="k-selection-"+a;return a},renderData:function(u){var c=this._sheet;var h=this._currentView;var f=b.dom.element("div",{className:_.classNames.data,style:{position:"relative",left:h.columnOffset+"px",top:h.rowOffset+"px"}});var t=this._currentRect;var e=b.spreadsheet.draw.doLayout(c,h.ref,{forScreen:true}),r;var d=this._grid;var p=c._showGridLines;if(p){r=null;e.xCoords.forEach(function(e){if(e!==r){r=e;f.children.push(b.dom.element("div",{className:y.vaxis,style:{left:e+"px",height:t.height+"px",borderColor:c.gridLinesColor()}}))}});r=null;e.yCoords.forEach(function(e){if(e!==r){r=e;f.children.push(b.dom.element("div",{className:y.haxis,style:{top:e+"px",width:t.width+"px",borderColor:c.gridLinesColor()}}))}})}var m=b.spreadsheet.draw.Borders();var g=c.activeCell().toRangeRef();var v=g.topLeft;e.cells.forEach(function(e){var t=null;var r=e.row+h.ref.topLeft.row;var n=e.col+h.ref.topLeft.col;if(c._activeDrawing){var i=c._activeDrawing.topLeftCell;if(i&&i.row==r&&i.col==n)t="k-spreadsheet-drawing-anchor-cell"}else if(r==v.row&&n==v.col){t=[_.classNames.activeCell].concat(this._activeFormulaColor(),this._directionClasses(g));if(c.singleCellSelection())t.push(_.classNames.single);t=t.join(" ")}m.add(e);x(f.children,e,t,p);if(e.comment&&c._commentRef&&r==c._commentRef.row&&n==c._commentRef.col){var a=4;var s=e.right+d.left+h.columnOffset+a;var o={top:e.top+d.top+h.rowOffset+"px"};if(s+200>u.contentWidth)o.right=u.contentWidth-d.left-e.left-h.columnOffset+a+"px";else o.left=s+"px";var l=b.dom.element("div",{className:"k-tooltip k-spreadsheet-cell-comment",style:o},[b.dom.text(e.comment)]);u.toplevelElements.push(l)}},this);m.vert.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;var t={left:e.x+"px",top:e.top+"px",height:e.bottom-e.top+1+"px",borderWidth:e.size+"px",borderColor:e.color};if(e.size!=1)t.transform="translateX(-"+(e.size-1)/2+"px)";f.children.push(b.dom.element("div",{className:y.vborder,style:t}))}})});m.horiz.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;var t={top:e.y+"px",left:e.left+"px",width:e.right-e.left+"px",borderWidth:e.size+"px",borderColor:e.color};if(e.size!=1)t.transform="translateY(-"+(e.size-1)/2+"px)";f.children.push(b.dom.element("div",{className:y.hborder,style:t}))}})});this.renderDrawings(e,f.children);return f},renderDrawings:function(e,i){var a=this._sheet;var s=a._workbook;e.drawings.forEach(function(e){var t=e.drawing;var r=e.box;var n=r.toDiv("k-spreadsheet-drawing");if(t.image)n.children.push(b.dom.element("div",{className:"k-spreadsheet-drawing-image",style:{backgroundImage:"url('"+s.imageUrl(t.image)+"')",opacity:t.opacity}}));if(t===a._activeDrawing){n.attr.className+=" k-spreadsheet-active-drawing";F(n.children)}i.push(n)})},renderResizeHandle:function(e){var t=this._sheet;var r=t.resizeHandlePosition();var n=this._rectangle(r);var i=[_.classNames.resizeHandle];var a;if(r.col!==-Infinity){if(this._grid.rows._start>0)return;a={height:this._grid.headerHeight+"px",width:s+"px",left:n.right-s/2+"px",top:"0px"};i.push(d.horizontalResize)}else{if(this._grid.columns._start>0)return;a={height:s+"px",width:this._grid.headerWidth+"px",top:n.bottom-s/2+"px",left:"0px"};i.push(d.verticalResize)}e.push(b.dom.element("div",{className:i.join(" "),style:a}))},filterIconRect:function(e){var t=16;var r=3;return new b.spreadsheet.Rectangle(e.right-t-r,e.top+r,t,t)},renderFilterHeaders:function(){var e=this._sheet;var a=[];var s=p.classNames;var o=e.filter();function l(e){return b.dom.element("span",{className:s.icon+" "+e})}function u(e,t,r){var n={left:t.left+"px",top:t.top+"px"};var i=o&&o.columns.some(function(e){return e.index===r});var a=e.filterButton;if(i)a+=" "+e.filterButtonSelected;var s=b.dom.element("span",{className:a,style:n},[l(e.iconFilterDefault)]);return s}if(o)this._addDiv(a,o.ref,s.filterRange);e.forEachFilterHeader(this._currentView.ref,function(e){var t=this._rectangle(e);var r=this.filterIconRect(t);var n=this._sheet.filterColumn(e);var i=u(s,r,n);a.push(i)}.bind(this));return b.dom.element("div",{className:s.filterHeadersWrapper},a)},renderEditorSelection:function(){var r=_.classNames;var e=this._sheet;var n=[];e._formulaSelections.forEach(function(e){var t=e.ref;if(t===b.spreadsheet.NULLREF)return;this._addDiv(n,t,r.selectionHighlight+" "+e.colorClass)}.bind(this));return b.dom.element("div",{className:r.selectionWrapper},n)},renderSelection:function(e){var t=_.classNames;var r=[];var n=[t.selection];var i=this._sheet;var a=i.activeCell().toRangeRef();var s=i.select();n=n.concat(this._activeFormulaColor());if(s.size()===1)n.push("k-single-selection");if(this._sheet.autoFillPunch())n.push("k-dim-auto-fill-handle");s.forEach(function(e){if(e!==b.spreadsheet.NULLREF)this._addDiv(r,e,n.join(" "))}.bind(this));this._renderCustomEditorButton(r,a,e);return b.dom.element("div",{className:t.selectionWrapper},r)},renderAutoFill:function(){var e=[];if(this._sheet.autoFillInProgress()){var t=this._sheet.autoFillRef();var r=this._sheet.autoFillPunch();var n=this._sheet._autoFillDirection;this._addDiv(e,t,"k-auto-fill");if(r)this._addDiv(e,r,"k-auto-fill-punch");else if(n!==undefined){var i,a;switch(n){case 0:i=t.bottomRight;a="k-auto-fill-br-hint";break;case 1:i=t.bottomRight;a="k-auto-fill-br-hint";break;case 2:i=new f(t.topLeft.row,t.bottomRight.col);a="k-auto-fill-tr-hint";break;case 3:i=new f(t.bottomRight.row,t.topLeft.col);a="k-auto-fill-bl-hint";break}var s=this._addDiv(e,i,a);if(s){var o=b.dom.element("span",{className:"k-tooltip"},[b.dom.text(this._sheet._autoFillHint)]);s.children.push(o)}}}return b.dom.element("div",{className:_.classNames.autoFillWrapper},e)},_addDiv:function(e,t,r){var n=this._currentView,i;if(n.ref.intersects(t)){i=this._rectangle(t).resize(1,1).toDiv(r);e.push(i)}return i},_renderCustomEditorButton:function(s,e,o){var l=this;var t=l._sheet;var r=l._currentView;var u=l._grid.columns._axis._count;var c=t.activeCellCustomEditor();if(c&&r.ref.intersects(e)){var h=l._rectangle(e);t.forEach(e.collapse(),function(e,t,r){r.left=h.left;r.top=h.top;r.width=h.width;r.height=h.height;var n="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button";var i=t==u-1||l._buttonOutOfVisiblePane(e,t,o);if(i)n+=" k-spreadsheet-last-column";l._editorInLastColumn=i;var a=b.dom.element("div",{className:n,style:{left:r.left+(i?0:r.width)+"px",top:r.top+"px",height:r.height+"px"}});if(c.icon)a.children.push(b.dom.element("span",{className:"k-icon "+c.icon}));s.push(a)})}},_activeFormulaColor:function(){var e;var t=[];if(this._sheet.isInEditMode()){e=this._sheet._formulaSelections.filter(function(e){return e.active&&e.type=="ref"})[0];if(e)t.push(e.colorClass)}return t},_directionClasses:function(e){var t=[];var r=_.classNames;var n=this._currentView.ref;if(!e.move(0,-1).intersects(n))t.push(r.left);if(!e.move(-1,0).intersects(n))t.push(r.top);if(!e.move(0,1).intersects(n))t.push(r.right);if(!e.move(1,0).intersects(n))t.push(r.bottom);return t},_rectangle:function(e){return this._grid.boundingRectangle(e.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop)},_buttonOutOfVisiblePane:function(e,t,r){var n=this;var i=n._grid;var a=n._sheet;var s=a.range(e,t)._ref;var o=i.scrollBoundaries(s);var l=i.columns.frozen?0:r.scrollLeft;if(o.right+u>l||t+1===a.frozenColumns())return true}});function F(t){["N","NE","E","SE","S","SW","W","NW"].forEach(function(e){t.push(b.dom.element("div",{className:"k-spreadsheet-drawing-handle "+e,"data-direction":e}))})}b.spreadsheet.View=p,b.spreadsheet.Pane=_,b.spreadsheet.drawCell=x,h.extend(true,p,{classNames:d}),h.extend(true,_,{classNames:y})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/customeditors.min",["../kendo.core.min","../kendo.popup.min","../kendo.calendar.min","../kendo.listview.min","./sheet.min"],function(){(function(d){"use strict";var e=d.jQuery;var i={};var t=d.spreadsheet.registerEditor=function(e,t){i[e]=t};d.spreadsheet.Sheet.prototype.activeCellCustomEditor=function(){var e=this.activeCell().first();if(this.range(e).enable()){var t=this.validation(e);var r=this._properties.get("editor",this._grid.cellRefIndex(e));var n;if(r!=null)n=i[r];else if(t&&t.showButton){r="_validation_"+t.dataType;n=i[r]}if(typeof n=="function")n=i[r]=n();return n}};t("_validation_date",function(){var l,u,c;function h(){if(!u){u=e("<div>").kendoCalendar();c=e("<div>").kendoPopup();u.appendTo(c);u=u.getKendoCalendar();c=c.getKendoPopup();u.bind("change",function(){c.close();var e=u.value();if(!l.range.format())l.range.format("yyyy-mm-dd");l.callback(d.spreadsheet.dateToNumber(e))})}c.setOptions({anchor:l.view.element.find(".k-spreadsheet-editor-button")})}function t(){h();var e=l.range.value();var n=l.range.sheet();if(e!=null)u.value(d.spreadsheet.numberToDate(e));else u.value(null);var i=l.validation;if(i){var t=d.ui.Calendar.fn.options.min;var r=d.ui.Calendar.fn.options.max;var a=i.from;var s=i.to;var o=d.spreadsheet.calc.runtime.Formula;if(/^(?:greaterThan|between)/.test(i.comparerType))if(a instanceof o&&f(a.value))t=d.spreadsheet.numberToDate(n.range(a.value.row,a.value.col).value());else t=d.spreadsheet.numberToDate(a.value);if(i.comparerType=="between")if(s instanceof o&&f(s.value))r=d.spreadsheet.numberToDate(n.range(s.value.row,s.value.col).value());else r=d.spreadsheet.numberToDate(i.to.value);if(i.comparerType=="lessThan"||i.comparerType=="lessThanOrEqualTo")if(a instanceof o&&f(a.value))r=d.spreadsheet.numberToDate(n.range(a.value.row,a.value.col).value());else r=d.spreadsheet.numberToDate(i.from.value);u.setOptions({disableDates:function(e){var t,r;if(a&&a instanceof o&&f(a.value))t=n.range(a.value.row,a.value.col).value();else t=a?a.value|0:0;if(s&&s instanceof o&&f(s.value))r=n.range(s.value.row,s.value.col).value();else r=s?s.value|0:0;e=d.spreadsheet.dateToNumber(e)|0;return!d.spreadsheet.validation.validationComparers[i.comparerType](e,t,r)},min:t,max:r})}else u.setOptions({disableDates:null,min:null,max:null});c.open()}function f(e){return e&&e.row!==null&&e.col!==null&&e.row>-1&&e.col>-1}return{edit:function(e){l=e;t()},icon:"k-i-calendar"}});t("_validation_list",function(){var i,a,s;function o(){if(!a){a=e("<ul class='k-list k-reset'/>").kendoStaticList({template:"#:value#",selectable:true,autoBind:false});s=e("<div class='k-spreadsheet-list-popup'>").kendoPopup();a.appendTo(s);s=s.getKendoPopup();a=a.getKendoStaticList();a.bind("change",function(){s.close();var e=a.value()[0];if(e)i.callback(e.value)})}s.setOptions({anchor:i.view.element.find(".k-spreadsheet-editor-button")})}function t(){o();var e=i.validation.from.value;var t=[],r=function(e){t.push({value:e})};if(e instanceof d.spreadsheet.calc.runtime.Matrix)e.each(r);else(e+"").split(/\s*,\s*/).forEach(r);var n=new d.data.DataSource({data:t});a.setDataSource(n);n.read();s.open()}return{edit:function(e){i=e;t()},icon:"k-i-arrow-60-down"}})})(window.kendo)})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/grid.min",["../kendo.core.min","./references.min"],function(){var t=kendo,h=t.spreadsheet.CellRef,f=t.spreadsheet.RangeRef,r=t.spreadsheet.UnionRef,n=t.Class.extend({init:function e(t,r,n,i){this.left=t;this.top=r;this.width=n;this.height=i;this.right=this.left+this.width;this.bottom=this.top+this.height},offset:function(e,t){return new n(this.left+e,this.top+t,this.width,this.height)},resize:function(e,t){return new n(this.left,this.top,this.width+e,this.height+t)},intersects:function(e,t){if(e instanceof n)return this.intersectsRect(e);return this.left<e&&e<this.left+this.width&&this.top<t&&t<this.top+this.height},intersectsRect:function(e){var t=this;return t.left<=e.right&&e.left<=t.right&&t.top<=e.bottom&&e.top<=t.bottom},toDiv:function(e){return t.dom.element("div",{className:e,style:{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}})}}),e=t.Class.extend({init:function(e,t,r,n,i,a){this.rowCount=r;this.columnCount=n;this._columns=t;this._rows=e;this._headerHeight=i;this._headerWidth=a},isAxis:function(e){e=e.toRangeRef();var t=e.topLeft;var r=e.bottomRight;return t.row===0&&r.row===this.rowCount-1||t.col===0&&r.col===this.columnCount-1},width:function(e,t){return this._columns.sum(e,t)},height:function(e,t){return this._rows.sum(e,t)},totalHeight:function(){return this._rows.total+this._headerHeight},totalWidth:function(){return this._columns.total+this._headerWidth},index:function(e,t){return t*this.rowCount+e},cellRef:function(e){return new h(e%this.rowCount,e/this.rowCount>>0)},rowRef:function(e){return new f(new h(e,0),new h(e,this.columnCount-1))},colRef:function(e){return new f(new h(0,e),new h(this.rowCount-1,e))},cellRefIndex:function(e){return this.index(e.row,e.col)},normalize:function(e){if(e instanceof f)return new f(this.normalize(e.topLeft),this.normalize(e.bottomRight)).setSheet(e.sheet,e.hasSheet());if(e instanceof r)return e.map(function(e){return this.normalize(e)},this);if(e instanceof h){e=e.clone();e.col=Math.max(0,Math.min(this.columnCount-1,e.col));e.row=Math.max(0,Math.min(this.rowCount-1,e.row))}return e},rectangle:function(e){var t=this.normalize(e.topLeft);var r=this.normalize(e.bottomRight);return new n(this.width(0,t.col-1),this.height(0,t.row-1),this.width(t.col,r.col),this.height(t.row,r.row))},pane:function(e){return new i(new t.spreadsheet.PaneAxis(this._rows,e.row,e.rowCount,this._headerHeight),new t.spreadsheet.PaneAxis(this._columns,e.column,e.columnCount,this._headerWidth),this)},rangeDimensions:function(e){return{rows:this._rows.values.iterator(e.topLeft.row,e.bottomRight.row),columns:this._columns.values.iterator(e.topLeft.col,e.bottomRight.col)}},forEach:function(e,t){var r=this.normalize(e.topLeft);var n=this.normalize(e.bottomRight);for(var i=r.col;i<=n.col;i++)for(var a=r.row;a<=n.row;a++)t(new h(a,i))},trim:function(e,t){var r=this.normalize(e.topLeft);var n=this.normalize(e.bottomRight);var i=r.row;var a=r.col;for(var s=r.col;s<=n.col;s++){var o=this.index(r.row,s);var l=this.index(n.row,s);var u=t.tree.intersecting(o,l);if(u.length){var c=this.cellRef(u[u.length-1].end);i=Math.max(i,c.row);a=s}}return new f(e.topLeft,new h(Math.min(i,e.bottomRight.row),a))}}),i=t.Class.extend({init:function(e,t,r){this.rows=e;this.columns=t;this._grid=r;this.headerHeight=e.headerSize;this.headerWidth=t.headerSize;this.hasRowHeader=t.hasHeader;this.hasColumnHeader=e.hasHeader},refresh:function(e,t){this.columns.viewSize(e);this.rows.viewSize(t);var r=this.columns.paneSegment();var n=this.rows.paneSegment();this.left=r.offset;this.top=n.offset;this.right=r.offset+r.length;this.bottom=n.offset+n.length;this.style={top:n.offset+"px",left:r.offset+"px",height:n.length+"px",width:r.length+"px"}},view:function(e,t){var r=this.rows.visible(t);var n=this.columns.visible(e);return{rows:r,columns:n,rowOffset:r.offset,columnOffset:n.offset,mergedCellLeft:n.start,mergedCellTop:r.start,ref:new f(new h(r.values.start,n.values.start),new h(r.values.end,n.values.end))}},contains:function(e){return this.rows.contains(e.topLeft.row,e.bottomRight.row)&&this.columns.contains(e.topLeft.col,e.bottomRight.col)},index:function(e,t){return this._grid.index(e,t)},boundingRectangle:function(e){return this._grid.rectangle(e)},cellRefIndex:function(e){return this._grid.cellRefIndex(e)},scrollBoundaries:function(e){var t=this.boundingRectangle(e);var r={top:Math.max(0,t.top-this.top+(this.hasColumnHeader?0:this.headerHeight)),left:Math.max(0,t.left-this.left+(this.hasRowHeader?0:this.headerWidth)),right:t.right-this.columns._viewSize+this.headerWidth,bottom:t.bottom-this.rows._viewSize+this.headerHeight};var n=this.columns.defaultValue/2;var i=this.rows.defaultValue/2;r.scrollTop=r.top-i;r.scrollBottom=r.bottom+i;r.scrollLeft=r.left-n;r.scrollRight=r.right+n;return r}});t.spreadsheet.Grid=e,t.spreadsheet.PaneGrid=i,t.spreadsheet.Rectangle=n})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/axis.min",["../kendo.core.min"],function(){var i=kendo,e=i.Class.extend({init:function(e,t){this._value=t;this._count=e;this.values=new i.spreadsheet.RangeList(0,e-1,t);this._hidden=new i.spreadsheet.RangeList(0,e-1,0);this.scrollBarSize=i.support.scrollbar();this._refresh()},adjust:function(e,t){if(t<0){this.values.copy(e-t,this._count-1,e);this._hidden.copy(e-t,this._count-1,e)}else{this.values.copy(e,this._count,e+t);this._hidden.copy(e,this._count,e+t);this.values.value(e,e+t-1,this._value);this._hidden.value(e,e+t-1,0)}this._refresh()},toJSON:function(e,t){var r=[];var n=this.values.iterator(0,this._count-1);for(var i=0;i<this._count;i++){var a=n.at(i);var s=this._hidden.value(i,i);if(a===this._value&&!s)continue;var o=t[i];if(o===undefined){o=r.length;var l={index:i};l[e]=a;if(s)l.hidden=s;r.push(l);t[i]=o}}return r},fromJSON:function(e,t){for(var r=0;r<t.length;r++){var n=t[r];var i=n.index;if(i===undefined)i=r;var a=n[e];if(a===0){this._hidden.value(i,i,n.hidden||this._value);this.value(i,i,0)}else this.value(i,i,a)}},hide:function(e){if(!this.hidden(e)){var t=this.value(e,e);this._hidden.value(e,e,t);this.value(e,e,0)}},hidden:function(e){return this._hidden.value(e,e)!==0},includesHidden:function(e,t){return this._hidden.intersecting(e,t).length>1},nextVisible:function(e){var t=this._count-1,r=e;while(++r<=t)if(!this.hidden(r))return r;return e},nextUntil:function(e,t){var r=this._count-1,n=e,i=false;while(++n<=r){var a=t(n,i,this.hidden(n));if(typeof a=="number")return a;else if(a)break;i=true}return n-1},nextPage:function(e,t){return this.index(this.sum(0,e-1)+t)},prevPage:function(e,t){return this.index(this.sum(0,e)-t)},firstVisible:function(){var e=this._hidden.first();if(e.value===0)return 0;else return e.end+1},lastVisible:function(){var e=this._hidden.last();if(e.value===0)return this._count-1;else return e.start-1},prevVisible:function(e){var t=e;while(--t>=0)if(!this.hidden(t))return t;return e},prevUntil:function(e,t){var r=e,n=false;while(--r>=0){var i=t(r,n,this.hidden(r));if(typeof i=="number")return i;else if(i)break;n=true}return r+1},unhide:function(e){if(this.hidden(e)){var t=this._hidden.value(e,e);this._hidden.value(e,e,0);this.value(e,e,t)}},value:function(e,t,r){if(r!==undefined){this.values.value(e,t,r);this._refresh()}else return this.values.iterator(e,t).at(0)},sum:function(e,t){var r=this.values.iterator(e,t);var n=0;for(var i=e;i<=t;i++)n+=r.at(i);return n},locate:function(e,t,r){var n=this.values.iterator(e,t);var i=0;for(var a=e;a<=t;a++){i+=n.at(a);var s=r(i);if(s)return a}return null},visible:function(e,t){var r=null;var n=null;var i=false;if(t>=this.total+this.scrollBarSize)i=true;var a=this._pixelValues.intersecting(e,t);r=a[0];n=a[a.length-1];if(!r)return{values:this.values.iterator(0,0),offset:0};var s=e-r.start;var o=(s/r.value.value>>0)+r.value.start;var l=s-(o-r.value.start)*r.value.value;var c=t-n.start;var u=(c/n.value.value>>0)+n.value.start;if(u>n.value.end)u=n.value.end;if(i)l+=n.value.value-(c-(u-n.value.start)*n.value.value);l=Math.min(-l,0);return{values:this.values.iterator(o,u),offset:l}},index:function(e){var t=0;var r=this.values.iterator(0,this._count-1);var n=r.at(0);while(n<e&&t<this._count-1)n+=r.at(++t);return t},indexVisible:function(e){var t=this.index(e);if(this.hidden(t))t=this.prevVisible(t);return t},_refresh:function(){var n=0;this._pixelValues=this.values.map(function(e){var t=n;n+=(e.end-e.start+1)*e.value;var r=n-1;return new i.spreadsheet.ValueRange(t,r,e)});this.total=n},getState:function(){return{values:this.values.getState(),hidden:this._hidden.getState()}},setState:function(e){this.values.setState(e.values);this._hidden.setState(e.hidden);this._refresh()}}),t=i.Class.extend({init:function(e,t,r,n){this._axis=e;this._start=t;this._count=r;this.hasHeader=t===0;this.headerSize=n;this.defaultValue=e._value;this.frozen=r>0},viewSize:function(e){this._viewSize=e},sum:function(e,t){return this._axis.sum(e,t-1)},start:function(){return this.sum(0,this._start)},size:function(){return this.sum(this._start,this._start+this._count)},index:function(e,t){return this._axis.index(e+(this.frozen?0:t)-this.headerSize)},indexVisible:function(e,t){return this._axis.indexVisible(e+(this.frozen?0:t)-this.headerSize)},paneSegment:function(){var e=this.start();var t;if(!this.hasHeader)e+=this.headerSize;if(this.frozen){t=this.size();if(this.hasHeader)t+=this.headerSize;else t-=this.headerSize}else t=this._viewSize-e;return{offset:e,length:t}},visible:function(e){var t=this.start();var r;if(this.frozen){r=this.size();if(!this.hasHeader)r-=this.headerSize}else{r=this._viewSize-t-this.headerSize;t+=e}var n=this._axis.visible(t,t+r-1);if(this.frozen)n.offset=0;n.start=t;if(this.hasHeader){n.offset+=this.headerSize;n.start-=this.headerSize}return n},contains:function(e,t){if(this.frozen){if(e>this._start+this._count)return false;if(t<this._start)return false;return true}else return t>=this._start}});i.spreadsheet.Axis=e,i.spreadsheet.PaneAxis=t})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/filter.min",["../kendo.core.min","../kendo.data.min"],function(){var a=kendo,e=a.spreadsheet.Filter=a.Class.extend({prepare:function(){},value:function(e){return e.value},matches:function(){throw new Error("The 'matches' method is not implemented.")},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.")}});function n(e){var t=e.getMonth()+1;if(t>=1&&t<=3)return 1;else if(t>=4&&t<=6)return 2;else if(t>=7&&t<=9)return 3;else return 4}function t(e,t){if(e instanceof Date){var r=a.date.today();r.setFullYear(r.getFullYear()+t);return r.getFullYear()===e.getFullYear()}return false}function r(e,t){if(e instanceof Date){var r=a.date.firstDayOfMonth(a.date.today());r.setMonth(r.getMonth()+t,1);return r.getTime()===a.date.firstDayOfMonth(e).getTime()}return false}function i(e,t){if(t instanceof Date){var r=a.date.dayOfWeek(a.date.getDate(e),1);var n=a.date.dayOfWeek(a.date.getDate(t),1);return r.getTime()===n.getTime()}return false}e.create=function(e){var t=e.filter;if(!t)throw new Error("Filter type not specified.");var r=a.spreadsheet[t.charAt(0).toUpperCase()+t.substring(1)+"Filter"];if(!r)throw new Error("Filter type not recognized.");return new r(e)},a.spreadsheet.ValueFilter=e.extend({_values:[],_dates:[],_blanks:false,init:function e(t){if(t.values!==undefined)this._values=t.values;if(t.blanks!==undefined)this._blanks=t.blanks;if(t.dates!==undefined)this._dates=t.dates},value:function(e){var t=e.value;if(this._dates.length>0&&e.format&&typeof t==="number"){var r=a.spreadsheet.formatting.type(t,e.format);if(r==="date")t=a.spreadsheet.numberToDate(t)}return t},matches:function(t){if(t===null||t===undefined)return this._blanks;if(t instanceof Date)return this._dates.some(function(e){return e.year===t.getFullYear()&&(e.month===undefined||e.month===t.getMonth())&&(e.day===undefined||e.day===t.getDate())&&(e.hours===undefined||e.hours===t.getHours())&&(e.minutes===undefined||e.minutes===t.getMinutes())&&(e.seconds===undefined||e.seconds===t.getSeconds())});return this._values.indexOf(t)>=0},toJSON:function(){return{filter:"value",blanks:this._blanks,values:this._values.slice(0)}}}),a.spreadsheet.CustomFilter=e.extend({_logic:"and",init:function e(t){if(t.logic!==undefined)this._logic=t.logic;if(t.criteria===undefined)throw new Error("Must specify criteria.");this._criteria=t.criteria;var r=a.data.Query.filterExpr({logic:this._logic,filters:this._criteria,accentFoldingFiltering:a.culture().name}).expression;this._matches=new Function("d","return "+r)},matches:function(e){if(e===null)return false;return this._matches(e)},value:function(e){var t=e.value;var r=this._criteria[0].value;var n=r instanceof Date?"date":typeof r;var i=typeof t;if(e.format)i=a.spreadsheet.formatting.type(t,e.format);if(i!=n){if(n=="string"){if(e.format)t=a.spreadsheet.formatting.text(t,e.format);t=t+""}}else if(i=="date")t=a.spreadsheet.numberToDate(t);return t},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria}}}),a.spreadsheet.TopFilter=e.extend({init:function e(t){this._type=t.type;this._value=t.value;this._values=[]},prepare:function(e){var t=e.map(this.value).sort().filter(function(e,t,r){return t===0||e!==r[t-1]});if(this._type==="topNumber"||this._type=="topPercent")t.sort(function(e,t){return t-e});else t.sort(function(e,t){return e-t});var r=this._value;if(this._type==="topPercent"||this._type==="bottomPercent")r=t.length*r/100>>0;this._values=t.slice(0,r)},matches:function(e){return this._values.indexOf(e)>=0},toJSON:function(){return{filter:"top",type:this._type,value:this._value}}}),a.spreadsheet.DynamicFilter=e.extend({init:function e(t){this._type=t.type;this._predicate=this[t.type];if(typeof this._predicate!=="function")throw new Error("DynamicFilter type '"+t.type+"' not recognized.")},value:function(e){var t=e.value;if(e.format){var r=a.spreadsheet.formatting.type(t,e.format);if(r==="date")t=a.spreadsheet.numberToDate(t)}return t},prepare:function(e){var t=0;var r=0;for(var n=0;n<e.length;n++){var i=this.value(e[n]);if(typeof i==="number"){t+=i;r++}}if(r>0)this._average=t/r;else this._average=0},matches:function(e){return this._predicate(e)},aboveAverage:function(e){if(e instanceof Date)e=a.spreadsheet.dateToNumber(e);if(typeof e!=="number")return false;return e>this._average},belowAverage:function(e){if(e instanceof Date)e=a.spreadsheet.dateToNumber(e);if(typeof e!=="number")return false;return e<this._average},tomorrow:function(e){if(e instanceof Date){var t=a.date.addDays(a.date.today(),1);return a.date.getDate(e).getTime()===t.getTime()}return false},today:function(e){if(e instanceof Date)return a.date.isToday(e);return false},yesterday:function(e){if(e instanceof Date){var t=a.date.addDays(a.date.today(),-1);return a.date.getDate(e).getTime()===t.getTime()}return false},nextWeek:function(e){return i(a.date.addDays(a.date.today(),7),e)},thisWeek:function(e){return i(a.date.today(),e)},lastWeek:function(e){return i(a.date.addDays(a.date.today(),-7),e)},nextMonth:function(e){return r(e,1)},thisMonth:function(e){return r(e,0)},lastMonth:function(e){return r(e,-1)},nextQuarter:function(e){if(e instanceof Date){var t=a.date.today();var r=n(e)-n(t);return r===1&&t.getFullYear()===e.getFullYear()||r==-3&&t.getFullYear()+1===e.getFullYear()}return false},thisQuarter:function(e){if(e instanceof Date){var t=a.date.today();var r=n(e)-n(t);return r===0&&t.getFullYear()===e.getFullYear()}return false},lastQuarter:function(e){if(e instanceof Date){var t=a.date.today();var r=n(t)-n(e);return r===1&&t.getFullYear()===e.getFullYear()||r==-3&&t.getFullYear()-1===e.getFullYear()}return false},nextYear:function(e){return t(e,1)},thisYear:function(e){return t(e,0)},lastYear:function(e){return t(e,-1)},yearToDate:function(e){if(e instanceof Date){var t=a.date.today();return e.getFullYear()===t.getFullYear()&&e<=t}return false},toJSON:function(){return{filter:"dynamic",type:this._type}}}),[1,2,3,4].forEach(function(t){a.spreadsheet.DynamicFilter.prototype["quarter"+t]=function(e){if(e instanceof Date)return n(e)===t;return false}}),a.cultures["en-US"].calendar.months.names.forEach(function(e,t){a.spreadsheet.DynamicFilter.prototype[e.toLowerCase()]=function(e){if(e instanceof Date)return e.getMonth()===t;return false}})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/sorter.min",["../kendo.core.min"],function(){var i=kendo,a=i.Class.extend({init:function(e,t){this._grid=e;this._lists=t},indices:function(e,t,r,n){var i=a.ascendingComparer;if(r===false)i=a.descendingComparer;return t.sortedIndices(this._grid.cellRefIndex(e.topLeft),this._grid.cellRefIndex(e.bottomRight),i,n)},sortBy:function(e,t,r,n,i){var a=this.indices(e.toColumn(t),r,n,i);for(var s=e.topLeft.col;s<=e.bottomRight.col;s++){var o=this._grid.index(e.topLeft.row,s);var l=this._grid.index(e.bottomRight.row,s);for(var u=0;u<this._lists.length;u++)if(o<this._lists[u].lastRangeStart())this._lists[u].sort(o,l,a)}return a}});a.ascendingComparer=function(e,t){if(e===null&&t===null)return 0;if(e===null)return 1;if(t===null)return-1;var r=typeof e;var n=typeof t;if(r==="number")if(n==="number")return e-t;else return-1;if(r==="string")switch(n){case"number":return 1;case"string":return e.localeCompare(t);default:return-1}if(r==="boolean")switch(n){case"number":return 1;case"string":return 1;case"boolean":return e-t;default:return-1}if(e instanceof i.spreadsheet.calc.runtime.CalcError)if(t instanceof i.spreadsheet.calc.runtime.CalcError)return 0;else return 1;throw new Error("Cannot compare "+e+" and "+t)},a.descendingComparer=function(e,t){if(e===null&&t===null)return 0;if(e===null)return 1;if(t===null)return-1;return a.ascendingComparer(t,e)},i.spreadsheet.Sorter=a})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/numformat.min",["./calc.min","../kendo.dom.min","../util/main.min"],function(){"use strict";var e=kendo.util,h=kendo.spreadsheet.calc,l=kendo.dom,f=/^\[(black|green|white|blue|magenta|yellow|cyan|red)\]/i,p=/^\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\]/;function u(n){n=h.InputStream(n);var e=[],t=false,r;while(!n.eof()){var i=c();e.push(i);if(i.cond)t=true}if(!t)if(e.length==1)e[0].cond="num";else if(e.length==2){e[0].cond={op:">=",value:0};e[1].cond={op:"<",value:0}}else if(e.length>=3){e[0].cond={op:">",value:0};e[1].cond={op:"<",value:0};e[2].cond={op:"=",value:0};if(e.length>3){e[3].cond="text";e=e.slice(0,4)}}return e;function a(){var e=n.skip(f);if(e)return e[1].toLowerCase()}function s(){var e=n.skip(p);if(e){var t=parseFloat(e[2]);if(!isNaN(t))return{op:e[1],value:t,custom:true}}}function o(){var e=[],t,r=null;while(!n.eof()&&(t=u())){if(t.type=="date"){if(r&&/^(el)?time$/.test(r.type)&&r.part=="h"&&t.part=="m"&&t.format<3)t.type="time"}else if(/^(el)?time$/.test(t.type)&&t.part=="s")if(r&&r.type=="date"&&r.part=="m"&&r.format<3)r.type="time";if(!/^(?:str|space|fill)$/.test(t.type))r=t;e.push(t)}return e}function l(e){if(e.type!="date"||e.part=="m"&&e.format<3){var t=n.skip(/^\.(0+)/);if(t){e.fraction=t[1].length;if(e.type=="date")e.type="time"}}return e}function u(){var e,t;if(t=n.skip(/^([#0?]+)(?:,([#0?]+))+/))return{type:"digit",sep:true,format:t[1]+t[2],decimal:r};if(t=n.skip(/^[#0?]+/))return{type:"digit",sep:false,format:t[0],decimal:r};if(t=n.skip(/^(e)([+-])/i))return{type:"exp",ch:t[1],sign:t[2]};if(t=n.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)){t=t[1].toLowerCase();return l({type:"date",part:t.charAt(0),format:t.length})}if(t=n.skip(/^(hh?|ss?)/i)){t=t[1].toLowerCase();return l({type:"time",part:t.charAt(0),format:t.length})}if(t=n.skip(/^\[(hh?|mm?|ss?)\]/i)){t=t[1].toLowerCase();return l({type:"eltime",part:t.charAt(0),format:t.length})}if(t=n.skip(/^(a[.]?m[.]?\/p[.]?m[.]?|a\/p)/i)){t=t[1].split("/");return{type:"ampm",am:t[0],pm:t[1]}}switch(e=n.next()){case";":return null;case"\\":return{type:"str",value:n.next()};case'"':return{type:"str",value:n.readEscaped(e)};case"@":return{type:"text"};case"_":return{type:"space",value:n.next()};case"*":return{type:"fill",value:n.next()};case".":if(n.lookingAt(/^\s*[#0?]/)){r=true;return{type:"dec"}}return{type:"str",value:"."};case"%":return{type:"percent"};case",":return{type:"comma"}}return{type:"str",value:e}}function c(){r=false;var e=a(),t=s();if(!e&&t)e=a();return{color:e,cond:t,body:o()}}}function a(e){return e.map(t).join(";");function t(e){var t="";if(e.color)t+="["+e.color+"]";if(e.cond)if(!(e.cond=="text"||e.cond=="num"))t+="["+e.cond.op+e.cond.value+"]";t+=e.body.map(n).join("");return t}function r(e,t){if(t.fraction)e+="."+d("",t.fraction,"0");return e}function n(e){if(e.type=="digit")if(e.sep)return e.format.charAt(0)+","+e.format.substr(1);else return e.format;else if(e.type=="exp")return e.ch+e.sign;else if(e.type=="date"||e.type=="time")return r(d("",e.format,e.part),e);else if(e.type=="eltime")return r("["+d("",e.format,e.part)+"]",e);else if(e.type=="ampm")return e.am+"/"+e.pm;else if(e.type=="str")return JSON.stringify(e.value);else if(e.type=="text")return"@";else if(e.type=="space")return"_"+e.value;else if(e.type=="fill")return"*"+e.value;else if(e.type=="dec")return".";else if(e.type=="percent")return"%";else if(e.type=="comma")return","}}function s(e,o){e.forEach(function(e){var t=o;if(e.cond=="text")return;var r=e.body,n=false,i=r.length;while(t!==0&&--i>=0){var a=r[i];if(a.type=="digit"){if(a.decimal){n=true;if(t>0)a.format+=d("",t,"0");else if(t<0){var s=a.format.length;a.format=a.format.substr(0,s+t);t+=s-a.format.length}if(a.format.length===0){r.splice(i,1);while(--i>=0){a=r[i];if(a.type=="digit"&&a.decimal){++i;break}if(a.type=="dec"){r.splice(i,1);break}}}}if(t>0)break}}if(!n&&t>0)r.splice(i+1,0,{type:"dec"},{type:"digit",sep:false,decimal:true,format:d("",t,"0")})})}function b(n){var i=0;return{next:function(){return n[i++]},eof:function(){return i>=n.length},ahead:function(e,t){if(i+e<=n.length){var r=t.apply(null,n.slice(i,i+e));if(r)i+=e;return r}},restart:function(){i=0}}}function n(e){var t=b(e.body);var r=false;var n=false;var c=false;var h=0;var f=/[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]/;var d=0;var i="var intPart, decPart, isNegative, date, time; ";var p=false;var m=0;var a=[],s=[];var o=e.cond;var l="";if(o=="text")l="if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { ";else if(o=="num")l="if (typeof value == 'number') { ";else if(o){var g=o.op=="="?"==":o.op;l="if (typeof value == 'number' && value "+g+" "+o.value+") { ";if(!o.custom)i+="value = Math.abs(value); "}if(e.color)i+="result.color = "+JSON.stringify(e.color)+"; ";function v(e,t){if(e.type=="digit"&&t.type=="comma"||e.type=="comma"&&e.hidden&&t.type=="comma"){t.hidden=true;d++}}while(!t.eof()){t.ahead(2,v);var u=t.next();if(u.type=="percent")h++;else if(u.type=="digit")if(u.decimal){m+=u.format.length;s.push(u.format)}else{a.push(u.format);if(u.sep)p=true}else if(u.type=="time")n=true;else if(u.type=="date")r=true;else if(u.type=="ampm")c=n=true}if(h>0)i+="value *= "+Math.pow(100,h)+"; ";if(d>0)i+="value /= "+Math.pow(1e3,d)+"; ";if(a.length){i+="intPart = runtime.formatInt(culture, value, "+JSON.stringify(a)+", "+m+", "+p+"); ";i+="isNegative = parseInt(intPart[0]) < 0;"}if(s.length)i+="decPart = runtime.formatDec(value, "+JSON.stringify(s)+", "+m+"); ";if(a.length||s.length)i+="type = 'number'; ";if(r)i+="date = runtime.unpackDate(value); ";if(n)i+="time = runtime.unpackTime(value); ";if(r||n)i+="type = 'date'; ";if(h>0||d>0||a.length||s.length||r||n)if(!l)l="if (typeof value == 'number') { ";t.restart();i+="var matchedCurrency = false;";while(!t.eof()){var u=t.next();if(u.type=="dec")i+="output += culture.numberFormat['.']; ";else if(u.type=="comma"&&!u.hidden)i+="output += ','; ";else if(u.type=="percent"){i+="type = 'percent'; ";i+="output += culture.numberFormat.percent.symbol; "}else if(u.type=="str"){if(f.test(u.value)){i+="type = 'currency'; ";i+="if (isNegative) { output += '-'; matchedCurrency = true; }"}i+="output += "+JSON.stringify(u.value)+"; "}else if(u.type=="text"){i+="type = 'text'; ";i+="output += value; "}else if(u.type=="space"){i+="if (output) result.body.push(output); ";i+="output = ''; ";i+="result.body.push({ type: 'space', value: "+JSON.stringify(u.value)+" }); "}else if(u.type=="fill")i+="output += runtime.fill("+JSON.stringify(u.value)+"); ";else if(u.type=="digit"){i+="if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace('-', '');}";i+="output += "+(u.decimal?"decPart":"intPart")+".shift(); "}else if(u.type=="date")i+="output += runtime.date(culture, date, "+JSON.stringify(u.part)+", "+u.format+"); ";else if(u.type=="time")i+="output += runtime.time(time, "+JSON.stringify(u.part)+", "+u.format+", "+c+", "+u.fraction+"); ";else if(u.type=="eltime")i+="output += runtime.eltime(value, "+JSON.stringify(u.part)+", "+u.format+", "+u.fraction+"); ";else if(u.type=="ampm")i+="output += time.hours < 12 ? "+JSON.stringify(u.am)+" : "+JSON.stringify(u.pm)+"; "}i+="if (output) result.body.push(output); ";i+="result.type = type; ";i+="return result; ";if(l)i=l+i+"}";return i}var o=n({cond:"text",body:[{type:"text"}]}),c=e.memoize(function(e){var t=u(e);var r=t.map(n);r.push(o);r=r.join("\n");r="'use strict'; return function(value, culture){ "+"if (!culture) culture = kendo.culture(); "+"var output = '', type = null, result = { body: [] }; "+r+"; return result; };";return new Function("runtime",r)(g)}),t=e.memoize(function(e){var t=u(e);var r,n=false,i=false;for(var a=0;a<t.length;++a){r=t[a];for(var s=0;s<r.body.length;++s)if(/^(?:date|time|ampm)$/.test(r.body[s].type)){n=true;if(r.body[s].type=="ampm")i=true}if(n)break}if(!n)return null;return r.body.map(l).join("");function o(e,t){if(t.fraction)e+=d("",Math.max(t.fraction,3),"f");return e}function l(e){if(e.type=="digit")if(e.sep)return e.format.charAt(0)+","+e.format.substr(1);else return e.format;else if(e.type=="exp")return e.ch+e.sign;else if(e.type=="date"||e.type=="time"){var t=e.part;if(e.type=="date"&&/^m/.test(t))t="M";else if(e.type=="time"&&/^h/.test(t))if(!i)t=t.toUpperCase();return o(d("",e.format,t),e)}else if(e.type=="ampm")return"tt";else if(e.type=="str")return e.value;else if(e.type=="space")return" ";else if(e.type=="dec")return".";else if(e.type=="percent")return"%";else if(e.type=="comma")return",";else return""}}),g={unpackDate:h.runtime.unpackDate,unpackTime:h.runtime.unpackTime,date:function(e,t,r,n){switch(r){case"d":switch(n){case 1:return t.date;case 2:return d(t.date,2,"0");case 3:return e.calendars.standard.days.namesAbbr[t.day];case 4:return e.calendars.standard.days.names[t.day]}break;case"m":switch(n){case 1:return t.month+1;case 2:return d(t.month+1,2,"0");case 3:return e.calendars.standard.months.namesAbbr[t.month];case 4:return e.calendars.standard.months.names[t.month];case 5:return e.calendars.standard.months.names[t.month].charAt(0)}break;case"y":switch(n){case 2:return t.year%100;case 4:return t.year}break}return"##"},time:function(e,t,r,n,i){var a,s;switch(t){case"h":a=d(n?e.hours%12||12:e.hours,r,"0");if(i)s=(e.minutes+(e.seconds+e.milliseconds/1e3)/60)/60;break;case"m":a=d(e.minutes,r,"0");if(i)s=(e.seconds+e.milliseconds/1e3)/60;break;case"s":a=d(e.seconds,r,"0");if(i)s=e.milliseconds/1e3;break}if(s)a+=g.toFixed(s,i).replace(/^0+/,"");return a},eltime:function(e,t,r,n){var i,a;switch(t){case"h":i=e*24;break;case"m":i=e*24*60;break;case"s":i=e*24*60*60;break}if(n)a=i-(i|0);i=d(i|0,r,"0");if(a)i+=g.toFixed(a,n).replace(/^0+/,"");return i},fill:function(e){return e},formatInt:function(c,e,t,r,h){e=g.toFixed(e,r).replace(/\..*$/,"");var f=t[t.length-1];if(r>0&&f[t.length-1]!="0")if(e==="0")e="";else if(e==="-0")e="-";var d=false;var n=e.length-1;var i=[];var a=0,s;function o(e,t){if(h&&a&&a%3===0&&/^[0-9]$/.test(e))s=c.numberFormat[","]+s;if(t&&e==="-"){d=true;e="0"}s=e+s;a++}for(var l=t.length;--l>=0;){var p=t[l];s="";for(var m=p.length;--m>=0;){var u=p.charAt(m);if(n<0){if(u=="0")o("0");else if(u=="?")o(" ")}else{if(e=="0"&&u=="?")o(" ");else if(u=="0")o(e.charAt(n),true);else o(e.charAt(n));n--}}if(l===0)while(n>=0)o(e.charAt(n--));i.unshift(s)}if(d)i[0]="-"+i[0];return i},formatDec:function(e,t,c){e=g.toFixed(e,c);var r=e.indexOf(".");if(r>=0)e=e.substr(r+1).replace(/0+$/,"");else e="";var n=0;var i=[];for(var a=0;a<t.length;++a){var s=t[a];var o="";for(var l=0;l<s.length;++l){var u=s.charAt(l);if(n<e.length)o+=e.charAt(n++);else if(u=="0")o+="0";else if(u=="?")o+=" "}i.push(o)}return i},toFixed:function(e,o){return function e(t,r){if(!isFinite(t))return"#NUM!";if(t<0)return"-"+e(-t);if(o===0)return String(Math.round(t));if(t===Math.round(t)&&!/e/i.test(String(t)))return t.toFixed(o);var n=v(t);var i=n.intpart;var a=n.decpart;if(a.length<=o){while(a.length<o)a+="0";return i+"."+a}if(r)return i+"."+a.substr(0,o);var s=Math.pow(10,o);return e(Math.round(t*s)/s,true)}(Number(e.toFixed(14)))}};function d(e,t,r){e+="";while(e.length<t)e=r+e;return e}function m(e,t,r){e+="";while(e.length<t)e+=r;return e}function v(e){var t=String(e).toLowerCase();var r,n,i;var a=t.indexOf(".");if(a<0){a=t.indexOf("e");if(a<0){r=t;n=""}else{r=t.substr(0,a);n=t.substr(a)}}else{r=t.substr(0,a);n=t.substr(a+1)}if(i=/(\d*)e([-+]?\d+)/.exec(n)){var s=parseInt(i[2],10);if(s>=0){n=m(i[1],s,"0");r+=n.substr(0,s);n=n.substr(s)}else{r=d(r,-s,"0");n=r.substr(s)+i[1];r=r.substr(0,r.length+s)}}return{intpart:r||"0",decpart:n}}function i(e){var t=e.body;var r="";for(var n=0;n<t.length;++n){var i=t[n];if(typeof i=="string")r+=i;else if(i.type=="space")r+=" "}return r}kendo.spreadsheet.formatting={compile:c,parse:u,format:function(e,t,r){var n=c(t)(e,r);var i=l.element("span");i.__dataType=n.type;var a=n.body;if(n.color)i.attr.style={color:n.color};for(var s=0;s<a.length;++s){var o=a[s];if(typeof o=="string")i.children.push(l.text(o));else if(o.type=="space")i.children.push(l.element("span",{style:{visibility:"hidden"}},[l.text(o.value)]))}return i},text:function(e,t,r){var n=c(t)(e,r);return i(n)},textAndColor:function(e,t,r){var n=c(t)(e,r);return{text:i(n),color:n.color,type:n.type}},type:function(e,t){return c(t)(e).type},adjustDecimals:function(e,t){var r=u(e);s(r,t);return a(r)},makeDateFormat:t}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/runtime.functions.min",["./runtime.min","../util/main.min"],function(){"use strict";var r=kendo.util,a=kendo.spreadsheet,i=a.calc,s=i.runtime,t=s.defineFunction,e=s.defineAlias,u=s.CalcError,d=a.RangeRef,c=a.CellRef,p=a.UnionRef,m=s.Matrix,g=a.Ref,v=a.NameRef,b=s.daysInMonth,w=s.packDate,o=s.unpackDate,n=s.daysInYear;function y(e){return(Math.exp(e)+Math.exp(-e))/2}function _(e){return(Math.exp(e)-Math.exp(-e))/2}function k(e){return _(e)/y(e)}function x(e,t){while(t){var r=e%t;e=t;t=r}return e}function C(e,t){return Math.abs(e*t)/x(e,t)}function F(e,t){var r=[],n=0,i=e[0];while(n<e.length)r.push({matrix:e[n++],pred:h(e[n++])});e:for(var a=0;a<i.height;++a)t:for(var s=0;s<i.width;++s){for(n=0;n<r.length;++n){var o=r[n].matrix.get(a,s);if(!r[n].pred(o==null||o===""?0:o))continue t}t(a,s)}}["abs","cos","sin","acos","asin","tan","atan","exp","sqrt"].forEach(function(e){t(e,Math[e]).args([["*n","number"]])}),t("ln",Math.log).args([["*n","number"]]),t("log",function(e,t){return Math.log(e)/Math.log(t)}).args([["*num","number++"],["*base",["or","number++",["null",10]]],["?",["assert","$base != 1","DIV/0"]]]),t("log10",function(e){return Math.log(e)/Math.log(10)}).args([["*num","number++"]]),t("pi",function(){return Math.PI}).args([]),t("sqrtpi",function(e){return Math.sqrt(e*Math.PI)}).args([["*num","number+"]]),t("degrees",function(e){return 180*e/Math.PI%360}).args([["*radians","number"]]),t("radians",function(e){return Math.PI*e/180}).args([["*degrees","number"]]),t("cosh",y).args([["*num","number"]]),t("acosh",function(e){return Math.log(e+Math.sqrt(e-1)*Math.sqrt(e+1))}).args([["*num","number"],["?",["assert","$num >= 1"]]]),t("sinh",_).args([["*num","number"]]),t("asinh",function(e){return Math.log(e+Math.sqrt(e*e+1))}).args([["*num","number"]]),t("sec",function(e){return 1/Math.cos(e)}).args([["*num","number"]]),t("sech",function(e){return 1/y(e)}).args([["*num","number"]]),t("csc",function(e){return 1/Math.sin(e)}).args([["*num","number"]]),t("csch",function(e){return 1/_(e)}).args([["*num","number"]]),t("atan2",function(e,t){return Math.atan(t/e)}).args([["*x","divisor"],["*y","number"]]),t("tanh",k).args([["*num","number"]]),t("atanh",function(e){return Math.log(Math.sqrt(1-e*e)/(1-e))}).args([["*num",["and","number",["(between)",-1,1]]]]),t("cot",function(e){return 1/Math.tan(e)}).args([["*num","divisor"]]),t("coth",function(e){return 1/k(e)}).args([["*num","divisor"]]),t("acot",function(e){return Math.PI/2-Math.atan(e)}).args([["*num","number"]]),t("acoth",function(e){return Math.log((e+1)/(e-1))/2}).args([["*num","number"],["?",["or",["assert","$num < -1"],["assert","$num > 1"]]]]),t("power",function(e,t){return Math.pow(e,t)}).args([["*a","number"],["*b","number"]]),t("mod",function(e,t){return e%t}).args([["*a","number"],["*b","divisor"]]),t("quotient",function(e,t){return Math.floor(e/t)}).args([["*a","number"],["*b","divisor"]]),t("ceiling",function(e,t){return t?t*Math.ceil(e/t):0}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]),t("ceiling.precise",function(e,t){t=Math.abs(t);return t?t*Math.ceil(e/t):0}).args([["*number","number"],["*significance",["or","number",["null",1]]]]),e("iso.ceiling","ceiling.precise"),t("ceiling.math",function(e,t,r){if(!t||!e)return 0;if(e<0&&(!r&&t<0||r&&t>0))t=-t;return t?t*Math.ceil(e/t):0}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]),t("floor",function(e,t){return t?t*Math.floor(e/t):0}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]),t("floor.precise",function(e,t){t=Math.abs(t);return t?t*Math.floor(e/t):0}).args([["*number","number"],["*significance",["or","number",["null",1]]]]),t("floor.math",function(e,t,r){if(!t||!e)return 0;if(e<0&&(!r&&t<0||r&&t>0))t=-t;return t?t*Math.floor(e/t):0}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]),t("int",Math.floor).args([["*number","number"]]),t("mround",function(e,t){return t?t*Math.round(e/t):0}).args([["*number","number"],["*multiple","number"]]),t("round",function(e,t){var r=e<0?-1:1;if(r<0)e=-e;t=Math.pow(10,t);e*=t;e=Math.round(e);return r*e/t}).args([["*number","number"],["*digits","number"]]),t("roundup",function(e,t){t=Math.pow(10,t);e*=t;e=e<0?Math.floor(e):Math.ceil(e);return e/t}).args([["*number","number"],["*digits","number"]]),t("rounddown",function(e,t){t=Math.pow(10,t);e*=t;e=e<0?Math.ceil(e):Math.floor(e);return e/t}).args([["*number","number"],["*digits","number"]]),t("even",function(e){var t=e<0?Math.floor(e):Math.ceil(e);return t%2?t+(t<0?-1:1):t}).args([["*number","number"]]),t("odd",function(e){var t=e<0?Math.floor(e):Math.ceil(e);return t%2?t:t+(t<0?-1:1)}).args([["*number","number"]]),t("sign",function(e){return e<0?-1:e>0?1:0}).args([["*number","number"]]),t("gcd",function(e){var t=e[0];for(var r=1;r<e.length;++r)t=x(t,e[r]);return t}).args([["numbers",["collect","number"]]]),t("lcm",function(e){var t=e[0];for(var r=1;r<e.length;++r)t=C(t,e[r]);return t}).args([["numbers",["collect","number"]]]),t("sum",function(e){return e.reduce(function(e,t){return e+t},0)}).args([["numbers",["collect","number"]]]),t("product",function(e){return e.reduce(function(e,t){return e*t},1)}).args([["numbers",["collect","number"]]]),t("sumproduct",function(e,a){var s=0;e.each(function(e,t,r){if(typeof e=="number"){for(var n=0;n<a.length;++n){var i=a[n].get(t,r);if(typeof i!="number")return;e*=i}s+=e}});return s}).args([["a1","matrix"],["+",["a2",["and","matrix",["assert","$a2.width == $a1.width"],["assert","$a2.height == $a1.height"]]]]]),t("sumsq",function(e){return e.reduce(function(e,t){return e+t*t},0)}).args([["numbers",["collect","number"]]]),t("sumx2my2",function(e,i){var a=0;e.each(function(e,t,r){var n=i.get(t,r);if(typeof e=="number"&&typeof n=="number")a+=e*e-n*n});return a}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]),t("sumx2py2",function(e,i){var a=0;e.each(function(e,t,r){var n=i.get(t,r);if(typeof e=="number"&&typeof n=="number")a+=e*e+n*n});return a}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]),t("sumxmy2",function(e,i){var a=0;e.each(function(e,t,r){var n=i.get(t,r);if(typeof e=="number"&&typeof n=="number")a+=(e-n)*(e-n)});return a}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]),t("seriessum",function(t,r,n,e){var i=0;e.each(function(e){if(typeof e!="number")throw new u("VALUE");i+=e*Math.pow(t,r);r+=n});return i}).args([["x","number"],["y","number"],["m","number"],["a","matrix"]]),t("min",function(e){return e.length?Math.min.apply(Math,e):0}).args([["numbers",["collect","number"]]]),t("max",function(e){return e.length?Math.max.apply(Math,e):0}).args([["numbers",["collect","number"]]]),t("counta",function(e){return e.length}).args([["values",["#collect","anyvalue"]]]),t("count",function(e){return e.length}).args([["numbers",["#collect","number"]]]),t("countunique",function(e){var t=0,r=[];e.forEach(function(e){if(r.indexOf(e)<0){t++;r.push(e)}});return t}).args([["values",["#collect","anyvalue"]]]),t("countblank",function(e){var t=0;function n(e){if(e==null||e==="")t++}function r(e){for(var t=0;t<e.length;++t){var r=e[t];if(r instanceof m)r.each(n,true);else n(r)}}r(e);return t}).args([["+",["args",["or","matrix","anyvalue"]]]]),t("iseven",function(e){return e%2===0}).args([["*number","number"]]),t("isodd",function(e){return e%2!==0}).args([["*number","number"]]),t("n",function(e){if(typeof e=="boolean")return e?1:0;if(typeof e=="number")return e;return 0}).args([["*value","anyvalue"]]),t("na",function(){return new u("N/A")}).args([]);var R=[["m1","matrix"],["c1","anyvalue"],[["m2","matrix"],["c2","anyvalue"]]],S=(t("countifs",function(e,t,r){var n=0;r.unshift(e,t);F(r,function(){n++});return n}).args(R),[["range","matrix"]].concat(R)),A=(t("sumifs",function(n,e,t,r){r.unshift(n,J,e,t);var i=0;F(r,function(e,t){var r=n.get(e,t);if(r)i+=r});return i}).args(S),t("averageifs",function(n,e,t,r){r.unshift(n,J,e,t);var i=0,a=0;F(r,function(e,t){var r=n.get(e,t);if(r==null||r==="")r=0;i+=r;a++});return a?i/a:new u("DIV/0")}).args(S),t("countif",function(e,t){t=h(t);var r=0;e.each(function(e){if(t(e))r++});return r}).args([["range","matrix"],["*criteria","anyvalue"]]),[["range","matrix"],["*criteria","anyvalue"],["sumRange",["or","area","#matrix",["null","$range"]]]]);function D(s){return function(e,t,r,n){var i=this;if(n instanceof g){var a=n.clone().toRangeRef();if(a.width()!=t.width||a.height()!=t.height){if(!isFinite(a.topLeft.row))a.topLeft.row=0;if(!isFinite(a.topLeft.col))a.topLeft.col=0;a.bottomRight.row=a.topLeft.row+t.height-1;a.bottomRight.col=a.topLeft.col+t.width-1;return i.resolveCells([a],function(){e(s(t,r,i.asMatrix(a)))})}}e(s(t,r,i.asMatrix(n)))}}t("sumif",D(function(e,i,a){var s=0;i=h(i);e.each(function(e,t,r){if(i(e)){var n=a.get(t,r);if(J(n))s+=n||0}});return s})).argsAsync(A),t("averageif",D(function(e,i,a){var s=0,o=0;i=h(i);e.each(function(e,t,r){if(i(e)){var n=a.get(t,r);if(J(n)){s+=n||0;o++}}});return o?s/o:new u("DIV/0")})).argsAsync(A);var E=function(e,i){t(e,function(e,t){var r=[];var n=e.each(function(e){if(e instanceof u)return e;if(typeof e=="number")r.push(e)});if(n)return n;if(t>r.length)return new u("NUM");return i(r,t-1)}).args([["array","matrix"],["*nth","number++"]])};function B(e){return e.reduce(function(e,t){return e+t},0)/e.length}function M(e,t,r){if(r==null)r=B(e);return e.reduce(function(e,t){return e+Math.pow(t-r,2)},0)/t}function T(e,t){return Math.sqrt(M(e,t))}function I(e,t,r){var n=0,i=0,a=null,s=null,o=false;e.forEach(function(e){if(e<t){n++;a=a==null?e:Math.max(a,e)}else if(e>t){i++;s=s==null?e:Math.min(s,e)}else o=true});if(!n&&!i)return new u("N/A");if(o){if(r)return(n+1)/(e.length+1);return n/(n+i)}return((s-t)*I(e,a,r)+(t-a)*I(e,s,r))/(s-a)}E("large",function(e,t){return e.sort(G)[t]}),E("small",function(e,t){return e.sort(f)[t]}),t("stdev.s",function(e){return T(e,e.length-1)}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]),t("stdev.p",function(e){return T(e,e.length)}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]),t("var.s",function(e){return M(e,e.length-1)}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]),t("var.p",function(e){return M(e,e.length)}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]),t("median",function(e){var t=e.length;e.sort(f);if(t%2)return e[t>>1];return(e[t>>=1]+e[t-1])/2}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]),t("mode.sngl",function(e){e.sort(f);var t=null,r=0,n=1,i=null;for(var a=0;a<e.length;++a){var s=e[a];if(s!=t){r=1;t=s}else r++;if(r>n){n=r;i=s}}return i==null?new u("N/A"):i}).args([["numbers",["collect","number"]]]),t("mode.mult",function(e){var r=Object.create(null),n=2,i=[];e.forEach(function(e){var t=r[e]||0;r[e]=++t;if(t==n)i.push(e);else if(t>n){n=t;i=[e]}});var a=new m(this);i.forEach(function(e,t){a.set(t,0,e)});return a}).args([["numbers",["collect","number"]]]),t("geomean",function(e){var t=e.length;var r=e.reduce(function(e,t){if(t<0)throw new u("NUM");return e*t},1);return Math.pow(r,1/t)}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]),t("harmean",function(e){var t=e.length;var r=e.reduce(function(e,t){if(!t)throw new u("DIV/0");return e+1/t},0);return t/r}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]),t("trimmean",function(e,t){var r=e.length;e.sort(f);var n=Math.floor(r*t);if(n%2)--n;n/=2;var i=0;for(var a=n;a<r-n;++a)i+=e[a];return i/(r-n*2)}).args([["numbers",["collect","number",1]],["percent",["and","number",["[between)",0,1]]],["?",["assert","$numbers.length > 0","NUM"]]]),t("frequency",function(r,e){r.sort(f);e.sort(f);var n=-Infinity;var i=0;function a(e){var t=0;while(i<r.length&&r[i]>n&&r[i]<=e){++t;++i}return t}var s=new m(this);e.forEach(function(e,t){var r=a(e);n=e;s.set(t,0,r)});s.set(s.height,0,r.length-i);return s}).args([["data",["collect","number",1]],["bins",["collect","number",1]]]),t("rank.eq",function(e,t,r){t.sort(r?f:G);var n=t.indexOf(e);return n<0?new u("N/A"):n+1}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]),e("rank","rank.eq"),t("rank.avg",function(e,t,r){t.sort(r?f:G);var n=t.indexOf(e);if(n<0)return new u("N/A");for(var i=n;t[i]==e;++i);return(n+i+1)/2}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]),t("kurt",function(e){var t=e.length;var r=B(e);var n=M(e,t-1,r);var i=Math.sqrt(n);var a=e.reduce(function(e,t){return e+Math.pow((t-r)/i,4)},0);return t*(t+1)/((t-1)*(t-2)*(t-3))*a-3*Math.pow(t-1,2)/((t-2)*(t-3))}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 4","NUM"]]]);var L=[["array",["collect","number",1]],["x","number"],["significance",["or",["null",3],"integer++"]],["?",["assert","$array.length > 0","NUM"]]];function N(e,t,r){var n=0;var i=B(e);var a=B(t);var s=e.length;for(var o=0;o<s;++o)n+=(e[o]-i)*(t[o]-a);return n/r}t("percentrank.inc",function(e,t,r){var n=I(e,t,0);n=n.toFixed(r+1);return parseFloat(n.substr(0,n.length-1))}).args(L),t("percentrank.exc",function(e,t,r){var n=I(e,t,1);n=n.toFixed(r+1);return parseFloat(n.substr(0,n.length-1))}).args(L),e("percentrank","percentrank.inc"),t("covariance.p",function(e,t){return N(e,t,e.length)}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 0","DIV/0"]]]),t("covariance.s",function(e,t){return N(e,t,e.length-1)}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 1","DIV/0"]]]),e("covar","covariance.p");var z=r.memoize(function(e){for(var t=2,r=1;t<=e;++t)r*=t;return r}),l=(t("fact",z).args([["*n","integer+"]]),t("factdouble",function(e){for(var t=2+(e&1),r=1;t<=e;t+=2)r*=t;return r}).args([["*n","integer+"]]),t("multinomial",function(e){var t=1,r=0;e.forEach(function(e){if(e<0)throw new u("NUM");r+=e;t*=z(e)});return z(r)/t}).args([["numbers",["collect","number"]]]),r.memoize(function(e,t){for(var r=t+1,n=1,i=1,a=1;n<=e-t;++r,++n){i*=r;a*=n}return i/a}));function P(e,t){e.sort(f);var r=e.length;var n=t|0,i=t-n;if(n===0)return e[0];if(n>=r)return e[r-1];--n;return e[n]+i*(e[n+1]-e[n])}function H(e,t){var r=t*(e.length-1)+1;return P(e,r)}function O(e,t){var r=t*(e.length+1);return P(e,r)}t("combin",l).args([["*n","integer++"],["*k",["and","integer",["[between]",0,"$n"]]]]),t("combina",function(e,t){return l(e+t-1,e-1)}).args([["*n","integer++"],["*k",["and","integer",["[between]",1,"$n"]]]]),t("average",function(e){var t=e.reduce(function(e,t){return e+t},0);return t/e.length}).args([["numbers",["collect","number!"]],["?",["assert","$numbers.length > 0","DIV/0"]]]),t("averagea",function(e){var t=0,r=0;e.forEach(function(e){if(typeof e!="string")t+=e;++r});return r?t/r:new u("DIV/0")}).args([["values",["collect","anyvalue"]]]),t("percentile.inc",H).args([["numbers",["collect","number",1]],["p",["and","number",["[between]",0,1]]]]),t("percentile.exc",O).args([["numbers",["collect","number",1]],["p",["and","number",["(between)",0,1]]]]),t("quartile.inc",function(e,t){return H(e,t/4)}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]),t("quartile.exc",function(e,t){return O(e,t/4)}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]),e("quartile","quartile.inc"),e("percentile","percentile.inc");var V=["AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV.S","STDEV.P","SUM","VAR.S","VAR.P","MEDIAN","MODE.SNGL","LARGE","SMALL","PERCENTILE.INC","QUARTILE.INC","PERCENTILE.EXC","QUARTILE.EXC"];function $(n,e,i){var a=[];var s=1;var o=2;var l=4;(function e(t){if(t instanceof g)n.getRefCells(t,true).forEach(function(e){var t=e.value;if(i&s&&e.hidden)return;if(e.formula){var r=e.formula.print(e.row,e.col);if(/^\s*(?:aggregate|subtotal)\s*\(/i.test(r))if(!(i&l))return}if(i&o&&t instanceof u)return;if(typeof t=="number"||t instanceof u)a.push(t)});else if(Array.isArray(t))for(var r=0;r<t.length;++r)e(t[r]);else if(t instanceof m)t.each(e);else if(typeof t=="number")a.push(t);else if(t instanceof u&&!(i&o))a.push(t)})(e);return a}function U(e,t,r,n){if(!n)return l(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e);else{var i=0;for(var a=0;a<=e;++a)i+=l(t,a)*Math.pow(r,a)*Math.pow(1-r,t-a);return i}}function W(e){var t=o(w(e,0,1));if(t.day==4||t.day==3&&s.isLeapYear(e))return 53;return 52}function j(e,t,r){var n=o(e);var i=o(t);if(r){if(n.date==31)n.date=30;if(i.date==31)i.date=30}else{if(n.month==1&&i.month==1&&n.date==b(n.year,1)&&i.date==b(i.year,1))i.date=30;if(n.date==b(n.year,n.month)){n.date=30;if(i.date==31)i.date=30}else if(n.date==30&&i.date==31)i.date=30}return 360*(i.year-n.year)+30*(i.month-n.month)+(i.date-n.date)}t("aggregate",function(r,n,i,a){var s=this;s.resolveCells(a,function(){var e;if(n>12){e=$(s,a[0],i);var t=a[1];if(t instanceof c)t=s.getRefData(t);if(typeof t!="number")return r(new u("VALUE"))}else e=$(s,a,i);s.func(V[n-1],r,e)})}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],["options",["or",["null",0],["values",0,1,2,3,4,5,6,7]]],["args","rest"]]),t("subtotal",function(t,r){var n=this;var i=r>100;if(i)r-=100;var a=[];for(var e=2;e<arguments.length;++e)a.push(arguments[e]);n.resolveCells(a,function(){var e=$(n,a,i?1:0);n.func(V[r-1],t,e)})}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,101,102,103,104,105,106,107,108,109,110,111]],["+",["ref",["or","ref","#matrix"]]]]),t("avedev",function(e){var r=e.reduce(function(e,t){return e+t},0)/e.length;return e.reduce(function(e,t){return e+Math.abs(t-r)},0)/e.length}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]),t("binom.dist",U).args([["successes","integer+"],["trials",["and","integer",["assert","$trials >= $successes"]]],["probability",["and","number",["[between]",0,1]]],["cumulative","logical"]]),e("binomdist","binom.dist"),t("binom.inv",function(e,t,r){for(var n=0;n<=e;++n)if(U(n,e,t,true)>=r)return n;return new u("N/A")}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["alpha",["and","number",["[between]",0,1]]]]),e("critbinom","binom.inv"),t("binom.dist.range",function(e,t,r,n){var i=0;for(var a=r;a<=n;++a)i+=l(e,a)*Math.pow(t,a)*Math.pow(1-t,e-a);return i}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["successes_min",["and","integer",["[between]",0,"$trials"]]],["successes_max",["or",["and","integer",["[between]","$successes_min","$trials"]],["null","$successes_min"]]]]),t("negbinom.dist",function(e,t,r,n){if(n){var i=0;while(e>=0){i+=l(e+t-1,e)*Math.pow(r,t)*Math.pow(1-r,e);e--}return i}return l(e+t-1,e)*Math.pow(r,t)*Math.pow(1-r,e)}).args([["number_f","integer+"],["number_s","integer+"],["probability_s",["and","number",["[between]",0,1]]],["cumulative","logical"]]),e("negbinomdist","negbinom.dist"),t("address",function(e,t,r,n,i){var a=new c(e-1,t-1,r-1);if(i)a.setSheet(i,true);return n?a.print(0,0):a.print()}).args([["row","integer++"],["col","integer++"],["abs",["or",["null",1],["values",1,2,3,4]]],["a1",["or",["null",true],"logical"]],["sheet",["or","null","string"]]]),t("areas",function(e){var r=0;(function e(t){if(t instanceof c||t instanceof d)r++;else if(t instanceof p)t.refs.forEach(e)})(e);return r}).args([["ref","ref"]]),t("choose",function(e,t){if(e>t.length)return new u("N/A");else return t[e-1]}).args([["*index","integer"],["+",["value","anything"]]]),t("column",function(t){if(!t)return this.formula.col+1;if(t instanceof c)return t.col+1;return this.asMatrix(t).mapCol(function(e){return e+t.topLeft.col+1})}).args([["ref",["or","area","null"]]]),t("columns",function(e){return e instanceof g?e.width():e.width}).args([["ref",["or","area","#matrix"]]]),t("formulatext",function(e){var t=this.getRefCells(e)[0];if(!t.formula)return new u("N/A");return t.formula.print(t.row,t.col)}).args([["ref","ref"]]),t("hlookup",function(r,n,e,i){var a=null;n.eachCol(function(e){var t=n.get(0,e);if(i){if(t>r)return true;a=e}else if(t===r){a=e;return true}});if(a==null)return new u("N/A");return n.get(e-1,a)}).args([["value","anyvalue"],["range","matrix"],["row","integer++"],["approx",["or","logical",["null",true]]]]),t("index",function(e,t,r,n,i){var a=this;if(t instanceof p)t=t.refs[i-1];if(!r&&!n||!t)return e(new u("N/A"));if(t instanceof c)t=t.toRangeRef();if(t instanceof d){if(r&&n){if(n>t.width()||r>t.height())return e(new u("REF"));var s=t.toCell(r-1,n-1);a.resolveCells([s],function(){e(a.getRefData(s))});return}if(!r){var o=t.toColumn(n-1);a.resolveCells([o],function(){e(a.asMatrix(o))});return}if(!n){var l=t.toRow(r-1);a.resolveCells([l],function(){e(a.asMatrix(l))});return}}else if(t instanceof m){if(t.width>1&&t.height>1){if(r&&n)return e(t.get(r-1,n-1));if(!r)return e(t.mapRow(function(e){return t.get(e,n-1)}));if(!n)return e(t.mapCol(function(e){return t.get(r-1,e)}))}if(t.width==1)return e(t.get(r-1,0));if(t.height==1)return e(t.get(0,n-1))}else e(new u("REF"))}).argsAsync([["range",["or","ref","matrix"]],["row",["or","integer+","null"]],["col",["or","integer+","null"]],["areanum",["or","integer++",["null",1]]]]),t("indirect",function(e){try{var t=this.formula;var r=i.parseFormula(t.sheet,t.row,t.col,e);var n=r.ast;if(n instanceof v)n=this.ss.nameValue(n,t.sheet,t.row,t.col);if(!(n instanceof g))throw 1;return n.absolute(t.row,t.col)}catch(e){return new u("REF")}}).args([["thing","string"]]),t("match",function(t,e,r){var n=1,i;if(r===0)i=h(t);else if(r===-1)i=h("<="+t);else if(r===1)i=h(">="+t);if(e.each(function(e){if(e!=null&&i(e)){if(r!==0&&t!=e)--n;return true}n++},true)&&n>0)return n;else return new u("N/A")}).args([["value","anyvalue"],["range","matrix"],["type",["or",["values",-1,0,1],["null",1]]]]),t("offset",function(e,t,r,n,i){var a=(e instanceof c?e:e.topLeft).clone();a.row+=t;a.col+=r;if(a.row<0||a.col<0)return new u("VALUE");if(n>1||i>1)return new d(a,new c(a.row+n-1,a.col+i-1)).setSheet(e.sheet,e.hasSheet());return a}).args([["ref","area"],["*rows","integer"],["*cols","integer"],["*height",["or","integer++",["null","$ref.height()"]]],["*width",["or","integer++",["null","$ref.width()"]]]]),t("row",function(t){if(!t)return this.formula.row+1;if(t instanceof c)return t.row+1;return this.asMatrix(t).mapRow(function(e){return e+t.topLeft.row+1})}).args([["ref",["or","area","null"]]]),t("rows",function(e){return e instanceof g?e.height():e.height}).args([["ref",["or","area","#matrix"]]]),t("vlookup",function(r,n,e,i){var a=null;if(typeof r!="number")i=false;if(typeof r=="string")r=r.toLowerCase();n.eachRow(function(e){var t=n.get(e,0);if(i){if(t>r)return true;a=e}else{if(typeof t=="string")t=t.toLowerCase();if(t===r){a=e;return true}}});if(a==null)return new u("N/A");return n.get(a,e-1)}).args([["value","anyvalue"],["range","matrix"],["col","integer++"],["approx",["or","logical",["null",true]]]]),t("date",function(e,t,r){return w(e,t-1,r)}).args([["*year","integer"],["*month","integer"],["*date","integer"]]),t("day",function(e){return o(e).date}).args([["*date","date"]]),t("month",function(e){return o(e).month+1}).args([["*date","date"]]),t("year",function(e){return o(e).year}).args([["*date","date"]]),t("weekday",function(e){return o(e).day+1}).args([["*date","date"]]),t("weeknum",function(e,t){var r=w(o(e).year,0,1);var n=o(r);var i;if(t==21){i=3-(n.day+6)%7;if(i<0)i+=7;r+=i;n.date+=i;n.day=4;t=1}else if(t==1)t=0;else if(t==2)t=1;else t=(t-10)%7;i=n.day-t;if(i<0)i+=7;r-=i;return Math.ceil((e+1-r)/7)}).args([["*date","date"],["*type",["or",["null",1],["values",1,2,11,12,13,14,15,16,17,21]]]]),t("isoweeknum",function e(t){var r=o(t);var n=r.day||7;var i=Math.floor((r.ord-n+10)/7);if(i<1)return W(r.year-1);else if(i==53&&i>W(r.year))return 1;return i}).args([["*date","date"]]),t("now",function(){return s.dateToSerial(new Date)}).args([]),t("today",function(){return s.dateToSerial(new Date)|0}).args([]),t("time",function(e,t,r){return s.packTime(e,t,r,0)}).args([["*hours","integer"],["*minutes","integer"],["*seconds","integer"]]),t("hour",function(e){return s.unpackTime(e).hours}).args([["*time","datetime"]]),t("minute",function(e){return s.unpackTime(e).minutes}).args([["*time","datetime"]]),t("second",function(e){return s.unpackTime(e).seconds}).args([["*time","datetime"]]),t("edate",function(e,t){var r=o(e);var n=r.month+t;var i=r.year+Math.floor(n/12);n%=12;if(n<0)n+=12;r=Math.min(r.date,b(i,n));return w(i,n,r)}).args([["*start_date","date"],["*months","integer"]]),t("eomonth",function(e,t){var r=o(e);var n=r.month+t;var i=r.year+Math.floor(n/12);n%=12;if(n<0)n+=12;r=b(i,n);return w(i,n,r)}).args([["*start_date","date"],["*months","integer"]]),t("workday",function(e,t,r){var n=t>0?1:-1;t=Math.abs(t);var i=o(e).day;while(t>0){e+=n;i=(i+n)%7;if(i>0&&i<6&&r.indexOf(e)<0)--t}return e}).args([["start_date","date"],["days","integer"],["holidays",["collect","date"]]]),t("networkdays",function(e,t,r){if(e>t){var n=e;e=t;t=n}var i=0;var a=o(e).day;while(e<=t){if(a>0&&a<6&&r.indexOf(e)<0)i++;e++;a=(a+1)%7}return i}).args([["start_date","date"],["end_date","date"],["holidays",["collect","date"]]]),t("days",function(e,t){return t-e}).args([["*start_date","date"],["*end_date","date"]]),t("days360",s._days_360=j).args([["*start_date","date"],["*end_date","date"],["*method",["or","logical",["null",false]]]]),t("yearfrac",function(e,t,r){switch(r){case 0:return j(e,t,false)/360;case 1:return(t-e)/n(o(e).year);case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return j(e,t,true)/360}}).args([["*start_date","date"],["*end_date","date"],["*method",["or",["null",0],["values",0,1,2,3,4]]]]),t("datevalue",function(e){var t=s.parseDate(e);if(t)return s.dateToSerial(t);return new u("VALUE")}).args([["*text","string"]]),t("timevalue",function(e){var t=e.toLowerCase().match(/(\d+):(\d+)(:(\d+)(\.(\d+))?)?\s*(am?|pm?)?/);if(t){var r=parseFloat(t[1]);var n=parseFloat(t[2]);var i=t[3]?parseFloat(t[4]):0;var a=t[7];if(a&&(r>12||r<1))return new u("VALUE");if(/^p/.test(a))r+=12;return s.packTime(r,n,i,0)}return new u("VALUE")}).args([["*text","string"]]),t("mdeterm",function(e){var t=e.each(function(e){if(typeof e!="number")return new u("VALUE")},true);return t||e.determinant()}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]),t("transpose",function(e){return e.transpose()}).args([["range","matrix"]]),t("mmult",function(e,t){return e.multiply(t)}).args([["a","matrix"],["b",["and","matrix",["assert","$b.height == $a.width"]]]]),t("munit",function(e){return new m(this).unit(e)}).args([["n","integer+"]]),t("minverse",function(e){var t=e.each(function(e){if(typeof e!="number")return new u("VALUE")},true);return t||e.inverse()||new u("VALUE")}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]),t("rand",function(){return Math.random()}).args([]),t("randbetween",function(e,t){return e+Math.floor((t-e+1)*Math.random())}).args([["min","integer"],["max",["and","integer",["assert","$max >= $min"]]]]),t("true",function(){return true}).args([]),t("false",function(){return true}).args([]),t("roman",function(e){return r.arabicToRoman(e).toUpperCase()}).args([["*number","integer"]]),t("arabic",function(e){var t=r.romanToArabic(e);return t==null?new u("VALUE"):t}).args([["*roman","string"]]),t("base",function(e,t,r){var n=e.toString(t).toUpperCase();while(n.length<r)n="0"+n;return n}).args([["*number","integer"],["*radix",["and","integer",["[between]",2,36]]],["*minLen",["or","integer+",["null",0]]]]),t("decimal",function(e,t){e=e.toUpperCase();var r=0;for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i>=48&&i<=57)i-=48;else if(i>=65&&i<55+t)i-=55;else return new u("VALUE");r=r*t+i}return r}).args([["*text","string"],["*radix",["and","integer",["[between]",2,36]]]]),t("char",function(e){return String.fromCharCode(e)}).args([["*code","integer+"]]);var q=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;function K(e,t){this.link=e;this.text=t}t("clean",function(e){return e.replace(q,"")}).args([["*text","string"]]),t("code",function(e){return e.charAt(0)}).args([["*text","string"]]),e("unichar","char"),e("unicode","code"),t("concatenate",function(e){var t="";for(var r=0;r<e.length;++r)t+=e[r];return t}).args([["+",["*text","string"]]]),t("dollar",function(e,t){var r="$#,##0DECIMALS;($#,##0DECIMALS)";var n="";var i=1;while(t-- >0)n+="0";while(++t<0)i*=10;if(n!=="")n="."+n;else if(i!==1)e=Math.round(e/i)*i;r=r.replace(/DECIMALS/g,n);return a.formatting.text(e,r)}).args([["*number","number"],["*decimals",["or","integer",["null",2]]]]),t("exact",function(e,t){return e===t}).args([["*text1","string"],["*text2","string"]]),t("find",function(e,t,r){var n=t.indexOf(e,r-1);return n<0?new u("VALUE"):n+1}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]),t("fixed",function(e,t,r){var n=Math.pow(10,t);e=Math.round(e*n)/n;var i=r?"0":"#,##0";if(t>0){i+=".";while(t-- >0)i+="0"}return a.formatting.text(e,i)}).args([["*number","number"],["*decimals",["or","integer",["null",2]]],["*noCommas",["or","boolean",["null",false]]]]),t("left",function(e,t){return e.substr(0,t)}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]),t("right",function(e,t){return e.substr(-t)}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]),t("len",function(e){return e.length}).args([["*text","string"]]),t("lower",function(e){return e.toLowerCase()}).args([["*text","string"]]),t("upper",function(e){return e.toUpperCase()}).args([["*text","string"]]),t("ltrim",function(e){return e.replace(/^\s+/,"")}).args([["*text","string"]]),t("rtrim",function(e){return e.replace(/\s+$/,"")}).args([["*text","string"]]),t("trim",function(e){return e.replace(/^\s+|\s+$/,"")}).args([["*text","string"]]),t("mid",function(e,t,r){return e.substr(t-1,r)}).args([["*text","string"],["*start","integer++"],["*length","integer+"]]),t("proper",function(e){return e.toLowerCase().replace(/\b./g,function(e){return e.toUpperCase()})}).args([["*text","string"]]),t("replace",function(e,t,r,n){return e.substr(0,--t)+n+e.substr(t+r)}).args([["*text","string"],["*start","integer++"],["*length","integer+"],["*newText","string"]]),t("rept",function(e,t){var r="";while(t-- >0)r+=e;return r}).args([["*text","string"],["*number","integer+"]]),t("search",function(e,t,r){var n=t.toLowerCase().indexOf(e.toLowerCase(),r-1);return n<0?new u("VALUE"):n+1}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]),t("substitute",function(e,t,r,n){if(t===r)return e;var i=e.split(t);if(n==null)return i.join(r);e="";n--;for(var a=0;a<i.length;++a){e+=i[a];if(a<i.length-1)if(a===n)e+=r;else e+=t}return e}).args([["*text","string"],["*oldText","string"],["*newText","string"],["*nth",["or","integer++","null"]]]),t("t",function(e){return typeof e=="string"?e:""}).args([["*value","anyvalue"]]),t("text",function(e,t){return a.formatting.text(e,t)}).args([["*value","anyvalue"],["*format","string"]]),t("value",function(e){if(typeof e=="number")return e;if(typeof e=="boolean")return+e;e=(e+"").replace(/[$€,]/g,"");e=parseFloat(e);return isNaN(e)?new u("VALUE"):e}).args([["*value","anyvalue"]]),K.prototype.toString=function(){return this.text},t("hyperlink",function(e,t){return new K(e,t)}).args([["*link","string"],["*text",["or","string",["null","$link"]]]]),t("iferror",function(e,t){return e instanceof u?t:e}).args([["*value","forced!"],["*value_if_error","anyvalue!"]]);var h=function(){var n=Object.create(null);function i(r,n){if(typeof n=="string"){var e=parseFloat(n);if(!isNaN(e)&&e==n)n=e}return function(e){var t=n;if(typeof e=="string"&&typeof t=="string"){e=e.toLowerCase();t=t.toLowerCase()}return r(e,t)}}function r(e){var t,r;if(typeof e=="string")e=e.toLowerCase();if(/^[0-9.]+%$/.test(e)){r=e.substr(0,e.length-1);t=parseFloat(r);if(!isNaN(t)&&t==r)e=t/100}else if(/^[0-9.]+$/.test(e)){t=parseFloat(e);if(!isNaN(t)&&t==e)e=t}return e}function a(e,t){return r(e)<r(t)}function s(e,t){return r(e)<=r(t)}function o(e,t){return r(e)>r(t)}function l(e,t){return r(e)>=r(t)}function u(e,t){return!c(e,t)}function c(e,t){if(t instanceof RegExp)return t.test(e);if(typeof e=="string"||typeof t=="string"){e=String(e);t=String(t)}return r(e)==r(t)}return function(e){if(typeof e=="function")return e;var t;if(t=/^=(.*)$/.exec(e))return i(c,t[1]);if(t=/^<>(.*)$/.exec(e))return i(u,t[1]);if(t=/^<=(.*)$/.exec(e))return i(s,t[1]);if(t=/^<(.*)$/.exec(e))return i(a,t[1]);if(t=/^>=(.*)$/.exec(e))return i(l,t[1]);if(t=/^>(.*)$/.exec(e))return i(o,t[1]);if(/[?*]/.exec(e)){var r=n[e];if(!r){r=e.replace(/(~\?|~\*|[\]({\+\.\|\^\$\\})\[]|[?*])/g,function(e){switch(e){case"~?":return"\\?";case"~*":return"\\*";case"?":return".";case"*":return".*";default:return"\\"+e}});r=n[e]=new RegExp("^"+r+"$","i")}return i(c,r)}return i(c,e)}}();function J(e){return typeof e=="number"||typeof e=="boolean"||e==null||e===""}function f(e,t){return e===t?0:e<t?-1:1}function G(e,t){return e===t?0:e<t?1:-1}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/runtime.functions.2.min",["./runtime.min"],function(){"use strict";var n,i,e=kendo.spreadsheet.calc.runtime,t=e.defineFunction,p=e.CalcError,a=e.packDate,u=e.unpackDate,s=e.isLeapYear,o=e.daysInMonth,l=e._days_360,r=(t("ERF",function(e,t){if(t==null)return h(e);return h(t)-h(e)}).args([["lower_limit","number"],["upper_limit",["or","number","null"]]]),t("ERFC",f).args([["x","number"]]),t("GAMMALN",c).args([["x","number++"]]),t("GAMMA",v).args([["x","number"]]),t("GAMMA.DIST",S).args([["x","number+"],["alpha","number++"],["beta","number++"],["cumulative","logical"]]),t("GAMMA.INV",A).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"]]),t("NORM.S.DIST",D).args([["z","number"],["cumulative","logical"]]),t("NORM.S.INV",E).args([["p",["and","number",["[between]",0,1]]]]),t("NORM.DIST",B).args([["x","number"],["mean","number"],["stddev","number++"],["cumulative","logical"]]),t("NORM.INV",M).args([["p",["and","number",["[between]",0,1]]],["mean","number"],["stddev","number++"]]),t("BETADIST",z).args([["x","number"],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]),t("BETA.DIST",P).args([["x","number"],["alpha","number++"],["beta","number++"],["cumulative","logical"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]),t("BETA.INV",H).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]]]),t("CHISQ.DIST",O).args([["x","number+"],["deg_freedom","integer++"],["cumulative","logical"]]),t("CHISQ.DIST.RT",V).args([["x","number+"],["deg_freedom","integer++"]]),t("CHISQ.INV",$).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]),t("CHISQ.INV.RT",U).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]),t("CHISQ.TEST",function(e,t){return W(e.data,t.data)}).args([["actual_range","matrix"],["expected_range","matrix"],["?",["assert","$actual_range.width == $expected_range.width"]],["?",["assert","$actual_range.height == $expected_range.height"]]]),t("EXPON.DIST",j).args([["x","number+"],["lambda","number++"],["cumulative","logical"]]),t("POISSON.DIST",q).args([["x","integer+"],["mean","number+"],["cumulative","logical"]]),t("F.DIST",K).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"],["cumulative","logical"]]),t("F.DIST.RT",J).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]),t("F.INV",Y).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]),t("F.INV.RT",G).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]),t("F.TEST",Q).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]),t("FISHER",Z).args([["x",["and","number",["(between)",-1,1]]]]),t("FISHERINV",ee).args([["y","number"]]),t("T.DIST",te).args([["x","number"],["deg_freedom","integer++"],["cumulative","logical"]]),t("T.DIST.RT",re).args([["x","number"],["deg_freedom","integer++"]]),t("T.DIST.2T",ne).args([["x","number+"],["deg_freedom","integer++"]]),t("T.INV",ie).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]),t("T.INV.2T",ae).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]),t("T.TEST",se).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["tails",["and","integer",["values",1,2]]],["type",["and","integer",["values",1,2,3]]],["?",["assert","$type != 1 || $array1.length == $array2.length","N/A"]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]),t("CONFIDENCE.T",oe).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++",["assert","$size != 1","DIV/0"]]]]),t("CONFIDENCE.NORM",le).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++"]]]),t("GAUSS",ue).args([["z","number"]]),t("PHI",ce).args([["x","number"]]),t("LOGNORM.DIST",he).args([["x","number++"],["mean","number"],["standard_dev","number++"],["cumulative","logical"]]),t("LOGNORM.INV",fe).args([["probability",["and","number",["(between)",0,1]]],["mean","number"],["standard_dev","number++"]]),t("PROB",de).args([["x_range",["collect","number",1]],["prob_range",["collect","number",1]],["lower_limit","number"],["upper_limit",["or","number",["null","$lower_limit"]]],["?",["assert","$prob_range.length == $x_range.length","N/A"]]]),t("SLOPE",pe).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]),t("INTERCEPT",me).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]),t("PEARSON",ge).args([["array1",["collect!","anything",1]],["array2",["collect!","anything",1]],["?",["assert","$array2.length == $array1.length","N/A"]],["?",["assert","$array2.length > 0 && $array1.length > 0","N/A"]]]),t("RSQ",ve).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]],["?",["assert","$known_x.length != 1 && $known_y.length != 1","N/A"]]]),t("STEYX",be).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length >= 3 && $known_y.length >= 3","DIV/0"]]]),t("FORECAST",we).args([["x","number"],["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]),t("LINEST",ke).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]),t("LOGEST",xe).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]),t("TREND",Ce).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]),t("GROWTH",Fe).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]),t("FV",Se).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["pv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $pv"]]]),t("PV",Ae).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]),t("PMT",De).args([["rate","number"],["nper","number"],["pmt","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]),t("NPER",Ee).args([["rate","number"],["pmt","number"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]),t("RATE",Be).args([["nper","number"],["pmt",["or","number",["null",0]]],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["guess",["or","number++",["null",.01]]],["?",["assert","$pmt || $fv"]]]),t("IPMT",Me).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]),t("PPMT",Te).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]),t("CUMPRINC",Ie).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]),t("CUMIPMT",Le).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]),t("NPV",Ne).args([["rate","number"],["values",["collect","number"]],["?",["assert","$values.length > 0","N/A"]]]),t("IRR",ze).args([["values",["collect","number",1]],["guess",["or","number",["null",.1]]]]),t("EFFECT",Pe).args([["nominal_rate","number++"],["npery","integer++"]]),t("NOMINAL",He).args([["effect_rate","number++"],["npery","integer++"]]),t("XNPV",Oe).args([["rate","number"],["values",["collect","number",1]],["dates",["collect","date",1]],["?",["assert","$values.length == $dates.length","NUM"]]]),t("XIRR",Ve).args([["values",["collect","number",1]],["dates",["collect","date",1]],["guess",["or","number",["null",.1]]],["?",["assert","$values.length == $dates.length","NUM"]]]),t("ISPMT",$e).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["?",["assert","$per >= 1 && $per <= $nper"]]]),t("DB",Ue).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["month",["or","number",["null",12]]]]),t("DDB",We).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["factor",["or","number",["null",2]]]]),t("SLN",je).args([["cost","number"],["salvage","number"],["life","number++"]]),t("SYD",qe).args([["cost","number"],["salvage","number"],["life","number++"],["per","number++"]]),t("VDB",Ke).args([["cost","number+"],["salvage","number+"],["life","number++"],["start_period","number+"],["end_period","number+"],["factor",["or","number+",["null",2]]],["no_switch",["or","logical",["null",false]]],["?",["assert","$end_period >= $start_period","NUM"]]]),[["settlement","date"],["maturity","date"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),m=(t("COUPDAYBS",Ye).args(r),t("COUPDAYS",Xe).args(r),t("COUPDAYSNC",Qe).args(r),t("COUPPCD",Ze).args(r),t("COUPNCD",et).args(r),t("COUPNUM",tt).args(r),t("ACCRINTM",nt).args([["issue","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1e3],"number++"]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$issue < $settlement","NUM"]]]),t("ACCRINT",it).args([["issue","date"],["first_interest","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1e3],"number++"]],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["calc_method",["or","logical",["null",true]]],["?",["assert","$issue < $settlement","NUM"]]]),t("DISC",at).args([["settlement","date"],["maturity","date"],["pr","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),t("INTRATE",st).args([["settlement","date"],["maturity","date"],["investment","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),t("RECEIVED",ot).args([["settlement","date"],["maturity","date"],["investment","number++"],["discount","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),t("PRICE",lt).args([["settlement","date"],["maturity","date"],["rate","number++"],["yld","number++"],["redemption","number++"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),t("PRICEDISC",ut).args([["settlement","date"],["maturity","date"],["discount","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]),300),g=22204e-20,d=1e-30,k=Math.abs;function h(e){if(k(e)>=3.3)return 1-f(e);var t=e>0?1:-1;if(t==-1)e=-e;var r=0,n=1;for(var i=1;i<100;i++){r+=n;n*=2*e*e/(2*i+1)}return t*2/Math.sqrt(Math.PI)*e*Math.exp(-e*e)*r}function f(e){if(k(e)<3.3)return 1-h(e);var t=1;if(e<0){t=-1;e=-e}var r=e;for(var n=8;n>=1;n-=.5)r=e+n/r;r=1/(e+r);return t==1?Math.exp(-e*e)/Math.sqrt(Math.PI)*r:2-Math.exp(-e*e)/Math.sqrt(Math.PI)*r}function c(e){var t=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];var r=e,n=e+5.5,i=t[0];n-=(e+.5)*Math.log(n);for(var a=1;a<=6;a++){r+=1;i+=t[a]/r}return-n+Math.log(Math.sqrt(2*Math.PI)*i/e)}function v(e){if(e>0)return Math.exp(c(e));var t=Math.PI,r=-e;return-t/(r*v(r)*Math.sin(t*r))}function y(e,t){return c(e)+c(t)-c(e+t)}function _(e,t){return Math.exp(y(e,t))}function C(e,t){return t<e+1?F(e,t):1-R(e,t)}function F(e,t){var r=1/e,n=r,i=e;var a=c(e),s;for(s=1;s<=m;s++){i++;n*=t/i;r+=n;if(k(n)<k(r)*g)break}return r*Math.exp(-t+e*Math.log(t)-a)}function R(e,t){var r=d,n=r,i=0,a=1,s=t+1-e;var o=c(e);for(var l=1;l<=m;l++){i=s+a*i;if(k(i)<d)i=d;n=s+a/n;if(k(n)<d)n=d;i=1/i;var u=n*i;r*=u;if(k(u-1)<g)break;s+=2;a=-l*(l-e)}return r*Math.exp(-t-o+e*Math.log(t))}function S(e,t,r,n){if(!n)return Math.pow(e/r,t-1)*Math.exp(-e/r)/(r*v(t));return C(t,e/r)}function A(e,t,r){if(e===0)return 0;if(e==1)return Infinity;var n=0,i=10,a=0,s=t*r;if(s>1)i*=s;for(var o=0;o<m;o++){a=.5*(n+i);var l=S(a,t,r,true);if(k(e-l)<1e-16)break;if(l>e)i=a;else n=a}return a}function D(e,t){if(!t)return Math.exp(-e*e/2)/Math.sqrt(2*Math.PI);return.5+.5*h(e/Math.sqrt(2))}function E(e){var t=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],r=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],n=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],i=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416];var a=.02425,s=1-a;var o,l;if(e<a){o=Math.sqrt(-2*Math.log(e));return(((((n[0]*o+n[1])*o+n[2])*o+n[3])*o+n[4])*o+n[5])/((((i[0]*o+i[1])*o+i[2])*o+i[3])*o+1)}if(s<e){o=Math.sqrt(-2*Math.log(1-e));return-(((((n[0]*o+n[1])*o+n[2])*o+n[3])*o+n[4])*o+n[5])/((((i[0]*o+i[1])*o+i[2])*o+i[3])*o+1)}o=e-.5;l=o*o;return(((((t[0]*l+t[1])*l+t[2])*l+t[3])*l+t[4])*l+t[5])*o/(((((r[0]*l+r[1])*l+r[2])*l+r[3])*l+r[4])*l+1)}function B(e,t,r,n){if(!n)return Math.exp(-(e-t)*(e-t)/(2*r*r))/(r*Math.sqrt(2*Math.PI));return D((e-t)/r,true)}function M(e,t,r){return t+r*E(e)}function T(e,t,r){return Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-y(t,r))}function I(e,t,r){var n=Math.exp(t*Math.log(e)+r*Math.log(1-e)-y(t,r));return e<(t+1)/(t+r+2)?n*L(t,r,e)/t:1-n*L(r,t,1-e)/r}function L(e,c,t){var r,n;var i,a,s,o,l,u,h,f;u=e+c;f=e+1;h=e-1;a=1;s=1-u*t/f;if(k(s)<d)s=d;s=1/s;l=s;for(r=1;r<=m;r++){n=2*r;i=r*(c-r)*t/((h+n)*(e+n));s=1+i*s;if(k(s)<d)s=d;a=1+i/a;if(k(a)<d)a=d;s=1/s;l*=s*a;i=-(e+r)*(u+r)*t/((e+n)*(f+n));s=1+i*s;if(k(s)<d)s=d;a=1+i/a;if(k(a)<d)a=d;s=1/s;o=s*a;l*=o;if(k(o-1)<g)break}return l}function N(e,t,r){var n=0,i=1,a=0;for(var s=0;s<m;s++){a=.5*(n+i);var o=I(a,t,r);if(k(e-o)<g)break;if(o>e)i=a;else n=a}return a}function z(e,t,r,n,i){return I((e-n)/(i-n),t,r)}function P(e,t,r,n,i,a){if(n)return I((e-i)/(a-i),t,r);return T((e-i)/(a-i),t,r)/(a-i)}function H(e,t,r,n,i){return n+(i-n)*N(e,t,r)}function O(e,t,r){return S(e,t/2,2,r)}function V(e,t){return 1-O(e,t,true)}function $(e,t){return A(e,t/2,2)}function U(e,t){return $(1-e,t)}function W(e,t){var r=e.length,n=e[0].length;var i=0,a,s;for(a=0;a<r;a++)for(s=0;s<n;s++){var o=t[a][s];var l=e[a][s]-o;l*=l;i+=l/o}var u=(r-1)*(n-1);return V(i,u)}function j(e,t,r){if(r)return 1-Math.exp(-t*e);return t*Math.exp(-t*e)}function q(e,t,r){if(r)return 1-O(2*t,2*(e+1),true);var n=0;for(var i=2;i<=e;i++)n+=Math.log(i);return Math.exp(e*Math.log(t)-t-n)}function K(e,t,r,n){if(n)return I(t*e/(r+t*e),t/2,r/2);var i=t/r;t/=2;r/=2;return i/_(t,r)*Math.pow(i*e,t-1)/Math.pow(1+i*e,t+r)}function J(e,t,r){return 1-K(e,t,r,true)}function G(e,t,r){return r/t*(1/H(e,r/2,t/2,0,1)-1)}function Y(e,t,r){return r/t*(1/H(1-e,r/2,t/2,0,1)-1)}function x(e){var t=0,r=e.length;for(var n=0;n<r;n++)t+=e[n];return t/r}function X(e,t){var r=0,n=e.length;for(var i=0;i<n;i++){var a=e[i]-t;r+=a*a}return r/(n-1)}function Q(e,t){var r=e.length-1,n=t.length-1;var i=X(e,x(e)),a=X(t,x(t));if(!i||!a)throw new p("DIV/0");return 2*K(i/a,r,n,true)}function Z(e){return.5*Math.log((1+e)/(1-e))}function ee(e){var t=Math.exp(2*e);return(t-1)/(t+1)}function te(e,t,r){if(r)return 1-.5*I(t/(e*e+t),t/2,.5);return 1/(Math.sqrt(t)*_(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)}function re(e,t){return 1-te(e,t,true)}function ne(e,t){if(e<0)e=-e;return 2*re(e,t)}function ie(e,t){var r=N(2*Math.min(e,1-e),t/2,.5);r=Math.sqrt(t*(1-r)/r);return e>.5?r:-r}function ae(e,t){return ie(1-e/2,t)}function se(e,t,r,c){var n=e.length,i=t.length;var a,s;if(c==1){var o=0,h=0;for(var l=0;l<n;l++){var u=e[l]-t[l];o+=u;h+=u*u}var f=o/n;a=f/Math.sqrt((h-o*f)/(n*(n-1)));return r==1?re(a,n-1):ne(a,n-1)}var d=x(e),p=x(t),m=X(e,d),g=X(t,p);if(c==3){var v=m/n,b=g/i,w=v+b;var y=v/w,_=b/w;s=1/(y*y/(n-1)+_*_/(i-1));a=k(d-p)/Math.sqrt(w);return r==1?re(a,s):ne(a,s)}else{s=n+i-2;a=k(d-p)*Math.sqrt(s*n*i/((n+i)*((n-1)*m+(i-1)*g)));return r==1?re(a,s):ne(a,s)}}function oe(e,t,r){return-ie(e/2,r-1)*t/Math.sqrt(r)}function le(e,t,r){return-E(e/2)*t/Math.sqrt(r)}function ue(e){return D(e,true)-.5}function ce(e){return D(e)}function he(e,t,r,n){if(n)return.5+.5*h((Math.log(e)-t)/(r*Math.sqrt(2)));var i=Math.log(e)-t;return Math.exp(-i*i/(2*r*r))/(e*r*Math.sqrt(2*Math.PI))}function fe(e,t,r){return Math.exp(M(e,t,r))}function de(e,t,r,n){var i=e.length;var a=0,s;for(s=0;s<i;s++){if(t[s]<=0||t[s]>1)throw new p("NUM");a+=t[s]}if(a!=1)throw new p("NUM");var o=0;for(s=0;s<i;s++){var l=e[s];if(l>=r&&l<=n)o+=t[s]}return o}function pe(e,t){var r=x(t),n=x(e),i=0,a=0;for(var s=0,o=e.length;s<o;s++){var l=t[s]-r;i+=l*(e[s]-n);a+=l*l}return i/a}function me(e,t){var r=x(t),n=x(e);var i=0,a=0;for(var s=0,o=e.length;s<o;s++){var l=t[s]-r;i+=l*(e[s]-n);a+=l*l}return n-i*r/a}function ge(e,t){ct(e,t);var r=x(e),n=x(t);var i=0,a=0,s=0;for(var o=0,c=e.length;o<c;o++){var l=e[o]-r,u=t[o]-n;i+=l*u;a+=l*l;s+=u*u}return i/Math.sqrt(a*s)}function ve(e,t){var r=ge(e,t);return r*r}function be(e,t){var r=t.length;var n=x(t),c=x(e);var i=0,a=0,s=0;for(var o=0;o<r;o++){var l=t[o]-n,u=e[o]-c;i+=u*u;a+=l*u;s+=l*l}return Math.sqrt((i-a*a/s)/(r-2))}function we(e,t,r){var n=x(r),i=x(t);var a=0,s=0;for(var o=0,c=r.length;o<c;o++){var l=r[o]-n,h=t[o]-i;a+=l*h;s+=l*l}if(s===0)throw new p("N/A");var u=a/s,f=i-u*n;return f+u*e}function ye(e){var t=e.height,r=0;for(var n=0;n<t;n++)r+=e.data[n][0];return r/t}function _e(e,t){var r=e.height,n=0;for(var i=0;i<r;i++){var a=e.data[i][0]-t;n+=a*a}return n}function ke(e,t,r,c){var n=0;if(!t)t=e.map(function(){return++n});if(r){t=t.clone();t.eachRow(function(e){t.data[e].unshift(1)});++t.width}var i=t.transpose();var a=i.multiply(t).inverse().multiply(i).multiply(e);var s=[];for(n=a.height-1;n>=0;n--)s.push(a.data[n][0]);if(!r)s.push(0);if(!c)return this.asMatrix([s]);var h=t.multiply(a);var f=e.adds(h,true);var d=!r?0:ye(h);var o=_e(h,d);var p=!r?0:ye(f);var l=_e(f,p);var m=[];m.push(o,l);var g=o/(o+l);var u=e.height-t.width;var v=Math.sqrt(l/u);var b=[];b.push(g,v);var w=!r?g/t.width/((1-g)/u):o/(t.width-1)/(l/u);var y=[];y.push(w,u);var _=i.multiply(t).inverse();var k=[];for(n=_.height-1;n>=0;n--)k.push(Math.sqrt(_.data[n][n]*l/u));return this.asMatrix([s,k,b,y,m])}function xe(e,t,r,n){return ke.call(this,e.map(Math.log),t,r,n).map(Math.exp)}function Ce(e,t,r,n){var i=0;if(!t)t=e.map(function(){return++i});if(n){t=t.clone();t.eachRow(function(e){t.data[e].unshift(1)});++t.width}var a=t.transpose();var s=a.multiply(t).inverse().multiply(a).multiply(e);if(!r)r=t;else if(n){r=r.clone();r.eachRow(function(e){r.data[e].unshift(1)});++r.width}return r.multiply(s)}function Fe(e,t,r,n){return Ce.call(this,e.map(Math.log),t,r,n).map(Math.exp)}function Re(e,t,r,n){var i=r||20,a=n||1e-7;var s=t;for(var o=1;o<=i;o++){var l=e(s),c=l[0],h=l[1];var u=c/h;s-=u;if(Math.abs(u)<a)return s}return new p("NUM")}function Se(e,t,r,n,i){var a=Math.pow(1+e,t);var s=e?(a-1)/e:t;return-(n*a+r*s*(1+e*i))}function Ae(e,t,r,n,i){if(!e)return-n-r*t;var a=Math.pow(1+e,t);return-(n+r*(a-1)/e*(1+e*i))/a}function De(e,t,r,n,i){if(!e)return-(n+r)/t;var a=Math.pow(1+e,t);return-e*(n+r*a)/((1+e*i)*(a-1))}function Ee(e,t,r,n,i){if(!e)return-(n+r)/t;var a=t*(1+e*i);return Math.log((a-n*e)/(a+r*e))/Math.log(1+e)}function Be(n,i,a,s,o,e){function t(e){var t=Math.pow(1+e,n-1),r=t*(1+e);return[a*r+i*(1/e+o)*(r-1)+s,n*a*t+i*(-(r-1)/(e*e)+(1/e+o)*n*t)]}return Re(t,e)}function Me(e,t,r,n,i,a){if(a==1&&t==1)return 0;var s=De(e,r,n,i,a);var o=Se(e,t-1,s,n,a)*e;return a?o/(1+e):o}function Te(e,t,r,n,i,a){var s=De(e,r,n,i,a);return s-Me(e,t,r,n,i,a)}function Ie(e,t,r,n,i,a){if(a==1){n--;i--}var s=Math.pow(1+e,t),o=Math.pow(1+e,n-1),l=Math.pow(1+e,i);var u=e*r*s/(s-1);var c=o*r-(o-1)/e*u;var h=l*r-(l-1)/e*u;return h-c}function Le(e,t,r,n,i,a){var s=0;for(var o=n;o<=i;o++)s+=Me(e,o,t,r,0,a);return s}function Ne(e,t){var r=0;for(var n=0,i=t.length;n<i;n++)r+=t[n]*Math.pow(1+e,-n-1);return r}function ze(a,e){function t(e){var t=0,r=0;for(var n=0,i=a.length;n<i;n++){t+=a[n]*Math.pow(1+e,-n-1);r+=-n*a[n]*Math.pow(1+e,-n-2)}return[t,r]}return Re(t,e)}function Pe(e,t){return Math.pow(1+e/t,t)-1}function He(e,t){return t*(Math.pow(e+1,1/t)-1)}function Oe(e,t,r){var n=0;for(var i=0,a=t.length;i<a;i++)n+=t[i]*Math.pow(1+e,(r[0]-r[i])/365);return n}function Ve(s,o,e){function t(e){var t=s[0],r=0;for(var n=1,i=s.length;n<i;n++){var a=(o[0]-o[n])/365;t+=s[n]*Math.pow(1+e,a);r+=a*s[n]*Math.pow(1+e,a-1)}return[t,r]}return Re(t,e)}function $e(e,t,r,n){var i=-n*e;return i*(1-t/r)}function Ue(e,t,r,n,i){var a=1-Math.pow(t/e,1/r);a=Math.floor(a*1e3+.5)/1e3;var s=e*a*i/12;if(n==1)return s;for(var o=1;o<r;o++){if(o==n-1)return(e-s)*a;s+=(e-s)*a}return(e-s)*a*(12-i)/12}function We(e,t,r,n,i){var a=i/r;var s=-e*(Math.pow(1-a,n-1)-1);var o=(e-s)*a;o=Math.min(o,Math.max(0,e-s-t));return o}function je(e,t,r){return(e-t)/r}function qe(e,t,r,n){return(e-t)*(r-n+1)*2/(r*(r+1))}function Ke(e,h,t,r,n,i,u){var a=i>=t?1:i/t;function f(e,t){var r,n,i;if(a==1)n=t==1?e:0;else n=e*Math.pow(1-a,t-1);i=e*Math.pow(1-a,t);r=i<h?n-h:n-i;return r<0?0:r}function c(e,c,t){var r=e-h;var n=Math.ceil(t);var i,a=0,s=0,o=false;for(var l=1;l<=n;l++){if(!o){var u=f(e,l);a=r/(c-l+1);if(a>u){i=a;o=true}else{i=u;r-=u}}else i=a;if(l==n)i*=t+1-n;s+=i}return s}var s=Math.floor(r),o=Math.ceil(n);var d=0;if(u)for(var l=s+1;l<=o;l++){var p=f(e,l);if(l==s+1)p*=Math.min(n,s+1)-r;else if(l==o)p*=n+1-o;d+=p}else{var m=t;if(r!=Math.floor(r))if(i>1)if(r>=t/2){var g=r-t/2;r=t/2;n-=g;m+=1}e-=c(e,m,r);d=c(e,t-r,n-r)}return d}function Je(e,t){var r=u(e);var n=r.month+t;var i=r.year+Math.floor(n/12);n%=12;if(n<0)n+=12;r=Math.min(r.date,o(i,n));return a(i,n,r)}function b(e,t,r){if(r==1||r==2||r==3)return t-e;return l(e,t,r)}function w(e,t,r){var n=u(e),i=u(t);var a=i.year-n.year;if(a>0)a=(a-1)*r;var s,o,l=12/r;do{a++;s=Je(t,-a*l)}while(e<s);a--;o=Je(t,-a*l);return[s,o]}function Ge(e,t,r){var n=u(t),i=u(e);var a=n.year-i.year;if(a>0)a=(a-1)*r;var s=e,o,l=12/r;while(t>s){o=s;a++;s=Je(e,a*l)}return[o,s]}function Ye(e,t,r,n){var i=w(e,t,r)[0];return b(i,e,n)}function Xe(e,t,r,n){if(n==1){var i=w(e,t,r);return b(i[0],i[1],1)}if(n==3)return 365/r;return 360/r}function Qe(e,t,r,n){var i=w(e,t,r)[1];return b(e,i,n)}function Ze(e,t,r){return w(e,t,r)[0]}function et(e,t,r){return w(e,t,r)[1]}function tt(e,t,r){var n=u(e),i=u(t);var a=12*(i.year-n.year)+i.month-n.month;return 1+(a*r/12|0)}function rt(e,t){if(t==3)return 365;if(t==1)return s(e)?366:365;return 360}function nt(e,t,r,n,i){var a=rt(u(t).year,i);return r*n*b(e,t,i)/a}function it(e,t,r,c,h,n,i,f){var a=0,d=h*c/n;var s,o,l,p,m,u;var g=i%2===0?360:365;function v(e,t){return(t-e)*n/g|0}if(r<=t){s=w(r,t,n);o=s[0];l=s[1];if(o<=e)return d*b(e,r,i)/b(o,l,i);s=w(e,o,n);p=s[0];m=s[1];u=v(m,r);return d*(u+b(e,m,i)/b(p,m,i)+(r<l?b(o,r,i)/b(o,l,i):0))}else{s=Ge(t,r,n);o=s[0];l=s[1];u=v(t,r);if(l==r)a=d*u;else a=d*(u+b(o,r,i)/b(o,l,i));if(!f)return a;s=w(e,t,n);o=s[0];l=s[1];u=v(e,t);a+=d*(u+b(e,l,i)/b(o,l,i));return a}}function at(e,t,r,n,i){var a=i%2===0?360:s(u(e).year)?366:365;return(n-r)/n*a/b(e,t,i)}function st(e,t,r,n,i){var a=i%2===0?360:s(u(e).year)?366:365;return(n-r)/r*a/b(e,t,i)}function ot(e,t,r,n,i){var a=i%2===0?360:s(u(e).year)?366:365;return r/(1-n*b(e,t,i)/a)}function lt(e,t,c,h,r,n,i){var a=1+((t-e)*n/(i%2===0?360:365)|0);var f=w(e,t,n),d=f[0],p=f[1];var m=b(d,e,i),g=b(e,p,i),s=b(d,p,i);var o=100*c/n,l=h/n,u=g/s;if(a==1)return(r+o)/(1+u*l)-m/s*o;return r/Math.pow(1+l,a-1+u)+o*Math.pow(1+l,1-a-u)*(Math.pow(1+l,a)-1)/l-m/s*o}function ut(e,t,r,n,i){var a=b(e,t,i),s=rt(u(t).year,i);return n-r*n*a/s}function ct(e,t){for(var r=e.length;--r>=0;)if(typeof e[r]!="number"||typeof t[r]!="number"){e.splice(r,1);t.splice(r,1)}}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/borderpalette.min",["../kendo.core.min","../kendo.colorpicker.min","../kendo.popup.min"],function(){var i=window.kendo,a=i.jQuery,n=["allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders"],s=i.spreadsheet.messages.borderPalette={allBorders:"All borders",insideBorders:"Inside borders",insideHorizontalBorders:"Inside horizontal borders",insideVerticalBorders:"Inside vertical borders",outsideBorders:"Outside borders",leftBorder:"Left border",topBorder:"Top border",rightBorder:"Right border",bottomBorder:"Bottom border",noBorders:"No border"},o=i.spreadsheet.messages.colorPicker={reset:"Reset color",customColor:"Custom color...",apply:"Apply",cancel:"Cancel"};function r(t){return function(e){e.preventDefault();return t.apply(this,arguments)}}var t=i.ui.Widget.extend({init:function(e,t){i.ui.Widget.call(this,e,t);this.element=e;this.color=t.color;this._resetButton();this._colorPalette();this._customColorPalette();this._customColorButton();this.resetButton.on("click",r(this.resetColor.bind(this)));this.customColorButton.on("click",r(this.customColor.bind(this)))},options:{name:"ColorChooser"},events:["change"],destroy:function(){i.unbind(this.dialog.element.find(".k-action-buttons"));this.dialog.destroy();this.colorPalette.destroy();this.resetButton.off("click");this.customColorButton.off("click")},value:function(e){if(e!==undefined){this.color=e;this.customColorButton.find(".k-icon").css("background-color",this.color);this.colorPalette.value(null);this.flatColorPicker.value(this.color)}else return this.color},_change:function(e){this.color=e;this.trigger("change",{value:e})},_colorPalette:function(){var e=a("<div />",{class:"k-spreadsheet-color-palette"});var t=this.colorPalette=a("<div />").kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],value:this.color,change:function(e){this.customColorButton.find(".k-icon").css("background-color","transparent");this.flatColorPicker.value(null);this._change(e.value)}.bind(this)}).data("kendoColorPalette");e.append(t.wrapper).appendTo(this.element)},_customColorPalette:function(){var e=a("<div />",{class:"k-spreadsheet-window",html:"<div></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-"+i.ns+"bind='click: apply'><span class='k-button-text'>"+o.apply+"</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-"+i.ns+"bind='click: close'><span class='k-button-text'>"+o.cancel+"</span></button>"+"</div>"});var t=this.dialog=e.appendTo(document.body).kendoWindow({animation:false,scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:"auto",open:function(){this.center()}}).data("kendoWindow");t.one("activate",function(){this.element.find("["+i.attr("role")+"=flatcolorpicker]").data("kendoFlatColorPicker")._view._hueSlider.resize()});var r=this.flatColorPicker=t.element.children().first().kendoFlatColorPicker().data("kendoFlatColorPicker");var n=i.observable({apply:function(){this.customColorButton.find(".k-icon").css("background-color",r.value());this.colorPalette.value(null);this._change(r.value());t.close()}.bind(this),close:function(){r.value(null);t.close()}});i.bind(t.element.find(".k-action-buttons"),n)},_resetButton:function(){this.resetButton=a("<a role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-reset-color' href='#'>"+"<span class='k-button-icon k-icon k-i-reset-color'></span>"+'<span class="k-button-text">'+o.reset+"</span>"+"</a>").appendTo(this.element)},_customColorButton:function(){this.customColorButton=a("<a role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-custom-color' href='#'>"+"<span class='k-button-icon k-icon'></span>"+'<span class="k-button-text">'+o.customColor+"</span>"+"</a>").appendTo(this.element)},resetColor:function(){this.colorPalette.value(null);this.flatColorPicker.value(null);this._change(null)},customColor:function(){this.dialog.open()}}),e=i.ui.Widget.extend({init:function(e,t){i.ui.Widget.call(this,e,t);this.element=e;this.color="#000";this.element.addClass("k-spreadsheet-border-palette");this._borderTypePalette();this._borderColorPalette();this.element.on("click",".k-spreadsheet-border-type-palette .k-button",r(this._click.bind(this)))},options:{name:"BorderPalette"},events:["change"],destroy:function(){this.colorChooser.destroy();this.element.off("click")},_borderTypePalette:function(){var t=s;var e=n.map(function(e){return'<a role="button" title="'+t[e]+'" aria-label="'+t[e]+'" href="#" data-border-type="'+e+'" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button">'+'<span class="k-button-icon k-icon k-i-'+i.toHyphens(e)+'"></span>'+"</a>"}).join("");var r=a("<div />",{class:"k-spreadsheet-border-type-palette",html:e});r.appendTo(this.element)},_borderColorPalette:function(){var e=a("<div />",{class:"k-spreadsheet-border-color-palette"});e.appendTo(this.element);this.colorChooser=new t(e,{color:this.color,change:this._colorChange.bind(this)})},_click:function(e){this.type=a(e.currentTarget).data("borderType");this.trigger("change",{type:this.type,color:this.color})},_colorChange:function(e){this.color=e.value;if(this.type)this.trigger("change",{type:this.type,color:this.color})}});i.spreadsheet.ColorChooser=t,i.spreadsheet.BorderPalette=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/toolbar.min",["../kendo.toolbar.min","../kendo.colorpicker.min","../kendo.combobox.min","../kendo.dropdownlist.min","../kendo.popup.min","./borderpalette.min"],function(){var u=window.kendo,o=u.jQuery,i=u.ui.ToolBar,l=u.spreadsheet.messages.toolbar={addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowAbove:"Add row above",addRowBelow:"Add row below",alignment:"Alignment",alignmentButtons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"},backgroundColor:"Background",bold:"Bold",borders:"Borders",copy:"Copy",cut:"Cut",deleteColumn:"Delete column",deleteRow:"Delete row",filter:"Filter",fontFamily:"Font",fontSize:"Font size",format:"Custom format...",formatTypes:{automatic:"Automatic",text:"Text",number:"Number",percent:"Percent",financial:"Financial",currency:"Currency",date:"Date",time:"Time",dateTime:"Date time",duration:"Duration",moreFormats:"More formats..."},formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",freeze:"Freeze panes",freezeButtons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"},insertComment:"Insert comment",insertImage:"Insert image",italic:"Italic",merge:"Merge cells",mergeButtons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"},open:"Open...",paste:"Paste",quickAccess:{redo:"Redo",undo:"Undo"},exportAs:"Export...",toggleGridlines:"Toggle gridlines",sort:"Sort",sortButtons:{sortRangeAsc:"Sort range A to Z",sortRangeDesc:"Sort range Z to A"},textColor:"Text Color",textWrap:"Wrap text",underline:"Underline",validation:"Data validation...",hyperlink:"Link"},e,f={open:{type:"open",overflow:"never",iconClass:"file-excel"},exportAs:{type:"exportAsDialog",dialogName:"exportAs",overflow:"never",text:"",iconClass:"file-excel"},bold:{type:"button",command:"PropertyChangeCommand",property:"bold",value:true,iconClass:"bold",togglable:true},italic:{type:"button",command:"PropertyChangeCommand",property:"italic",value:true,iconClass:"italic",togglable:true},underline:{type:"button",command:"PropertyChangeCommand",property:"underline",value:true,iconClass:"underline",togglable:true},formatDecreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:-1,iconClass:"decimal-decrease"},formatIncreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:+1,iconClass:"decimal-increase"},textWrap:{type:"button",command:"TextWrapCommand",property:"wrap",value:true,iconClass:"text-wrap",togglable:true},cut:{type:"button",command:"ToolbarCutCommand",iconClass:"cut"},copy:{type:"button",command:"ToolbarCopyCommand",iconClass:"copy"},paste:{type:"button",command:"ToolbarPasteCommand",iconClass:"paste"},separator:{type:"separator"},alignment:{type:"alignment",iconClass:"align-left"},backgroundColor:{type:"colorPicker",property:"background",iconClass:"paint"},textColor:{type:"colorPicker",property:"color",iconClass:"foreground-color"},fontFamily:{type:"fontFamily",property:"fontFamily",iconClass:"font-family"},fontSize:{type:"fontSize",property:"fontSize",iconClass:"font-size"},format:{type:"format",property:"format",iconClass:"custom-format"},filter:{type:"filter",property:"hasFilter",iconClass:"filter"},merge:{type:"merge",iconClass:"cells-merge"},freeze:{type:"freeze",iconClass:"pane-freeze"},borders:{type:"borders",iconClass:"borders-all"},formatCells:{type:"dialog",dialogName:"formatCells",overflow:"never"},hyperlink:{type:"dialog",dialogName:"hyperlink",iconClass:"link-horizontal",overflow:"never",text:""},toggleGridlines:{type:"button",command:"GridLinesChangeCommand",property:"gridLines",value:true,iconClass:"border-no",togglable:true},insertComment:{type:"dialog",dialogName:"insertComment",property:"comment",togglable:true,overflow:"never",iconClass:"comment",text:""},insertImage:{type:"dialog",dialogName:"insertImage",overflow:"never",iconClass:"image",text:""},addColumnLeft:{type:"button",command:"AddColumnCommand",value:"left",iconClass:"table-column-insert-left"},addColumnRight:{type:"button",command:"AddColumnCommand",value:"right",iconClass:"table-column-insert-right"},addRowBelow:{type:"button",command:"AddRowCommand",value:"below",iconClass:"table-row-insert-below"},addRowAbove:{type:"button",command:"AddRowCommand",value:"above",iconClass:"table-row-insert-above"},deleteColumn:{type:"button",command:"DeleteColumnCommand",iconClass:"table-column-delete"},deleteRow:{type:"button",command:"DeleteRowCommand",iconClass:"table-row-delete"},sort:{type:"sort",iconClass:"sort-desc"},validation:{type:"dialog",dialogName:"validation",iconClass:"exception",overflow:"never"}},d=i.extend({init:function(e,t){t.items=this._expandTools(t.tools||d.prototype.options.tools[t.toolbarName]);i.fn.init.call(this,e,t);var r=this._click.bind(this);this.element.addClass("k-spreadsheet-toolbar");this._addSeparators(this.element);var n=this;this.element.on("keydown",function(e){var t;if(e.keyCode===9){t=n._nextTool(e.shiftKey?-1:1);if(t){document.activeElement.blur();if(o(t).is(".k-upload-button"))o(t).addClass("k-focus");if(o(t).find("input").length)o(t).find("input").trigger("focus");else t.focus();e.preventDefault()}}});this.element.on("focusout",function(){o(this).find(".k-toolbar-first-visible").removeClass("k-focus")});this.bind({click:r,toggle:r})},_nextTool:function(e){var t=this;var r=t.element.find(".k-widget, .k-button, .k-button-group > a");var n=r.index(o(document.activeElement).closest(".k-widget, .k-button, .k-button-group > a"));if(n>0)return r[n+e]},_addSeparators:function(e){var t=e.children(".k-widget, a.k-button, .k-button-group");t.before("<span class='k-separator'></span>")},_expandTools:function(e){function s(e){var t=o.isPlainObject(e)?e:f[e]||{};var r="k-icon k-i-"+t.iconClass;var n=t.type;var i={button:{showText:"overflow"},colorPicker:{toolIcon:r,spriteCssClass:r},borders:{spriteCssClass:r},alignment:{spriteCssClass:r},merge:{spriteCssClass:r},freeze:{spriteCssClass:r}};var a=u.deepExtend({name:t.name||e,text:l[t.name||e],icon:t.iconClass,attributes:{title:l[t.name||e],"aria-label":l[t.name||e]}},i[n],t);if(n=="splitButton")a.menuButtons=a.menuButtons.map(s);if(a.name==="fontSize"||e==="fontSize")a.attributes["aria-label"]=null;a.attributes["data-tool"]=e;if(t.property)a.attributes["data-property"]=t.property;return a}return e.reduce(function(e,t){if(Array.isArray(t))e.push({type:"buttonGroup",buttons:t.map(s)});else e.push(s.call(this,t));return e},[])},_click:function(e){var t=e.target.attr("data-tool");var r=f[t]||{};var n=r.command;if(!n)return;var i={command:n,options:{property:r.property||null,value:r.value||null}};if(typeof i.options.value==="boolean")i.options.value=e.checked?true:null;this.action(i)},events:["click","toggle","open","close","overflowOpen","overflowClose","action","dialog"],options:{name:"SpreadsheetToolBar",resizable:true,tools:{home:["open","exportAs",["cut","copy","paste"],["bold","italic","underline"],"hyperlink","insertComment","insertImage","backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","freeze","filter","toggleGridlines"],insert:[["addColumnLeft","addColumnRight","addRowBelow","addRowAbove"],["deleteColumn","deleteRow"]],data:["sort","filter","validation"]}},action:function(e){this.trigger("action",e)},dialog:function(e){this.trigger("dialog",e)},refresh:function(e){var s=e;var t=this._tools();function r(e,t){var r=e.toolbar;var n=e.overflow;var i=r&&r.options.togglable||n&&n.options.togglable;if(!i)return;var a=false;if(typeof t==="boolean")a=t;else if(typeof t==="string")if(r.options.hasOwnProperty("value"))a=r.options.value===t;else a=t!=null;r.toggle(a);if(n)n.toggle(a)}function n(e,t){var r=e.toolbar;var n=e.overflow;var i,a;if(r&&r.update)r.update(t);if(n&&n.update)n.update(t);if(e.type=="filter"){i=s.sheet().selection();if(i&&i._ref&&i._ref.height){a=t||i._ref.height()>1;r.enable(a);n.enable(a)}}}for(var i=0;i<t.length;i++){var a=t[i].property;var o=t[i].tool;var l=u.isFunction(s[a])?s[a]():s;if(a=="gridLines")l=s.sheet().showGridLines();if(o.type==="button")r(o,l);else n(o,l)}this.resize()},_tools:function(){return this.element.find("[data-property]").toArray().map(function(e){e=o(e);return{property:e.attr("data-property"),tool:this._getItem(e)}}.bind(this))},destroy:function(){this.element.find("[data-command],.k-button").each(function(){var e=o(this);var t=e.data("instance");if(t&&t.destroy)t.destroy()});i.fn.destroy.call(this)}}),a=(u.spreadsheet.ToolBar=d,u.toolbar.Item.extend({init:function(e,t){var r=o("<select />").attr("title",e.attributes.title).attr("aria-label",e.attributes.title).kendoDropDownList({height:"auto"}).data("kendoDropDownList");this.dropDownList=r;this.element=r.wrapper;this.options=e;this.toolbar=t;this.attributes();this.addUidAttr();this.addOverflowAttr();r.bind("open",this._open.bind(this));r.bind("change",this._change.bind(this));this.element.width(e.width).attr({"data-command":"PropertyChangeCommand","data-property":e.property})},_open:function(){var e=this.dropDownList;var t=e.list;var r;t.css({whiteSpace:"nowrap",width:"auto"});r=t.width();if(r>0)r+=20;else r=e._listWidth;t.css("width",r+u.support.scrollbar());e._listWidth=r},_change:function(e){var t=this;var r=e.sender;var n=r.value();var i=r.dataItem();var a=i?i.popup:undefined;if(a)setTimeout(function(){t.toolbar.dialog({name:a})});else t.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:n=="null"?null:n}})},value:function(e){if(e!==undefined)this.dropDownList.value(e);else return this.dropDownList.value()}})),r=u.toolbar.Item.extend({init:function(e,t){this.element=o("<a role='button' href='#' class='k-button k-button-md k-rounded-md  k-button-rectangle k-button-solid k-button-solid-base'>"+"<span class='k-button-icon k-icon "+e.spriteCssClass+"'></span>"+"<span class='k-button-text'><span class='k-icon k-i-arrow-s'></span></span>"+"</a>");this.element.on("click touchend",this.open.bind(this)).attr("data-command",e.command);this.options=e;this.toolbar=t;this.attributes();this.addUidAttr();this.addOverflowAttr();this._popup()},destroy:function(){this.popup.destroy()},open:function(e){e.preventDefault();this.popup.toggle()},_popup:function(){var e=this.element;this.popup=o("<div class='k-spreadsheet-popup' />").appendTo(e).kendoPopup({anchor:e}).data("kendoPopup")}}),n=(u.toolbar.registerComponent("dialog",u.toolbar.ToolBarButton.extend({init:function(e,t){u.toolbar.ToolBarButton.fn.init.call(this,e,t);this._dialogName=e.dialogName;this.element.on("click touchend",this.open.bind(this)).data("instance",this)},open:function(){this.toolbar.dialog({name:this._dialogName})}})),u.toolbar.registerComponent("exportAsDialog",u.toolbar.Item.extend({init:function(e,t){this._dialogName=e.dialogName;this.toolbar=t;this._title=e.attributes.title;this.element=o("<button type='button' role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button'>"+"<span class='k-button-icon k-icon k-i-download'></span>"+"</button>").attr("title",this._title).attr("aria-label",this._title).data("instance",this);this.element.on("click",this.open.bind(this)).data("instance",this)},open:function(){this.toolbar.dialog({name:this._dialogName})}})),u.toolbar.OverflowButton.extend({init:function(e,t){u.toolbar.OverflowButton.fn.init.call(this,e,t);this.element.on("click touchend",this._click.bind(this));this.message=this.options.text;var r=this.element.data("button");this.element.data(this.options.type,r)},_click:o.noop})),t=r.extend({init:function(e,t){r.fn.init.call(this,e,t);this.popup.element.addClass("k-spreadsheet-colorpicker");this.colorChooser=new u.spreadsheet.ColorChooser(this.popup.element,{change:this._colorChange.bind(this)});this.element.attr({"data-property":e.property});this.element.data({type:"colorPicker",colorPicker:this,instance:this})},destroy:function(){this.colorChooser.destroy();r.fn.destroy.call(this)},update:function(e){this.value(e)},value:function(e){this.colorChooser.value(e)},_colorChange:function(e){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:e.sender.value()}});this.popup.close()}}),p=n.extend({init:function(e,t){e.iconName="text";n.fn.init.call(this,e,t)},_click:function(){this.toolbar.dialog({name:"colorPicker",options:{title:this.options.property,property:this.options.property}})}}),m=(u.toolbar.registerComponent("colorPicker",t,p),[8,9,10,11,12,13,14,16,18,20,22,24,26,28,36,48,72]),s=12,g=u.toolbar.Item.extend({init:function(e,t){var r=o("<input />").attr("aria-label",e.attributes.title).attr("title",e.attributes.title).kendoComboBox({change:this._valueChange.bind(this),clearButton:false,dataSource:e.fontSizes||m,value:s}).data("kendoComboBox");this.comboBox=r;this.element=r.wrapper;this.options=e;this.toolbar=t;this.attributes();this.addUidAttr();this.addOverflowAttr();this.element.width(e.width).attr({"data-command":"PropertyChangeCommand","data-property":e.property});this.element.data({type:"fontSize",fontSize:this})},_valueChange:function(e){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:u.parseInt(e.sender.value())}})},update:function(e){this.value(u.parseInt(e)||s)},value:function(e){if(e!==undefined)this.comboBox.value(e);else return this.comboBox.value()}}),v=n.extend({_click:function(){this.toolbar.dialog({name:"fontSize",options:{sizes:m,defaultSize:s}})},update:function(e){this._value=e||s;this.element.find(".k-button-text").text(this.message+" ("+this._value+") ...")}}),b=(u.toolbar.registerComponent("fontSize",g,v),["Arial","Courier New","Georgia","Times New Roman","Trebuchet MS","Verdana"]),c="Arial",w=a.extend({init:function(e,t){a.fn.init.call(this,e,t);var r=this.dropDownList;r.setDataSource(e.fontFamilies||b);r.value(c);this.element.data({type:"fontFamily",fontFamily:this})},update:function(e){this.value(e||c)}}),y=n.extend({_click:function(){this.toolbar.dialog({name:"fontFamily",options:{fonts:b,defaultFont:c}})},update:function(e){this._value=e||c;this.element.find(".k-button-text").text(this.message+" ("+this._value+") ...")}}),h=(u.toolbar.registerComponent("fontFamily",w,y),u.spreadsheet.formats={automatic:null,text:"@",number:"#,0.00",percent:"0.00%",financial:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',currency:"$#,##0.00;[Red]$#,##0.00",date:"m/d/yyyy",time:"h:mm:ss AM/PM",dateTime:"m/d/yyyy h:mm",duration:"[h]:mm:ss"}),_=a.extend({_revertTitle:function(e){e.sender.value("");e.sender.wrapper.width("auto")},init:function(e,t){a.fn.init.call(this,e,t);var r=this.dropDownList;var n="<span class='k-icon k-i-"+e.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>";r.bind("change",this._revertTitle.bind(this));r.bind("dataBound",this._revertTitle.bind(this));r.setOptions({dataValueField:"format",dataTextField:"name",dataValuePrimitive:true,valueTemplate:n,template:"# if (data.sample) { #"+"<span class='k-spreadsheet-sample'>#: data.sample #</span>"+"# } #"+"#: data.name #"});r.text(n);r.setDataSource([{format:h.automatic,name:l.formatTypes.automatic},{format:h.text,name:l.formatTypes.text},{format:h.number,name:l.formatTypes.number,sample:"1,499.99"},{format:h.percent,name:l.formatTypes.percent,sample:"14.50%"},{format:h.financial,name:l.formatTypes.financial,sample:"(1,000.12)"},{format:h.currency,name:l.formatTypes.currency,sample:"$1,499.99"},{format:h.date,name:l.formatTypes.date,sample:"4/21/2012"},{format:h.time,name:l.formatTypes.time,sample:"5:49:00 PM"},{format:h.dateTime,name:l.formatTypes.dateTime,sample:"4/21/2012 5:49:00"},{format:h.duration,name:l.formatTypes.duration,sample:"168:05:00"},{popup:"formatCells",name:l.formatTypes.moreFormats}]);this.element.data({type:"format",format:this});r.wrapper.find("[role='option']").attr("aria-label","Select format")}}),k=n.extend({_click:function(){this.toolbar.dialog({name:"formatCells"})}}),x=(u.toolbar.registerComponent("format",_,k),r.extend({init:function(e,t){r.fn.init.call(this,e,t);this._borderPalette();this.element.data({type:"borders",instance:this})},destroy:function(){this.borderPalette.destroy();r.fn.destroy.call(this)},_borderPalette:function(){var e=o("<div />").appendTo(this.popup.element);this.borderPalette=new u.spreadsheet.BorderPalette(e,{change:this._action.bind(this)})},_action:function(e){this.toolbar.action({command:"BorderChangeCommand",options:{border:e.type,style:{size:1,color:e.color}}})}})),C=n.extend({_click:function(){this.toolbar.dialog({name:"borders"})}}),F=(u.toolbar.registerComponent("borders",x,C),r.extend({init:function(e,t){r.fn.init.call(this,e,t);this.element.attr({"data-property":"alignment"});this._defineButtons();this._commandPalette();this.popup.element.on("click",".k-button",function(e){this._action(o(e.currentTarget))}.bind(this));this.element.data({type:"alignment",alignment:this,instance:this})},_defineButtons:function(){this.buttons=[{property:"textAlign",value:"left",iconClass:"align-left",text:l.alignmentButtons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"align-center",text:l.alignmentButtons.justifyCenter},{property:"textAlign",value:"right",iconClass:"align-right",text:l.alignmentButtons.justifyRight},{property:"textAlign",value:"justify",iconClass:"align-justify",text:l.alignmentButtons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:l.alignmentButtons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:l.alignmentButtons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:l.alignmentButtons.alignBottom}]},destroy:function(){this.popup.element.off();r.fn.destroy.call(this)},update:function(e){var t=e.textAlign();var r=e.verticalAlign();var n=this.popup.element;n.find(".k-button").removeClass("k-active");if(t)n.find("[data-property=textAlign][data-value="+t+"]").addClass("k-active");if(r)n.find("[data-property=verticalAlign][data-value="+r+"]").addClass("k-active")},_commandPalette:function(){var n=this.buttons;var i=o("<div />").appendTo(this.popup.element);n.forEach(function(e,t){var r="<a role='button' title='"+e.text+"' data-property='"+e.property+"' data-value='"+e.value+"' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button'>"+"<span class='k-button-icon k-icon k-i-"+e.iconClass+"'></span>"+"</a>";if(t!==0&&n[t-1].property!==e.property)i.append(o("<span class='k-separator' />"));i.append(r)})},_action:function(e){var t=e.attr("data-property");var r=e.attr("data-value");this.toolbar.action({command:"PropertyChangeCommand",options:{property:t,value:r}})}})),R=n.extend({_click:function(){this.toolbar.dialog({name:"alignment"})}}),S=(u.toolbar.registerComponent("alignment",F,R),r.extend({init:function(e,t){r.fn.init.call(this,e,t);this._defineButtons();this._commandPalette();this.popup.element.on("click",".k-button",function(e){this._action(o(e.currentTarget))}.bind(this));this.element.data({type:"merge",merge:this,instance:this})},_defineButtons:function(){this.buttons=[{value:"cells",iconClass:"cells-merge",text:l.mergeButtons.mergeCells},{value:"horizontally",iconClass:"cells-merge-horizontally",text:l.mergeButtons.mergeHorizontally},{value:"vertically",iconClass:"cells-merge-vertically",text:l.mergeButtons.mergeVertically},{value:"unmerge",iconClass:"table-unmerge",text:l.mergeButtons.unmerge}]},destroy:function(){this.popup.element.off();r.fn.destroy.call(this)},_commandPalette:function(){var r=o("<div />").appendTo(this.popup.element);this.buttons.forEach(function(e){var t="<a role='button' title='"+e.text+"' data-value='"+e.value+"' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'>"+"<span class='k-button-icon k-icon k-i-"+e.iconClass+"'></span>"+"<span class='k-button-text'>"+e.text+"</span>"+"</a>";r.append(t)})},_action:function(e){var t=e.attr("data-value");this.toolbar.action({command:"MergeCellCommand",options:{value:t}})}})),A=n.extend({_click:function(){this.toolbar.dialog({name:"merge"})}}),D=(u.toolbar.registerComponent("merge",S,A),r.extend({init:function(e,t){r.fn.init.call(this,e,t);this._defineButtons();this._commandPalette();this.popup.element.on("click",".k-button",function(e){this._action(o(e.currentTarget))}.bind(this));this.element.data({type:"freeze",freeze:this,instance:this})},_defineButtons:function(){this.buttons=[{value:"panes",iconClass:"pane-freeze",text:l.freezeButtons.freezePanes},{value:"rows",iconClass:"row-freeze",text:l.freezeButtons.freezeRows},{value:"columns",iconClass:"column-freeze",text:l.freezeButtons.freezeColumns},{value:"unfreeze",iconClass:"table-unmerge",text:l.freezeButtons.unfreeze}]},destroy:function(){this.popup.element.off();r.fn.destroy.call(this)},_commandPalette:function(){var r=o("<div />").appendTo(this.popup.element);this.buttons.forEach(function(e){var t="<a role='button' title='"+e.text+"' data-value='"+e.value+"' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'>"+"<span class='k-button-icon k-icon k-i-"+e.iconClass+"'></span>"+"<span class='k-button-text'>"+e.text+"</span>"+"</a>";r.append(t)})},_action:function(e){var t=e.attr("data-value");this.toolbar.action({command:"FreezePanesCommand",options:{value:t}})}})),E=n.extend({_click:function(){this.toolbar.dialog({name:"freeze"})}}),B=(u.toolbar.registerComponent("freeze",D,E),a.extend({_revertTitle:function(e){e.sender.wrapper.find('[role="option"]').attr("aria-label",e.sender.value());e.sender.value("");e.sender.wrapper.width("auto")},init:function(e,t){a.fn.init.call(this,e,t);var r=this.dropDownList;r.bind("change",this._revertTitle.bind(this));r.bind("dataBound",this._revertTitle.bind(this));r.setOptions({valueTemplate:"<span class='k-icon k-i-"+e.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"<span class='k-icon k-i-#= iconClass #' style='line-height: 1em; width: 1.35em;'></span>#=text#",dataTextField:"text",dataValueField:"value"});r.setDataSource([{value:"asc",sheet:false,text:l.sortButtons.sortRangeAsc,iconClass:"sort-asc"},{value:"desc",sheet:false,text:l.sortButtons.sortRangeDesc,iconClass:"sort-desc"}]);r.select(0);r.wrapper.find('[role="option"]').attr("aria-label","asc");this.element.data({type:"sort",sort:this})},_change:function(e){var t=e.sender;var r=t.dataItem();if(r)this.toolbar.action({command:"SortCommand",options:{value:r.value,sheet:r.sheet}})},value:o.noop})),M=n.extend({_click:function(){this.toolbar.dialog({name:"sort"})}}),T=(u.toolbar.registerComponent("sort",B,M),u.toolbar.ToolBarButton.extend({init:function(e,t){e.showText="overflow";u.toolbar.ToolBarButton.fn.init.call(this,e,t);this.element.on("click",this._click.bind(this));this.element.data({type:"filter",filter:this})},_click:function(){this.toolbar.action({command:"FilterCommand"})},update:function(e){this.toggle(e)}})),I=n.extend({init:function(e,t){n.fn.init.call(this,e,t);this.element.data({type:"filter",filter:this})},_click:function(){this.toolbar.action({command:"FilterCommand"})},update:function(e){this.toggle(e)}}),L=(u.toolbar.registerComponent("filter",T,I),u.toolbar.Item.extend({init:function(e,t){this.toolbar=t;this.element=o("<div class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-upload-button k-icon-button'>"+"<span class='k-button-icon k-icon k-i-folder-open'></span>"+"</div>").data("instance",this);this._title=e.attributes.title;this._reset()},_reset:function(){this.element.find("input").remove();o("<input type='file' autocomplete='off' accept='.xlsx'/>").attr("title",this._title).attr("aria-label",this._title).one("change",this._change.bind(this)).appendTo(this.element)},_change:function(e){this.toolbar.action({command:"OpenCommand",options:{file:e.target.files[0]}});this._reset()}}));u.toolbar.registerComponent("open",L),u.spreadsheet.TabStrip=u.ui.TabStrip.extend({init:function(e,r){u.ui.TabStrip.fn.init.call(this,e,r);e.addClass("k-spreadsheet-tabstrip");this._quickAccessButtons();this.toolbars={};var n=r.dataSource;this.contentElements.each(function(e,t){this._toolbar(o(t),n[e].id,r.toolbarOptions[n[e].id])}.bind(this));this.one("activate",function(){this.toolbars[this.options.dataSource[0].id].resize()})},events:u.ui.TabStrip.fn.events.concat(["action","dialog"]),destroy:function(){this.quickAccessToolBar.off("click");u.ui.TabStrip.fn.destroy.call(this);for(var e in this.toolbars)this.toolbars[e].destroy()},action:function(e){this.trigger("action",e)},dialog:function(e){this.trigger("dialog",e)},refreshTools:function(e){var t=this.toolbars;for(var r in t)if(t.hasOwnProperty(r))t[r].refresh(e)},_quickAccessButtons:function(){var e=[{title:l.quickAccess.undo,iconClass:"undo",action:"undo"},{title:l.quickAccess.redo,iconClass:"redo",action:"redo"}];var t=u.template("<a role='button' href='\\#' title='#= title #' data-action='#= action #' class='k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button' aria-label='#= title #'><span class='k-button-icon k-icon k-i-#=iconClass#'></span></a>");this.quickAccessToolBar=o("<div />",{class:"k-spreadsheet-quick-access-toolbar",html:u.render(t,e)}).insertBefore(this.wrapper);this.quickAccessToolBar.on("click",".k-button",function(e){e.preventDefault();var t=o(e.currentTarget).attr("data-action");this.action({action:t})}.bind(this));this.quickAccessAdjust()},quickAccessAdjust:function(){this.tabGroup.css("padding-left",u._outerWidth(this.quickAccessToolBar))},_toolbar:function(e,t,r){var n;var i;if(this.toolbars[t]){this.toolbars[t].destroy();e.children(".k-toolbar").remove()}if(r){n=e.html("<div></div>").children("div");i={tools:typeof r==="boolean"?undefined:r,toolbarName:t,action:this.action.bind(this),dialog:this.dialog.bind(this)};this.toolbars[t]=new u.spreadsheet.ToolBar(n,i)}}})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/dialogs.min",["../kendo.core.min","../kendo.binder.min","../kendo.validator.min"],function(){var s=window.kendo,a=s.jQuery,t=s.data.ObservableObject,n=s.spreadsheet.messages.dialogs={apply:"Apply",save:"Save",cancel:"Cancel",remove:"Remove",retry:"Retry",revert:"Revert",okText:"OK",formatCellsDialog:{title:"Format",categories:{number:"Number",currency:"Currency",date:"Date"}},fontFamilyDialog:{title:"Font"},fontSizeDialog:{title:"Font size"},bordersDialog:{title:"Borders"},alignmentDialog:{title:"Alignment",buttons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"}},mergeDialog:{title:"Merge cells",buttons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"}},freezeDialog:{title:"Freeze panes",buttons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"}},confirmationDialog:{text:"Are you sure you want to remove this sheet?",title:"Sheet remove"},validationDialog:{title:"Data Validation",hintMessage:"Please enter a valid {0} value {1}.",hintTitle:"Validation {0}",criteria:{any:"Any value",number:"Number",text:"Text",date:"Date",custom:"Custom Formula",list:"List"},comparers:{greaterThan:"greater than",lessThan:"less than",between:"between",notBetween:"not between",equalTo:"equal to",notEqualTo:"not equal to",greaterThanOrEqualTo:"greater than or equal to",lessThanOrEqualTo:"less than or equal to"},comparerMessages:{greaterThan:"greater than {0}",lessThan:"less than {0}",between:"between {0} and {1}",notBetween:"not between {0} and {1}",equalTo:"equal to {0}",notEqualTo:"not equal to {0}",greaterThanOrEqualTo:"greater than or equal to {0}",lessThanOrEqualTo:"less than or equal to {0}",custom:"that satisfies the formula: {0}"},labels:{criteria:"Criteria",comparer:"Comparer",min:"Min",max:"Max",value:"Value",start:"Start",end:"End",onInvalidData:"On invalid data",rejectInput:"Reject input",showWarning:"Show warning",showHint:"Show hint",hintTitle:"Hint title",hintMessage:"Hint message",ignoreBlank:"Ignore blank",showListButton:"Display button to show list",showCalendarButton:"Display button to show calendar"},placeholders:{typeTitle:"Type title",typeMessage:"Type message"}},exportAsDialog:{title:"Export...",defaultFileName:"Workbook",xlsx:{description:"Excel Workbook (.xlsx)"},pdf:{description:"Portable Document Format (.pdf)",area:{workbook:"Entire Workbook",sheet:"Active Sheet",selection:"Selection"},paper:{a2:"A2 (420 mm × 594 mm)",a3:"A3 (297 mm x 420 mm)",a4:"A4 (210 mm x 297 mm)",a5:"A5 (148 mm x 210 mm)",b3:"B3 (353 mm × 500 mm)",b4:"B4 (250 mm x 353 mm)",b5:"B5 (176 mm x 250 mm)",folio:'Folio (8.5" x 13")',legal:'Legal (8.5" x 14")',letter:'Letter (8.5" x 11")',tabloid:'Tabloid (11" x 17")',executive:'Executive (7.25" x 10.5")'},margin:{normal:"Normal",narrow:"Narrow",wide:"Wide"}},labels:{scale:"Scale",fit:"Fit to page",fileName:"File name",saveAsType:"Save as type",exportArea:"Export",paperSize:"Paper size",margins:"Margins",orientation:"Orientation",print:"Print",guidelines:"Guidelines",center:"Center",horizontally:"Horizontally",vertically:"Vertically"}},modifyMergedDialog:{errorMessage:"Cannot change part of a merged cell."},rangeDisabledDialog:{errorMessage:"Destination range contains disabled cells."},intersectsArrayDialog:{errorMessage:"You cannot alter part of an array"},incompatibleRangesDialog:{errorMessage:"Incompatible ranges"},noFillDirectionDialog:{errorMessage:"Cannot determine fill direction"},duplicateSheetNameDialog:{errorMessage:"Duplicate sheet name"},overflowDialog:{errorMessage:"Cannot paste, because the copy area and the paste area are not the same size and shape."},useKeyboardDialog:{title:"Copying and pasting",errorMessage:"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:",labels:{forCopy:"for copy",forCut:"for cut",forPaste:"for paste"}},unsupportedSelectionDialog:{errorMessage:"That action cannot be performed on multiple selection."},linkDialog:{title:"Hyperlink",labels:{text:"Text",url:"Address",removeLink:"Remove link"}},insertCommentDialog:{title:"Insert comment",labels:{comment:"Comment",removeComment:"Remove comment"}},insertImageDialog:{title:"Insert image",info:"Drag an image here, or click to select",typeError:"Please select a JPEG, PNG or GIF image"}},c={},o=(s.spreadsheet.dialogs={register:function(e,t){c[e]=t},registered:function(e){return!!c[e]},create:function(e,t){var r=c[e];if(r)return new r(t)}},s.spreadsheet.SpreadsheetDialog=s.Observable.extend({init:function(e){s.Observable.fn.init.call(this,e);this.options=I(a.extend(true,{},this.options,e));this.bind(this.events,e)},events:["close","activate"],options:{autoFocus:true},dialog:function(){if(!this._dialog){var e={autoFocus:false,scrollable:false,resizable:false,modal:true,visible:false,width:this.options.width||320,title:this.options.title,open:function(){this.center()},close:this._onDialogClose.bind(this),activate:this._onDialogActivate.bind(this),deactivate:this._onDialogDeactivate.bind(this)};this._dialog=a("<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />").addClass(this.options.className||"").append(s.template(this.options.template)({messages:s.spreadsheet.messages.dialogs||n,ns:s.ns,errors:this.options.errors})).kendoWindow(e).data("kendoWindow")}return this._dialog},_onDialogClose:function(){this.trigger("close",{action:this._action})},_onDialogActivate:function(){this.trigger("activate")},_onDialogDeactivate:function(){this.trigger("deactivate");this.destroy()},destroy:function(){if(this._dialog){this._dialog.destroy();this._dialog=null}},open:function(){this.dialog().open();this.dialog().element.find(".k-button-solid-primary").trigger("focus")},apply:function(){this.close()},close:function(){this._action="close";this.dialog().close()}}));function h(e,t){return s.spreadsheet.formatting.text(e,t)}var l=s.spreadsheet.FormatCellsViewModel=t.extend({init:function(e){t.fn.init.call(this,e);this.useCategory(this.category)},useCategory:function(e){var t=e&&e.type||"number";var r=t=="currency";this.category=e;this.set("showCurrencyFilter",r&&this.currencies.length>1);if(!r)this.set("formats",this.allFormats[t+"Formats"]);else this.currency(this.currencies[0]);this.useFirstFormat()},useFirstFormat:function(){if(this.formats.length)this.set("format",this.formats[0].value)},currency:function(e){if(e!==undefined){this._currency=e;var t=e.value;var r=[{currency:t,decimals:true},{currency:t,decimals:true,iso:true},{currency:t,decimals:false}];r=r.map(function(e){e=l.convert.currency(e);return{value:e,name:h(1e3,e)}});this.set("formats",r);this.useFirstFormat()}return this._currency||this.currencies[0]},categoryFilter:function(e){if(e!==undefined)this.useCategory(e);return this.category},preview:function(){var e=this.get("format");var t=this.value||0;if(e&&e.length)return h(t,e);else return t}});function f(e,t){var r=[];var n=[];for(var i=0;i<t.length;i++)if(a.inArray(t[i][e],n)==-1){r.push(t[i]);n.push(t[i][e])}return r}l.convert={currency:function(e){function t(e,t){return new Array(t+1).join(e)}var r=e.currency;var n=r.pattern[1];if(e.decimals)n=n.replace(/n/g,"n"+r["."]+t("0",r.decimals));if(e.iso)n='"'+r.abbr+'" '+n.replace(/\s*\$\s*/g,"");else n=n.replace(/\$/g,JSON.stringify(r.symbol));n=n.replace(/n/g,"?");return n},date:function(e){if(/T|Z/.test(e))return"";return e.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"')}};var r=o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.formatCellsDialog||n;var r={title:t.title,categories:[{type:"number",name:t.categories.number},{type:"currency",name:t.categories.currency},{type:"date",name:t.categories.date}]};o.fn.init.call(this,a.extend(r,e));this._generateFormats()},options:{className:"k-spreadsheet-format-cells",template:"<div class='k-edit-form-container'>"+"<div class='k-root-tabs' data-#:ns#role='tabstrip' "+"data-#:ns#text-field='name' "+"data-#:ns#bind='source: categories, value: categoryFilter' "+"data-#:ns#animation='false'></div>"+"<div class='k-spreadsheet-preview' data-#:ns#bind='text: preview'></div>"+"<script type='text/x-kendo-template' id='format-item-template'>"+"\\#: data.name \\#"+"<\/script>"+"<select data-#:ns#role='dropdownlist' class='k-format-filter' "+"data-#:ns#text-field='description' "+"data-#:ns#value-field='value.name' "+"data-#:ns#bind='visible: showCurrencyFilter, value: currency, source: currencies'></select>"+"<ul data-#:ns#role='staticlist' tabindex='0' "+"id='formats-list' "+"aria-label='formats list' "+"class='k-list k-reset' "+"data-#:ns#template='format-item-template' "+"data-#:ns#value-primitive='true' "+"data-#:ns#value-field='value' "+"data-#:ns#bind='source: formats, value: format'></ul>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>"+"</div>"+"</div>"},_generateFormats:function(){var e=this.options;if(!e.currencies)e.currencies=r.currenciesFrom(s.cultures);if(!e.numberFormats)e.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}];if(!e.dateFormats){var t=s.cultures.current.calendars.standard.patterns;e.dateFormats=f("value",a.map(t,function(e){e=l.convert.date(e);if(!e)return;return{value:e,name:h(34567.7678,e)}}))}},open:function(e){var t=this.options;var r=e.value();var n=t.categories.slice(0);var i;this.viewModel=new l({currencies:t.currencies.slice(0),allFormats:{numberFormats:t.numberFormats.slice(0),dateFormats:t.dateFormats.slice(0)},categories:n,format:e.format(),category:r instanceof Date?n[2]:n[0],apply:this.apply.bind(this),close:this.close.bind(this),value:r});o.fn.open.call(this);i=this.dialog().element;s.bind(i,this.viewModel);var a=i.find("select.k-format-filter").data("kendoDropDownList");if(t.currencies.length>10)a.setOptions({filter:"contains"});i.find(s.roleSelector("staticlist")).parent().addClass("k-list-wrapper");i.find(".k-tabstrip-item").attr("aria-controls","formats-list")},apply:function(){var e=this.viewModel.format;o.fn.apply.call(this);this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:e}})}}),i=(r.currenciesFrom=function(e){return f("description",a.map(e,function(e,t){if(!/-/.test(t))return;var r=e.numberFormat.currency;var n=s.format("{0} ({1}, {2})",r.name,r.abbr,r.symbol);return{description:n,value:r}}))},s.spreadsheet.dialogs.register("formatCells",r),s.spreadsheet.dialogs.FormatCellsDialog=r,o.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>"+"<span class='k-button-text'>#= messages.okText #</span>"+"</button>"+"</div>"},open:function(){o.fn.open.call(this);var e=this.options;var t=e.text;if(e.messageId)t=s.getter(e.messageId,true)(s.spreadsheet.messages.dialogs);s.bind(this.dialog().element,{text:t,close:this.close.bind(this)})}})),d=(s.spreadsheet.dialogs.register("message",i),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.confirmationDialog||n;var r={title:t.title,text:t.text};o.fn.init.call(this,a.extend(r,e))},options:{className:"k-spreadsheet-message",messageId:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: confirm'>"+"<span class='k-button-text'>#= messages.okText #</span>"+"</button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>"+"<span class='k-button-text'>#= messages.cancel #</span>"+"</button>"+"</div>"},open:function(){o.fn.open.call(this);var e=this.options;var t=e.text;if(e.messageId)t=s.getter(e.messageId,true)(s.spreadsheet.messages.dialogs);s.bind(this.dialog().element,{text:t,confirm:this.confirm.bind(this),cancel:this.close.bind(this)})},isConfirmed:function(){return this._confirmed},confirm:function(){this._confirmed=true;this.close()}})),p=(s.spreadsheet.dialogs.register("confirmation",d),o.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: retry'>"+"<span class='k-button-text'>#= messages.retry #</span>"+"</button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>"+"<span class='k-button-text'>#= messages.cancel #</span>"+"</button>"+"</div>"},open:function(){o.fn.open.call(this);var e=this.options;var t=e.text;if(e.messageId)t=s.getter(e.messageId,true)(s.spreadsheet.messages.dialogs);s.bind(this.dialog().element,{text:t,retry:this.retry.bind(this),cancel:this.close.bind(this)})},retry:function(){this._retry=true;this.close()}})),m=(s.spreadsheet.dialogs.register("validationError",p),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.fontFamilyDialog||n;o.fn.init.call(this,a.extend({title:t.title},e));this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var e=this.dialog().element.find("ul");var t=this.options.fonts;var r=this.options.defaultFont;this.list=new s.ui.StaticList(e,{dataSource:new s.data.DataSource({data:t}),template:"#: data #",value:r,change:this.apply.bind(this)});this.list.dataSource.fetch()},apply:function(e){o.fn.apply.call(this);this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:e.sender.value()[0]}})}})),g=(s.spreadsheet.dialogs.register("fontFamily",m),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.fontSizeDialog||n;o.fn.init.call(this,a.extend({title:t.title},e));this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var e=this.dialog().element.find("ul");var t=this.options.sizes;var r=this.options.defaultSize;this.list=new s.ui.StaticList(e,{dataSource:new s.data.DataSource({data:t}),template:"#: data #",value:r,change:this.apply.bind(this)});this.list.dataSource.fetch()},apply:function(e){o.fn.apply.call(this);this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:s.parseInt(e.sender.value()[0])}})}})),v=(s.spreadsheet.dialogs.register("fontSize",g),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.bordersDialog||n;o.fn.init.call(this,a.extend({title:t.title},e));this.element=this.dialog().element;this._borderPalette();this.viewModel=s.observable({apply:this.apply.bind(this),close:this.close.bind(this)});s.bind(this.element.find(".k-action-buttons"),this.viewModel)},options:{width:177,template:"<div></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>"+"</div>"},apply:function(){o.fn.apply.call(this);var e=this.value();this.trigger("action",{command:"BorderChangeCommand",options:{border:e.type,style:{size:1,color:e.color}}})},_borderPalette:function(){var e=this.dialog().element.find("div").first();this.borderPalette=new s.spreadsheet.BorderPalette(e,{change:this.value.bind(this)})},value:function(e){if(e===undefined)return this._state;else this._state=e}})),b=(s.spreadsheet.dialogs.register("borders",v),o.extend({init:function(e){o.fn.init.call(this,e);this.element=this.dialog().element;this.property=e.property;this.options.title=e.title;this.viewModel=s.observable({apply:this.apply.bind(this),close:this.close.bind(this)});s.bind(this.element.find(".k-action-buttons"),this.viewModel)},options:{template:"<div></div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>"+"</div>"},apply:function(){o.fn.apply.call(this);this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}})},value:function(e){if(e===undefined)return this._value;else this._value=e.value}})),w=b.extend({init:function(e){e.width=177;b.fn.init.call(this,e);this._colorPalette()},_colorPalette:function(){var e=this.dialog().element.find("div").first();this.colorPalette=e.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette")}}),y=(s.spreadsheet.dialogs.register("colorPicker",w),b.extend({init:function(e){e.width=268;b.fn.init.call(this,e);this.dialog().setOptions({animation:false});this.dialog().one("activate",this._colorPicker.bind(this))},_colorPicker:function(){var e=this.dialog().element.find("div").first();this.colorPicker=e.kendoFlatColorPicker({change:this.value.bind(this)}).data("kendoFlatColorPicker")}})),_=(s.spreadsheet.dialogs.register("customColor",y),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.alignmentDialog||n;var r={title:t.title,buttons:[{property:"textAlign",value:"left",iconClass:"align-left",text:t.buttons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"align-center",text:t.buttons.justifyCenter},{property:"textAlign",value:"right",iconClass:"align-right",text:t.buttons.justifyRight},{property:"textAlign",value:"justify",iconClass:"align-justify",text:t.buttons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:t.buttons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:t.buttons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:t.buttons.alignBottom}]};o.fn.init.call(this,a.extend(r,e));this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var e=this.dialog().element.find("ul");this.list=new s.ui.StaticList(e,{dataSource:new s.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-property='#=property#' data-value='#=value#'>"+"<span class='k-icon k-i-#=iconClass#'></span>"+"#=text#"+"</a>",change:this.apply.bind(this)});this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];o.fn.apply.call(this);this.trigger("action",{command:"PropertyChangeCommand",options:{property:t.property,value:t.value}})}})),k=(s.spreadsheet.dialogs.register("alignment",_),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.mergeDialog||n;var r={title:t.title,buttons:[{value:"cells",iconClass:"cells-merge",text:t.buttons.mergeCells},{value:"horizontally",iconClass:"cells-merge-horizontally",text:t.buttons.mergeHorizontally},{value:"vertically",iconClass:"cells-merge-vertically",text:t.buttons.mergeVertically},{value:"unmerge",iconClass:"table-unmerge",text:t.buttons.unmerge}]};o.fn.init.call(this,a.extend(r,e));this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var e=this.dialog().element.find("ul");this.list=new s.ui.StaticList(e,{dataSource:new s.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-value='#=value#'>"+"<span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#"+"</a>",change:this.apply.bind(this)});this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];o.fn.apply.call(this);this.trigger("action",{command:"MergeCellCommand",options:{value:t.value}})}})),x=(s.spreadsheet.dialogs.register("merge",k),o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.freezeDialog||n;var r={title:t.title,buttons:[{value:"panes",iconClass:"pane-freeze",text:t.buttons.freezePanes},{value:"rows",iconClass:"row-freeze",text:t.buttons.freezeRows},{value:"columns",iconClass:"column-freeze",text:t.buttons.freezeColumns},{value:"unfreeze",iconClass:"table-unmerge",text:t.buttons.unfreeze}]};o.fn.init.call(this,a.extend(r,e));this._list()},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var e=this.dialog().element.find("ul");this.list=new s.ui.StaticList(e,{dataSource:new s.data.DataSource({data:this.options.buttons}),template:"<a role='button' title='#=text#' data-value='#=value#'>"+"<span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#"+"</a>",change:this.apply.bind(this)});this.list.dataSource.fetch()},apply:function(e){var t=e.sender.value()[0];o.fn.apply.call(this);this.trigger("action",{command:"FreezePanesCommand",options:{value:t.value}})}})),C=(s.spreadsheet.dialogs.register("freeze",x),s.spreadsheet.ValidationCellsViewModel=t.extend({init:function(e){t.fn.init.call(this,e);this.bind("change",function(e){if(e.field==="criterion"){this.reset();if(this.criterion==="custom"||this.criterion==="list")this.setHintMessageTemplate()}if(e.field==="comparer")this.setHintMessageTemplate();if((e.field=="hintMessage"||e.field=="hintTitle")&&!this._mute)this.shouldBuild=false;if((e.field=="from"||e.field=="to"||e.field=="hintMessageTemplate"||e.field=="type")&&this.shouldBuild)this.buildMessages()}.bind(this));this.reset()},buildMessages:function(){this._mute=true;this.set("hintTitle",this.hintTitleTemplate?s.format(this.hintTitleTemplate,this.type):"");this.set("hintMessage",this.hintMessageTemplate?s.format(this.hintMessageTemplate,this.from,this.to):"");this._mute=false},reset:function(){this.setComparers();this.set("comparer",this.comparers[0].type);this.set("from",null);this.set("to",null);this.set("useCustomMessages",false);this.shouldBuild=true;this.hintTitleTemplate=this.defaultHintTitle;this.buildMessages()},setComparers:function(){var e=this.defaultComparers;var t=[];if(this.criterion==="text"){var r=["equalTo","notEqualTo"];for(var n=0;n<e.length;n++)if(r[0]==e[n].type){t.push(e[n]);r.shift()}}else t=e.slice();this.set("comparers",t)},setHintMessageTemplate:function(){if(this.criterion!=="custom"&&this.criterion!=="list")this.set("hintMessageTemplate",s.format(this.defaultHintMessage,this.criterion,this.comparerMessages[this.comparer]));else{this.set("hintMessageTemplate","");this.set("hintMessage","")}},isAny:function(){return this.get("criterion")==="any"},isNumber:function(){return this.get("criterion")==="number"},showToForNumber:function(){return this.showTo()&&this.isNumber()},showToForDate:function(){return this.showTo()&&this.isDate()},isText:function(){return this.get("criterion")==="text"},isDate:function(){return this.get("criterion")==="date"},isList:function(){return this.get("criterion")==="list"},isCustom:function(){return this.get("criterion")==="custom"},showRemove:function(){return this.get("hasValidation")},showTo:function(){return this.get("comparer")=="between"||this.get("comparer")=="notBetween"},update:function(e){this.set("hasValidation",!!e);if(e)this.fromValidationObject(e)},fromValidationObject:function(e){this.set("criterion",e.dataType);this.set("comparer",e.comparerType);this.set("from",e.from);this.set("to",e.to);this.set("type",e.type);this.set("ignoreBlank",e.allowNulls);this.set("showButton",e.showButton);if(e.messageTemplate||e.titleTemplate){this.hintMessageTemplate=e.messageTemplate;this.hintMessage=e.messageTemplate;this.hintTitleTemplate=e.titleTemplate;this.hintTitle=e.titleTemplate;this.useCustomMessages=true;this.buildMessages()}else this.useCustomMessages=false},toValidationObject:function(){if(this.criterion==="any")return null;var e={type:this.type,dataType:this.criterion,comparerType:this.comparer,from:this.from,to:this.to,allowNulls:this.ignoreBlank,showButton:this.showButton};if(this.useCustomMessages){e.messageTemplate=this.shouldBuild?this.hintMessageTemplate:this.hintMessage;e.titleTemplate=this.hintTitle}return e}})),F=o.extend({init:function(e){var t=s.spreadsheet.messages.dialogs.validationDialog||n;var r={title:t.title,hintMessage:t.hintMessage,hintTitle:t.hintTitle,criteria:[{type:"any",name:t.criteria.any},{type:"number",name:t.criteria.number},{type:"text",name:t.criteria.text},{type:"date",name:t.criteria.date},{type:"custom",name:t.criteria.custom},{type:"list",name:t.criteria.list}],comparers:[{type:"greaterThan",name:t.comparers.greaterThan},{type:"lessThan",name:t.comparers.lessThan},{type:"between",name:t.comparers.between},{type:"notBetween",name:t.comparers.notBetween},{type:"equalTo",name:t.comparers.equalTo},{type:"notEqualTo",name:t.comparers.notEqualTo},{type:"greaterThanOrEqualTo",name:t.comparers.greaterThanOrEqualTo},{type:"lessThanOrEqualTo",name:t.comparers.lessThanOrEqualTo}],comparerMessages:t.comparerMessages};o.fn.init.call(this,a.extend(r,e))},options:{width:450,criterion:"any",type:"reject",ignoreBlank:true,showButton:true,useCustomMessages:false,errorTemplate:'<div class="k-tooltip k-tooltip-error k-validator-tooltip">'+'<span class="k-tooltip-icon k-icon k-i-warning"></span>'+'<span class="k-tooltip-content">#= message #</span>'+'<span class="k-callout k-callout-n"></span>'+"</div>",template:'<div class="k-edit-form-container">'+'<div class="k-edit-label"><label for="criteria">#: messages.validationDialog.labels.criteria #:</label></div>'+'<div class="k-edit-field">'+'<select id="criteria" data-#:ns#role="dropdownlist" '+'title="#: messages.validationDialog.labels.criteria #"'+'data-#:ns#text-field="name" '+'data-#:ns#value-field="type" '+'data-#:ns#bind="value: criterion, source: criteria"></select>'+"</div>"+'<div data-#:ns#bind="visible: isNumber">'+'<div class="k-edit-label"><label for="number-comparer">#: messages.validationDialog.labels.comparer #:</label></div>'+'<div class="k-edit-field">'+'<select id="number-comparer" data-#:ns#role="dropdownlist" '+'title="#: messages.validationDialog.labels.comparer #"'+'data-#:ns#text-field="name" '+'data-#:ns#value-field="type" '+'data-#:ns#bind="value: comparer, source: comparers"></select>'+"</div>"+'<div class="k-edit-label"><label for="comparer-min">#: messages.validationDialog.labels.min #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="comparer-min" name="#: messages.validationDialog.labels.min #" title="#: messages.validationDialog.labels.min #" placeholder="e.g. 10" class="k-input-inner" data-#:ns#bind="value: from, enabled: isNumber" required="required" /></span>'+"</div>"+'<div data-#:ns#bind="visible: showTo">'+'<div class="k-edit-label"><label for="comparer-max">#: messages.validationDialog.labels.max #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="comparer-max" name="#: messages.validationDialog.labels.max #" title="#: messages.validationDialog.labels.max #" placeholder="e.g. 100" class="k-input-inner" data-#:ns#bind="value: to, enabled: showToForNumber" required="required" /></span>'+"</div>"+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isText">'+'<div class="k-edit-label"><label for="text-comparer">#: messages.validationDialog.labels.comparer #:</label></div>'+'<div class="k-edit-field">'+'<select id="text-comparer" data-#:ns#role="dropdownlist" '+'title="#: messages.validationDialog.labels.comparer #"'+'data-#:ns#text-field="name" '+'data-#:ns#value-field="type" '+'data-#:ns#bind="value: comparer, source: comparers"></select>'+"</div>"+'<div class="k-edit-label"><label for="text-comparer-value">#: messages.validationDialog.labels.value #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="text-comparer-value" name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isText" required="required" /></span>'+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isDate">'+'<div class="k-edit-label"><label for="date-comparer">#: messages.validationDialog.labels.comparer #:</label></div>'+'<div class="k-edit-field">'+'<select id="date-comparer" data-#:ns#role="dropdownlist" '+'title="#: messages.validationDialog.labels.comparer #"'+'data-#:ns#text-field="name" '+'data-#:ns#value-field="type" '+'data-#:ns#bind="value: comparer, source: comparers"></select>'+"</div>"+'<div class="k-edit-label"><label for="date-comparer-start">#: messages.validationDialog.labels.start #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="date-comparer-start" name="#: messages.validationDialog.labels.start #" title="#: messages.validationDialog.labels.start #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isDate" required="required" /></span>'+"</div>"+'<div data-#:ns#bind="visible: showTo">'+'<div class="k-edit-label"><label for="date-comparer-end">#: messages.validationDialog.labels.end #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="date-comparer-end" name="#: messages.validationDialog.labels.end #" title="#: messages.validationDialog.labels.end #" class="k-input-inner" data-#:ns#bind="value: to, enabled: showToForDate" required="required" /></span>'+"</div>"+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isCustom">'+'<div class="k-edit-label"><label for="custom-comparer-value">#: messages.validationDialog.labels.value #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="custom-comparer-value" name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isCustom" required="required" /></span>'+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isList">'+'<div class="k-edit-label"><label for="list-comparer-value">#: messages.validationDialog.labels.value #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="list-comparer-value" name="#: messages.validationDialog.labels.value #" title="#: messages.validationDialog.labels.value #" class="k-input-inner" data-#:ns#bind="value: from, enabled: isList" required="required" /></span>'+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isList">'+'<div class="k-edit-field">'+'<input type="checkbox" name="showButton" id="listShowButton" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: showButton"/>'+'<label for="listShowButton" class="k-checkbox-label">'+" #: messages.validationDialog.labels.showListButton #"+"</label>"+"</div>"+"</div>"+'<div data-#:ns#bind="visible: isDate">'+'<div class="k-edit-field">'+'<input type="checkbox" name="showButton" id="dateShowButton" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: showButton"/>'+'<label for="dateShowButton" class="k-checkbox-label">'+" #: messages.validationDialog.labels.showCalendarButton #"+"</label>"+"</div>"+"</div>"+'<div data-#:ns#bind="invisible: isAny">'+'<div class="k-edit-field">'+'<input type="checkbox" title="#: messages.validationDialog.labels.ignoreBlank #" name="ignoreBlank" id="ignoreBlank" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: ignoreBlank"/>'+'<label for="ignoreBlank" class="k-checkbox-label">'+" #: messages.validationDialog.labels.ignoreBlank #"+"</label>"+"</div>"+"</div>"+'<div data-#:ns#bind="invisible: isAny">'+'<div class="k-hr"></div>'+'<div class="k-edit-label"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>'+'<div class="k-edit-field">'+'<input type="radio" title="#: messages.validationDialog.labels.rejectInput #" id="validationTypeReject" name="validationType" value="reject" data-#:ns#bind="checked: type" class="k-radio k-radio-md" />'+'<label for="validationTypeReject" class="k-radio-label">'+"#: messages.validationDialog.labels.rejectInput #"+"</label> "+'<input type="radio" title="#: messages.validationDialog.labels.showWarning #" id="validationTypeWarning"  name="validationType" value="warning" data-#:ns#bind="checked: type" class="k-radio k-radio-md" />'+'<label for="validationTypeWarning" class="k-radio-label">'+"#: messages.validationDialog.labels.showWarning #"+"</label>"+"</div>"+"</div>"+'<div data-#:ns#bind="invisible: isAny" class="hint-wrapper">'+'<div class="k-edit-field">'+'<input type="checkbox" title="#: messages.validationDialog.labels.showHint #" name="useCustomMessages" id="useCustomMessages" class="k-checkbox k-checkbox-md k-rounded-md" data-#:ns#bind="checked: useCustomMessages" />'+'<label class="k-checkbox-label" for="useCustomMessages">'+" #: messages.validationDialog.labels.showHint #"+"</label>"+"</div>"+'<div data-#:ns#bind="visible: useCustomMessages">'+'<div class="k-edit-label"><label for="hint-title">#: messages.validationDialog.labels.hintTitle #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="hint-title" name="hint-title" class="k-input-inner" title="#: messages.validationDialog.labels.hintTitle #" placeholder="#: messages.validationDialog.placeholders.typeTitle #" data-#:ns#bind="value: hintTitle" /></span>'+"</div>"+'<div class="k-edit-label"><label for="hint-message">#: messages.validationDialog.labels.hintMessage #:</label></div>'+'<div class="k-edit-field">'+'<span class="k-textbox k-input k-input-md k-rounded-md k-input-solid"><input id="hint-message" class="k-input-inner" title="#: messages.validationDialog.labels.hintMessage #" placeholder="#: messages.validationDialog.placeholders.typeMessage #" data-#:ns#bind="value: hintMessage" /></span>'+"</div>"+"</div>"+"</div>"+'<div class="k-action-buttons">'+'<button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base" data-#:ns#bind="visible: showRemove, click: remove"><span class="k-button-text">#: messages.remove #</span></button>'+'<button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary" data-#:ns#bind="click: apply"><span class="k-button-text">#: messages.apply #</span></button>'+'<button class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base" data-#:ns#bind="click: close"><span class="k-button-text">#: messages.cancel #</span></button>'+"</div>"+"</div>"},open:function(e){var t=this.options;var r;this.viewModel=new C({type:t.type,defaultHintMessage:t.hintMessage,defaultHintTitle:t.hintTitle,defaultComparers:t.comparers.slice(0),comparerMessages:t.comparerMessages,criteria:t.criteria.slice(0),criterion:t.criterion,ignoreBlank:t.ignoreBlank,showButton:t.showButton,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)});this.viewModel.update(e.validation());o.fn.open.call(this);r=this.dialog().element;if(this.validatable)this.validatable.destroy();s.bind(r,this.viewModel);this.validatable=new s.ui.Validator(r.find(".k-edit-form-container"),{validateOnBlur:false,errorTemplate:this.options.errorTemplate||undefined})},apply:function(){if(this.validatable.validate()){o.fn.apply.call(this);this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}})}},remove:function(){this.viewModel.set("criterion","any");this.apply()}});function R(e){return{value:e,text:u("exportAsDialog.pdf.paper."+e)}}s.spreadsheet.dialogs.register("validation",F),s.spreadsheet.dialogs.ValidationDialog=F;var S=o.extend({init:function(e){o.fn.init.call(this,e);e=this.options;this.viewModel=s.observable({title:e.title,name:e.name,extension:e.extension,fileFormats:e.fileFormats,excel:e.excelExport,pdf:{proxyURL:e.pdfExport.proxyURL,forceProxy:e.pdfExport.forceProxy,title:e.pdfExport.title,author:e.pdfExport.author,autoPrint:e.pdfExport.autoPrint,subject:e.pdfExport.subject,keywords:e.pdfExport.keywords,creator:e.pdfExport.creator,date:e.pdfExport.date,fitWidth:e.pdf.fitWidth,area:e.pdf.area,areas:e.pdf.areas,paperSize:e.pdf.paperSize,paperSizes:e.pdf.paperSizes,margin:e.pdf.margin,margins:e.pdf.margins,landscape:e.pdf.landscape,guidelines:e.pdf.guidelines,hCenter:e.pdf.hCenter,vCenter:e.pdf.vCenter},apply:this.apply.bind(this),close:this.close.bind(this)});var t=this.dialog();this.viewModel.bind("change",function(e){if(e.field==="extension"){this.set("showPdfOptions",this.extension===".pdf"?true:false);t.center()}});s.bind(t.element,this.viewModel)},options:{title:u("exportAsDialog.title","Export..."),name:u("exportAsDialog.defaultFileName","Workbook"),extension:".xlsx",fileFormats:[{description:u("exportAsDialog.xlsx.description","Excel Workbook (.xlsx)"),extension:".xlsx"},{description:u("exportAsDialog.pdf.description","Portable Document Format (.pdf)"),extension:".pdf"}],pdf:{fitWidth:true,area:"workbook",areas:[{area:"workbook",text:u("exportAsDialog.pdf.area.workbook","Entire Workbook")},{area:"sheet",text:u("exportAsDialog.pdf.area.sheet","Active Sheet")},{area:"selection",text:u("exportAsDialog.pdf.area.selection","Selection")}],paperSize:"a4",paperSizes:["a2","a3","a4","a5","b3","b4","b5","folio","legal","letter","tabloid","executive"].map(R),margin:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},margins:[{value:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},text:u("exportAsDialog.pdf.margin.normal","Normal")},{value:{bottom:"0.75in",left:"0.25in",right:"0.25in",top:"0.75in"},text:u("exportAsDialog.pdf.margin.narrow","Narrow")},{value:{bottom:"1in",left:"1in",right:"1in",top:"1in"},text:u("exportAsDialog.pdf.margin.wide","Wide")}],landscape:true,guidelines:true,hCenter:true,vCenter:true},width:520,template:"<div class='k-edit-label'><label id='name-label'>#: messages.exportAsDialog.labels.fileName #:</label></div>"+"<div class='k-edit-field'>"+"<span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-#:ns#bind='value: name' /></span>"+"</div>"+"<div >"+"<div class='k-edit-label'><label id='file-format-label'>#: messages.exportAsDialog.labels.saveAsType #:</label></div>"+"<div class='k-edit-field'>"+"<select aria-labelledby='file-format-label' data-#:ns#role='dropdownlist' class='k-file-format' "+"data-#:ns#text-field='description' "+"data-#:ns#value-field='extension' "+"data-#:ns#bind='value: extension, source: fileFormats'></select>"+"</div>"+"</div>"+"<div class='k-export-config' data-#:ns#bind='visible: showPdfOptions'>"+"<hr class='k-hr' />"+"<div class='k-edit-label'><label id='export-area-label'>#: messages.exportAsDialog.labels.exportArea #:</label></div>"+"<div class='k-edit-field'>"+"<select aria-labelledby='export-area-label' data-#:ns#role='dropdownlist' class='k-file-format' "+"data-#:ns#text-field='text' "+"data-#:ns#value-field='area' "+"data-#:ns#bind='value: pdf.area, source: pdf.areas'></select>"+"</div>"+"<div class='k-edit-label'><label id='paper-size-label'>#: messages.exportAsDialog.labels.paperSize#:</label></div>"+"<div class='k-edit-field'>"+"<select aria-labelledby='paper-size-label' data-#:ns#role='dropdownlist' class='k-file-format' "+"data-#:ns#text-field='text' "+"data-#:ns#value-field='value' "+"data-#:ns#bind='value: pdf.paperSize, source: pdf.paperSizes'></select>"+"</div>"+"<div class='k-edit-label'><label id='margins-label'>#: messages.exportAsDialog.labels.margins #:</label></div>"+"<div class='k-edit-field'>"+"<select aria-labelledby='margins-label' data-#:ns#role='dropdownlist' class='k-file-format' "+"data-#:ns#value-primitive='true'"+"data-#:ns#text-field='text' "+"data-#:ns#value-field='value' "+"data-#:ns#bind='value: pdf.margin, source: pdf.margins'></select>"+"</div>"+"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>"+"<div class='k-edit-field'>"+"<div class='k-button-group'>"+"<input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='false' />"+"<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'><span class='k-button-icon k-icon k-i-page-portrait'></span></label>"+"<input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='true' />"+"<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'><span class='k-button-icon k-icon k-i-page-landscape'></span></label>"+"</div>"+"</div>"+"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div>"+"<div class='k-edit-field'>"+"<input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-#:ns#bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label>"+"</div>"+"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div>"+"<div class='k-edit-field'>"+"<input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-#:ns#bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label>"+"</div>"+"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div>"+"<div class='k-edit-field'>"+"<input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-#:ns#bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label>"+"<input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-#:ns#bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label>"+"</div>"+"<div class='k-page-orientation'>"+"<span class='k-icon k-i-page-portrait' data-#:ns#bind='invisible: pdf.landscape'></span>"+"<span class='k-icon k-i-page-landscape' data-#:ns#bind='visible: pdf.landscape'></span>"+"</div>"+"</div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.save #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>"+"</div>"},apply:function(){o.fn.apply.call(this);this.trigger("action",{command:"SaveAsCommand",options:this.viewModel})}});function e(e,t){s.spreadsheet.dialogs.register(e,i.extend({options:{messageId:t}}))}s.spreadsheet.dialogs.register("exportAs",S),e("modifyMerged","modifyMergedDialog.errorMessage"),e("rangeDisabled","rangeDisabledDialog.errorMessage"),e("intersectsArray","intersectsArrayDialog.errorMessage"),e("overflow","overflowDialog.errorMessage"),e("unsupportedSelection","unsupportedSelectionDialog.errorMessage"),e("incompatibleRanges","incompatibleRangesDialog.errorMessage"),e("noFillDirection","noFillDirectionDialog.errorMessage"),e("duplicateSheetName","duplicateSheetNameDialog.errorMessage");var A=i.extend({options:{width:640,title:"Errors in import",template:"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'>"+"<div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>"+"<div class='k--errors'>"+"<table>"+"<thead>"+"<tr><th>Context</th><th>Error message</th></tr>"+"</thead>"+"# for (var i = 0; i < errors.length; ++i) { #"+"# var err = errors[i]; #"+"<tr><td>#: err.context #</td><td>#: err.error #</td></tr>"+"# } #"+"</table>"+"</div>"+"</div>"+"<div class='k-action-buttons'>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>"+"<span class='k-button-text'>#: messages.okText #</span>"+"</button>"+"</div>"}}),D=(s.spreadsheet.dialogs.register("importError",A),i.extend({options:{title:u("useKeyboardDialog.title","Copying and pasting"),template:"#: messages.useKeyboardDialog.errorMessage #"+"<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>"+"<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>"+"<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>"+'<div class="k-action-buttons">'+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>"+"<span class='k-button-text'>#= messages.okText #</span>"+"</button>"+"</div>"}})),E=(s.spreadsheet.dialogs.register("useKeyboard",D),o.extend({options:{title:u("linkDialog.title","Hyperlink"),template:"<div class='k-edit-label'><label id='url-label'>#: messages.linkDialog.labels.url #:</label></div>"+"<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: url' title='#: messages.linkDialog.labels.url #' aria-labelledby='url-label'/></span></div>"+"<div class='k-action-buttons'>"+("<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#= messages.linkDialog.labels.removeLink #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#= messages.okText #</span></button>"+"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>")+"</div>",autoFocus:false},open:function(e){var t=this;o.fn.open.apply(t,arguments);var r=t.dialog().element;var n=s.observable({url:e.link(),apply:function(){if(!/\S/.test(n.url))n.url=null;t.trigger("action",{command:"HyperlinkCommand",options:{link:n.url}});t.close()},remove:function(){n.url=null;n.apply()},cancel:t.close.bind(t)});s.bind(r,n);r.find("input").trigger("focus").on("keydown",function(e){if(e.keyCode==13){n.url=a(this).val();e.stopPropagation();e.preventDefault();n.apply()}else if(e.keyCode==27){e.stopPropagation();e.preventDefault();n.cancel()}})}})),B=(s.spreadsheet.dialogs.register("hyperlink",E),o.extend({options:{className:"k-spreadsheet-insert-comment",template:"<div class='k-edit-label'><label id='comment-label'>#: messages.insertCommentDialog.labels.comment #:</label></div><div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea aria-labelledby='comment-label' rows='5' class='k-input-inner' data-#:ns#bind='value: comment'></textarea></span></div><div class='k-action-buttons'>  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#: messages.insertCommentDialog.labels.removeComment #</span></button>  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.okText #</span></button>  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button></div>",title:u("insertCommentDialog.title","Insert comment"),autoFocus:false,width:450},open:function(e){var t=this;o.fn.open.apply(t,arguments);var r=t.dialog().element;var n=s.observable({comment:e.comment(),apply:function(){if(!/\S/.test(n.comment))n.comment=null;t.trigger("action",{command:"InsertCommentCommand",options:{value:n.comment}});t.close()},remove:function(){n.comment=null;n.apply()},cancel:t.close.bind(t)});s.bind(r,n);r.find("textarea").trigger("focus")}})),M=(s.spreadsheet.dialogs.register("insertComment",B),o.extend({options:{template:"<div class='k-spreadsheet-insert-image-dialog'>  <label data-#:ns#bind='style: { background-image: imageUrl },                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>    <div data-#:ns#bind='text: info'></div>    <input type='file' data-#:ns#bind='events: { change: change }'           accept='image/png, image/jpeg, image/gif' />  </label></div><div class='k-action-buttons'>  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='enabled: okEnabled, click: apply'><span class='k-button-text'>#: messages.okText #</span></button>  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button></div>",title:u("insertImageDialog.title","Insert image"),width:"auto"},open:function(){var e=this;o.fn.open.apply(e,arguments);var t=e.dialog().element;var i=s.observable({okEnabled:false,info:s.spreadsheet.messages.dialogs.insertImageDialog.info,imageUrl:"",hasImage:false,isHovered:false,_url:null,_image:null,apply:function(){window.URL.revokeObjectURL(i._url);e.trigger("action",{command:"InsertImageCommand",options:{blob:i._image,width:i._width,height:i._height}});e.close()},cancel:e.close.bind(e),stopEvent:function(e){e.stopPropagation();e.preventDefault()},drop:function(e){i.stopEvent(e);i.selectFile(e.originalEvent.dataTransfer.files);i.set("isHovered",false)},dragEnter:function(e){i.stopEvent(e);i.set("isHovered",true)},dragLeave:function(e){i.stopEvent(e);i.set("isHovered",false)},change:function(e){i.selectFile(e.target.files)},selectFile:function(e){var t;for(var r=0;r<e.length;++r)if(/^image\//i.test(e[r].type)){t=e[r];break}if(i._url)window.URL.revokeObjectURL(i._url);if(t){i._image=t;i._url=window.URL.createObjectURL(t);var n=new Image;n.src=i._url;n.onload=function(){i._width=n.width;i._height=n.height;i.set("info",s.spreadsheet.messages.dialogs.insertImageDialog.info);i.set("okEnabled",true);i.set("imageUrl","url('"+i._url+"')");i.set("hasImage",true)}}else{i._image=null;i.set("info",s.spreadsheet.messages.dialogs.insertImageDialog.typeError);i.set("okEnabled",false);i.set("imageUrl","");i.set("hasImage",false)}}});s.bind(t,i)}}));function T(e,t){this.path=e.split(".");this.def=t}function u(e,t){return new T(e,t)}function I(r){if(r instanceof T)return r.trans();else if(Array.isArray(r))return r.map(I);else if(r!=null&&typeof r=="object")return Object.keys(r).reduce(function(e,t){e[t]=I(r[t]);return e},{});return r}s.spreadsheet.dialogs.register("insertImage",M),T.prototype.trans=function(){var e=s.spreadsheet.messages.dialogs;for(var t=0;t<this.path.length;++t){e=e[this.path[t]];if(!e)return this.def}return e}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/sheetbinder.min",["../kendo.core.min","../kendo.data.min","./sheet.min"],function(){var p=kendo,m=function(e){return e},e=p.Class.extend({init:function(e){this.options=p.jQuery.extend({},this.options,e);this.columns=this._normalizeColumns(this.options.columns);this._sheet();this._dataSource();this._header();this._boundRowsCount=0;this.dataSource.fetch()},_sheet:function(){this.sheet=this.options.sheet;this._sheetChangeHandler=this._sheetChange.bind(this);this._sheetDeleteRowHandler=this._sheetDeleteRow.bind(this);this._sheetInsertRowHandler=this._sheetInsertRow.bind(this);this.sheet.bind("change",this._sheetChangeHandler).bind("afterDeleteRow",this._sheetDeleteRowHandler).bind("afterInsertRow",this._sheetInsertRowHandler)},_sheetInsertRow:function(e){if(e.index!==undefined)this.dataSource.insert(Math.max(e.index-1,0),{})},_sheetDeleteRow:function(e){if(e.index!==undefined){var t=this.dataSource;var r=t.view()[e.index-1];if(r)t.remove(r)}},_header:function(){this.sheet.batch(function(){this.columns.forEach(function(e,t){this.sheet.range(0,t).value(e.title)}.bind(this))}.bind(this))},_sheetChange:function(e){if(e.insertRow||e.deleteRow)return;if(e.recalc&&e.ref){var t=p.spreadsheet.UnionRef;var o=this.dataSource;var l=o.view();var u=this.columns;var c=[];var a=this.sheet;var r,f,n,h,s,i;var d=function(e){e=e.toRangeRef();var t;var r=0;for(var n=e.topLeft.row;n<=e.bottomRight.row;n++){t=l[n-1];if(!t){t=o.insert(n-1,{});l=o.view()}var i=0;for(var a=e.topLeft.col;a<=e.bottomRight.col&&a<u.length;a++){var s=c[h][r][i++];t.set(u[a].field,f[a](s))}r++}};if(o.reader.model)r=o.reader.model.fields;if(!u.length&&l.length)u=Object.keys(l[0].toJSON());f=u.map(function(e){var t=e.field;if(t&&r&&r[t]&&r[t].type=="date")return p.spreadsheet.numberToDate;return m});this._skipRebind=true;n=a._grid.normalize(e.ref);if(!(n instanceof t))n=new t([n]);i=n.refs;i.forEach(function(e){c.push(a.range(e).values())});for(h=0;h<i.length;h++){s=i[h];s.forEach(d)}this._boundRowsCount=o.view().length;this._skipRebind=false}},_normalizeColumns:function(e){return e.map(function(e){var t=e.field||e;return{field:t,title:e.title||t}})},_dataSource:function(){var e=this.options;var t=e.dataSource;t=Array.isArray(t)?{data:t}:t;if(this.dataSource&&this._changeHandler)this.dataSource.unbind("change",this._changeHandler).unbind("progress",this._progressHandler).unbind("error",this._errorHandler);else{this._changeHandler=this._change.bind(this);this._progressHandler=this._requestStart.bind(this);this._errorHandler=this._error.bind(this)}this.dataSource=p.data.DataSource.create(t).bind("change",this._changeHandler).bind("progress",this._progressHandler).bind("error",this._errorHandler)},_error:function(){this._progress(false)},_requestStart:function(){this._progress(true)},_progress:function(e){this.sheet.trigger("progress",{toggle:e})},_change:function(){if(this._skipRebind)return;if(this.sheet.trigger("dataBinding"))return;var i=this.dataSource.view();var e=this.columns;if(!e.length&&i.length){this.columns=e=this._normalizeColumns(Object.keys(i[0].toJSON()));this._header()}var a=e.map(function(e){return p.getter(e.field)});this.sheet.batch(function(){var e=Math.max(i.length,this._boundRowsCount,this.sheet._grid.rowCount-1);for(var t=0;t<e;t++)for(var r=0;r<a.length;r++){var n=i[t]?a[r](i[t]):null;this.sheet.range(t+1,r).value(n)}}.bind(this));this._boundRowsCount=i.length;this._progress(false);this.sheet.trigger("dataBound")},destroy:function(){this.dataSource.unbind("change",this._changeHandler).unbind("progress",this._progressHandler).unbind("error",this._errorHandler);this.sheet.unbind("change",this._sheetChangeHandler).unbind("deleteRow",this._sheetDeleteRowHandler).unbind("insertRow",this._sheetInsertRowHandler)},options:{columns:[]}});p.spreadsheet.SheetDataSourceBinder=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/filtermenu.min",["../kendo.core.min","../kendo.popup.min","../kendo.treeview.min","../kendo.numerictextbox.min","../kendo.datepicker.min","../kendo.datetimepicker.min"],function(){var f=window.kendo,s=f.jQuery,n=f.ui.Widget,e={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon",iconCollapse:"k-i-arrow-45-down-right",iconExpand:"k-i-arrow-60-right",iconSearch:"k-i-zoom",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"},o=(f.spreadsheet.messages.filterMenu={all:"All",sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",addToCurrent:"Add to current selection",clear:"Clear",blanks:"(Blanks)",operatorNone:"None",and:"AND",or:"OR",operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},n.extend({init:function(e,t){n.fn.init.call(this,e,t);this.element.addClass(l.classNames.details);this._summary=this.element.find("."+l.classNames.detailsSummary).on("click",this._toggle.bind(this));var r=t.expanded?l.classNames.iconCollapse:l.classNames.iconExpand;this._icon=s("<span />",{class:l.classNames.icon+" "+r}).prependTo(this._summary);this._container=f.wrap(this._summary.next(),true);if(!t.expanded)this._container.hide()},options:{name:"Details"},events:["toggle"],visible:function(){return this.options.expanded},toggle:function(e){var t=f.fx(this._container).expand("vertical");t.stop()[e?"reverse":"play"]();this._icon.toggleClass(l.classNames.iconExpand,e).toggleClass(l.classNames.iconCollapse,!e);this.options.expanded=!e},_toggle:function(){var e=this.visible();this.toggle(e);this.trigger("toggle",{show:e})}})),t=(f.data.binders.spreadsheetFilterValue=f.data.Binder.extend({init:function(e,t,r){f.data.Binder.fn.init.call(this,e,t,r);this._change=s.proxy(this.change,this);s(this.element).on("change",this._change)},refresh:function(){var e=this,t=e.bindings.spreadsheetFilterValue.get();s(e.element).val(t instanceof Date?"":t)},change:function(){var e=this.element.value;this.bindings.spreadsheetFilterValue.set(e)}}),f.data.binders.widget.spreadsheetFilterValue=f.data.Binder.extend({init:function(e,t,r){f.data.Binder.fn.init.call(this,e.element[0],t,r);this.widget=e;this._change=s.proxy(this.change,this);this.widget.first("change",this._change)},refresh:function(){var e=this.bindings.spreadsheetFilterValue,t=e.get(),r=s(this.widget.element).data("filterType");if(r==="date"&&t instanceof Date||r==="number"&&!isNaN(t))this.widget.value(t);else this.widget.value(null)},change:function(){var e=this.widget.value(),t=this.bindings.spreadsheetFilterValue;t.set(e)}}),{filterByValue:"<div class='"+e.detailsSummary+"'>#= messages.filterByValue #</div>"+"<div class='"+e.detailsContent+"'>"+"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>"+"<span class='k-input-icon k-icon k-i-search'></span>"+"<input class='k-input-inner' autocomplete='off' placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' />"+"</div>"+"<div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#'/><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div>"+"<div class='"+e.valuesTreeViewWrapper+"'>"+"<div data-#=ns#role='treeview' "+"data-#=ns#checkboxes='{ checkChildren: true }' "+"data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' "+"></div>"+"</div>"+"</div>",filterByCondition:"<div class='"+e.detailsSummary+"'>#= messages.filterByCondition #</div>"+"<div class='"+e.detailsContent+"'>"+"<div>"+"<select "+'aria-label="#= messages.filterByCondition #" '+'data-#=ns#role="dropdownlist"'+'data-#=ns#bind="value: operator, source: operators, events: { change: operatorChange } "'+'data-#=ns#value-primitive="false"'+'data-#=ns#option-label="#=messages.operatorNone#"'+'data-#=ns#height="auto"'+'data-#=ns#text-field="text"'+'data-#=ns#value-field="unique">'+"</select>"+"</div>"+'<div data-#=ns#bind="visible: isString">'+'<input aria-label="string-value" data-filter-type="string" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" class="k-textbox" />'+"</div>"+'<div data-#=ns#bind="visible: isNumber">'+'<input aria-label="number-value" data-filter-type="number" data-#=ns#role="numerictextbox" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" />'+"</div>"+'<div data-#=ns#bind="visible: isDate">'+'<input aria-label="date-value" data-filter-type="date" data-#=ns#role="datepicker" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" />'+"</div>"+"</div>",menuItem:"<li data-command='#=command#' data-dir='#=dir#'>"+"<span class='k-icon k-i-#=iconClass#'></span>#=text#"+"</li>",actionButtons:"<button data-#=ns#bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>#=messages.apply#</span></button>"+"<button data-#=ns#bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>#=messages.clear#</span></button>"});function c(e){var t={};var r=[];for(var n=0;n<e.length;n++)if(!t[e[n].value]){t[e[n].value]=e[n];r.push(e[n])}else if(!t[e[n].value].checked&&e[n].checked)t[e[n].value].checked=true;return r}function d(e,t){var r=false;var n=e instanceof f.data.HierarchicalDataSource&&e.data();var i=this;var a=this.values;for(var s=0;s<n.length;s++){var o=n[s];var c=o.text.toString().toLocaleLowerCase(f.culture().name);var l=t===true||t===""||c.indexOf(t)>=0;var h=d.bind(i);var u=h(o.children,t);r=r||u||l;o.hidden=!l&&!u;if(t.length||a&&!a.length)o.checked=!o.hidden;else if(a&&a.indexOf(o.text)!=-1)o.checked=true}if(n)e.filter({field:"hidden",operator:"neq",value:true});return r}function i(e){var t=e instanceof f.data.HierarchicalDataSource&&e.data();for(var r=0;r<t.length;r++){var n=t[r];n.checked=false;if(n.hasChildren)i(n.children)}}var r=f.spreadsheet.FilterMenuViewModel=f.data.ObservableObject.extend({valuesChange:function(e){var t=e?e.sender.dataSource:this.valuesDataSource;var r=function(e){return e.checked};var n=function(e){return e.dataType==="date"?f.spreadsheet.dateToNumber(e.value):e.value};var i=function(e,t,r){return r.lastIndexOf(e)===t};var a=t.data();var s=a.toJSON()[0].items;var o=s.filter(function(e){return e.dataType==="blank"});o=o.length?o[0].checked:false;s=s.filter(r).map(n);if(this.appendToSearch&&this.valueFilter&&this.valueFilter.values.length)s=s.concat(this.valueFilter.values.toJSON()).sort().filter(i);this.set("valueFilter",{values:s,blanks:o})},valueSelect:function(e){e.preventDefault();var t=e.sender.dataItem(e.node);t.set("checked",!t.checked)},hasActiveSearch:false,appendToSearch:false,filterValues:function(e){var t=typeof e=="string"?e:s(e.target).val().toLocaleLowerCase(f.culture().name);var r=this.valuesDataSource;this.set("hasActiveSearch",!!t);var n=d.bind(this.valueFilter);i(r);n(r,t)},reset:function(){this.set("customFilter",{logic:"and",criteria:[{operator:null,value:null}]});this.set("valueFilter",{values:[]})},operatorChange:function(e){var t=e.sender.dataItem();this.set("operatorType",t.type);if(!this.get("customFilter"))this.reset();this.set("customFilter.criteria[0].operator",t.value)},isNone:function(){return this.get("operatorType")===undefined},isString:function(){return this.get("operatorType")==="string"},isNumber:function(){return this.get("operatorType")==="number"},isDate:function(){return this.get("operatorType")==="date"}});function u(e){var t=f.spreadsheet.messages.filterMenu.operators;var r=[];for(var n in e){if(!e.hasOwnProperty(n))continue;for(var i in e[n]){if(!e[n].hasOwnProperty(i))continue;r.push({text:t[n][i],value:i,unique:n+"_"+i,type:n})}}return r}var a=f.spreadsheet.FilterMenuController={valuesTree:function(e,t){return[{text:f.spreadsheet.messages.filterMenu.all,expanded:true,checked:false,items:this.values(e.resize({top:1}),t)}]},values:function(e,t){var o=[];var l=f.spreadsheet.messages.filterMenu;var r=e.column(t);var u=e.sheet();r.forEachCell(function(e,t,r){var n=true;if(u.isHiddenRow(e))n=false;var i=r.value;var a=r.dataType;var s=r.text;if(i===undefined)a="blank";else if(r.format)a=f.spreadsheet.formatting.type(i,r.format);else a=typeof i;if(i!==null&&r.format)s=f.spreadsheet.formatting.text(i,r.format);else s=a=="blank"?l.blanks:i;if(a==="percent"||a==="currency")a="number";if(a==="date")i=f.spreadsheet.numberToDate(i);o.push({dataType:a,value:i,text:s,checked:n})});o=c(o);o.sort(function(e,t){if(e.dataType===t.dataType)return 0;if(e.dataType==="blank"||t.dataType==="blank")return e.dataType==="blank"?-1:1;if(e.dataType==="number"||t.dataType==="number")return e.dataType==="number"?-1:1;if(e.dataType==="date"||t.dataType==="date")return e.dataType==="date"?-1:1;return 0});return o},filterType:function(e,t){var r=e.sheet();var n=this.filterForColumn(t,r);var i;n=n&&n.filter.toJSON();if(n&&n.filter=="custom"){var a=n.criteria[0].value;if(a instanceof Date)i="date";else if(typeof a=="string")i="string";else if(typeof a=="number")i="number"}if(!i){var s=this.values(e.row(1),t)[0];i=s&&s.dataType;if(i=="blank")i=null}return i},filterForColumn:function(t,e){var r=e.filter();var n;if(r)n=r.columns.filter(function(e){return e.index===t})[0];return n},filter:function(e,t){var r=this.filterForColumn(e,t);if(!r)return;var n=r.filter.toJSON();var i=n.filter;delete n.filter;var a={type:i,options:n};var s=n.criteria;if(s&&s.length)a.operator=s[0].operator;return a}},l=n.extend({init:function(e,t){n.call(this,e,t);this.element.addClass(l.classNames.wrapper);this.viewModel=new r({active:"value",operator:null,operators:u(this.options.operators),clear:this.clear.bind(this),apply:this.apply.bind(this)});this._filterInit();this._popup();this._sort();this._filterByCondition();this._filterByValue();this._actionButtons()},options:{name:"FilterMenu",column:0,range:null,operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){n.fn.destroy.call(this);this.menu.destroy();this.valuesTreeView.destroy();this.popup.destroy()},openFor:function(e){this.popup.setOptions({anchor:e});this.popup.open()},close:function(){this.popup.close()},clear:function(){this.action({command:"ClearFilterCommand",options:{column:this.options.column}});this.viewModel.reset();this.close()},apply:function(){this._active();var e={operatingRange:this.options.range,column:this.options.column};var t;var r;if(this.viewModel.active==="value"){this.viewModel.valuesChange({sender:this.valuesTreeView});t=this.viewModel.valueFilter.toJSON();if(t.blanks||t.values&&t.values.length)e.valueFilter=t}else if(this.viewModel.active==="custom"){r=this.viewModel.customFilter.toJSON();if(r.criteria.length&&r.criteria[0].value!==null)e.customFilter=r}if(e.valueFilter||e.customFilter)this.action({command:"ApplyFilterCommand",options:e})},action:function(e){this.trigger("action",s.extend({},e))},_filterInit:function(){var e=this.options.column;var t=this.options.range;var r=t.sheet();var n=a.filter(e,r);if(n){var i=a.filterType(t,e);this.viewModel.set("active",n.type);this.viewModel.set(n.type+"Filter",n.options);if(n.type=="custom"){this.viewModel.set("operator",i+"_"+n.operator);this.viewModel.set("operatorType",i)}}else this.viewModel.reset()},_popup:function(){this.popup=this.element.kendoPopup({copyAnchorStyles:false}).data("kendoPopup")},_sort:function(){var e=f.template(l.templates.menuItem);var t=f.spreadsheet.messages.filterMenu;var r=[{command:"sort",dir:"asc",text:t.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:t.sortDescending,iconClass:"sort-desc"}];var n=s("<ul></ul>",{html:f.render(e,r)}).appendTo(this.element);this.menu=n.kendoMenu({orientation:"vertical",select:function(e){var t=s(e.item).data("dir");var r=this.options.range.resize({top:1});var n={value:t,sheet:false,operatingRange:r,column:this.options.column};this.action({command:"SortCommand",options:n})}.bind(this)}).data("kendoMenu")},_appendTemplate:function(e,t,r,n){var i=f.template(e);var a=s("<div class='"+t+"'/>").html(i({messages:f.spreadsheet.messages.filterMenu,guid:f.guid(),ns:f.ns}));this.element.append(a);if(r)r=new o(a,{expanded:n,toggle:this._detailToggle.bind(this)});f.bind(a,this.viewModel);return a},_detailToggle:function(e){this.element.find("["+f.attr("role")+"=details]").not(e.sender.element).data("kendoDetails").toggle(!e.show)},_filterByCondition:function(){var e=this.viewModel.active==="custom";this._appendTemplate(l.templates.filterByCondition,l.classNames.filterByCondition,true,e)},_filterByValue:function(){var e=this.viewModel.active==="value";var t=this._appendTemplate(l.templates.filterByValue,l.classNames.filterByValue,true,e);this.valuesTreeView=t.find("["+f.attr("role")+"=treeview]").data("kendoTreeView");var r=a.valuesTree(this.options.range,this.options.column);this.viewModel.set("valuesDataSource",new f.data.HierarchicalDataSource({data:r,accentFoldingFiltering:f.culture().name}))},_actionButtons:function(){this._appendTemplate(l.templates.actionButtons,l.classNames.actionButtons,false)},_active:function(){var e=this.element.find("["+f.attr("role")+"=details]").filter(function(e,t){return s(t).data("kendoDetails").visible()});if(e.hasClass(l.classNames.filterByValue))this.viewModel.set("active","value");else if(e.hasClass(l.classNames.filterByCondition))this.viewModel.set("active","custom")}});s.extend(true,f.spreadsheet.FilterMenu=l,{classNames:e,templates:t})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/editor.min",["../kendo.core.min"],function(){var r=kendo,e=r.Observable.extend({init:function(e){r.Observable.fn.init.call(this);this.view=e;this.formulaBar=e.formulaBar;this._active=false;this.barInput=e.formulaBar.formulaInput;this.cellInput=e.formulaInput;this.barInput.syncWith(this.cellInput);this.cellInput.syncWith(this.barInput);this.barInput.bind("keyup",this._triggerUpdate.bind(this));this.cellInput.bind("keyup",this._triggerUpdate.bind(this));this.barInput.bind("blur",this._blur.bind(this));this.cellInput.bind("blur",this._blur.bind(this))},events:["activate","deactivate","change","update"],_blur:function(){this.deactivate()},_triggerUpdate:function(){this.trigger("update",{value:this.value()})},activeEditor:function(){var e=null;var t=r._activeElement();if(this.barElement()[0]===t)e=this.barInput;else if(this.cellElement()[0]===t)e=this.cellInput;return e},activate:function(e){var t=this.view.element,r,n,i;this._active=true;this._rect=e.rect;this._range=e.range;this.cellInput.position(e.rect);this.cellInput.resize(e.rect);this.cellInput.tooltip(e.tooltip);this.cellInput.activeCell=this.barInput.activeCell=this._range.topLeft();this.cellInput.activeSheet=this.barInput.activeSheet=this._range._sheet;if(t){r=t.width();n=t.find(".k-spreadsheet-scroller")[0];i=n.offsetWidth-n.clientWidth;this.cellInput.element.css("max-width",r-i-this.cellInput.element.position().left+"px")}this.trigger("activate");return this},deactivate:function(e){var t=this.cellInput;if(!this._active)return;this._active=false;if(!e&&t.value()!=this._value)this.trigger("change",{value:t.value(),range:this._range});this._rect=null;t.hide();this.trigger("deactivate")},enable:function(e){this.barInput.enable(e);this.cellInput.enable(e)},barElement:function(){return this.barInput.element},cellElement:function(){return this.cellInput.element},focus:function(e){e=e||"cell";if(e==="cell"){this.cellInput.element.trigger("focus");this.cellInput.end()}else this.barInput.element.trigger("focus")},isActive:function(){return this._active},isFiltered:function(){return this.barInput.popup.visible()||this.cellInput.popup.visible()},canInsertRef:function(e){var t=this.activeEditor();return t&&t.canInsertRef(e)},highlightedRefs:function(){var e=this.activeEditor();var t=[];if(e)t=e.highlightedRefs();return t},scale:function(){this.cellInput.scale()},toggleTooltip:function(e){this.cellInput.toggleTooltip(t(this._rect,e))},value:function(e,t){if(e===undefined)return this.barInput.value();if(e===null)e="";this._value=e;this.barInput.value(e);this.cellInput.value(e);this.barInput.element.toggleClass("k-spreadsheet-array-formula",!!t)},insertNewline:function(){this.activeEditor().insertNewline();this.scale()},select:function(){this.activeEditor().select()}});function t(e,t){return e&&(e.top!==t.top||e.left!==t.left)}r.spreadsheet.SheetEditor=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/autofill.min",["./runtime.min","./range.min"],function(){"use strict";var e=kendo.spreadsheet,t=e.Range,r,d=e.calc.runtime.Formula,y="incompatibleRanges",_="noFillDirection",k=t.FillError=function(e){this.code=e};function p(t){var e=t.length;var r=(e+1)/2,n=t.reduce(function(e,t){return e+t},0)/e;var i=0,a=0;for(var s=0;s<e;s++){var o=s+1-r,l=t[s]-n;i+=o*l;a+=o*o}if(!a)return function(e){return t[e%t.length]};var u=i/a,c=n-u*r;return function(e){return c+u*(e+1)}}function x(l){function u(e){var t=e[1]-e[0];for(var r=2;r<e.length;++r)if(e[r]-e[r-1]!=t)return null;return t}function c(e){return e.map(function(e){return e.number})}var h=[];var f=l.map(function(e){return e.formula||e.value});n(f,function(e,t,r,n){var i,a;if(r=="number"){a=c(n);i=p(a)}else if(r=="string"||r=="formula"||r=="boolean")i=function(e,t){return f[t]};else if(Array.isArray(r))if(n.length==1)i=function(e){return r[(n[0].number+e)%r.length]};else{var s=u(c(n));if(s==null)i=function(e){return n[e%n.length].value};else i=function(e){var t=n[0].number+s*e;return r[t%r.length]}}else if(r!="null"){a=c(n);if(a.length==1)a.push(a[0]+1);a=p(a);i=function(e,t){return f[t].replace(/^(.*\D)\d+/,"$1"+a(e,t))}}else i=function(){return null};var o={f:i,begin:e,end:t,len:t-e};for(var l=e;l<t;++l)h[l]=o});return function(e,t){var r=h[t];var n=e/f.length|0;var i=e%f.length;var a=n*r.len+i-r.begin;var s=r.f(a,t);var o=m(l[t]);delete o.enable;if(s instanceof d)o.formula=s;else o.value=s;return o}}function m(t){var r={};Object.keys(t||{}).forEach(function(e){r[e]=t[e]});return r}function n(e,t){var r=null,n=0,i=[],a;for(var s=0;s<e.length;++s){a=o(e[s]);i.push(a);if(r!=null&&a.type!==r.type){t(n,s,r.type,i.slice(n,s));n=s}r=a}t(n,s,r.type,i.slice(n,s))}function o(e){if(typeof e=="number")return{type:"number",number:e};if(typeof e=="string"){var t=i(e);if(t)return t;var r=/^(.*\D)(\d+)/.exec(e);if(r){e=e.replace(/^(.*\D)\d+/,"$1-######");return{type:e,match:r,number:parseFloat(r[2])}}return{type:"string"}}if(typeof e=="boolean")return{type:"boolean"};if(e==null)return{type:"null"};if(e instanceof d)return{type:"formula"};window.console.error(e);throw new Error("Cannot fill data")}function l(){var e=kendo.culture();return[e.calendars.standard.days.namesAbbr,e.calendars.standard.days.names,e.calendars.standard.months.namesAbbr,e.calendars.standard.months.names]}function i(e){var t=e.toLowerCase();var r=l();for(var n=0;n<r.length;++n){var i=r[n];for(var a=i.length;--a>=0;){var s=i[a].toLowerCase();if(s==t)return{type:i,number:a,value:e}}}}function C(e){var t=e.length,r=e[0].length;var n=[];for(var i=0;i<r;++i){n[i]=[];for(var a=0;a<t;++a)n[i][a]=e[a][i]}return n}t.prototype._previewFillFrom=function(e,t){var c=this,r=c._sheet;if(typeof e=="string")e=r.range(e);var n=e._ref.toRangeRef().clone().setSheet(r.name());var i=c._ref.toRangeRef().clone().setSheet(r.name());if(n.intersects(i)){if(n.eq(i))return null;i=i.clone();if(n.topLeft.eq(i.topLeft))if(n.width()==i.width()){i.topLeft.row+=n.height();t=0}else if(n.height()==i.height()){i.topLeft.col+=n.width();t=1}else throw new k(y);else if(n.bottomRight.eq(i.bottomRight))if(n.width()==i.width()){i.bottomRight.row-=n.height();t=2}else if(n.height()==i.height()){i.bottomRight.col-=n.width();t=3}else throw new k(y);else throw new k(y);return r.range(i)._previewFillFrom(e,t)}if(t==null)if(n.topLeft.col==i.topLeft.col)t=n.topLeft.row<i.topLeft.row?0:2;else if(n.topLeft.row==i.topLeft.row)t=n.topLeft.col<i.topLeft.col?1:3;else throw new k(_);var a=t&1;var h=t&2;if(a&&n.height()!=i.height()||!a&&n.width()!=i.width())throw new k(y);var s=e._properties(),o;if(!a){s=C(s);o=i.height()}else o=i.width();var f=new Array(s.length);var d=null;for(var p=0;p<s.length;++p){var l=s[p];var m=x(l);var g=f[p]=new Array(o);for(var u=0;u<o;++u){var v=h?-u-1:l.length+u;var b=h?l.length-u%l.length-1:u%l.length;var w=g[h?o-u-1:u]=m(v,b);if(w.value!=null)d=w.value}}if(!a)f=C(f);return{props:f,direction:t,dest:c,hint:d}},t.prototype.fillFrom=function(e,t){var r=this._previewFillFrom(e,t);r.dest._properties(r.props,true);return r.dest}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/nameeditor.min",["../kendo.core.min"],function(){var a=window.kendo,s=a.jQuery,o={input:"k-spreadsheet-name-editor",list:"k-spreadsheet-name-list"},e=a.ui.Widget.extend({init:function(e,t){a.ui.Widget.call(this,e,t);e.addClass(o.input);var r=t.messages.nameBox||"Name Box";var n=new a.data.DataSource({transport:{read:function(e){var t=[];this._workbook.forEachName(function(e){if(!e.hidden&&e.value instanceof a.spreadsheet.Ref)t.push({name:e.name})});e.success(t)}.bind(this),cache:false}});var i=s("<input />").attr("title",r).attr("aria-label",r);this.combo=i.appendTo(e).kendoComboBox({clearButton:false,dataTextField:"name",dataValueField:"name",template:"#:data.name#<a role='button' class='k-button-delete' href='\\#'><span class='k-icon k-i-close'></span></a>",dataSource:n,autoBind:false,ignoreCase:true,change:this._on_listChange.bind(this),noDataTemplate:"<div></div>",open:function(){n.read()}}).getKendoComboBox();this.combo.input.on("keydown",this._on_keyDown.bind(this)).on("focus",this._on_focus.bind(this));this.combo.popup.element.addClass("k-spreadsheet-names-popup").on("mousemove",function(e){e.stopPropagation()}).on("click",".k-button-delete",function(e){e.preventDefault();e.stopPropagation();var t=s(e.target).closest(".k-item");t=this.combo.dataItem(t);this._deleteItem(t.name)}.bind(this))},value:function(e){if(e===undefined)return this.combo.value();else this.combo.value(e)},_deleteItem:function(e){this.trigger("delete",{name:e})},_on_keyDown:function(e){switch(e.keyCode){case 27:this.combo.value(this._prevValue);this.trigger("cancel");break;case 13:this.trigger("enter");break}},_on_focus:function(){this._prevValue=this.combo.value()},_on_listChange:function(){var e=this.combo.value();if(e)this.trigger("select",{name:e})}});a.spreadsheet.NameEditor=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("spreadsheet/print.min",["../kendo.pdf.min","./sheet.min","./range.min","./references.min","./numformat.min","../util/text-metrics.min"],function(){"use strict";var u=kendo.spreadsheet,S=u.CellRef,x=kendo.drawing,d=u.formatting,C=kendo.geometry,F=.8,s;function k(e,r,n,i,a){var s=0;var o=[];var l=r;var u=0;if(r&&n)n*=r;e.forEach(function(e,t){if(i!=null&&t<i)u+=e;if(r&&s+e>l){if(l-s<n){s=r*Math.ceil(s/r)+u;if(u>0)a.push(s-u)}l+=r*Math.ceil(e/r)}o.push(s);s+=e});o.push(s);return o}function c(c,h,f){var e=c._grid;h=e.normalize(h);var r=e.rectangle(h);var w=[];c._drawings.forEach(function(e){var t=c.drawingBoundingBox(e);if(t.intersects(r))w.push({drawing:e,box:t.offset(-r.left,-r.top)})});var d=[];var p=[];var m=[];var g=c._getMergedCells(h);var v=-1,b=-1;c.forEach(h,function(r,n,e){var t=r-h.topLeft.row;var i=n-h.topLeft.col;var a=c.rowHeight(r);var s=c.columnWidth(n);if(!f.forScreen)e.drawings=w.filter(function(e){var t=e.drawing.topLeftCell;if(t&&t.row==r&&t.col==n){v=Math.max(v,c._rows.index(e.box.bottom));b=Math.max(b,c._columns.index(e.box.right));return true}});if(!i)p.push(a);if(!t)m.push(s);var o=new S(r,n).print();if(g.secondary[o])return;e.row=t;e.col=i;var l=g.primary[o];if(l){delete g.primary[o];e.merged=true;e.rowspan=l.height();e.colspan=l.width();if(f.forScreen){e.width=c._columns.sum(l.topLeft.col,l.bottomRight.col);e.height=c._rows.sum(l.topLeft.row,l.bottomRight.row)}}else{e.rowspan=1;e.colspan=1}if(!c._grid._columns.sum(n,n+e.colspan-1)||!c._grid._rows.sum(r,r+e.rowspan-1))return;var u=f.forScreen||E(e);if(!(f.emptyCells||u))return;if(u){v=Math.max(v,t+e.rowspan-1);b=Math.max(b,i+e.colspan-1)}else e.empty=true;d.push(e)});if(!f.forScreen){p=p.slice(0,v+1);m=m.slice(0,b+1)}var t=f.pageWidth;var n=f.pageHeight;var i=f.scale||1;if(f.fitWidth){var a=m.reduce(A,0);if(a>t)i=t/a}t=Math.ceil(t/i);n=Math.ceil(n/i);var o=[];var s=k(p,n||0,f.maxEmpty,f.headerRows,o);var l=k(m,t||0,f.maxEmpty);var u=0;var y=0;var _=[];d=d.filter(function(r){if(r.empty&&(r.row>v||r.col>b))return false;if(f.headerRows&&r.row<f.headerRows)_.push(r);r.left=l[r.col];r.top=s[r.row];if(r.merged)if(!f.forScreen){r.right=D(l,r.col+r.colspan);r.bottom=D(s,r.row+r.rowspan);r.width=r.right-r.left;r.height=r.bottom-r.top}else{r.right=r.left+r.width;r.bottom=r.top+r.height}else{r.width=m[r.col];r.height=p[r.row];r.bottom=r.top+r.height;r.right=r.left+r.width}if(!f.forScreen)r.drawings.forEach(function(e){var t=e.box;t.left=r.left+e.drawing.offsetX;t.top=r.top+e.drawing.offsetY;t.right=t.left+t.width;t.bottom=t.top+t.height});u=Math.max(u,r.right);y=Math.max(y,r.bottom);return true});Object.keys(g.primary).forEach(function(e){var a=g.primary[e];c.forEach(a.topLeft.toRangeRef(),function(e,t,r){var n=e-h.topLeft.row;var i=t-h.topLeft.col;r.merged=true;r.colspan=a.width();r.rowspan=a.height();if(n<0)r.top=-c._rows.sum(e,e-n-1);else r.top=s[n];if(i<0)r.left=-c._columns.sum(t,t-i-1);else r.left=l[i];r.height=c._rows.sum(a.topLeft.row,a.bottomRight.row);r.width=c._columns.sum(a.topLeft.col,a.bottomRight.col);if(r.height>0&&r.width>0){r.right=r.left+r.width;r.bottom=r.top+r.height;r.row=n;r.col=i;d.push(r)}})});if(f.headerRows){o.forEach(function(t){_.forEach(function(e){e=R(e);e.top+=t;e.bottom=e.top+e.height;d.push(e)});s.push(t)});s.sort(M)}return{width:u,height:y,cells:d.sort(B),scale:i,xCoords:l,yCoords:s,drawings:w}}function R(r,e){if(!e)e={};if(Object.assign)return Object.assign(e,r);return Object.keys(r).reduce(function(e,t){e[t]=r[t];return e},e)}function h(e,t){return e.size===t.size&&e.color===t.color}function A(e,t){return e+t}function D(e,t){return t<e.length?e[t]:e[e.length-1]}function E(e){return e.value!=null||e.merged||e.background!=null||e.borderRight!=null||e.borderBottom!=null||e.validation!=null&&!e.validation.value||e.drawings&&e.drawings.length}function B(e,t){if(e.top<t.top)return-1;else if(e.top==t.top)if(e.left<t.left)return-1;else if(e.left==t.left)return 0;else return 1;else return 1}function M(e,t){return e<t?-1:e>t?1:0}function p(v,b,w,y){var e=Math.ceil(b.width/y.pageWidth);var t=Math.ceil(b.height/y.pageHeight);var _=Math.ceil(y.pageWidth/b.scale);var k=Math.ceil(y.pageHeight/b.scale);for(var r=0;r<t;++r)for(var n=0;n<e;++n)i(r,n);function i(c,h){var t=h*_;var r=t+_;var n=c*k;var i=n+k;var a=0,s=0;function f(e){if(e.right<=t||e.left>=r||e.bottom<=n||e.top>=i)return false;a=Math.max(e.bottom,a);s=Math.max(e.right,s);return true}var d=b.cells.filter(f);var p=b.drawings.filter(function(e){return f(e.box)});a=Math.min(a,i);s=Math.min(s,r);if(d.length||p.length){var m=new x.Group;w.append(m);var o=new x.Group;m.append(o);o.clip(x.Path.fromRect(new C.Rect([t-1,n-1],[s+1,a+1])));var e=C.Matrix.scale(b.scale,b.scale).multiplyCopy(C.Matrix.translate(-t,-n));if(y.hCenter||y.vCenter)e=e.multiplyCopy(C.Matrix.translate(y.hCenter?(r-s)/2:0,y.vCenter?(i-a)/2:0));o.transform(e);if(y.guidelines){var l=null;b.xCoords.forEach(function(e){e=Math.min(e,s);if(e!==l&&e>=t&&e<=r){l=e;o.append((new x.Path).moveTo(e,n).lineTo(e,a).close().stroke(y.guideColor,F))}});var l=null;b.yCoords.forEach(function(e){e=Math.min(e,a);if(e!==l&&e>=n&&e<=i){l=e;o.append((new x.Path).moveTo(t,e).lineTo(s,e).close().stroke(y.guideColor,F))}})}var u=I();d.forEach(function(e){T(e,o,y);u.add(e,v)});var g=new x.Group;u.vert.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;g.append((new x.Path).moveTo(e.x,e.top).lineTo(e.x,e.bottom).close().stroke(e.color,e.size))}})});u.horiz.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;g.append((new x.Path).moveTo(e.left,e.y).lineTo(e.right,e.y).close().stroke(e.color,e.size))}})});o.append(g);p.forEach(function(e){var t=e.drawing;var r=t.image;if(r!=null){var n=e.box;var i=v._workbook.imageUrl(r);o.append(new x.Image(i,new C.Rect([n.left,n.top],[n.width,n.height])).opacity(t.opacity))}})}}}function T(e,t,c){var r=new x.Group;t.append(r);var n=new C.Rect([e.left,e.top],[e.width,e.height]);if(e.background||e.merged){var i=n;if(c.guidelines){i=n.clone();i.origin.x+=F/2+.1;i.origin.y+=F/2+.1;i.size.width-=F+.2;i.size.height-=F+.2}r.append(new x.Rect(i).fill(e.background||"#fff").stroke(null))}var a=e.value;if(a!=null){var s=typeof a=="number"?"number":null;var o=new x.Group;o.clip(x.Path.fromRect(n));r.append(o);var l,u=e.format;if(!u&&s=="number"&&a!=Math.floor(a))u="0.##############";if(u){l=d.textAndColor(a,u);a=l.text;if(l.type)s=l.type}else a+="";if(!e.textAlign)switch(s){case"number":case"date":case"percent":case"currency":e.textAlign="right";break;case"boolean":e.textAlign="center";break}m(a,l&&l.color||e.color||"#000",e,o)}}function o(e,t){if(e.indent){var r=1.4*e.indent;switch(t.textAlign){case null:case"left":t.paddingLeft=r+"ch";break;case"right":t.paddingRight=r+"ch";break;case"center":t.paddingLeft=r/2+"ch";t.paddingRight=r/2+"ch";break}}}function m(e,t,r,n){if(!s){s=document.createElement("div");s.style.position="fixed";s.style.left="0px";s.style.top="0px";s.style.visibility="hidden";s.style.overflow="hidden";s.style.boxSizing="border-box";s.style.lineHeight="normal";document.body.appendChild(s)}if(s.firstChild)s.removeChild(s.firstChild);s.style.padding="2px 4px";s.style.color=t;s.style.font=l(r);s.style.width=r.width+"px";s.style.textAlign=r.textAlign||"left";s.style.textDecoration=r.underline?"underline":"none";o(r,s.style);if(r.wrap){s.style.whiteSpace="pre-wrap";s.style.overflowWrap=s.style.wordWrap="break-word"}else{s.style.whiteSpace="pre";s.style.overflowWrap=s.style.wordWrap="normal"}s.appendChild(document.createTextNode(e));var i=0;switch(r.verticalAlign){case"center":i=r.height-s.offsetHeight>>1;break;case undefined:case null:case"bottom":i=r.height-s.offsetHeight;break}if(i<0)i=0;var a=kendo.drawing.drawDOM.drawText(s);a.transform(C.Matrix.translate(r.left,r.top+i));n.append(a)}function l(e){var t=[];if(e.italic)t.push("italic");if(e.bold)t.push("bold");t.push((e.fontSize||12)+"px");t.push(e.fontFamily||"Arial");return t.join(" ")}function i(e,t,r,n){if(r==null&&n==null){n=t;r={};t=u.SHEETREF}if(n==null){n=r;if(t instanceof u.Range||t instanceof u.Ref||typeof t=="string")r={};else{r=t;t=u.SHEETREF}}r=kendo.jQuery.extend({paperSize:"A4",landscape:true,margin:"1cm",guidelines:true,guideColor:"#aaa",emptyCells:true,fitWidth:false,center:false,headerRows:null,maxEmpty:.2,scale:1},r);var i=new x.Group;var a=kendo.pdf.getPaperOptions(r);i.options.set("pdf",{author:r.author,creator:r.creator,date:r.date,keywords:r.keywords,margin:a.margin,multiPage:true,paperSize:a.paperSize,subject:r.subject,title:r.title,autoPrint:r.autoPrint});var s=a.paperSize[0];var o=a.paperSize[1];if(a.margin){s-=a.margin.left+a.margin.right+1;o-=a.margin.top+a.margin.bottom+1}r.pageWidth=s;r.pageHeight=o;var l=c(e,e._ref(t),r);p(e,l,i,r);n(i)}function f(){}function I(){var l=new f;var u=new f;function e(e,t){if(t){var r=t._properties;var n=t._grid;e.borderLeft=r.get("vBorders",n.index(e.row,e.col));e.borderRight=r.get("vBorders",n.index(e.row,e.col+e.colspan));e.borderTop=r.get("hBorders",n.index(e.row,e.col));e.borderBottom=r.get("hBorders",n.index(e.row+e.rowspan,e.col))}if(e.borderLeft)i(e.row,e.col,e.borderLeft,e.left,e.top,e.bottom);if(e.borderRight)i(e.row,e.col+e.colspan,e.borderRight,e.right,e.top,e.bottom);if(e.borderTop)a(e.row,e.col,e.borderTop,e.top,e.left,e.right);if(e.borderBottom)a(e.row+e.rowspan,e.col,e.borderBottom,e.bottom,e.left,e.right)}function i(e,t,r,n,i,a){var s=u[t]||(u[t]=new f);var o=e>0&&s[e-1];if(o&&h(o,r)){s[e]=o;o.bottom=a}else s[e]={size:r.size,color:r.color,x:n,top:i,bottom:a}}function a(e,t,r,n,i,a){var s=l[e]||(l[e]=new f);var o=t>0&&s[t-1];if(o&&h(o,r)){s[t]=o;o.right=a}else s[t]={size:r.size,color:r.color,y:n,left:i,right:a}}return{add:e,horiz:l,vert:u}}function e(s){var o=new $.Deferred;var e=o.promise();s=R(s,{dataSource:null,guidelines:true,guideColor:"#000",columns:null,headerBackground:"#999",headerColor:"#000",oddBackground:null,evenBackground:null,fontFamily:"Arial",fontSize:12,paperSize:"A4",margin:"1cm",landscape:true,fitWidth:false,scale:1,rowHeight:20,maxEmpty:1,useGridFormat:true});kendo.drawing.pdf.defineFont(kendo.drawing.drawDOM.getFontFaces(document));var n=r(s.fontFamily,s.fontSize);function l(e){if(e!=null){var t=12;for(var r=e.length;--r>=0;)t+=n(e.charAt(r));return t}return 0}var t=s.guidelines?{size:1,color:s.guideColor}:null;function u(e){if(!t)return e;return R(e,{borderLeft:t,borderTop:t,borderRight:t,borderBottom:t})}s.dataSource.fetch(function(){var e=s.dataSource.data();if(!e.length)return o.reject("Empty dataset");var t=s.columns.map(function(e){if(typeof e=="string")return{title:e,field:e};else return e});var r=t.map(function(e){return e.title||e.field});var a=r.map(l);var n=e.map(function(n,i){return{cells:t.map(function(e,t){var r=n[e.field];if(s.useGridFormat){if(r!=null)if(e.format)r=kendo.format(e.format,r);else r+="";a[t]=Math.max(l(r),a[t])}return u({value:r,format:s.useGridFormat?null:e.format,background:i%2?s.evenBackground:s.oddBackground})})}});n.unshift({cells:r.map(function(e){return u({value:e,background:s.headerBackground,color:s.headerColor})})});var i=new kendo.spreadsheet.Sheet(n.length+1,t.length+1,s.rowHeight,50,20,20,{fontFamily:s.fontFamily,fontSize:s.fontSize,verticalAlign:"center"});i.fromJSON({name:"Sheet1",rows:n,columns:a.map(function(e,t){return{index:t,width:e}})});i.draw({paperSize:s.paperSize,landscape:s.landscape,margin:s.margin,guidelines:false,scale:s.scale,fitWidth:s.fitWidth,maxEmpty:s.maxEmpty,headerRows:1},o.resolve.bind(o))});return e}u.Sheet.prototype.draw=function(e,t,r){var n=this;if(n._workbook)n.recalc(n._workbook._context,function(){i(n,e,t,r)});else i(n,e,t,r)},f.prototype={forEach:function(t){Object.keys(this).forEach(function(e){t(this[e],e,this)},this)}};var g={},r=function(e,t){var r=t+":"+e;var n=g[r];if(!n){var i,a=document.createElement("div");a.style.position="fixed";a.style.left="-10000px";a.style.top="-10000px";a.style.fontFamily=e;a.style.fontSize=t+"px";a.style.whiteSpace="pre";for(var s=32;s<128;++s){i=document.createElement("span");i.appendChild(document.createTextNode(String.fromCharCode(s)));a.appendChild(i)}document.body.appendChild(a);var o={};for(s=32,i=a.firstChild;s<128&&i;++s,i=i.nextSibling)o[s]=i.offsetWidth;while(i=a.firstChild)a.removeChild(i);n=g[r]=function(e){var t=e.charCodeAt(0);var r=o[t];if(r==null){i=document.createElement("span");i.appendChild(document.createTextNode(String.fromCharCode(t)));a.appendChild(i);r=o[t]=i.offsetWidth;a.removeChild(i)}return r}}return n};u.draw={Borders:I,doLayout:c,applyIndent:o},u.drawTabularData=e})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("kendo.spreadsheet.min",["./util/undoredostack.min","./util/text-metrics.min","./util/parse-xml.min","./kendo.excel.min","./kendo.progressbar.min","./kendo.pdf.min","./spreadsheet/commands.min","./spreadsheet/formulabar.min","./spreadsheet/formulainput.min","./spreadsheet/eventlistener.min","./spreadsheet/rangelist.min","./spreadsheet/propertybag.min","./spreadsheet/references.min","./spreadsheet/navigator.min","./spreadsheet/axismanager.min","./spreadsheet/clipboard.min","./spreadsheet/range.min","./spreadsheet/sheet.min","./spreadsheet/sheetsbar.min","./spreadsheet/excel-reader.min","./spreadsheet/workbook.min","./spreadsheet/formulacontext.min","./spreadsheet/controller.min","./spreadsheet/view.min","./spreadsheet/customeditors.min","./spreadsheet/grid.min","./spreadsheet/axis.min","./spreadsheet/filter.min","./spreadsheet/sorter.min","./spreadsheet/runtime.min","./spreadsheet/calc.min","./spreadsheet/numformat.min","./spreadsheet/runtime.functions.min","./spreadsheet/runtime.functions.2.min","./spreadsheet/toolbar.min","./spreadsheet/dialogs.min","./spreadsheet/sheetbinder.min","./spreadsheet/filtermenu.min","./spreadsheet/editor.min","./spreadsheet/autofill.min","./spreadsheet/nameeditor.min","./spreadsheet/print.min"],function(){var e={id:"spreadsheet",name:"Spreadsheet",category:"web",description:"Spreadsheet component",depends:["core","binder","colorpicker","combobox","data","dom","dropdownlist","menu","ooxml","popup","sortable","tabstrip","toolbar","treeview","window","validator","excel","pdf","drawing"]};return function(n,t){if(n.support.browser.msie&&n.support.browser.version<9)return;var i=n.jQuery;var a=i.extend({F10:121,F11:122,B:66,I:73,U:85,N:78,H:72,A:65,PAGEDOWN:34,PAGEUP:33,DELETE:46,R:82},n.keys);var r=n.ui.Widget;var s=n.spreadsheet.Workbook;var o=n.spreadsheet.Controller;var h=n.spreadsheet.View;var l=".kendoSpreadsheet";var u={recalc:true,selection:true,activeCell:true,layout:true,sheetSelection:true,resize:true,editorChange:false,editorClose:false};var e={wrapper:"k-widget k-spreadsheet"};var c=n.ui.Widget.extend({init:function(e,t){r.fn.init.call(this,e,t);this.element.addClass(c.classNames.wrapper);this.element.attr("role","application");this._view=new h(this.element,{messages:this.options.messages.view,toolbar:this.options.toolbar,sheetsbar:this.options.sheetsbar});this._workbook=new s(this.options,this._view);this._controller=new o(this._view,this._workbook);this._autoRefresh=true;this._bindWorkbookEvents();this._view.workbook(this._workbook);this._view.enableClipboard(false);this.refresh();this._view.enableClipboard(true);this._resizeHandler=function(){this.resize()}.bind(this);i(window).on("resize"+l,this._resizeHandler);this.element.on("keydown"+l,this._keyDown.bind(this))},_keyDown:function(e){var t=e.keyCode;var r=i(".k-spreadsheet-quick-access-toolbar [title=Redo]");if(t===a.F11&&e.shiftKey){this._view.sheetsbar._onAddSelect();e.preventDefault();return}else if(e.altKey&&t===a.PAGEDOWN)this._view.sheetsbar.trigger("select",{name:this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex+1].name(),isAddButton:false});else if(e.altKey&&t===a.PAGEUP)this._view.sheetsbar.trigger("select",{name:this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex-1].name(),isAddButton:false});else if(e.altKey&&t===a.DELETE){var n=function(e){var t=e.sender;if(t.isConfirmed())this._view.sheetsbar.trigger("remove",{name:this.activeSheet()._name(),confirmation:true})}.bind(this);this._view.sheetsbar._openDialog("confirmation",{close:n});e.preventDefault();return}else if(e.altKey&&t===a.R){this._view.sheetsbar._createEditor();e.preventDefault();return}else if(t===a.F10&&this._view.tabstrip||t===a.TAB&&!e.shiftKey&&i(document.activeElement).is(r)){this._view.tabstrip.toolbars[this._view.tabstrip.element.find("li.k-state-active").text().toLowerCase()].element.find(":not(.k-overflow-anchor):kendoFocusable").first().trigger("focus");this._view.tabstrip.toolbars[this._view.tabstrip.element.find("li.k-state-active").text().toLowerCase()].element.find(".k-toolbar-first-visible").addClass("k-focus");e.preventDefault();return}else if(e.ctrlKey&&t===a.B)i("[data-tool=bold]")[0].click();else if(e.ctrlKey&&t===a.I)i("[data-tool=italic]")[0].click();else if(e.ctrlKey&&t===a.U)i("[data-tool=underline]")[0].click();else if(e.altKey&&t===a.H){this._view.tabstrip.select(0);e.preventDefault();return}else if(e.altKey&&t===a.N){this._view.tabstrip.select(1);e.preventDefault();return}else if(e.altKey&&t===a.A){this._view.tabstrip.select(2);e.preventDefault();return}},_resize:function(){this.refresh({layout:true})},_workbookChanging:function(e){if(this.trigger("changing",e))e.preventDefault()},_workbookChange:function(e){if(this._autoRefresh)this.refresh(e);if(e.recalc&&e.ref){var t=e.range||new n.spreadsheet.Range(e.ref,this.activeSheet());this.trigger("change",{range:t})}},_workbookCut:function(e){this.trigger("cut",e)},_workbookCopy:function(e){this.trigger("copy",e)},_workbookPaste:function(e){this.trigger("paste",e)},activeSheet:function(e){return this._workbook.activeSheet(e)},moveSheetToIndex:function(e,t){return this._workbook.moveSheetToIndex(e,t)},insertSheet:function(e){return this._workbook.insertSheet(e)},sheets:function(){return this._workbook.sheets()},removeSheet:function(e){return this._workbook.removeSheet(e)},sheetByName:function(e){return this._workbook.sheetByName(e)},sheetIndex:function(e){return this._workbook.sheetIndex(e)},sheetByIndex:function(e){return this._workbook.sheetByIndex(e)},renameSheet:function(e,t){return this._workbook.renameSheet(e,t)},refresh:function(e){if(!e)e=u;if(!e.editorClose){this._view.sheet(this._workbook.activeSheet());this._controller.sheet(this._workbook.activeSheet());this._workbook.refresh(e)}if(!e.editorChange){this._view.refresh(e);this._controller.refresh();this._view.render(e);this.trigger("render")}return this},openDialog:function(e,t){return this._view.openDialog(e,t)},autoRefresh:function(e){if(e!==t){this._autoRefresh=e;if(e===true)this.refresh();return this}return this._autoRefresh},toJSON:function(){return this._workbook.toJSON()},fromJSON:function(e){if(e.sheets){this._workbook.destroy();this._workbook=new s(i.extend({},this.options,e));this._bindWorkbookEvents();this._view.workbook(this._workbook);this._controller.workbook(this._workbook);this.activeSheet(this.activeSheet())}else this.refresh()},saveJSON:function(){return this._workbook.saveJSON()},fromFile:function(e,t){return this._workbook.fromFile(e,t)},saveAsPDF:function(e){this._workbook.saveAsPDF(i.extend({},this.options.pdf,e,{workbook:this._workbook}))},saveAsExcel:function(e){this._workbook.saveAsExcel(e)},draw:function(e,t){this._workbook.draw(e,t)},_workbookExcelExport:function(e){if(this.trigger("excelExport",e))e.preventDefault()},_workbookExcelImport:function(e){if(this.trigger("excelImport",e))e.preventDefault();else this._initProgress(e.promise)},_initProgress:function(e){var t=i("<div class='k-loading-mask' "+"style='width: 100%; height: 100%; top: 0;'>"+"<div class='k-loading-color'></div>"+"</div>").appendTo(this.element);var r=i("<div class='k-loading-progress'>").appendTo(t).kendoProgressBar({type:"chunk",chunkCount:10,min:0,max:1,value:0}).data("kendoProgressBar");e.progress(function(e){r.value(e.progress)}).always(function(){n.destroy(t);t.remove()})},_workbookPdfExport:function(e){if(this.trigger("pdfExport",e))e.preventDefault()},_workbookInsertSheet:function(e){if(this.trigger("insertSheet",e))e.preventDefault()},_workbookRemoveSheet:function(e){if(this.trigger("removeSheet",e))e.preventDefault()},_workbookSelectSheet:function(e){if(this.trigger("selectSheet",e))e.preventDefault()},_workbookRenameSheet:function(e){if(this.trigger("renameSheet",e))e.preventDefault()},_workbookInsertRow:function(e){if(this.trigger("insertRow",e))e.preventDefault()},_workbookInsertColumn:function(e){if(this.trigger("insertColumn",e))e.preventDefault()},_workbookDeleteRow:function(e){if(this.trigger("deleteRow",e))e.preventDefault()},_workbookDeleteColumn:function(e){if(this.trigger("deleteColumn",e))e.preventDefault()},_workbookHideRow:function(e){if(this.trigger("hideRow",e))e.preventDefault()},_workbookHideColumn:function(e){if(this.trigger("hideColumn",e))e.preventDefault()},_workbookUnhideRow:function(e){if(this.trigger("unhideRow",e))e.preventDefault()},_workbookUnhideColumn:function(e){if(this.trigger("unhideColumn",e))e.preventDefault()},_workbookSelect:function(e){this.trigger("select",e)},_workbookChangeFormat:function(e){this.trigger("changeFormat",e)},_workbookDataBinding:function(e){if(this.trigger("dataBinding",e))e.preventDefault()},_workbookDataBound:function(e){this.trigger("dataBound",e)},_workbookProgress:function(e){n.ui.progress(this.element,e.toggle)},_bindWorkbookEvents:function(){this._workbook.bind("cut",this._workbookCut.bind(this));this._workbook.bind("copy",this._workbookCopy.bind(this));this._workbook.bind("paste",this._workbookPaste.bind(this));this._workbook.bind("changing",this._workbookChanging.bind(this));this._workbook.bind("change",this._workbookChange.bind(this));this._workbook.bind("excelExport",this._workbookExcelExport.bind(this));this._workbook.bind("excelImport",this._workbookExcelImport.bind(this));this._workbook.bind("pdfExport",this._workbookPdfExport.bind(this));this._workbook.bind("insertSheet",this._workbookInsertSheet.bind(this));this._workbook.bind("removeSheet",this._workbookRemoveSheet.bind(this));this._workbook.bind("selectSheet",this._workbookSelectSheet.bind(this));this._workbook.bind("renameSheet",this._workbookRenameSheet.bind(this));this._workbook.bind("insertRow",this._workbookInsertRow.bind(this));this._workbook.bind("insertColumn",this._workbookInsertColumn.bind(this));this._workbook.bind("deleteRow",this._workbookDeleteRow.bind(this));this._workbook.bind("deleteColumn",this._workbookDeleteColumn.bind(this));this._workbook.bind("hideRow",this._workbookHideRow.bind(this));this._workbook.bind("hideColumn",this._workbookHideColumn.bind(this));this._workbook.bind("unhideRow",this._workbookUnhideRow.bind(this));this._workbook.bind("unhideColumn",this._workbookUnhideColumn.bind(this));this._workbook.bind("select",this._workbookSelect.bind(this));this._workbook.bind("changeFormat",this._workbookChangeFormat.bind(this));this._workbook.bind("dataBinding",this._workbookDataBinding.bind(this));this._workbook.bind("dataBound",this._workbookDataBound.bind(this));this._workbook.bind("progress",this._workbookProgress.bind(this))},destroy:function(){n.ui.Widget.fn.destroy.call(this);this._workbook.destroy();this._controller.destroy();this._view.destroy();if(this._resizeHandler)i(window).off("resize"+l,this._resizeHandler)},options:{name:"Spreadsheet",toolbar:true,sheetsbar:true,rows:200,columns:50,rowHeight:20,columnWidth:64,headerHeight:20,headerWidth:32,excel:{proxyURL:"",fileName:"Workbook.xlsx"},messages:{},pdf:{area:"workbook",fileName:"Workbook.pdf",proxyURL:"",paperSize:"a4",landscape:true,margin:null,title:null,author:null,subject:null,keywords:null,creator:"Kendo UI PDF Generator v."+n.version,date:null},defaultCellStyle:{fontFamily:"Arial",fontSize:12},useCultureDecimals:false},defineName:function(e,t,r){return this._workbook.defineName(e,t,r)},undefineName:function(e){return this._workbook.undefineName(e)},nameValue:function(e){return this._workbook.nameValue(e)},forEachName:function(e){return this._workbook.forEachName(e)},cellContextMenu:function(){return this._view.cellContextMenu},rowHeaderContextMenu:function(){return this._view.rowHeaderContextMenu},colHeaderContextMenu:function(){return this._view.colHeaderContextMenu},addImage:function(e){return this._workbook.addImage(e)},cleanupImages:function(){return this._workbook.cleanupImages()},events:["cut","copy","paste","pdfExport","excelExport","excelImport","changing","change","render","removeSheet","selectSheet","renameSheet","insertRow","insertColumn","deleteRow","insertSheet","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","changeFormat","dataBinding","dataBound"]});n.spreadsheet.ALL_REASONS=u;n.ui.plugin(c);i.extend(true,c,{classNames:e})}(window.kendo),window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()});
//# sourceMappingURL=kendo.spreadsheet.min.js.map
