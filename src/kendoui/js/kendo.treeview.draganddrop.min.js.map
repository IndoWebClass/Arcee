{"version":3,"file":"kendo.treeview.draganddrop.min.js","sources":["kendo.treeview.draganddrop.js"],"sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function(f, define){\n    define('kendo.treeview.draganddrop',[ \"./kendo.data\", \"./kendo.draganddrop\" ], f);\n})(function(){\n\nvar __meta__ = { // jshint ignore:line\n    id: \"treeview.draganddrop\",\n    name: \"Hierarchical Drag & Drop\",\n    category: \"framework\",\n    depends: [ \"core\", \"draganddrop\" ],\n    advanced: true\n};\n\n(function($, undefined){\n    var kendo = window.kendo;\n    var ui = kendo.ui;\n    var proxy = $.proxy;\n    var extend = $.extend;\n    var VISIBILITY = \"visibility\";\n    var KSTATEHOVER = \"k-state-hover\";\n    var INPUTSELECTOR = \"input,a:not(.k-in),textarea,.k-multiselect-wrap,select,button,a.k-button>.k-icon,button.k-button>.k-icon,span.k-icon.k-i-arrow-60-right,span.k-icon.k-i-arrow-45-down-right\";\n    var DROPHINTTEMPLATE = \"<div class='k-drop-hint k-drop-hint-h'>\" +\n                                \"<div class='k-drop-hint-start'></div>\" +\n                                \"<div class='k-drop-hint-line'></div>\" +\n                            \"</div>\";\n\n    ui.HierarchicalDragAndDrop = kendo.Class.extend({\n        init: function (element, options) {\n            this.element = element;\n            this.hovered = element;\n            this.options = extend({\n                dragstart: $.noop, drag: $.noop, drop: $.noop, dragend: $.noop\n            }, options);\n\n            this._draggable = new ui.Draggable(element, {\n                ignore: INPUTSELECTOR,\n                filter: options.filter,\n                autoScroll: options.autoScroll,\n                cursorOffset: {\n                    left: 10,\n                    top: kendo.support.mobileOS ? -40 / kendo.support.zoomLevel() : 10\n                },\n                hint: proxy(this._hint, this),\n                dragstart: proxy(this.dragstart, this),\n                dragcancel: proxy(this.dragcancel, this),\n                drag: proxy(this.drag, this),\n                dragend: proxy(this.dragend, this),\n                $angular: options.$angular,\n                holdToDrag: options.holdToDrag\n            });\n        },\n\n        _hint: function(element) {\n            return \"<div class='k-drag-clue'>\" +\n                        \"<span class='k-icon k-drag-status'></span>\" +\n                        this.options.hintText(element) +\n                    \"</div>\";\n        },\n\n        _removeTouchHover: function() {\n            if (kendo.support.touch && this.hovered) {\n                this.hovered.find(\".\" + KSTATEHOVER).removeClass(KSTATEHOVER);\n                this.hovered = false;\n            }\n        },\n\n        _hintStatus: function(newStatus) {\n            var statusElement = this._draggable.hint.find(\".k-drag-status\")[0];\n\n            if (newStatus) {\n                statusElement.className = \"k-icon k-drag-status \" + newStatus;\n            } else {\n                return kendo.trim(statusElement.className.replace(/(p|k)-(icon|drag-status)/g, \"\"));\n            }\n        },\n\n        dragstart: function (e) {\n            this.source = e.currentTarget.closest(this.options.itemSelector);\n\n            if (this.options.dragstart(this.source)) {\n                e.preventDefault();\n            }\n\n            if (this.options.reorderable) {\n                this.dropHint = $(DROPHINTTEMPLATE)\n                    .css(VISIBILITY, \"hidden\")\n                    .appendTo(this.element);\n            } else {\n                this.dropHint = $();\n            }\n        },\n\n        drag: function (e) {\n            var options = this.options;\n            var source = this.source;\n            var target = this.dropTarget = $(kendo.eventTarget(e));\n            var container = target.closest(options.allowedContainers);\n            var hoveredItem, itemHeight, itemTop, itemContent, delta;\n            var insertOnTop, insertOnBottom, addChild;\n            var itemData, position, status;\n\n            if (!container.length) {\n                // dragging outside of allowed elements\n                status = \"k-i-cancel\";\n                this._removeTouchHover();\n            } else if (source[0] == target[0] || options.contains(source[0], target[0])) {\n                // dragging item within itself\n                status = \"k-i-cancel\";\n            } else {\n                // moving or reordering item\n                status = \"k-i-insert-middle\";\n\n                itemData = options.itemFromTarget(target);\n                hoveredItem = itemData.item;\n\n                if (hoveredItem.length) {\n                    this._removeTouchHover();\n                    itemHeight = kendo._outerHeight(hoveredItem);\n                    itemContent = itemData.content;\n\n                    if (options.reorderable) {\n                        delta = itemHeight / (itemContent.length > 0 ? 4 : 2);\n                        itemTop = kendo.getOffset(hoveredItem).top;\n\n                        insertOnTop = e.y.location < (itemTop + delta);\n                        insertOnBottom = (itemTop + itemHeight - delta) < e.y.location;\n                        addChild = itemContent.length && !insertOnTop && !insertOnBottom;\n                    } else {\n                        addChild = true;\n                        insertOnTop = false;\n                        insertOnBottom = false;\n                    }\n\n                    this.hovered = addChild ? container : false;\n\n                    this.dropHint.css(VISIBILITY, addChild ? \"hidden\" : \"visible\");\n\n                    if (this._lastHover && this._lastHover[0] != itemContent[0]) {\n                        this._lastHover.removeClass(KSTATEHOVER);\n                    }\n\n                    this._lastHover = itemContent.toggleClass(KSTATEHOVER, addChild);\n\n                    if (addChild) {\n                        status = \"k-i-plus\";\n                    } else {\n                        position = hoveredItem.position();\n                        position.top += insertOnTop ? 0 : itemHeight;\n\n                        this.dropHint.css(position)\n                            [insertOnTop ? \"prependTo\" : \"appendTo\"]\n                            (options.dropHintContainer(hoveredItem));\n\n                        if (insertOnTop && itemData.first) {\n                            status = \"k-i-insert-up\";\n                        }\n\n                        if (insertOnBottom && itemData.last) {\n                            status = \"k-i-insert-down\";\n                        }\n                    }\n                } else if (target[0] != this.dropHint[0]) {\n                    if (this._lastHover) {\n                        this._lastHover.removeClass(KSTATEHOVER);\n                    }\n\n                    if (!$.contains(this.element[0], container[0])) {\n                        // moving node to different element\n                        status = \"k-i-plus\";\n                    } else {\n                        status = \"k-i-cancel\";\n                    }\n                }\n            }\n\n            this.options.drag({\n                originalEvent: e.originalEvent,\n                source: source,\n                target: target,\n                pageY: e.y.location,\n                pageX: e.x.location,\n                status: status.substring(2),\n                setStatus: function(value) {\n                    status = value;\n                }\n            });\n\n            if (status.indexOf(\"k-i-insert\") !== 0) {\n                this.dropHint.css(VISIBILITY, \"hidden\");\n            }\n\n            this._hintStatus(status);\n        },\n\n        dragcancel: function() {\n            this.dropHint.remove();\n        },\n\n        dragend: function (e) {\n            var position = \"over\",\n                source = this.source,\n                destination,\n                dropHint = this.dropHint,\n                dropTarget = this.dropTarget,\n                eventArgs, dropPrevented;\n\n            if (dropHint.css(VISIBILITY) == \"visible\") {\n                position = this.options.dropPositionFrom(dropHint);\n                destination = dropHint.closest(this.options.itemSelector);\n            } else if (dropTarget) {\n                destination = dropTarget.closest(this.options.itemSelector);\n\n                // moving node to root element\n                if (!destination.length) {\n                    destination = dropTarget.closest(this.options.allowedContainers);\n                }\n            }\n\n            eventArgs = {\n                originalEvent: e.originalEvent,\n                source: source[0],\n                destination: destination[0],\n                valid: this._hintStatus() != \"k-i-cancel\",\n                setValid: function(newValid) {\n                    this.valid = newValid;\n                },\n                dropTarget: dropTarget[0],\n                position: position\n            };\n\n            dropPrevented = this.options.drop(eventArgs);\n\n            dropHint.remove();\n            this._removeTouchHover();\n            if (this._lastHover) {\n                this._lastHover.removeClass(KSTATEHOVER);\n            }\n\n            if (!eventArgs.valid || dropPrevented) {\n                this._draggable.dropped = eventArgs.valid;\n                return;\n            }\n\n            this._draggable.dropped = true;\n\n            this.options.dragend({\n                originalEvent: e.originalEvent,\n                source: source,\n                destination: destination,\n                position: position\n            });\n        },\n\n        destroy: function() {\n            this._lastHover = this.hovered = null;\n            this._draggable.destroy();\n        }\n    });\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n\n"],"names":["define","__meta__","id","name","category","depends","advanced","$","window","kendo","jQuery","undefined","ui","proxy","extend","VISIBILITY","KSTATEHOVER","INPUTSELECTOR","DROPHINTTEMPLATE","HierarchicalDragAndDrop","Class","init","element","options","this","hovered","dragstart","noop","drag","drop","dragend","_draggable","Draggable","ignore","filter","autoScroll","cursorOffset","left","top","support","mobileOS","zoomLevel","hint","_hint","dragcancel","$angular","holdToDrag","hintText","_removeTouchHover","touch","find","removeClass","_hintStatus","newStatus","statusElement","className","trim","replace","e","source","currentTarget","closest","itemSelector","preventDefault","reorderable","dropHint","css","appendTo","target","dropTarget","eventTarget","container","allowedContainers","hoveredItem","itemHeight","itemTop","itemContent","delta","insertOnTop","insertOnBottom","addChild","itemData","position","status","length","contains","itemFromTarget","item","_outerHeight","content","getOffset","y","location","_lastHover","toggleClass","dropHintContainer","first","last","originalEvent","pageY","pageX","x","substring","setStatus","value","indexOf","remove","destination","eventArgs","dropPrevented","dropPositionFrom","valid","setValid","newValid","dropped","destroy","amd","a1","a2","a3"],"mappings":"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"}